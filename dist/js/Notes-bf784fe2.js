var e=(e,a,l)=>new Promise((t,i)=>{var s=e=>{try{o(l.next(e))}catch(a){i(a)}},n=e=>{try{o(l.throw(e))}catch(a){i(a)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,n);o((l=l.apply(e,a)).next())});import{d as a,q as l,r as t,b as i,t as s,al as n,ar as o,o as u,c,R as d,a as r,J as v,u as p,P as m,O as g,K as f,M as h,Q as y,a4 as _,D as k,W as z}from"./chunk-bb5ca2a1.js";import{f as b}from"./chunk-8c8694a4.js";import{_ as C}from"./chunk-a96cebc7.js";import{_ as x}from"./chunk-9c6aa90d.js";import{n as S,r as w,p as V,o as j,q as P,j as U,E as T,b as q}from"./chunk-e922f209.js";import{_ as N}from"../assets/index-ffe4e112.js";import"./chunk-cdccf614.js";import"./chunk-27701a41.js";const B={class:"flex flex-col mt-3 flex-1"},D={class:"notes-container"},$={class:"header-section"},E={class:"header-left"},G={class:"icon-wrapper"},H={class:"header-subtitle"},I={class:"header-actions"},J={class:"notes-grid"},K={key:0,class:"empty-state"},L=["onClick"],M={class:"note-header"},O={class:"note-title"},Q={class:"note-actions"},R={class:"note-content"},W={class:"note-text"},A={class:"note-footer"},F={class:"note-time"},X={class:"time-value"},Y={key:0,class:"pagination-wrapper"},Z={class:"form-container"},ee={class:"dialog-footer"},ae={key:0,class:"detail-container"},le={class:"detail-header"},te={class:"detail-title"},ie={class:"detail-meta"},se={class:"meta-item"},ne={class:"meta-item"},oe={class:"detail-content"},ue={class:"content-wrapper"},ce={class:"content-text"},de={class:"dialog-footer"},re=N(a({__name:"Notes",setup(a){const N=l({title:"笔记备忘录"}),re=t([]),ve=t(null),pe=t(!1),me=t(!1),ge=t(null),fe=t({total:0,page:1,pageSize:12,totalPages:0,hasNext:!1,hasPrev:!1}),he=l({title:"",content:""}),ye=t(!1),_e=t(!1),ke=(a=1,l=12)=>e(this,null,function*(){try{ye.value=!0;const e=yield b.get("/api/notes",{params:{page:a,pageSize:l}});if(200===e.status){const a=e.data;re.value=a.data||[],a.pagination&&(fe.value=a.pagination)}}catch(e){T.error("获取笔记列表失败")}finally{ye.value=!1}}),ze=e=>{ke(e,fe.value.pageSize)},be=e=>{fe.value.pageSize=e,ke(1,e)},Ce=()=>e(this,null,function*(){if(he.title.trim()&&he.content.trim())try{_e.value=!0;201===(yield b.post("/api/notes",{title:he.title.trim(),content:he.content.trim()})).status?(T.success("创建成功"),me.value=!1,Pe(),yield ke(fe.value.page,fe.value.pageSize)):T.error("创建失败")}catch(e){T.error("创建失败")}finally{_e.value=!1}else T.warning("标题和内容不能为空")}),xe=()=>e(this,null,function*(){if(ge.value&&he.title.trim()&&he.content.trim())try{_e.value=!0;200===(yield b.put(`/api/notes/${ge.value}`,{title:he.title.trim(),content:he.content.trim()})).status?(T.success("更新成功"),me.value=!1,pe.value=!1,ge.value=null,Pe(),yield ke(fe.value.page,fe.value.pageSize)):T.error("更新失败")}catch(e){T.error("更新失败")}finally{_e.value=!1}else T.warning("标题和内容不能为空")}),Se=a=>e(this,null,function*(){var e;yield q.confirm("确定要删除这条笔记吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});try{_e.value=!0;200===(yield b.delete(`/api/notes/${a.id}`)).status?(T.success("删除成功"),(null==(e=ve.value)?void 0:e.id)===a.id&&(ve.value=null),1===re.value.length&&fe.value.page>1?yield ke(fe.value.page-1,fe.value.pageSize):yield ke(fe.value.page,fe.value.pageSize)):T.error("删除失败")}catch(l){T.error("删除失败")}finally{_e.value=!1}}),we=e=>{pe.value=!0,ge.value=e.id,he.title=e.title,he.content=e.content,me.value=!0},Ve=e=>{pe.value||(ve.value=e,me.value=!1)},je=()=>{ve.value=null,pe.value=!1,Pe(),me.value=!0},Pe=()=>{he.title="",he.content=""},Ue=e=>new Date(e).toLocaleString("zh-CN"),Te=i(()=>null!==ve.value&&!me.value&&!pe.value);return s(()=>{ke()}),(e,a)=>{const l=n("el-icon"),t=n("el-button"),i=n("el-pagination"),s=n("el-input"),b=n("el-form-item"),T=n("el-form"),q=n("el-dialog"),ge=n("el-text"),Pe=o("loading");return u(),c("div",B,[d(C,{title:N.title},null,8,["title"]),r("div",D,[r("div",$,[r("div",E,[r("div",G,[d(l,{class:"header-icon"},{default:v(()=>[d(p(S))]),_:1})]),r("div",null,[a[13]||(a[13]=r("h3",{class:"header-title"},"我的笔记",-1)),r("p",H,"共 "+m(fe.value.total)+" 条笔记",1)])]),r("div",I,[d(t,{class:"action-btn refresh-btn",onClick:a[0]||(a[0]=e=>ke(fe.value.page,fe.value.pageSize)),icon:p(w),loading:ye.value,disabled:ye.value,circle:""},null,8,["icon","loading","disabled"]),d(t,{class:"action-btn create-btn",type:"primary",onClick:je,icon:p(V)},{default:v(()=>a[14]||(a[14]=[g(" 新建笔记 ",-1)])),_:1,__:[14]},8,["icon"])])]),f((u(),c("div",J,[0!==re.value.length||ye.value?h("",!0):(u(),c("div",K,[d(l,{class:"empty-icon"},{default:v(()=>[d(p(S))]),_:1}),a[16]||(a[16]=r("h3",{class:"empty-title"},"暂无笔记",-1)),a[17]||(a[17]=r("p",{class:"empty-desc"},"开始创建你的第一条笔记吧",-1)),d(t,{type:"primary",onClick:je,icon:p(V)},{default:v(()=>a[15]||(a[15]=[g("创建笔记",-1)])),_:1,__:[15]},8,["icon"])])),(u(!0),c(y,null,_(re.value,e=>{var l;return u(),c("div",{key:e.id,class:k(["note-card",{"note-active":(null==(l=ve.value)?void 0:l.id)===e.id}]),onClick:a=>Ve(e)},[r("div",M,[r("h4",O,m(e.title),1),r("div",Q,[d(t,{class:"action-icon",size:"small",icon:p(j),onClick:z(a=>Ve(e),["stop"]),circle:"",plain:""},null,8,["icon","onClick"]),d(t,{class:"action-icon edit-icon",size:"small",type:"primary",icon:p(P),loading:_e.value,disabled:_e.value,onClick:z(a=>we(e),["stop"]),circle:"",plain:""},null,8,["icon","loading","disabled","onClick"]),d(t,{class:"action-icon delete-icon",size:"small",type:"danger",icon:p(U),loading:_e.value,disabled:_e.value,onClick:z(a=>Se(e),["stop"]),circle:"",plain:""},null,8,["icon","loading","disabled","onClick"])])]),r("div",R,[r("p",W,m(e.content),1)]),r("div",A,[r("div",F,[a[18]||(a[18]=r("span",{class:"time-label"},"更新于",-1)),r("span",X,m(Ue(e.updateTime)),1)])])],10,L)}),128))])),[[Pe,ye.value]]),fe.value.total>0?(u(),c("div",Y,[d(i,{"current-page":fe.value.page,"onUpdate:currentPage":a[1]||(a[1]=e=>fe.value.page=e),"page-size":fe.value.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>fe.value.pageSize=e),"page-sizes":[6,12,24,48],total:fe.value.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:be,onCurrentChange:ze,class:"custom-pagination"},null,8,["current-page","page-size","total"])])):h("",!0),d(q,{modelValue:me.value,"onUpdate:modelValue":a[7]||(a[7]=e=>me.value=e),title:pe.value?"编辑笔记":"新建笔记",width:"90%","max-width":"600px",class:"note-dialog",onClose:a[8]||(a[8]=e=>pe.value=!1),"destroy-on-close":""},{footer:v(()=>[r("div",ee,[d(t,{size:"large",disabled:_e.value,onClick:a[5]||(a[5]=e=>{me.value=!1,pe.value=!1})},{default:v(()=>a[19]||(a[19]=[g(" 取消 ",-1)])),_:1,__:[19]},8,["disabled"]),d(t,{type:"primary",size:"large",loading:_e.value,disabled:_e.value,onClick:a[6]||(a[6]=e=>pe.value?xe():Ce())},{default:v(()=>[g(m(pe.value?"保存修改":"创建笔记"),1)]),_:1},8,["loading","disabled"])])]),default:v(()=>[r("div",Z,[d(T,{model:he,"label-position":"top"},{default:v(()=>[d(b,{label:"笔记标题",required:"",class:"form-item"},{default:v(()=>[d(s,{modelValue:he.title,"onUpdate:modelValue":a[3]||(a[3]=e=>he.title=e),placeholder:"请输入笔记标题",size:"large",class:"title-input"},null,8,["modelValue"])]),_:1}),d(b,{label:"笔记内容",required:"",class:"form-item"},{default:v(()=>[d(s,{modelValue:he.content,"onUpdate:modelValue":a[4]||(a[4]=e=>he.content=e),type:"textarea",rows:12,placeholder:"在这里记录你的想法...",class:"content-textarea",resize:"vertical"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue","title"]),d(q,{modelValue:Te.value,"onUpdate:modelValue":a[11]||(a[11]=e=>Te.value=e),title:"笔记详情",width:"90%","max-width":"700px",class:"detail-dialog",onClose:a[12]||(a[12]=e=>ve.value=null),"destroy-on-close":""},{footer:v(()=>[r("div",de,[d(t,{size:"large",onClick:a[9]||(a[9]=e=>ve.value=null)},{default:v(()=>a[20]||(a[20]=[g("关闭",-1)])),_:1,__:[20]}),d(t,{type:"primary",size:"large",icon:p(P),onClick:a[10]||(a[10]=e=>ve.value&&we(ve.value))},{default:v(()=>a[21]||(a[21]=[g(" 编辑笔记 ",-1)])),_:1,__:[21]},8,["icon"])])]),default:v(()=>[ve.value?(u(),c("div",ae,[r("div",le,[r("h2",te,m(ve.value.title),1),r("div",ie,[r("span",se,[d(l,null,{default:v(()=>[d(p(S))]),_:1}),g(" 创建于 "+m(Ue(ve.value.createTime)),1)]),r("span",ne,[d(l,null,{default:v(()=>[d(p(P))]),_:1}),g(" 更新于 "+m(Ue(ve.value.updateTime)),1)])])]),r("div",oe,[r("div",ue,[r("pre",ce,m(ve.value.content),1)])])])):h("",!0)]),_:1},8,["modelValue"])]),d(x,{title:"描述"},{default:v(()=>[d(ge,null,{default:v(()=>a[22]||(a[22]=[g(" 在线笔记记录工具，支持创建、编辑、删除笔记，数据安全存储在云端。您可以随时记录想法、待办事项、学习笔记等，支持富文本编辑，数据实时同步。 ",-1)])),_:1,__:[22]})]),_:1})])}}}),[["__scopeId","data-v-34e5dfe9"]]);export{re as default};
