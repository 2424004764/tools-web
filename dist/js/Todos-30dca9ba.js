var e=(e,l,a)=>new Promise((t,i)=>{var o=e=>{try{u(a.next(e))}catch(l){i(l)}},s=e=>{try{u(a.throw(e))}catch(l){i(l)}},u=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,s);u((a=a.apply(e,l)).next())});import{f as l}from"./chunk-183b2139.js";import{_ as a}from"./chunk-08a8c02c.js";import{_ as t}from"./chunk-9c6aa90d.js";import{r as i,p as o,B as s,q as u,j as r,E as n,b as d}from"./chunk-ebe7e565.js";import{d as c,q as p,r as m,t as v,al as g,ar as y,o as f,c as x,R as h,a as b,J as k,O as _,u as w,P as D,K as V,Q as z,a4 as C,D as S,M as j}from"./chunk-bb5ca2a1.js";import{_ as U}from"../assets/index-a02a0b09.js";import"./chunk-04652fe6.js";import"./chunk-b2647718.js";const P={class:"flex flex-col flex-1 bg-white rounded-md p-4 c-sm:p-6 mt-3"},T={class:"mb-4 p-3 border border-gray-200 rounded-lg bg-gray-50"},B={class:"flex gap-3 items-end"},L={class:"flex-1"},N={class:"w-40"},$={class:"flex justify-between items-center mb-4"},q={class:"flex gap-2"},I={class:"space-y-3"},J={class:"grid grid-cols-2 gap-3"},E={class:"flex-1"},K={key:0,class:"text-center py-12 text-gray-500"},M={key:1,class:"space-y-2"},O={class:"flex-1 min-w-0"},Q={class:"flex items-center gap-2"},R={class:"flex items-center gap-3 text-xs text-gray-500 mt-1"},A={key:0,class:"flex items-center gap-1"},F={class:"flex gap-1"},G={key:0,class:"mt-4 flex justify-center"},H={class:"text-gray-700 leading-relaxed"},W=U(c({__name:"Todos",setup(c){const U=p({title:"待办事项",desc:"在线待办事项管理工具，帮助您高效管理日常任务。支持设置优先级（低/中/高）、截止日期提醒，一键标记完成状态。所有数据安全存储在云端，登录后即可随时随地访问和管理您的待办清单。"}),W=m([]),X=m(!1),Y=m(!1),Z=m(null),ee=m({total:0,page:1,pageSize:10,totalPages:0,hasNext:!1,hasPrev:!1}),le=p({title:"",priority:""}),ae=p({title:"",priority:"medium",dueDate:""}),te=m(!1),ie=m(!1),oe=(a=1,t=10)=>e(this,null,function*(){try{te.value=!0;const e={page:a,pageSize:t};le.title&&(e.title=le.title),le.priority&&(e.priority=le.priority);const i=yield l.get("/api/todos",{params:e});if(200===i.status){const e=i.data;W.value=e.data||[],e.pagination&&(ee.value=e.pagination)}}catch(e){n.error("获取待办事项失败")}finally{te.value=!1}}),se=()=>{oe(1,ee.value.pageSize)},ue=()=>{le.title="",le.priority="",oe(1,ee.value.pageSize)},re=e=>{oe(e,ee.value.pageSize)},ne=()=>e(this,null,function*(){if(ae.title.trim())try{ie.value=!0;201===(yield l.post("/api/todos",{title:ae.title.trim(),priority:ae.priority,dueDate:ae.dueDate?new Date(ae.dueDate).toLocaleDateString("zh-CN"):null})).status&&(n.success("创建成功"),X.value=!1,ve(),yield oe(ee.value.page,ee.value.pageSize))}catch(e){n.error("创建失败")}finally{ie.value=!1}else n.warning("标题不能为空")}),de=()=>e(this,null,function*(){if(Z.value&&ae.title.trim())try{ie.value=!0;200===(yield l.put(`/api/todos/${Z.value}`,{title:ae.title.trim(),priority:ae.priority,dueDate:ae.dueDate?new Date(ae.dueDate).toLocaleDateString("zh-CN"):null})).status&&(n.success("更新成功"),X.value=!1,Y.value=!1,Z.value=null,ve(),yield oe(ee.value.page,ee.value.pageSize))}catch(e){n.error("更新失败")}finally{ie.value=!1}else n.warning("标题不能为空")}),ce=a=>e(this,null,function*(){try{200===(yield l.put(`/api/todos/${a.id}`,{completed:1===a.completed?0:1})).status&&(n.success(1===a.completed?"已标记为未完成":"已标记为完成"),yield oe(ee.value.page,ee.value.pageSize))}catch(e){n.error("更新状态失败")}}),pe=a=>e(this,null,function*(){try{yield d.confirm("确定要删除这个待办事项吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});200===(yield l.delete(`/api/todos/${a}`)).status&&(n.success("删除成功"),yield oe(ee.value.page,ee.value.pageSize))}catch(e){"cancel"!==e&&n.error("删除失败")}}),me=()=>{ve(),Y.value=!1,X.value=!0},ve=()=>{ae.title="",ae.priority="medium",ae.dueDate="",Z.value=null},ge=()=>{X.value=!1,Y.value=!1,ve()},ye=e=>({low:"低",medium:"中",high:"高"}[e]||e);return v(()=>{oe()}),(e,l)=>{const n=g("el-input"),d=g("el-option"),c=g("el-select"),p=g("el-button"),m=g("el-date-picker"),v=g("el-dialog"),ve=g("el-checkbox"),fe=g("el-icon"),xe=g("el-pagination"),he=y("loading");return f(),x(z,null,[h(a,{info:U},null,8,["info"]),b("div",P,[b("div",T,[b("div",B,[b("div",L,[l[9]||(l[9]=b("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"标题搜索",-1)),h(n,{modelValue:le.title,"onUpdate:modelValue":l[0]||(l[0]=e=>le.title=e),placeholder:"输入标题关键词",clearable:""},null,8,["modelValue"])]),b("div",N,[l[10]||(l[10]=b("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"优先级",-1)),h(c,{modelValue:le.priority,"onUpdate:modelValue":l[1]||(l[1]=e=>le.priority=e),placeholder:"全部",clearable:"",class:"w-full"},{default:k(()=>[h(d,{label:"低",value:"low"}),h(d,{label:"中",value:"medium"}),h(d,{label:"高",value:"high"})]),_:1},8,["modelValue"])]),h(p,{type:"primary",onClick:se},{default:k(()=>l[11]||(l[11]=[_("搜索",-1)])),_:1,__:[11]}),h(p,{onClick:ue},{default:k(()=>l[12]||(l[12]=[_("重置",-1)])),_:1,__:[12]})])]),b("div",$,[l[15]||(l[15]=b("h2",{class:"text-xl font-semibold text-gray-800"},"我的待办",-1)),b("div",q,[h(p,{icon:w(i),onClick:l[2]||(l[2]=e=>oe(ee.value.page,ee.value.pageSize)),loading:te.value},{default:k(()=>l[13]||(l[13]=[_(" 刷新 ",-1)])),_:1,__:[13]},8,["icon","loading"]),h(p,{type:"primary",icon:w(o),onClick:me},{default:k(()=>l[14]||(l[14]=[_(" 新建待办 ",-1)])),_:1,__:[14]},8,["icon"])])]),h(v,{modelValue:X.value,"onUpdate:modelValue":l[7]||(l[7]=e=>X.value=e),title:Y.value?"编辑待办":"新建待办",width:"500px"},{footer:k(()=>[h(p,{onClick:ge},{default:k(()=>l[19]||(l[19]=[_("取消",-1)])),_:1,__:[19]}),h(p,{type:"primary",onClick:l[6]||(l[6]=e=>Y.value?de():ne()),loading:ie.value},{default:k(()=>[_(D(Y.value?"更新":"创建"),1)]),_:1},8,["loading"])]),default:k(()=>[b("div",I,[b("div",null,[l[16]||(l[16]=b("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"标题",-1)),h(n,{modelValue:ae.title,"onUpdate:modelValue":l[3]||(l[3]=e=>ae.title=e),placeholder:"请输入待办事项标题",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),b("div",J,[b("div",null,[l[17]||(l[17]=b("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"优先级",-1)),h(c,{modelValue:ae.priority,"onUpdate:modelValue":l[4]||(l[4]=e=>ae.priority=e),class:"w-full"},{default:k(()=>[h(d,{label:"低",value:"low"}),h(d,{label:"中",value:"medium"}),h(d,{label:"高",value:"high"})]),_:1},8,["modelValue"])]),b("div",null,[l[18]||(l[18]=b("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"截止日期",-1)),h(m,{modelValue:ae.dueDate,"onUpdate:modelValue":l[5]||(l[5]=e=>ae.dueDate=e),type:"date",placeholder:"选择日期",class:"w-full"},null,8,["modelValue"])])])])]),_:1},8,["modelValue","title"]),V((f(),x("div",E,[0===W.value.length?(f(),x("div",K," 暂无待办事项 ")):(f(),x("div",M,[(f(!0),x(z,null,C(W.value,e=>{return f(),x("div",{key:e.id,class:S(["flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",{"bg-gray-50":1===e.completed}])},[h(ve,{"model-value":1===e.completed,onChange:l=>ce(e)},null,8,["model-value","onChange"]),b("div",O,[b("div",Q,[b("span",{class:S([{"line-through text-gray-400":1===e.completed},"font-medium"])},D(e.title),3),b("span",{class:S([(l=e.priority,{low:"text-green-600",medium:"text-yellow-600",high:"text-red-600"}[l]||"text-gray-600"),"text-xs"])},D(ye(e.priority)),3)]),b("div",R,[e.dueDate?(f(),x("span",A,[h(fe,null,{default:k(()=>[h(w(s))]),_:1}),_(" "+D(e.dueDate),1)])):j("",!0),b("span",null,"创建于 "+D(new Date(e.createTime).toLocaleDateString()),1)])]),b("div",F,[h(p,{icon:w(u),size:"small",onClick:l=>(e=>{ae.title=e.title,ae.priority=e.priority,ae.dueDate=e.dueDate||"",Z.value=e.id,Y.value=!0,X.value=!0})(e)},null,8,["icon","onClick"]),h(p,{icon:w(r),size:"small",type:"danger",onClick:l=>pe(e.id)},null,8,["icon","onClick"])])],2);var l}),128))]))])),[[he,te.value]]),ee.value.total>0?(f(),x("div",G,[h(xe,{"current-page":ee.value.page,"onUpdate:currentPage":l[8]||(l[8]=e=>ee.value.page=e),"page-size":ee.value.pageSize,total:ee.value.total,layout:"prev, pager, next, total",onCurrentChange:re},null,8,["current-page","page-size","total"])])):j("",!0)]),h(t,{title:"描述"},{default:k(()=>[b("div",H,[b("p",null,D(U.desc),1)])]),_:1})],64)}}}),[["__scopeId","data-v-cff3efd3"]]);export{W as default};
