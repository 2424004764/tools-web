var e=(e,a,l)=>new Promise((t,s)=>{var i=e=>{try{o(l.next(e))}catch(a){s(a)}},n=e=>{try{o(l.throw(e))}catch(a){s(a)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,n);o((l=l.apply(e,a)).next())});import{d as a,q as l,az as t,r as s,t as i,b as n,al as o,ar as c,o as u,c as r,R as d,a as v,J as p,u as m,P as q,O as f,K as h,M as g,Q as w,a4 as y,D as _,W as b,I as k}from"./chunk-bb5ca2a1.js";import{f as C}from"./chunk-957ece3b.js";import{_ as z}from"./chunk-aa90e3ba.js";import{_ as x}from"./chunk-9c6aa90d.js";import{E as I,G as V,r as Q,p as A,n as P,H as S,d as U,o as j,j as T,I as $,b as L}from"./chunk-d6839cfd.js";import{b as H,_ as M}from"../assets/index-561c40ed.js";import"./chunk-5443edaa.js";import"./chunk-eb404ece.js";const N={class:"flex flex-col mt-3 flex-1"},B={class:"qa-container"},D={class:"header-section"},E={class:"header-left"},F={class:"icon-wrapper"},G={class:"header-subtitle"},J={class:"header-actions"},K={class:"qa-grid"},O={key:0,class:"empty-state"},R=["onClick"],W={class:"qa-header"},X={class:"qa-title"},Y={class:"qa-actions"},Z={class:"qa-content"},ee={key:0,class:"qa-items-preview"},ae={class:"qa-question"},le={class:"question-label"},te={class:"question-text"},se={class:"qa-answer"},ie={class:"answer-label"},ne={class:"answer-text"},oe={key:0,class:"more-items"},ce={class:"more-text"},ue={key:1,class:"qa-fallback"},re={class:"qa-question"},de={class:"question-text"},ve={class:"qa-answer"},pe={class:"answer-text"},me={class:"qa-footer"},qe={class:"qa-meta"},fe={class:"qa-time"},he={class:"time-value"},ge={class:"qa-status"},we={key:0,class:"pagination-wrapper"},ye={class:"form-container"},_e={class:"qa-items-container"},be={class:"qa-item-header"},ke={class:"qa-item-title"},Ce={class:"qa-item-content"},ze={class:"dialog-footer"},xe={key:0,class:"detail-container"},Ie={class:"detail-header"},Ve={class:"detail-title"},Qe={class:"detail-meta"},Ae={class:"meta-item"},Pe={class:"meta-item"},Se={class:"meta-item"},Ue={class:"detail-content"},je={class:"content-wrapper"},Te={key:0,class:"qa-detail-items"},$e={class:"qa-detail-question"},Le={class:"detail-question-label"},He={class:"detail-question-text"},Me={class:"qa-detail-answer"},Ne={class:"detail-answer-label"},Be={class:"detail-answer-text"},De={key:1,class:"qa-detail-fallback"},Ee={class:"qa-detail-question"},Fe={class:"detail-question-text"},Ge={class:"qa-detail-answer"},Je={class:"detail-answer-text"},Ke={class:"dialog-footer"},Oe={key:0,class:"preview-container"},Re={class:"preview-header"},We={class:"preview-title"},Xe={class:"preview-actions"},Ye={class:"preview-content"},Ze={key:0,class:"preview-header-content"},ea=["innerHTML"],aa={class:"preview-qa-section"},la={key:0,class:"preview-qa-items"},ta={class:"preview-question-section"},sa={class:"preview-question-title"},ia={class:"preview-question-content"},na={class:"preview-answer-section"},oa={class:"preview-answer-title"},ca={class:"preview-answer-content"},ua={key:1,class:"preview-qa-fallback"},ra={class:"preview-question-section"},da={class:"preview-question-content"},va={class:"preview-answer-section"},pa={class:"preview-answer-content"},ma={key:1,class:"preview-footer-content"},qa=["innerHTML"],fa={class:"dialog-footer"},ha=M(a({__name:"QA",setup(a){const M=l({title:"QA问答页面制作"}),ha=H(),ga=t(),wa=s([]),ya=s(null),_a=s(!1),ba=s(!1),ka=s(null),Ca=s(!1),za=s({total:0,page:1,pageSize:12,totalPages:0,hasNext:!1,hasPrev:!1}),xa=l({title:"",qaItems:[{question:"",answer:""}],headerContent:"",footerContent:"",isPublic:!1}),Ia=s(!1),Va=s(!1);i(()=>{if(!ha.getLoginStatus)return I.warning("请先登录"),void ga.push("/login");Qa()});const Qa=(a=1,l=12)=>e(this,null,function*(){try{Ia.value=!0;const e=yield C.get("/api/qa",{params:{page:a,pageSize:l}});if(200===e.status){const a=e.data;wa.value=a.data||[],a.pagination&&(za.value=a.pagination)}}catch(e){I.error("获取QA列表失败")}finally{Ia.value=!1}}),Aa=e=>{Qa(e,za.value.pageSize)},Pa=e=>{za.value.pageSize=e,Qa(1,e)},Sa=()=>{xa.qaItems.push({question:"",answer:""})},Ua=()=>e(this,null,function*(){if(xa.title.trim()&&0!==xa.qaItems.length){for(let e=0;e<xa.qaItems.length;e++){const a=xa.qaItems[e];if(!a.question.trim()||!a.answer.trim())return void I.warning(`第${e+1}个问答对的问题和答案不能为空`)}try{Va.value=!0;201===(yield C.post("/api/qa",{title:xa.title.trim(),qaItems:xa.qaItems.map(e=>({question:e.question.trim(),answer:e.answer.trim()})),headerContent:xa.headerContent.trim(),footerContent:xa.footerContent.trim(),isPublic:xa.isPublic})).status?(I.success("创建成功"),ba.value=!1,Na(),yield Qa(za.value.page,za.value.pageSize)):I.error("创建失败")}catch(e){I.error("创建失败")}finally{Va.value=!1}}else I.warning("标题和问答对不能为空")}),ja=()=>e(this,null,function*(){if(ka.value&&xa.title.trim()&&0!==xa.qaItems.length){for(let e=0;e<xa.qaItems.length;e++){const a=xa.qaItems[e];if(!a.question.trim()||!a.answer.trim())return void I.warning(`第${e+1}个问答对的问题和答案不能为空`)}try{Va.value=!0;200===(yield C.put(`/api/qa/${ka.value}`,{title:xa.title.trim(),qaItems:xa.qaItems.map(e=>({question:e.question.trim(),answer:e.answer.trim()})),headerContent:xa.headerContent.trim(),footerContent:xa.footerContent.trim(),isPublic:xa.isPublic})).status?(I.success("更新成功"),ba.value=!1,_a.value=!1,ka.value=null,Na(),yield Qa(za.value.page,za.value.pageSize)):I.error("更新失败")}catch(e){I.error("更新失败")}finally{Va.value=!1}}else I.warning("标题和问答对不能为空")}),Ta=a=>e(this,null,function*(){var e;yield L.confirm("确定要删除这个QA吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});try{Va.value=!0;200===(yield C.delete(`/api/qa/${a.id}`)).status?(I.success("删除成功"),(null==(e=ya.value)?void 0:e.id)===a.id&&(ya.value=null),1===wa.value.length&&za.value.page>1?yield Qa(za.value.page-1,za.value.pageSize):yield Qa(za.value.page,za.value.pageSize)):I.error("删除失败")}catch(l){I.error("删除失败")}finally{Va.value=!1}}),$a=e=>{_a.value=!0,ka.value=e.id,xa.title=e.title,xa.qaItems=e.qaItems&&e.qaItems.length>0?[...e.qaItems]:[{question:"",answer:""}],xa.headerContent=e.headerContent,xa.footerContent=e.footerContent,xa.isPublic=e.isPublic,ba.value=!0},La=e=>{_a.value||(ya.value=e,ba.value=!1)},Ha=e=>{ya.value=e,Ca.value=!0},Ma=()=>{ya.value=null,_a.value=!1,Na(),ba.value=!0},Na=()=>{xa.title="",xa.qaItems=[{question:"",answer:""}],xa.headerContent="",xa.footerContent="",xa.isPublic=!1},Ba=e=>new Date(e).toLocaleString("zh-CN"),Da=a=>e(this,null,function*(){try{const e=`${window.location.origin}/qa-view/${a.id}`;yield navigator.clipboard.writeText(e),I.success("链接已复制到剪贴板")}catch(e){I.error("复制失败")}}),Ea=n(()=>null!==ya.value&&!ba.value&&!_a.value&&!Ca.value);return(e,a)=>{const l=o("el-icon"),t=o("el-button"),s=o("el-tag"),i=o("el-pagination"),n=o("el-input"),C=o("el-form-item"),L=o("el-checkbox"),H=o("el-form"),ha=o("el-dialog"),ga=o("el-text"),ka=c("loading");return u(),r("div",N,[d(z,{title:M.title},null,8,["title"]),v("div",B,[v("div",D,[v("div",E,[v("div",F,[d(l,{class:"header-icon"},{default:p(()=>[d(m(V))]),_:1})]),v("div",null,[a[21]||(a[21]=v("h3",{class:"header-title"},"我的QA页面",-1)),v("p",G,"共 "+q(za.value.total)+" 个QA页面",1)])]),v("div",J,[d(t,{class:"action-btn refresh-btn",onClick:a[0]||(a[0]=e=>Qa(za.value.page,za.value.pageSize)),icon:m(Q),loading:Ia.value,disabled:Ia.value,circle:""},null,8,["icon","loading","disabled"]),d(t,{class:"action-btn create-btn",type:"primary",onClick:Ma,icon:m(A)},{default:p(()=>a[22]||(a[22]=[f(" 新建QA页面 ",-1)])),_:1,__:[22]},8,["icon"])])]),h((u(),r("div",K,[0!==wa.value.length||Ia.value?g("",!0):(u(),r("div",O,[d(l,{class:"empty-icon"},{default:p(()=>[d(m(V))]),_:1}),a[24]||(a[24]=v("h3",{class:"empty-title"},"暂无QA页面",-1)),a[25]||(a[25]=v("p",{class:"empty-desc"},"开始创建你的第一个QA页面吧",-1)),d(t,{type:"primary",onClick:Ma,icon:m(A)},{default:p(()=>a[23]||(a[23]=[f("创建QA页面",-1)])),_:1,__:[23]},8,["icon"])])),(u(!0),r(w,null,y(wa.value,e=>{var l;return u(),r("div",{key:e.id,class:_(["qa-card",{"qa-active":(null==(l=ya.value)?void 0:l.id)===e.id}]),onClick:a=>La(e)},[v("div",W,[v("h4",X,q(e.title),1),v("div",Y,[d(t,{class:"action-icon",size:"small",icon:m(P),onClick:b(a=>La(e),["stop"]),circle:"",plain:""},null,8,["icon","onClick"]),d(t,{class:"action-icon preview-icon",size:"small",type:"success",icon:m(S),onClick:b(a=>Ha(e),["stop"]),circle:"",plain:""},null,8,["icon","onClick"]),d(t,{class:"action-icon copy-icon",size:"small",type:"info",icon:m(U),onClick:b(a=>Da(e),["stop"]),circle:"",plain:""},null,8,["icon","onClick"]),d(t,{class:"action-icon edit-icon",size:"small",type:"primary",icon:m(j),loading:Va.value,disabled:Va.value,onClick:b(a=>$a(e),["stop"]),circle:"",plain:""},null,8,["icon","loading","disabled","onClick"]),d(t,{class:"action-icon delete-icon",size:"small",type:"danger",icon:m(T),loading:Va.value,disabled:Va.value,onClick:b(a=>Ta(e),["stop"]),circle:"",plain:""},null,8,["icon","loading","disabled","onClick"])])]),v("div",Z,[e.qaItems&&e.qaItems.length>0?(u(),r("div",ee,[(u(!0),r(w,null,y(e.qaItems.slice(0,2),(e,a)=>(u(),r("div",{key:a,class:"qa-item-preview"},[v("div",ae,[v("h5",le,"问题"+q(a+1)+"：",1),v("p",te,q(e.question),1)]),v("div",se,[v("h5",ie,"答案"+q(a+1)+"：",1),v("p",ne,q(e.answer),1)])]))),128)),e.qaItems.length>2?(u(),r("div",oe,[v("span",ce,"还有 "+q(e.qaItems.length-2)+" 个问答对...",1)])):g("",!0)])):(u(),r("div",ue,[v("div",re,[a[26]||(a[26]=v("h5",{class:"question-label"},"问题：",-1)),v("p",de,q(e.question||"暂无问题"),1)]),v("div",ve,[a[27]||(a[27]=v("h5",{class:"answer-label"},"答案：",-1)),v("p",pe,q(e.answer||"暂无答案"),1)])]))]),v("div",me,[v("div",qe,[v("div",fe,[a[28]||(a[28]=v("span",{class:"time-label"},"更新于",-1)),v("span",he,q(Ba(e.updateTime)),1)]),v("div",ge,[d(s,{type:e.isPublic?"success":"warning",size:"small"},{default:p(()=>[f(q(e.isPublic?"公开":"私有"),1)]),_:2},1032,["type"])])])])],10,R)}),128))])),[[ka,Ia.value]]),za.value.total>0?(u(),r("div",we,[d(i,{"current-page":za.value.page,"onUpdate:currentPage":a[1]||(a[1]=e=>za.value.page=e),"page-size":za.value.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>za.value.pageSize=e),"page-sizes":[6,12,24,48],total:za.value.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:Pa,onCurrentChange:Aa,class:"custom-pagination"},null,8,["current-page","page-size","total"])])):g("",!0),d(ha,{modelValue:ba.value,"onUpdate:modelValue":a[9]||(a[9]=e=>ba.value=e),title:_a.value?"编辑QA页面":"新建QA页面",width:"90%","max-width":"900px",class:"qa-dialog",onClose:a[10]||(a[10]=e=>_a.value=!1),"destroy-on-close":""},{footer:p(()=>[v("div",ze,[d(t,{size:"large",disabled:Va.value,onClick:a[7]||(a[7]=e=>{ba.value=!1,_a.value=!1})},{default:p(()=>a[31]||(a[31]=[f(" 取消 ",-1)])),_:1,__:[31]},8,["disabled"]),d(t,{type:"primary",size:"large",loading:Va.value,disabled:Va.value,onClick:a[8]||(a[8]=e=>_a.value?ja():Ua())},{default:p(()=>[f(q(_a.value?"保存修改":"创建QA页面"),1)]),_:1},8,["loading","disabled"])])]),default:p(()=>[v("div",ye,[d(H,{model:xa,"label-position":"top"},{default:p(()=>[d(C,{label:"页面标题",required:"",class:"form-item"},{default:p(()=>[d(n,{modelValue:xa.title,"onUpdate:modelValue":a[3]||(a[3]=e=>xa.title=e),placeholder:"请输入QA页面标题",size:"large",class:"title-input"},null,8,["modelValue"])]),_:1}),d(C,{label:"问答对",required:"",class:"form-item"},{default:p(()=>[v("div",_e,[(u(!0),r(w,null,y(xa.qaItems,(e,a)=>(u(),r("div",{key:a,class:"qa-item-form"},[v("div",be,[v("h4",ke,"问答对 "+q(a+1),1),xa.qaItems.length>1?(u(),k(t,{key:0,type:"danger",icon:m($),size:"small",circle:"",onClick:e=>(e=>{xa.qaItems.length>1?xa.qaItems.splice(e,1):I.warning("至少需要保留一个问答对")})(a)},null,8,["icon","onClick"])):g("",!0)]),v("div",Ce,[d(C,{label:`问题 ${a+1}`,class:"qa-form-item"},{default:p(()=>[d(n,{modelValue:e.question,"onUpdate:modelValue":a=>e.question=a,type:"textarea",rows:3,placeholder:"请输入问题内容...",class:"question-textarea",resize:"vertical"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),d(C,{label:`答案 ${a+1}`,class:"qa-form-item"},{default:p(()=>[d(n,{modelValue:e.answer,"onUpdate:modelValue":a=>e.answer=a,type:"textarea",rows:4,placeholder:"请输入答案内容...",class:"answer-textarea",resize:"vertical"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])])]))),128)),d(t,{type:"primary",icon:m(A),onClick:Sa,class:"add-qa-btn"},{default:p(()=>a[29]||(a[29]=[f(" 添加问答对 ",-1)])),_:1,__:[29]},8,["icon"])])]),_:1}),d(C,{label:"页面头部内容（可选）",class:"form-item"},{default:p(()=>[d(n,{modelValue:xa.headerContent,"onUpdate:modelValue":a[4]||(a[4]=e=>xa.headerContent=e),type:"textarea",rows:3,placeholder:"在QA问题上方显示的自定义内容...",class:"header-textarea",resize:"vertical"},null,8,["modelValue"])]),_:1}),d(C,{label:"页面尾部内容（可选）",class:"form-item"},{default:p(()=>[d(n,{modelValue:xa.footerContent,"onUpdate:modelValue":a[5]||(a[5]=e=>xa.footerContent=e),type:"textarea",rows:3,placeholder:"在QA答案下方显示的自定义内容...",class:"footer-textarea",resize:"vertical"},null,8,["modelValue"])]),_:1}),d(C,{label:"页面设置",class:"form-item"},{default:p(()=>[d(L,{modelValue:xa.isPublic,"onUpdate:modelValue":a[6]||(a[6]=e=>xa.isPublic=e)},{default:p(()=>a[30]||(a[30]=[f(" 设为公开页面（其他人可以访问） ",-1)])),_:1,__:[30]},8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue","title"]),d(ha,{modelValue:Ea.value,"onUpdate:modelValue":a[14]||(a[14]=e=>Ea.value=e),title:"QA详情",width:"90%","max-width":"800px",class:"detail-dialog",onClose:a[15]||(a[15]=e=>ya.value=null),"destroy-on-close":""},{footer:p(()=>[v("div",Ke,[d(t,{size:"large",onClick:a[11]||(a[11]=e=>ya.value=null)},{default:p(()=>a[34]||(a[34]=[f("关闭",-1)])),_:1,__:[34]}),d(t,{type:"success",size:"large",icon:m(S),onClick:a[12]||(a[12]=e=>ya.value&&Ha(ya.value))},{default:p(()=>a[35]||(a[35]=[f(" 预览页面 ",-1)])),_:1,__:[35]},8,["icon"]),d(t,{type:"primary",size:"large",icon:m(j),onClick:a[13]||(a[13]=e=>ya.value&&$a(ya.value))},{default:p(()=>a[36]||(a[36]=[f(" 编辑QA ",-1)])),_:1,__:[36]},8,["icon"])])]),default:p(()=>[ya.value?(u(),r("div",xe,[v("div",Ie,[v("h2",Ve,q(ya.value.title),1),v("div",Qe,[v("span",Ae,[d(l,null,{default:p(()=>[d(m(V))]),_:1}),f(" 创建于 "+q(Ba(ya.value.createTime)),1)]),v("span",Pe,[d(l,null,{default:p(()=>[d(m(j))]),_:1}),f(" 更新于 "+q(Ba(ya.value.updateTime)),1)]),v("span",Se,[d(s,{type:ya.value.isPublic?"success":"warning",size:"small"},{default:p(()=>[f(q(ya.value.isPublic?"公开":"私有"),1)]),_:1},8,["type"])])])]),v("div",Ue,[v("div",je,[ya.value.qaItems&&ya.value.qaItems.length>0?(u(),r("div",Te,[(u(!0),r(w,null,y(ya.value.qaItems,(e,a)=>(u(),r("div",{key:a,class:"qa-detail-item"},[v("div",$e,[v("h3",Le,"问题 "+q(a+1)+"：",1),v("p",He,q(e.question),1)]),v("div",Me,[v("h3",Ne,"答案 "+q(a+1)+"：",1),v("p",Be,q(e.answer),1)])]))),128))])):(u(),r("div",De,[v("div",Ee,[a[32]||(a[32]=v("h3",{class:"detail-question-label"},"问题：",-1)),v("p",Fe,q(ya.value.question||"暂无问题"),1)]),v("div",Ge,[a[33]||(a[33]=v("h3",{class:"detail-answer-label"},"答案：",-1)),v("p",Je,q(ya.value.answer||"暂无答案"),1)])]))])])])):g("",!0)]),_:1},8,["modelValue"]),d(ha,{modelValue:Ca.value,"onUpdate:modelValue":a[19]||(a[19]=e=>Ca.value=e),title:"QA页面预览",width:"95%","max-width":"1000px",class:"preview-dialog",onClose:a[20]||(a[20]=e=>ya.value=null),"destroy-on-close":""},{footer:p(()=>[v("div",fa,[d(t,{size:"large",onClick:a[17]||(a[17]=e=>Ca.value=!1)},{default:p(()=>a[40]||(a[40]=[f("关闭",-1)])),_:1,__:[40]}),d(t,{type:"primary",size:"large",icon:m(j),onClick:a[18]||(a[18]=e=>ya.value&&$a(ya.value))},{default:p(()=>a[41]||(a[41]=[f(" 编辑QA ",-1)])),_:1,__:[41]},8,["icon"])])]),default:p(()=>[ya.value?(u(),r("div",Oe,[v("div",Re,[v("h1",We,q(ya.value.title),1),v("div",Xe,[d(t,{type:"primary",icon:m(U),onClick:a[16]||(a[16]=e=>Da(ya.value))},{default:p(()=>a[37]||(a[37]=[f(" 复制链接 ",-1)])),_:1,__:[37]},8,["icon"])])]),v("div",Ye,[ya.value.headerContent?(u(),r("div",Ze,[v("div",{class:"custom-content",innerHTML:ya.value.headerContent},null,8,ea)])):g("",!0),v("div",aa,[ya.value.qaItems&&ya.value.qaItems.length>0?(u(),r("div",la,[(u(!0),r(w,null,y(ya.value.qaItems,(e,a)=>(u(),r("div",{key:a,class:"preview-qa-item"},[v("div",ta,[v("h2",sa,"问题 "+q(a+1),1),v("div",ia,q(e.question),1)]),v("div",na,[v("h2",oa,"答案 "+q(a+1),1),v("div",ca,q(e.answer),1)])]))),128))])):(u(),r("div",ua,[v("div",ra,[a[38]||(a[38]=v("h2",{class:"preview-question-title"},"问题",-1)),v("div",da,q(ya.value.question||"暂无问题"),1)]),v("div",va,[a[39]||(a[39]=v("h2",{class:"preview-answer-title"},"答案",-1)),v("div",pa,q(ya.value.answer||"暂无答案"),1)])]))]),ya.value.footerContent?(u(),r("div",ma,[v("div",{class:"custom-content",innerHTML:ya.value.footerContent},null,8,qa)])):g("",!0)])])):g("",!0)]),_:1},8,["modelValue"])]),d(x,{title:"描述"},{default:p(()=>[d(ga,null,{default:p(()=>a[42]||(a[42]=[f(" QA问答页面制作工具，支持创建多个问答对的个性化页面。可以添加多个问题和答案，支持在页面头部和尾部添加自定义内容。创建后可以生成公开链接供他人访问。 ",-1)])),_:1,__:[42]})]),_:1})])}}}),[["__scopeId","data-v-7fa34f1a"]]);export{ha as default};
