var l=(l,e,a)=>new Promise((t,s)=>{var u=l=>{try{o(a.next(l))}catch(e){s(e)}},r=l=>{try{o(a.throw(l))}catch(e){s(e)}},o=l=>l.done?t(l.value):Promise.resolve(l.value).then(u,r);o((a=a.apply(l,e)).next())});import{f as e,_ as a}from"../assets/index-a02a0b09.js";import{_ as t}from"./chunk-08a8c02c.js";import{_ as s}from"./chunk-9c6aa90d.js";import{_ as u,w as r}from"./chunk-0cb65a34.js";import{E as o}from"./chunk-ebe7e565.js";import{d as n,q as i,r as c,t as d,al as m,ar as p,o as v,c as g,R as f,a as y,J as x,D as _,O as h,P as b,M as P,K as D,Q as w,a4 as k}from"./chunk-bb5ca2a1.js";import"./chunk-04652fe6.js";import"./chunk-b2647718.js";const F={class:"flex flex-col mt-3 flex-1"},j={class:"p-4 rounded-2xl bg-white space-y-4"},V={class:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg"},$={class:"flex flex-col items-center space-y-4"},I={key:0,class:"text-center py-8"},E={class:"mt-2 text-gray-600"},C={key:1,class:"p-3 bg-blue-50 rounded-lg"},q={class:"text-sm text-blue-800"},T={key:2,class:"space-y-4"},G={class:"flex justify-between items-center"},J={class:"text-lg font-semibold"},U={class:"space-x-2"},M={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3"},R={class:"aspect-[3/4] bg-gray-100 cursor-pointer"},L=["src","alt","title"],N={class:"p-2 bg-white"},O={class:"text-xs text-gray-600 mb-2"},z=a(n({__name:"PdfToImage",setup(a){u.workerSrc=r;let n=null;const z=i({title:"PDF转图片"}),A=c(!1),B=c(!1),K=c([]),Q=c(""),S=c(""),H=c(0),W=i({dpi:300,format:"png",quality:1}),X=()=>l(this,null,function*(){try{const l=yield e(()=>import("./chunk-0cb65a34.js").then(l=>l.p),["js/chunk-0cb65a34.js","assets/index-a02a0b09.js","js/chunk-bb5ca2a1.js","js/chunk-ebe7e565.js","js/chunk-04652fe6.js","js/chunk-b2647718.js","assets/index-5f044577.css"]);n=l}catch(l){o.error("PDF.js 库加载失败，请刷新页面重试")}});d(()=>{X()});const Y=l=>{if(!(null==l?void 0:l.raw))return;const e=l.raw;"application/pdf"===e.type?(Q.value=e.name,Z(e)):o.error("请选择PDF文件")},Z=e=>l(this,null,function*(){if(n){A.value=!0,K.value=[],S.value="正在读取PDF文件...",H.value=0;try{const l=yield e.arrayBuffer();S.value="正在解析PDF结构...";const a=yield n.getDocument({data:l}).promise,t=a.numPages;o.success(`PDF加载成功，共${t}页，开始转换...`);for(let e=1;e<=t;e++){S.value=`正在转换第 ${e}/${t} 页...`,H.value=Math.round((e-1)/t*100);const l=yield a.getPage(e),s=W.dpi/72,u=l.getViewport({scale:s}),r=document.createElement("canvas"),o=r.getContext("2d");r.height=u.height,r.width=u.width,yield l.render({canvasContext:o,viewport:u}).promise;const n=r.toDataURL(`image/${W.format}`,W.quality);K.value.push(n),H.value=Math.round(e/t*100),yield new Promise(l=>setTimeout(l,10))}S.value="转换完成！",o.success(`转换完成！共生成${t}张图片`)}catch(l){S.value="转换失败";const e=l instanceof Error?l.message:"未知错误";o.error(`PDF转换失败: ${e}`)}finally{A.value=!1,H.value=0,S.value=""}}else o.error("PDF.js 库未加载完成，请稍后重试")}),ll=(l,e)=>{const a=document.createElement("a");a.href=l,a.download=`${Q.value.replace(".pdf","")}_第${e+1}页.${W.format}`,a.click()},el=()=>{K.value.forEach((l,e)=>{setTimeout(()=>{ll(l,e)},100*e)})},al=l=>{var e;l.preventDefault(),B.value=!1;const a=null==(e=l.dataTransfer)?void 0:e.files;a&&(l=>{if(!l||0===l.length)return;const e=l[0];"application/pdf"===e.type?(Q.value=e.name,Z(e)):o.error("请选择PDF文件")})(a)},tl=l=>{l.preventDefault(),B.value=!0},sl=()=>{B.value=!1},ul=()=>{K.value=[],Q.value=""};return(l,e)=>{const a=m("el-option"),u=m("el-select"),r=m("Document"),o=m("el-icon"),n=m("el-button"),i=m("el-upload"),c=m("el-progress"),d=m("Download"),X=m("el-text"),Z=p("viewer");return v(),g("div",F,[f(t,{title:z.title},null,8,["title"]),y("div",j,[y("div",V,[y("div",null,[e[3]||(e[3]=y("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"分辨率 (DPI)",-1)),f(u,{modelValue:W.dpi,"onUpdate:modelValue":e[0]||(e[0]=l=>W.dpi=l),class:"w-full"},{default:x(()=>[f(a,{label:"150 DPI (标准)",value:150}),f(a,{label:"300 DPI (高清)",value:300}),f(a,{label:"600 DPI (超高清)",value:600})]),_:1},8,["modelValue"])]),y("div",null,[e[4]||(e[4]=y("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"输出格式",-1)),f(u,{modelValue:W.format,"onUpdate:modelValue":e[1]||(e[1]=l=>W.format=l),class:"w-full"},{default:x(()=>[f(a,{label:"PNG (推荐)",value:"png"}),f(a,{label:"JPG",value:"jpeg"})]),_:1},8,["modelValue"])]),y("div",null,[e[5]||(e[5]=y("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"图片质量",-1)),f(u,{modelValue:W.quality,"onUpdate:modelValue":e[2]||(e[2]=l=>W.quality=l),class:"w-full"},{default:x(()=>[f(a,{label:"高质量",value:1}),f(a,{label:"中等质量",value:.8}),f(a,{label:"压缩质量",value:.6})]),_:1},8,["modelValue"])])]),y("div",{class:_(["border-2 border-dashed border-gray-300 rounded-lg p-8 text-center transition-colors",{"border-blue-500 bg-blue-50":B.value}]),onDrop:al,onDragover:tl,onDragleave:sl},[y("div",$,[f(o,{class:"text-6xl text-gray-400"},{default:x(()=>[f(r)]),_:1}),e[7]||(e[7]=y("div",null,[y("p",{class:"text-lg text-gray-600 mb-2"},"拖拽PDF文件到此处，或点击选择文件"),y("p",{class:"text-sm text-gray-400"},"支持单个PDF文件，自动转换所有页面")],-1)),f(i,{class:"upload-demo","before-upload":()=>!1,"on-change":Y,"show-file-list":!1,accept:".pdf",disabled:A.value},{default:x(()=>[f(n,{type:"primary",loading:A.value},{default:x(()=>e[6]||(e[6]=[h("选择PDF文件",-1)])),_:1,__:[6]},8,["loading"])]),_:1},8,["disabled"])])],34),A.value?(v(),g("div",I,[f(c,{percentage:H.value,indeterminate:0===H.value,"stroke-width":8,class:"mb-4"},null,8,["percentage","indeterminate"]),y("p",E,b(S.value),1),e[8]||(e[8]=y("p",{class:"text-sm text-gray-400 mt-1"},"首次转换可能需要较长时间加载...",-1))])):P("",!0),Q.value&&!A.value?(v(),g("div",C,[y("p",q,"当前文件: "+b(Q.value),1)])):P("",!0),K.value.length>0?(v(),g("div",T,[y("div",G,[y("h3",J,"转换结果 ("+b(K.value.length)+"张图片)",1),y("div",U,[f(n,{onClick:el,type:"primary"},{default:x(()=>[f(o,null,{default:x(()=>[f(d)]),_:1}),e[9]||(e[9]=h(" 下载全部 ",-1))]),_:1,__:[9]}),f(n,{onClick:ul},{default:x(()=>e[10]||(e[10]=[h("清除结果",-1)])),_:1,__:[10]})])]),D((v(),g("div",M,[(v(!0),g(w,null,k(K.value,(l,a)=>(v(),g("div",{key:a,class:"border rounded-lg overflow-hidden hover:shadow-lg transition-shadow"},[y("div",R,[y("img",{src:l,alt:`第${a+1}页`,class:"w-full h-full object-contain hover:opacity-90 transition-opacity",title:`点击查看第${a+1}页大图`},null,8,L)]),y("div",N,[y("p",O,"第 "+b(a+1)+" 页",1),f(n,{onClick:e=>ll(l,a),size:"small",type:"primary",class:"w-full text-xs"},{default:x(()=>[f(o,{class:"text-xs"},{default:x(()=>[f(d)]),_:1}),e[11]||(e[11]=h(" 下载 ",-1))]),_:2,__:[11]},1032,["onClick"])])]))),128))])),[[Z]])])):P("",!0)]),f(s,{title:"功能说明"},{default:x(()=>[f(X,null,{default:x(()=>e[12]||(e[12]=[y("ul",{class:"space-y-2 text-gray-700"},[y("li",null,[h("• "),y("strong",null,"高清转换"),h("：支持150-600 DPI分辨率，确保图片清晰度")]),y("li",null,[h("• "),y("strong",null,"多页处理"),h("：自动转换PDF中的所有页面")]),y("li",null,[h("• "),y("strong",null,"格式选择"),h("：支持PNG和JPG格式输出")]),y("li",null,[h("• "),y("strong",null,"质量控制"),h("：可调节图片质量，平衡文件大小和清晰度")]),y("li",null,[h("• "),y("strong",null,"图片预览"),h("：点击图片可放大预览，支持缩放和全屏查看")]),y("li",null,[h("• "),y("strong",null,"批量下载"),h("：支持单页下载和批量下载")]),y("li",null,[h("• "),y("strong",null,"本地处理"),h("：所有转换在浏览器本地完成，保护文件隐私")])],-1)])),_:1,__:[12]})]),_:1}),f(s,{title:"使用说明"},{default:x(()=>[f(X,null,{default:x(()=>e[13]||(e[13]=[y("ol",{class:"space-y-2 text-gray-700"},[y("li",null,"1. 选择转换设置（分辨率、格式、质量）"),y("li",null,"2. 拖拽或点击上传PDF文件"),y("li",null,"3. 等待自动转换完成"),y("li",null,"4. 点击图片放大预览或直接下载"),y("li",null,"5. 下载单页图片或批量下载所有图片")],-1)])),_:1,__:[13]})]),_:1}),f(s,{title:"注意事项"},{default:x(()=>[f(X,null,{default:x(()=>e[14]||(e[14]=[y("ul",{class:"space-y-1 text-gray-600 text-sm"},[y("li",null,"• 首次使用需要加载PDF.js库，可能需要等待几秒"),y("li",null,"• 大文件或高分辨率转换需要较长时间，请耐心等待"),y("li",null,"• 暂不支持密码保护的PDF文件"),y("li",null,"• 建议使用现代浏览器以获得最佳体验")],-1)])),_:1,__:[14]})]),_:1})])}}}),[["__scopeId","data-v-b054621e"]]);export{z as default};
