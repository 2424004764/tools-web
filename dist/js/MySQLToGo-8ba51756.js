import{_ as e}from"./chunk-b26ce546.js";import{_ as l}from"./chunk-9c6aa90d.js";import{c as t,_ as s}from"../assets/index-94414794.js";import{d as a,q as i,r as n,m as o,al as r,o as u,c as d,R as m,a as c,J as p,P as g,M as T,Q as h,a4 as E,O as f}from"./chunk-bb5ca2a1.js";import"./chunk-0a8d181f.js";import"./chunk-96adf8d3.js";import"./chunk-b045bb46.js";const v={class:"flex flex-col mt-3 flex-1"},y={class:"p-4 rounded-2xl bg-white"},L={key:0,class:"text-red-500 text-sm bg-red-50 p-3 rounded-lg border border-red-200"},D={key:1,class:"text-yellow-600 text-sm bg-yellow-50 p-3 rounded-lg border border-yellow-200"},b={class:"list-disc list-inside space-y-1"},M={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},N={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},A={class:"flex flex-wrap gap-2"},U={key:0,class:"p-4 rounded-2xl bg-white"},_={class:"flex justify-between items-center mb-3"},C={class:"bg-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono"},w=s(a({__name:"MySQLToGo",setup(s){const a=i({title:"MySQL转Go结构体"}),w=i({mysqlDDL:"",addJsonTag:!0,addGormTag:!0,addXormTag:!1,addGinTag:!1,usePointer:!1,useTime:!0,useNull:!1}),x=n(""),R=n(""),V=n([]),O={tinyint:"int8",smallint:"int16",mediumint:"int32",int:"int",integer:"int",bigint:"int64",float:"float32",double:"float64",decimal:"float64",numeric:"float64",char:"string",varchar:"string",text:"string",tinytext:"string",mediumtext:"string",longtext:"string",blob:"[]byte",tinyblob:"[]byte",mediumblob:"[]byte",longblob:"[]byte",binary:"[]byte",varbinary:"[]byte",date:"time.Time",time:"time.Time",datetime:"time.Time",timestamp:"time.Time",year:"int",json:"string",enum:"string",set:"string",bit:"[]byte",boolean:"bool",bool:"bool"},P=e=>{const l=[],t=[];if(!e.trim())return{isValid:!0,errors:l,warnings:t};if(!e.toUpperCase().includes("CREATE TABLE"))return l.push("DDL语句必须包含CREATE TABLE关键字"),{isValid:!1,errors:l,warnings:t};e.match(/CREATE\s+TABLE\s+(?:`?(\w+)`?|`([^`]+)`)/i)||l.push("无法识别表名，请确保CREATE TABLE语句格式正确");const s=e.split("\n").map(e=>e.trim()).filter(e=>e);let a=!1;for(const o of s){if(o.startsWith("--")||o.startsWith("/*")||o.startsWith("CREATE TABLE")||o.startsWith("(")||o.startsWith(")")||o.startsWith("PRIMARY KEY")||o.startsWith("KEY")||o.startsWith("INDEX")||o.startsWith("UNIQUE KEY"))continue;const e=o.match(/`?(\w+)`?\s+(\w+)/i);if(e){a=!0;const[,s,i]=e;s||l.push(`字段定义错误: ${o}`),i?O[i.toLowerCase()]||t.push(`未知字段类型 "${i}"，将映射为string类型`):l.push(`字段类型缺失: ${o}`),s.includes(" ")&&l.push(`字段名包含空格: ${s}`)}}a||l.push("未找到有效的字段定义");(e.match(/\(/g)||[]).length!==(e.match(/\)/g)||[]).length&&l.push("括号不匹配，请检查DDL语句的括号");const i=(e.match(/'/g)||[]).length,n=(e.match(/"/g)||[]).length;return i%2!=0&&l.push("单引号不匹配"),n%2!=0&&l.push("双引号不匹配"),(e.includes("121")||e.includes("UP1212DATE"))&&l.push("检测到明显的语法错误，如多余的数字或拼写错误"),e.includes("ON UP")&&!e.includes("ON UPDATE")&&l.push('ON UPDATE语法错误，应该是"ON UPDATE CURRENT_TIMESTAMP"'),{isValid:0===l.length,errors:l,warnings:t}},G=()=>{if(R.value="",V.value=[],!w.mysqlDDL.trim())return void(x.value="");const e=P(w.mysqlDDL);if(V.value=e.warnings,!e.isValid)return R.value=e.errors.join("; "),void(x.value="");try{const e=(e=>{const l=e.split("\n").map(e=>e.trim()).filter(e=>e),t=[];for(const s of l){if(s.startsWith("--")||s.startsWith("/*")||s.startsWith("CREATE TABLE")||s.startsWith("(")||s.startsWith(")")||s.startsWith("PRIMARY KEY")||s.startsWith("KEY")||s.startsWith("INDEX")||s.startsWith("UNIQUE KEY"))continue;const e=s.match(/`?(\w+)`?\s+(\w+)(?:\([^)]+\))?(?:\s+(\w+))*(?:\s+COMMENT\s+['"]([^'"]*)['"])?/i);if(e){const[,l,a,,i]=e,n=s.includes("PRIMARY KEY")?"PRI":s.includes("UNIQUE KEY")?"UNI":s.includes("KEY")?"MUL":"";t.push({name:l.toLowerCase(),type:a.toLowerCase(),comment:i||"",key:n})}}return t})(w.mysqlDDL);if(0===e.length)return R.value="未能解析到有效的字段信息，请检查DDL格式",void(x.value="");const l=(e=>{const l=e.match(/CREATE\s+TABLE\s+(?:`?(\w+)`?|`([^`]+)`)/i);return l&&(l[1]||l[2])||""})(w.mysqlDDL);if(!l)return R.value="未能从DDL中提取到表名，请检查CREATE TABLE语句格式",void(x.value="");const t=(e=>e?e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(""):"Table")(l);let s=`type ${t} struct {\n`;for(const a of e){let e=O[a.type]||"string";w.useNull&&("string"===e?e="*string":"int"===e?e="*int":"int64"===e?e="*int64":"float64"===e?e="*float64":"bool"===e?e="*bool":"time.Time"===e&&(e="*time.Time")),w.usePointer&&!e.startsWith("*")&&(e="*"+e);s+=`\t${a.name.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("")}`,w.usePointer&&!e.startsWith("*")?s+=` *${e}`:s+=` ${e}`;const l=[];if(w.addJsonTag&&l.push(`json:"${a.name}"`),w.addGormTag){let e=`gorm:"column:${a.name}`;"PRI"===a.key&&(e+=";primaryKey"),a.comment&&(e+=`;comment:${a.comment}`),e+='"',l.push(e)}if(w.addXormTag){let e=`xorm:"'${a.name}'`;"PRI"===a.key&&(e+=" pk"),a.comment&&(e+=` comment('${a.comment}')`),e+='"',l.push(e)}w.addGinTag&&l.push(`form:"${a.name}" binding:"required"`),l.length>0&&(s+=` \`${l.join(" ")}\``),a.comment&&(s+=` // ${a.comment}`),s+="\n"}s+="}",w.useTime&&e.some(e=>"time.Time"===O[e.type])&&(s='import "time"\n\n'+s),x.value=s}catch(l){R.value=`转换失败: ${l}`,x.value=""}};o(()=>w.mysqlDDL,e=>{const l=P(e);V.value=l.warnings,l.isValid?(R.value="",G()):(R.value=l.errors.join("; "),x.value="")},{immediate:!0}),o([()=>w.addJsonTag,()=>w.addGormTag,()=>w.addXormTag,()=>w.addGinTag,()=>w.usePointer,()=>w.useTime,()=>w.useNull],()=>{w.mysqlDDL.trim()&&G()});const I=()=>{return e=this,l=null,s=function*(){x.value&&(yield t(x.value))},new Promise((t,a)=>{var i=e=>{try{o(s.next(e))}catch(l){a(l)}},n=e=>{try{o(s.throw(e))}catch(l){a(l)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,n);o((s=s.apply(e,l)).next())});var e,l,s},W=()=>{w.mysqlDDL="",x.value="",R.value="",V.value=[]},k=()=>{w.mysqlDDL="CREATE TABLE `users` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '用户ID',\n  `username` varchar(50) NOT NULL COMMENT '用户名',\n  `email` varchar(100) DEFAULT NULL COMMENT '邮箱',\n  `age` int(11) DEFAULT NULL COMMENT '年龄',\n  `created_at` datetime NOT NULL COMMENT '创建时间',\n  `updated_at` datetime DEFAULT NULL COMMENT '更新时间',\n  `is_active` tinyint(1) DEFAULT '1' COMMENT '是否激活',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_username` (`username`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';"};return(t,s)=>{const i=r("el-input"),n=r("el-form-item"),o=r("el-switch"),O=r("el-button"),P=r("el-form");return u(),d("div",v,[m(e,{title:a.title},null,8,["title"]),c("div",y,[m(P,{model:w,"label-width":"120px",class:"space-y-4"},{default:p(()=>[m(n,{label:"MySQL DDL"},{default:p(()=>[m(i,{modelValue:w.mysqlDDL,"onUpdate:modelValue":s[0]||(s[0]=e=>w.mysqlDDL=e),type:"textarea",rows:8,placeholder:"请输入MySQL CREATE TABLE语句",class:"font-mono"},null,8,["modelValue"])]),_:1}),R.value?(u(),d("div",L,[s[8]||(s[8]=c("div",{class:"flex items-center mb-1"},[c("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[c("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),c("span",{class:"font-medium"},"错误")],-1)),c("div",null,g(R.value),1)])):T("",!0),V.value.length>0?(u(),d("div",D,[s[9]||(s[9]=c("div",{class:"flex items-center mb-1"},[c("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[c("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),c("span",{class:"font-medium"},"警告")],-1)),c("ul",b,[(u(!0),d(h,null,E(V.value,e=>(u(),d("li",{key:e},g(e),1))),128))])])):T("",!0),c("div",M,[m(n,{label:"JSON标签"},{default:p(()=>[m(o,{modelValue:w.addJsonTag,"onUpdate:modelValue":s[1]||(s[1]=e=>w.addJsonTag=e)},null,8,["modelValue"])]),_:1}),m(n,{label:"GORM标签"},{default:p(()=>[m(o,{modelValue:w.addGormTag,"onUpdate:modelValue":s[2]||(s[2]=e=>w.addGormTag=e)},null,8,["modelValue"])]),_:1}),m(n,{label:"XORM标签"},{default:p(()=>[m(o,{modelValue:w.addXormTag,"onUpdate:modelValue":s[3]||(s[3]=e=>w.addXormTag=e)},null,8,["modelValue"])]),_:1}),m(n,{label:"Gin标签"},{default:p(()=>[m(o,{modelValue:w.addGinTag,"onUpdate:modelValue":s[4]||(s[4]=e=>w.addGinTag=e)},null,8,["modelValue"])]),_:1})]),c("div",N,[m(n,{label:"使用指针"},{default:p(()=>[m(o,{modelValue:w.usePointer,"onUpdate:modelValue":s[5]||(s[5]=e=>w.usePointer=e)},null,8,["modelValue"])]),_:1}),m(n,{label:"使用time包"},{default:p(()=>[m(o,{modelValue:w.useTime,"onUpdate:modelValue":s[6]||(s[6]=e=>w.useTime=e)},null,8,["modelValue"])]),_:1}),m(n,{label:"可空类型"},{default:p(()=>[m(o,{modelValue:w.useNull,"onUpdate:modelValue":s[7]||(s[7]=e=>w.useNull=e)},null,8,["modelValue"])]),_:1})]),c("div",A,[m(O,{onClick:k},{default:p(()=>s[10]||(s[10]=[f("加载示例",-1)])),_:1,__:[10]}),m(O,{onClick:W},{default:p(()=>s[11]||(s[11]=[f("清空",-1)])),_:1,__:[11]})])]),_:1},8,["model"])]),x.value?(u(),d("div",U,[c("div",_,[s[13]||(s[13]=c("h3",{class:"text-lg font-semibold"},"转换结果",-1)),m(O,{type:"primary",onClick:I},{default:p(()=>s[12]||(s[12]=[f("复制结果",-1)])),_:1,__:[12]})]),c("pre",C,g(x.value),1)])):T("",!0),m(l,{title:"功能说明"},{default:p(()=>s[14]||(s[14]=[c("div",{class:"space-y-2"},[c("p",null,"将MySQL数据表的DDL语句转换为Go语言结构体，支持以下功能："),c("ul",{class:"list-disc list-inside space-y-1 text-sm"},[c("li",null,[c("strong",null,"实时验证："),f("输入DDL时实时检查语法错误和格式问题")]),c("li",null,[c("strong",null,"自动转换："),f("输入DDL后自动转换，无需手动点击按钮")]),c("li",null,[c("strong",null,"自动提取："),f("自动从DDL中提取表名并转换为结构体名")]),c("li",null,[c("strong",null,"字段类型映射："),f("自动将MySQL字段类型转换为对应的Go类型")]),c("li",null,[c("strong",null,"标签生成："),f("支持生成JSON、GORM、XORM、Gin等常用标签")]),c("li",null,[c("strong",null,"命名转换："),f("将下划线命名转换为PascalCase命名")]),c("li",null,[c("strong",null,"注释保留："),f("保留字段注释信息")]),c("li",null,[c("strong",null,"错误提示："),f("详细的错误和警告信息，帮助快速定位问题")])])],-1)])),_:1,__:[14]}),m(l,{title:"使用说明"},{default:p(()=>s[15]||(s[15]=[c("div",{class:"space-y-2"},[c("ol",{class:"list-decimal list-inside space-y-1 text-sm"},[c("li",null,'在"MySQL DDL"文本框中粘贴完整的CREATE TABLE语句'),c("li",null,"系统会实时检查DDL格式，如有问题会显示错误或警告信息"),c("li",null,"系统会自动从DDL中提取表名并转换为结构体名"),c("li",null,"根据需要配置标签选项（JSON、GORM、XORM、Gin等）"),c("li",null,"配置其他选项（指针类型、时间包、可空类型等）"),c("li",null,'转换结果会实时显示，点击"复制结果"按钮复制生成的Go代码')]),c("p",{class:"text-sm text-gray-600 mt-2"},[c("strong",null,"提示："),f('可以点击"加载示例"按钮查看示例DDL语句。 ')])],-1)])),_:1,__:[15]})])}}}),[["__scopeId","data-v-3f2c5f99"]]);export{w as default};
