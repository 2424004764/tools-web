import{t as e,S as l,a,r as t,u}from"./chunk-1e32bb76.js";import{_ as s}from"./chunk-222eeebe.js";import{_ as o}from"./chunk-9c6aa90d.js";import{i as n}from"./chunk-e73e11b1.js";import{h as i}from"./chunk-8b37ed0a.js";import{d,q as r,r as c,t as m,al as v,o as f,c as h,R as _,a as p,J as x,O as g}from"./chunk-bb5ca2a1.js";import{_ as w}from"../assets/index-ca88e876.js";import"./chunk-273e6dc9.js";import"./chunk-94d45690.js";const V={class:"flex flex-col mt-3 flex-1"},b={class:"p-4 rounded-2xl flex"},k={class:"w-4/6"},y={class:"flex flex-row-reverse mb-4"},C={class:"w-2/6 bg-white ml-3 rounded-lg p-3"},U={class:"mb-3"},j={class:"flex items-center ml-1"},z={class:"flex w-full"},A={class:"flex"},B={class:"flex mt-3"},S={class:"flex"},O={class:"flex"},E={class:"flex"},R={class:"flex"},T={class:"flex"},F={class:"flex"},P={class:"flex"},W={class:"flex"},I=w(d({__name:"Bar",setup(d){const w=r({title:"柱状图"}),I=c(),M=c(),q=c(),D=c(1),G=c(100),J=c(720),L=c(400),$=c("1"),H=c("#5470c6"),N=c("center"),Y=c("Tools-Web"),K=c("在线图表制作工具"),Q=c(!0),X=c(!0),Z=c(!1),ee=c("Tools-Web"),le=()=>{let e=document.createElement("canvas"),l=e.getContext("2d");return e.width=e.height=100,l.textAlign="center",l.textBaseline="middle",l.globalAlpha=.08,l.font="20px Microsoft Yahei",l.translate(50,50),l.rotate(-Math.PI/4),l.fillText(ee.value,0,0),e},ae=e=>{var l,a,t,u,s;let o=I.value;switch(e){case"scale":let e=G.value/100;o.style.transform=`scale(${e})`;break;case"size":o.style.width=J.value+"px",o.style.height=L.value+"px",ne();break;case"title":let n="",i="";!0===Q.value&&(n=Y.value),!0===X.value&&(i=K.value),null==(l=M.value)||l.setOption({title:{text:n,subtext:i,left:N.value}});break;case"color":null==(a=M.value)||a.setOption({series:[{itemStyle:{color:H.value}}]});break;case"watermark":!0===Z.value?null==(t=M.value)||t.setOption({backgroundColor:{image:le()}}):null==(u=M.value)||u.setOption({backgroundColor:"#fff"});break;case"data":null==(s=M.value)||s.setOption({xAxis:{data:ue.value},series:[{data:se.value}]})}},te=()=>{},ue=c(["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]),se=c(["23","24","18","25","27","28","25"]),oe={backgroundColor:"#fff",title:{text:Y.value,subtext:K.value,left:N.value},xAxis:{data:ue.value},yAxis:{},series:[{type:"bar",data:se.value,itemStyle:{color:H.value}}],tooltip:{}},ne=()=>{M.value=n(I.value),M.value.clear(),M.value.resize({width:J.value,height:L.value}),M.value.setOption(oe)},ie=()=>{var e;let l="1"==$.value?"png":"jpeg",a=null==(e=M.value)?void 0:e.getDataURL({type:l,pixelRatio:2});if(null!=a){var t=document.createElement("a");t.href=a,t.download="echart."+l,t.click()}},de=c(!1),re=c({}),ce=()=>{1==de.value?de.value=!1:(de.value=!0,l.locale("zh-cn",window.x_spreadsheet.$messages["zh-cn"]),new l("#x-spreadsheet",{showToolbar:!1,showBottomBar:!1,view:{height:()=>document.documentElement.clientHeight/2,width:()=>document.documentElement.clientWidth}}).loadData({styles:[{bgcolor:"#f4f5f8",textwrap:!0,color:"#900b09",border:{top:["thin","#0366d6"],bottom:["thin","#0366d6"],right:["thin","#0366d6"],left:["thin","#0366d6"]}}],rows:re.value}).change(e=>{let l=a(e);ue.value=l[0],se.value=l[1],ae("data")}))},me=c(),ve=l=>{return a=this,s=null,o=function*(){const a=l.file,s=new FileReader;s.onload=l=>{try{if(!l.target)return;const a=l.target.result,s=t(a,{type:"binary"});let o=0,n=[],i=[];for(let e in s.Sheets){if(o>0)continue;const l=u.sheet_to_json(s.Sheets[e],{header:["0","1"]});if(0!=l.length){for(let e in l)if(null!=l[e]){let a=l;n.push(a[e][0]),i.push(a[e][1])}o++}}ue.value=n,se.value=i,ae("data"),re.value=e([ue,se])}catch(a){}},s.readAsArrayBuffer(a)},new Promise((e,l)=>{var t=e=>{try{n(o.next(e))}catch(a){l(a)}},u=e=>{try{n(o.throw(e))}catch(a){l(a)}},n=l=>l.done?e(l.value):Promise.resolve(l.value).then(t,u);n((o=o.apply(a,s)).next())});var a,s,o},fe=e=>{q.value.clearFiles();const l=e[0];l.uid=i(),q.value.handleStart(l),q.value.submit()};return m(()=>{I.value=document.getElementById("main"),ae("size"),ne(),re.value=e([ue,se])}),(e,l)=>{const a=v("el-input-number"),t=v("el-text"),u=v("el-button"),n=v("el-radio"),i=v("el-radio-group"),d=v("el-upload"),r=v("el-tooltip"),c=v("el-collapse-item"),m=v("el-radio-button"),I=v("el-divider"),M=v("el-switch"),le=v("el-input"),ue=v("el-color-picker"),se=v("el-collapse"),oe=v("el-drawer");return f(),h("div",V,[_(s,{title:w.title},null,8,["title"]),p("div",b,[p("div",k,[p("div",y,[_(a,{modelValue:G.value,"onUpdate:modelValue":l[0]||(l[0]=e=>G.value=e),min:1,max:100,step:5,onChange:l[1]||(l[1]=e=>ae("scale")),"step-strictly":""},null,8,["modelValue"]),_(t,null,{default:x(()=>l[26]||(l[26]=[g("缩放：",-1)])),_:1,__:[26]})]),l[27]||(l[27]=p("div",{class:"flex justify-center items-center max-h-[500px] max-w-[1000px] overflow-auto"},[p("div",{id:"main",class:"bg-white"})],-1))]),p("div",C,[p("div",U,[_(u,{class:"w-full mb-3",type:"primary",size:"large",onClick:ie},{default:x(()=>l[28]||(l[28]=[g("下载图表",-1)])),_:1,__:[28]}),p("div",j,[_(t,null,{default:x(()=>l[29]||(l[29]=[g("文件类型",-1)])),_:1,__:[29]}),_(i,{modelValue:$.value,"onUpdate:modelValue":l[2]||(l[2]=e=>$.value=e),class:"ml-4"},{default:x(()=>[_(n,{size:"large",label:"1"},{default:x(()=>l[30]||(l[30]=[g("PNG",-1)])),_:1,__:[30]}),_(n,{size:"large",label:"2"},{default:x(()=>l[31]||(l[31]=[g("JPEG",-1)])),_:1,__:[31]})]),_:1},8,["modelValue"])]),p("div",z,[_(r,{class:"box-item",effect:"dark",content:"支持上传：xls, xlsx, csv文件",placement:"top-start"},{default:x(()=>[_(u,{class:"w-1/2"},{default:x(()=>[_(d,{"file-list":me.value,"onUpdate:fileList":l[3]||(l[3]=e=>me.value=e),class:"dataFileRef flex",ref_key:"dataFileRef",ref:q,accept:".xls,.xlsx,.csv","http-request":ve,"on-exceed":fe,limit:1},{default:x(()=>l[32]||(l[32]=[g(" 上传数据 ",-1)])),_:1,__:[32]},8,["file-list"])]),_:1})]),_:1}),_(u,{class:"w-1/2",onClick:ce},{default:x(()=>l[33]||(l[33]=[g("编辑数据",-1)])),_:1,__:[33]})])]),_(se,{modelValue:D.value,"onUpdate:modelValue":l[24]||(l[24]=e=>D.value=e),onChange:te,accordion:""},{default:x(()=>[_(c,{title:"画布设置",name:"1"},{default:x(()=>[p("div",A,[_(t,{class:"w-16 text-right"},{default:x(()=>l[34]||(l[34]=[g("宽度",-1)])),_:1,__:[34]}),_(a,{modelValue:J.value,"onUpdate:modelValue":l[4]||(l[4]=e=>J.value=e),min:1,max:4e3,step:10,"controls-position":"right",class:"h-8 w-60 max-w-[60%] ml-3",onChange:l[5]||(l[5]=e=>ae("size"))},null,8,["modelValue"])]),p("div",B,[_(t,{class:"w-16 text-right"},{default:x(()=>l[35]||(l[35]=[g("高度",-1)])),_:1,__:[35]}),_(a,{modelValue:L.value,"onUpdate:modelValue":l[6]||(l[6]=e=>L.value=e),min:1,max:4e3,step:10,"controls-position":"right",class:"h-8 w-60 max-w-[60%] ml-3",onChange:l[7]||(l[7]=e=>ae("size"))},null,8,["modelValue"])])]),_:1}),_(c,{title:"标题设置",name:"2"},{default:x(()=>[p("div",S,[_(t,{class:"w-16 text-right"},{default:x(()=>l[36]||(l[36]=[g("位置",-1)])),_:1,__:[36]}),_(i,{modelValue:N.value,"onUpdate:modelValue":l[8]||(l[8]=e=>N.value=e),class:"ml-3",onChange:l[9]||(l[9]=e=>ae("title"))},{default:x(()=>[_(m,{label:"left",value:"left"},{default:x(()=>l[37]||(l[37]=[g("左",-1)])),_:1,__:[37]}),_(m,{label:"center",value:"center"},{default:x(()=>l[38]||(l[38]=[g("中",-1)])),_:1,__:[38]}),_(m,{label:"right",value:"right"},{default:x(()=>l[39]||(l[39]=[g("右",-1)])),_:1,__:[39]})]),_:1},8,["modelValue"])]),_(I,{"content-position":"left",class:"pl-10"},{default:x(()=>l[40]||(l[40]=[g("标题",-1)])),_:1,__:[40]}),p("div",O,[_(t,{class:"w-16 text-right"},{default:x(()=>l[41]||(l[41]=[g("显示",-1)])),_:1,__:[41]}),_(M,{modelValue:Q.value,"onUpdate:modelValue":l[10]||(l[10]=e=>Q.value=e),class:"ml-3",onChange:l[11]||(l[11]=e=>ae("title"))},null,8,["modelValue"])]),p("div",E,[_(t,{class:"w-16 text-right"},{default:x(()=>l[42]||(l[42]=[g("标题",-1)])),_:1,__:[42]}),_(le,{class:"h-8 w-60 max-w-[60%] ml-3",modelValue:Y.value,"onUpdate:modelValue":l[12]||(l[12]=e=>Y.value=e),onBlur:l[13]||(l[13]=e=>ae("title"))},null,8,["modelValue"])]),_(I,{"content-position":"left"},{default:x(()=>l[43]||(l[43]=[g("副标题",-1)])),_:1,__:[43]}),p("div",R,[_(t,{class:"w-16 text-right"},{default:x(()=>l[44]||(l[44]=[g("显示",-1)])),_:1,__:[44]}),_(M,{modelValue:X.value,"onUpdate:modelValue":l[14]||(l[14]=e=>X.value=e),class:"ml-3",onChange:l[15]||(l[15]=e=>ae("title"))},null,8,["modelValue"])]),p("div",T,[_(t,{class:"w-16 text-right"},{default:x(()=>l[45]||(l[45]=[g("副标题",-1)])),_:1,__:[45]}),_(le,{class:"h-8 w-60 max-w-[60%] ml-3",modelValue:K.value,"onUpdate:modelValue":l[16]||(l[16]=e=>K.value=e),onBlur:l[17]||(l[17]=e=>ae("title"))},null,8,["modelValue"])])]),_:1}),_(c,{title:"图形属性",name:"3"},{default:x(()=>[p("div",F,[_(t,{class:"w-16 text-right"},{default:x(()=>l[46]||(l[46]=[g("颜色",-1)])),_:1,__:[46]}),_(ue,{modelValue:H.value,"onUpdate:modelValue":l[18]||(l[18]=e=>H.value=e),class:"ml-3",onChange:l[19]||(l[19]=e=>ae("color"))},null,8,["modelValue"])])]),_:1}),_(c,{title:"水印设置",name:"4"},{default:x(()=>[p("div",P,[_(t,{class:"w-16 text-right"},{default:x(()=>l[47]||(l[47]=[g("显示",-1)])),_:1,__:[47]}),_(M,{modelValue:Z.value,"onUpdate:modelValue":l[20]||(l[20]=e=>Z.value=e),class:"ml-3",onChange:l[21]||(l[21]=e=>ae("watermark"))},null,8,["modelValue"])]),p("div",W,[_(t,{class:"w-16 text-right"},{default:x(()=>l[48]||(l[48]=[g("水印内容",-1)])),_:1,__:[48]}),_(le,{class:"h-8 w-60 max-w-[60%] ml-3",modelValue:ee.value,"onUpdate:modelValue":l[22]||(l[22]=e=>ee.value=e),onChange:l[23]||(l[23]=e=>ae("watermark"))},null,8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])])]),_(oe,{id:"x-spreadsheet",modelValue:de.value,"onUpdate:modelValue":l[25]||(l[25]=e=>de.value=e),direction:"btt","custom-class":"sheet",style:{}},null,8,["modelValue"]),_(o,{title:"描述"},{default:x(()=>[_(t,null,{default:x(()=>l[49]||(l[49]=[g(" 在线图表制作工具，在线制作柱状图",-1),p("br",null,null,-1),g(" 在线编辑表格生成柱状图，支持png和jpeg格式导出",-1),p("br",null,null,-1),g(" 柱状图是采用垂直柱子,即矩形块的宽度一样,用高度来代表数值大小。",-1),p("br",null,null,-1),g(" 能让使用者更为直观地看到不同类别数据或不同时间阶段的比较情况及发展趋势，通常利用于较小的数据集分析。",-1),p("br",null,null,-1),g(" 无需任何基础即可上手，并且支持超全的自定义配置，轻松实现你的个性化图表需求",-1),p("br",null,null,-1)])),_:1,__:[49]})]),_:1})])}}}),[["__scopeId","data-v-e3a3e1cf"]]);export{I as default};
