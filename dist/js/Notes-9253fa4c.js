var e=Object.defineProperty,a=(a,l,t)=>(((a,l,t)=>{l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t})(a,"symbol"!=typeof l?l+"":l,t),t),l=(e,a,l)=>new Promise((t,i)=>{var s=e=>{try{o(l.next(e))}catch(a){i(a)}},n=e=>{try{o(l.throw(e))}catch(a){i(a)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,n);o((l=l.apply(e,a)).next())});import{d as t,q as i,r as s,b as n,t as o,al as r,ar as u,o as c,c as d,R as p,a as v,J as m,u as g,P as h,O as f,K as y,M as _,Q as b,a4 as z,D as k,W as x}from"./chunk-bb5ca2a1.js";import{a as C}from"./chunk-273e6dc9.js";import{d as w,h as S,_ as j}from"../assets/index-ca88e876.js";import{E as U,l as V,r as P,p as T,m as q,n as B,j as N,b as $}from"./chunk-8b37ed0a.js";import{_ as D}from"./chunk-222eeebe.js";import{_ as L}from"./chunk-9c6aa90d.js";import"./chunk-94d45690.js";const O=new class{constructor(){a(this,"instance"),a(this,"proxyUrl"),this.proxyUrl="https://tool.fologde.com",this.instance=C.create({baseURL:this.proxyUrl,timeout:3e4}),this.instance.interceptors.request.use(e=>{const a=w();return a&&(e.headers=e.headers||{},e.headers.Authorization=`Bearer ${a}`),e},e=>Promise.reject(e)),this.instance.interceptors.response.use(e=>e,e=>{if(e.response){const a=e.response.status;401===a?(U.error("登录已过期，即将跳转到登录页"),setTimeout(()=>{window.location.href="/login"},1e3)):S(a)}else e.request&&U.error("网络连接失败");return Promise.reject(e)})}get(e,a){return this.instance.get(e,a)}post(e,a,l){return this.instance.post(e,a,l)}put(e,a,l){return this.instance.put(e,a,l)}delete(e,a){return this.instance.delete(e,a)}getProxyUrl(){return this.proxyUrl}},R={class:"flex flex-col mt-3 flex-1"},A={class:"notes-container"},E={class:"header-section"},I={class:"header-left"},J={class:"icon-wrapper"},K={class:"header-subtitle"},M={class:"header-actions"},Q={class:"notes-grid"},W={key:0,class:"empty-state"},F=["onClick"],G={class:"note-header"},H={class:"note-title"},X={class:"note-actions"},Y={class:"note-content"},Z={class:"note-text"},ee={class:"note-footer"},ae={class:"note-time"},le={class:"time-value"},te={key:0,class:"pagination-wrapper"},ie={class:"form-container"},se={class:"dialog-footer"},ne={key:0,class:"detail-container"},oe={class:"detail-header"},re={class:"detail-title"},ue={class:"detail-meta"},ce={class:"meta-item"},de={class:"meta-item"},pe={class:"detail-content"},ve={class:"content-wrapper"},me={class:"content-text"},ge={class:"dialog-footer"},he=j(t({__name:"Notes",setup(e){const a=i({title:"笔记备忘录"}),t=s([]),C=s(null),w=s(!1),S=s(!1),j=s(null),he=s({total:0,page:1,pageSize:12,totalPages:0,hasNext:!1,hasPrev:!1}),fe=i({title:"",content:""}),ye=s(!1),_e=s(!1),be=(e=1,a=12)=>l(this,null,function*(){try{ye.value=!0;const l=yield O.get("/api/notes",{params:{page:e,pageSize:a}});if(200===l.status){const e=l.data;t.value=e.data||[],e.pagination&&(he.value=e.pagination)}}catch(l){U.error("获取笔记列表失败")}finally{ye.value=!1}}),ze=e=>{be(e,he.value.pageSize)},ke=e=>{he.value.pageSize=e,be(1,e)},xe=()=>l(this,null,function*(){if(fe.title.trim()&&fe.content.trim())try{_e.value=!0;201===(yield O.post("/api/notes",{title:fe.title.trim(),content:fe.content.trim()})).status?(U.success("创建成功"),S.value=!1,Ve(),yield be(he.value.page,he.value.pageSize)):U.error("创建失败")}catch(e){U.error("创建失败")}finally{_e.value=!1}else U.warning("标题和内容不能为空")}),Ce=()=>l(this,null,function*(){if(j.value&&fe.title.trim()&&fe.content.trim())try{_e.value=!0;200===(yield O.put(`/api/notes/${j.value}`,{title:fe.title.trim(),content:fe.content.trim()})).status?(U.success("更新成功"),S.value=!1,w.value=!1,j.value=null,Ve(),yield be(he.value.page,he.value.pageSize)):U.error("更新失败")}catch(e){U.error("更新失败")}finally{_e.value=!1}else U.warning("标题和内容不能为空")}),we=e=>l(this,null,function*(){var a;yield $.confirm("确定要删除这条笔记吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});try{_e.value=!0;200===(yield O.delete(`/api/notes/${e.id}`)).status?(U.success("删除成功"),(null==(a=C.value)?void 0:a.id)===e.id&&(C.value=null),1===t.value.length&&he.value.page>1?yield be(he.value.page-1,he.value.pageSize):yield be(he.value.page,he.value.pageSize)):U.error("删除失败")}catch(l){U.error("删除失败")}finally{_e.value=!1}}),Se=e=>{w.value=!0,j.value=e.id,fe.title=e.title,fe.content=e.content,S.value=!0},je=e=>{w.value||(C.value=e,S.value=!1)},Ue=()=>{C.value=null,w.value=!1,Ve(),S.value=!0},Ve=()=>{fe.title="",fe.content=""},Pe=e=>new Date(e).toLocaleString("zh-CN"),Te=n(()=>null!==C.value&&!S.value&&!w.value);return o(()=>{be()}),(e,l)=>{const i=r("el-icon"),s=r("el-button"),n=r("el-pagination"),o=r("el-input"),j=r("el-form-item"),U=r("el-form"),$=r("el-dialog"),O=r("el-text"),Ve=u("loading");return c(),d("div",R,[p(D,{title:a.title},null,8,["title"]),v("div",A,[v("div",E,[v("div",I,[v("div",J,[p(i,{class:"header-icon"},{default:m(()=>[p(g(V))]),_:1})]),v("div",null,[l[13]||(l[13]=v("h3",{class:"header-title"},"我的笔记",-1)),v("p",K,"共 "+h(he.value.total)+" 条笔记",1)])]),v("div",M,[p(s,{class:"action-btn refresh-btn",onClick:l[0]||(l[0]=e=>be(he.value.page,he.value.pageSize)),icon:g(P),loading:ye.value,disabled:ye.value,circle:""},null,8,["icon","loading","disabled"]),p(s,{class:"action-btn create-btn",type:"primary",onClick:Ue,icon:g(T)},{default:m(()=>l[14]||(l[14]=[f(" 新建笔记 ",-1)])),_:1,__:[14]},8,["icon"])])]),y((c(),d("div",Q,[0!==t.value.length||ye.value?_("",!0):(c(),d("div",W,[p(i,{class:"empty-icon"},{default:m(()=>[p(g(V))]),_:1}),l[16]||(l[16]=v("h3",{class:"empty-title"},"暂无笔记",-1)),l[17]||(l[17]=v("p",{class:"empty-desc"},"开始创建你的第一条笔记吧",-1)),p(s,{type:"primary",onClick:Ue,icon:g(T)},{default:m(()=>l[15]||(l[15]=[f("创建笔记",-1)])),_:1,__:[15]},8,["icon"])])),(c(!0),d(b,null,z(t.value,e=>{var a;return c(),d("div",{key:e.id,class:k(["note-card",{"note-active":(null==(a=C.value)?void 0:a.id)===e.id}]),onClick:a=>je(e)},[v("div",G,[v("h4",H,h(e.title),1),v("div",X,[p(s,{class:"action-icon",size:"small",icon:g(q),onClick:x(a=>je(e),["stop"]),circle:"",plain:""},null,8,["icon","onClick"]),p(s,{class:"action-icon edit-icon",size:"small",type:"primary",icon:g(B),loading:_e.value,disabled:_e.value,onClick:x(a=>Se(e),["stop"]),circle:"",plain:""},null,8,["icon","loading","disabled","onClick"]),p(s,{class:"action-icon delete-icon",size:"small",type:"danger",icon:g(N),loading:_e.value,disabled:_e.value,onClick:x(a=>we(e),["stop"]),circle:"",plain:""},null,8,["icon","loading","disabled","onClick"])])]),v("div",Y,[v("p",Z,h(e.content),1)]),v("div",ee,[v("div",ae,[l[18]||(l[18]=v("span",{class:"time-label"},"更新于",-1)),v("span",le,h(Pe(e.updateTime)),1)])])],10,F)}),128))])),[[Ve,ye.value]]),he.value.total>0?(c(),d("div",te,[p(n,{"current-page":he.value.page,"onUpdate:currentPage":l[1]||(l[1]=e=>he.value.page=e),"page-size":he.value.pageSize,"onUpdate:pageSize":l[2]||(l[2]=e=>he.value.pageSize=e),"page-sizes":[6,12,24,48],total:he.value.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:ke,onCurrentChange:ze,class:"custom-pagination"},null,8,["current-page","page-size","total"])])):_("",!0),p($,{modelValue:S.value,"onUpdate:modelValue":l[7]||(l[7]=e=>S.value=e),title:w.value?"编辑笔记":"新建笔记",width:"90%","max-width":"600px",class:"note-dialog",onClose:l[8]||(l[8]=e=>w.value=!1),"destroy-on-close":""},{footer:m(()=>[v("div",se,[p(s,{size:"large",disabled:_e.value,onClick:l[5]||(l[5]=e=>{S.value=!1,w.value=!1})},{default:m(()=>l[19]||(l[19]=[f(" 取消 ",-1)])),_:1,__:[19]},8,["disabled"]),p(s,{type:"primary",size:"large",loading:_e.value,disabled:_e.value,onClick:l[6]||(l[6]=e=>w.value?Ce():xe())},{default:m(()=>[f(h(w.value?"保存修改":"创建笔记"),1)]),_:1},8,["loading","disabled"])])]),default:m(()=>[v("div",ie,[p(U,{model:fe,"label-position":"top"},{default:m(()=>[p(j,{label:"笔记标题",required:"",class:"form-item"},{default:m(()=>[p(o,{modelValue:fe.title,"onUpdate:modelValue":l[3]||(l[3]=e=>fe.title=e),placeholder:"请输入笔记标题",size:"large",class:"title-input"},null,8,["modelValue"])]),_:1}),p(j,{label:"笔记内容",required:"",class:"form-item"},{default:m(()=>[p(o,{modelValue:fe.content,"onUpdate:modelValue":l[4]||(l[4]=e=>fe.content=e),type:"textarea",rows:12,placeholder:"在这里记录你的想法...",class:"content-textarea",resize:"vertical"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue","title"]),p($,{modelValue:Te.value,"onUpdate:modelValue":l[11]||(l[11]=e=>Te.value=e),title:"笔记详情",width:"90%","max-width":"700px",class:"detail-dialog",onClose:l[12]||(l[12]=e=>C.value=null),"destroy-on-close":""},{footer:m(()=>[v("div",ge,[p(s,{size:"large",onClick:l[9]||(l[9]=e=>C.value=null)},{default:m(()=>l[20]||(l[20]=[f("关闭",-1)])),_:1,__:[20]}),p(s,{type:"primary",size:"large",icon:g(B),onClick:l[10]||(l[10]=e=>C.value&&Se(C.value))},{default:m(()=>l[21]||(l[21]=[f(" 编辑笔记 ",-1)])),_:1,__:[21]},8,["icon"])])]),default:m(()=>[C.value?(c(),d("div",ne,[v("div",oe,[v("h2",re,h(C.value.title),1),v("div",ue,[v("span",ce,[p(i,null,{default:m(()=>[p(g(V))]),_:1}),f(" 创建于 "+h(Pe(C.value.createTime)),1)]),v("span",de,[p(i,null,{default:m(()=>[p(g(B))]),_:1}),f(" 更新于 "+h(Pe(C.value.updateTime)),1)])])]),v("div",pe,[v("div",ve,[v("pre",me,h(C.value.content),1)])])])):_("",!0)]),_:1},8,["modelValue"])]),p(L,{title:"描述"},{default:m(()=>[p(O,null,{default:m(()=>l[22]||(l[22]=[f(" 在线笔记记录工具，支持创建、编辑、删除笔记，数据安全存储在云端。您可以随时记录想法、待办事项、学习笔记等，支持富文本编辑，数据实时同步。 ",-1)])),_:1,__:[22]})]),_:1})])}}}),[["__scopeId","data-v-34e5dfe9"]]);export{he as default};
