var e=(e,t,l)=>new Promise((r,a)=>{var o=e=>{try{n(l.next(e))}catch(t){a(t)}},s=e=>{try{n(l.throw(e))}catch(t){a(t)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);n((l=l.apply(e,t)).next())});import{_ as t}from"./chunk-af583744.js";import{_ as l}from"./chunk-9c6aa90d.js";import{d as r,q as a,r as o,al as s,o as n,c as i,R as u,a as c,P as f,Q as m,a4 as d,E as v,D as x,J as b,O as p}from"./chunk-bb5ca2a1.js";import{_ as h}from"../assets/index-139225df.js";import"./chunk-0a8d181f.js";import"./chunk-96adf8d3.js";import"./chunk-b045bb46.js";const y={class:"flex flex-col mt-3 flex-1"},g={class:"p-4 rounded-2xl bg-white"},w={class:"flex flex-col items-center"},k={class:"mb-4 text-center"},A={class:"text-lg font-semibold mb-2"},I=["viewBox"],_=["x1","x2","y2"],P=["y1","x2","y2"],O=["onClick"],M=15,B=40,j=20,G=h(r({__name:"AiGomoku",setup(r){const h=a({title:"AI五子棋"}),G={width:"640px",height:"640px"},N=a({board:Array(M).fill(null).map(()=>Array(M).fill(0)),currentPlayer:1,gameOver:!1,winner:0}),$=o(!1),C=2,D=6,E=600,R=2,T=(()=>{const e=()=>Math.floor(4294967296*Math.random())>>>0,t=[];for(let l=0;l<M;l++){t[l]=[];for(let r=0;r<M;r++)t[l][r]=[e(),e()]}return t})(),q=new Map,H=(e,t)=>e>=0&&e<M&&t>=0&&t<M,J=(e,t=R)=>{const l=Array(M).fill(null).map(()=>Array(M).fill(!1));let r=!1;for(let o=0;o<M;o++)for(let a=0;a<M;a++)if(0!==e[o][a]){r=!0;for(let r=-t;r<=t;r++)for(let s=-t;s<=t;s++){const t=o+r,n=a+s;H(t,n)&&0===e[t][n]&&(l[t][n]=!0)}}const a=[];if(!r){const e=Math.floor(7.5);return a.push({row:e,col:e}),a}for(let o=0;o<M;o++)for(let t=0;t<M;t++)0===e[o][t]&&l[o][t]&&a.push({row:o,col:t});return a},Q=[[1,0],[0,1],[1,1],[1,-1]],S=(e,t)=>e>=5?1e8:4===e&&2===t?1e7:4===e&&1===t?1e6:3===e&&2===t?1e5:3===e&&1===t?1e4:2===e&&2===t?1e3:2===e&&1===t?100:10*e,U=(e,t)=>{let l=0;for(let r=0;r<M;r++)for(let a=0;a<M;a++)if(e[r][a]===t)for(const[o,s]of Q){let n=1,i=0;for(let l=1;l<5;l++){const u=r+o*l,c=a+s*l;if(!H(u,c))break;if(e[u][c]!==t){0===e[u][c]&&i++;break}n++}for(let l=1;l<5;l++){const u=r-o*l,c=a-s*l;if(!H(u,c))break;if(e[u][c]!==t){0===e[u][c]&&i++;break}n++}l+=S(n,i)}return l},X=(e,t)=>{const l=1===t?2:1;return U(e,t)-1.1*U(e,l)+20*(e=>{let t=0;for(let l=0;l<M;l++)for(let r=0;r<M;r++)0!==e[l][r]&&(t-=Math.abs(l-7)+Math.abs(r-7));return t})(e)},Z=(e,t,l,r)=>{for(const[a,o]of Q){let s=1;for(let n=1;n<5;n++){const i=t+a*n,u=l+o*n;if(!H(i,u)||e[i][u]!==r)break;s++}for(let n=1;n<5;n++){const i=t-a*n,u=l-o*n;if(!H(i,u)||e[i][u]!==r)break;s++}if(s>=5)return!0}return!1},z=(e,t)=>{const l=J(e);for(const r of l){e[r.row][r.col]=t;const l=Z(e,r.row,r.col,t);if(e[r.row][r.col]=0,l)return r}return null},F=(e,t,l,r,a,o,s,n)=>{if(performance.now()-s>n)return{value:0,move:null,aborted:!0};const i=(e=>{let t=0;for(let l=0;l<M;l++)for(let r=0;r<M;r++){const a=e[l][r];1===a?t=(t^T[l][r][0]>>>0)>>>0:2===a&&(t=(t^T[l][r][1]>>>0)>>>0)}return t>>>0})(e),u=q.get(i);if(u&&u.depth>=t)return{value:u.value,move:null};const c=z(e,o*a);if(c){return{value:1e8+t,move:c}}if(0===t){return{value:a*X(e,o),move:null}}let f=-1/0,m=null;const d=J(e).map(t=>{e[t.row][t.col]=o*a;const l=X(e,o);return e[t.row][t.col]=0,{mv:t,v:l}}).sort((e,t)=>t.v-e.v).map(e=>e.mv);for(const v of d){e[v.row][v.col]=o*a;const i=F(e,t-1,-r,-l,-a,o,s,n);if(e[v.row][v.col]=0,i.aborted)return{value:0,move:null,aborted:!0};const u=-i.value;if(u>f&&(f=u,m=v),(l=Math.max(l,u))>=r)break}return q.set(i,{depth:t,value:f}),{value:f,move:m}},K=(t,l,r,a)=>e(this,null,function*(){const e=performance.now();q.clear();let o=null,s=-1/0;for(let n=1;n<=r;n++){if(a-(performance.now()-e)<=10)break;const r=F(t,n,-1/0,1/0,1,l,e,a);if(r.aborted)break;if(r.move&&(o=r.move,s=r.value),s>5e7)break;yield new Promise(e=>setTimeout(e,0))}return o}),L=(e,t)=>{N.board[e][t]=C,W(e,t,C)?(N.gameOver=!0,N.winner=C):Y()?(N.gameOver=!0,N.winner=0):N.currentPlayer=1,$.value=!1},V=(t,l)=>{if(!N.gameOver&&0===N.board[t][l]&&!$.value){if(N.board[t][l]=N.currentPlayer,W(t,l,N.currentPlayer))return N.gameOver=!0,void(N.winner=N.currentPlayer);if(Y())return N.gameOver=!0,void(N.winner=0);N.currentPlayer=C,$.value=!1,(()=>{e(this,null,function*(){const e=N.board.map(e=>e.slice()),t=z(e,C);if(t)return void L(t.row,t.col);const l=z(e,1);if(l)return void L(l.row,l.col);const r=yield K(e,C,D,E);if(r)L(r.row,r.col);else{const t=J(e);if(t.length>0){const e=t[Math.floor(Math.random()*t.length)];L(e.row,e.col)}else $.value=!1,N.currentPlayer=1}})})()}},W=(e,t,l)=>{for(const[r,a]of Q){let o=1;for(let s=1;s<5;s++){const n=e+r*s,i=t+a*s;if(n<0||n>=M||i<0||i>=M||N.board[n][i]!==l)break;o++}for(let s=1;s<5;s++){const n=e-r*s,i=t-a*s;if(n<0||n>=M||i<0||i>=M||N.board[n][i]!==l)break;o++}if(o>=5)return!0}return!1},Y=()=>N.board.every(e=>e.every(e=>0!==e)),ee=()=>{N.board=Array(M).fill(null).map(()=>Array(M).fill(0)),N.currentPlayer=1,N.gameOver=!1,N.winner=0,$.value=!1},te=(e,t)=>{const l=N.board[e][t];return 0===l?"empty":1===l?"black":2===l?"white":""},le=()=>{if(N.gameOver){if(0===N.winner)return"游戏结束，平局！";if(1===N.winner)return"恭喜！你赢了！";if(2===N.winner)return"AI赢了！再试一次吧！"}return $.value?"AI正在思考...":1===N.currentPlayer?"轮到你了（黑子）":"轮到AI（白子）"};return(e,r)=>{const a=s("el-text");return n(),i("div",y,[u(t,{title:h.title},null,8,["title"]),c("div",g,[c("div",w,[c("div",k,[c("div",A,f(le()),1),c("button",{onClick:ee,class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors"}," 重新开始 ")]),c("div",{class:"relative",style:G},[r[0]||(r[0]=c("div",{class:"absolute inset-0 bg-amber-100 rounded-lg"},null,-1)),(n(),i("svg",{class:"absolute inset-0 w-full h-full",viewBox:"0 0 640 640"},[(n(),i(m,null,d(M,e=>c("line",{key:`v${e}`,x1:j+(e-1)*B,y1:j,x2:j+(e-1)*B,y2:580,stroke:"#8B4513","stroke-width":"1"},null,8,_)),64)),(n(),i(m,null,d(M,e=>c("line",{key:`h${e}`,x1:j,y1:j+(e-1)*B,x2:580,y2:j+(e-1)*B,stroke:"#8B4513","stroke-width":"1"},null,8,P)),64))],8,I)),(n(),i(m,null,d(M,e=>c("div",{key:"row-"+(e-1),class:"absolute",style:v({top:j+(e-1)*B-20+"px",left:"0px",width:"600px",height:"40px"})},[(n(),i(m,null,d(M,t=>c("div",{key:`${e-1}-${t-1}`,class:x(["absolute cursor-pointer transition-all duration-200 hover:scale-110",te(e-1,t-1)]),style:v({left:(t-1)*B+"px",width:"40px",height:"40px"}),onClick:l=>V(e-1,t-1)},null,14,O)),64))],4)),64))]),r[1]||(r[1]=c("div",{class:"mt-6 text-center text-gray-600"},[c("p",null,"点击棋盘落子，与AI对战五子棋！"),c("p",null,"黑子先手，先连成五子者获胜。")],-1))])]),u(l,{title:"描述"},{default:b(()=>[u(a,null,{default:b(()=>r[2]||(r[2]=[p(" AI五子棋是一款智能对战游戏，玩家执黑子，AI执白子。游戏采用经典的15×15棋盘，支持鼠标点击落子，具有智能AI对手，能够进行策略性对战。游戏包含胜负判定、平局检测等功能，适合休闲娱乐和策略思维训练。 ",-1)])),_:1,__:[2]})]),_:1}),u(l,{title:"AI算法原理"},{default:b(()=>r[3]||(r[3]=[c("div",{class:"space-y-4"},[c("div",null,[c("h4",{class:"font-semibold text-lg mb-2"},"算法架构"),c("p",{class:"text-gray-700 mb-2"},"我们把AI能力分成两类职责："),c("ul",{class:"list-disc list-inside space-y-1 text-gray-600"},[c("li",null,[c("strong",null,"搜索（Search）"),p("：在若干可能走法中寻找最优走子 —— 用Negamax + Alpha-Beta、迭代加深、时间限制等实现")]),c("li",null,[c("strong",null,"评估（Evaluation）"),p("：当搜索走到深度底或叶节点时，为当前局面打分 —— 用棋型识别（活四/冲四/活三/眠三……）和位置权重")])])]),c("div",null,[c("h4",{class:"font-semibold text-lg mb-2"},"核心算法"),c("div",{class:"space-y-3"},[c("div",null,[c("h5",{class:"font-medium text-blue-600"},"1. Negamax算法"),c("p",{class:"text-gray-600 text-sm"},'Negamax是Minimax的变体，利用对称性把"最大化对我分数 = 最小化对方分数"的关系合并成统一函数，代码更简洁，易与Alpha-Beta、置换表配合。')]),c("div",null,[c("h5",{class:"font-medium text-blue-600"},"2. Alpha-Beta剪枝"),c("p",{class:"text-gray-600 text-sm"},"在Negamax上加上下界（alpha）和上界（beta），当某个分支不能影响根节点决策时就剪掉，在合理的走法排序下能把搜索树大小从O(b^d)大幅降为O(b^{d/2})。")]),c("div",null,[c("h5",{class:"font-medium text-blue-600"},"3. 迭代加深"),c("p",{class:"text-gray-600 text-sm"},"从浅到深逐层运行搜索（深度1,2,3...），每层都保存当前最佳走法。能在任何时间点都有一个可用解，配合时间限制很重要。")]),c("div",null,[c("h5",{class:"font-medium text-blue-600"},"4. 候选走法生成"),c("p",{class:"text-gray-600 text-sm"},"只考虑靠近已有棋子的空位（搜索半径=2），或在空盘只考虑中心。五子棋的合理走子大多发生在已有棋子附近，过滤孤立点能大幅降低分支因子。")]),c("div",null,[c("h5",{class:"font-medium text-blue-600"},"5. 立即获胜/阻挡检测"),c("p",{class:"text-gray-600 text-sm"},'在正式深搜前先检测"落子立刻获胜"或"必须阻挡对手的立刻获胜"，若存在直接走法就优先执行，避免浪费搜索预算。')]),c("div",null,[c("h5",{class:"font-medium text-blue-600"},"6. 评估函数"),c("p",{class:"text-gray-600 text-sm"},"识别常见棋型并赋权：五连(1e8)、活四(1e7)、冲四(1e6)、活三(1e5)、眠三(1e4)、活二(1e3)。对敌方棋型赋负分，防守权重略微放大，促使AI在对手有威胁时更偏向阻挡。")]),c("div",null,[c("h5",{class:"font-medium text-blue-600"},"7. 置换表 + Zobrist哈希"),c("p",{class:"text-gray-600 text-sm"},"为棋盘中每个位置和每种棋子分配随机数，棋局哈希是对这些随机数做XOR的结果。用哈希把已评估局面和深度/分值缓存起来，节省大量重复计算。")]),c("div",null,[c("h5",{class:"font-medium text-blue-600"},"8. 走法排序"),c("p",{class:"text-gray-600 text-sm"},'Alpha-Beta的效率极度依赖先搜索到"好走法"。把"立即获胜走法"放在最前面，先按静态评估对候选走法排序，越早找到高分走法，越多后续分支被剪掉。')])])]),c("div",null,[c("h4",{class:"font-semibold text-lg mb-2"},"工作流程"),c("ol",{class:"list-decimal list-inside space-y-1 text-gray-600"},[c("li",null,"用户落子 → 检查胜负/平局"),c("li",null,"切换AI：先查找我方必胜 → 若无，再查找必堵 → 若都无，进入深搜"),c("li",null,"使用迭代加深（depth = 1..maxDepth），每层调用negamax（带alpha-beta、置换表、时间检测）"),c("li",null,"搜索中若超时则中断，返回当前bestMove"),c("li",null,"应用走子，更新状态，UI更新")])]),c("div",{class:"bg-blue-50 p-3 rounded-lg"},[c("p",{class:"text-blue-800 text-sm"},[c("strong",null,"技术特点："),p("搜索深度6层，时间限制600ms，搜索半径2格，支持异步计算和超时中断，确保AI既能快速响应又具备足够的策略深度。 ")])]),c("div",{class:"bg-gray-50 p-3 rounded-lg border-l-4 border-gray-400"},[c("p",{class:"text-gray-700 text-sm"},[c("strong",null,"源码地址："),c("a",{href:"https://github.com/2424004764/tools-web/blob/master/src/components/Tools/AiGomoku/AiGomoku.vue",target:"_blank",rel:"noopener noreferrer",class:"text-blue-600 hover:text-blue-800 underline"}," GitHub - AI五子棋组件源码 "),c("br"),c("span",{class:"text-gray-500 text-xs"},"欢迎查看完整实现，了解算法细节和代码结构")])])],-1)])),_:1,__:[3]})])}}}),[["__scopeId","data-v-7f6be378"]]);export{G as default};
