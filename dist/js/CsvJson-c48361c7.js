import{D as e}from"./chunk-7c0c6fbd.js";import{T as l}from"./chunk-f92b9743.js";import{c as a,_ as t}from"../assets/index-4e015737.js";import{E as s}from"./chunk-d6839cfd.js";import{d as n,q as o,r as u,b as r,al as c,o as i,c as d,R as m,a as p,J as v,O as f,I as y,M as h,D as g}from"./chunk-bb5ca2a1.js";import"./chunk-5443edaa.js";import"./chunk-eb404ece.js";const _={class:"flex flex-col mt-3 flex-1"},V={class:"p-4 rounded-2xl bg-white"},x={class:"flex flex-wrap items-center gap-3"},b={class:"flex items-center gap-2"},S={class:"mt-3 text-sm text-gray-500"},j={class:"mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4"},k={key:0,class:"lg:col-span-1"},A={key:1,class:"lg:col-span-1"},C=t(n({__name:"CsvJson",setup(t){const n=o({title:"CSV/TSV ↔ JSON 互转"}),C=u("csv2json"),J=u(""),O=u(""),w=u(""),N=o({delimKey:"comma",customDelim:"",hasHeader:!0,includeHeader:!0}),H=r(()=>{switch(N.delimKey){case"comma":return",";case"tab":return"\t";case"semicolon":return";";case"pipe":return"|";case"custom":return N.customDelim||","}});function T(){"csv2json"===C.value?function(){try{const e=function(e,l){const a=[];let t="",s=[],n=!1;const o=e.replace(/\r\n/g,"\n"),u=o.length;for(let r=0;r<u;r++){const e=o[r];'"'===e?n&&'"'===o[r+1]?(t+='"',r++):n=!n:e!==l||n?"\n"!==e||n?t+=e:(s.push(t),a.push(s),s=[],t=""):(s.push(t),t="")}for(s.push(t),a.push(s);a.length&&1===a[a.length-1].length&&""===a[a.length-1][0];)a.pop();return a}(J.value||"",H.value);if(!e.length)return void(w.value="[]");let l=[],a=[];if(N.hasHeader)l=e[0].map((e,l)=>(null!=e?e:"").toString().trim()||`col_${l+1}`),a=e.slice(1);else{const t=Math.max(...e.map(e=>e.length));l=Array.from({length:t},(e,l)=>`col_${l+1}`),a=e}const t=a.map(e=>{const a={};return l.forEach((l,t)=>{var s;a[l]=null!=(s=e[t])?s:""}),a});w.value=JSON.stringify(t,null,2),s.success("转换成功")}catch(e){s.error((null==e?void 0:e.message)||"转换失败")}}():function(){try{const e=JSON.parse(O.value||"[]"),l=Array.isArray(e)?e:[e];if(!l.length)return void(w.value="");let a=[];if(N.includeHeader)if("object"!=typeof l[0]||Array.isArray(l[0])){if(Array.isArray(l[0])){const e=Math.max(...l.map(e=>Array.isArray(e)?e.length:0));a=Array.from({length:e},(e,l)=>`col_${l+1}`)}}else{const e=new Set;for(const a of l)a&&"object"==typeof a&&!Array.isArray(a)&&Object.keys(a).forEach(l=>e.add(l));a=Array.from(e)}const t=e=>{const l=null==e?"":String(e),a=H.value,t=l.includes('"')||l.includes("\n")||l.includes("\r")||l.includes(a),s=l.replace(/"/g,'""');return t?`"${s}"`:s},n=[];N.includeHeader&&a.length&&n.push(a.map(t).join(H.value));for(const s of l)if(Array.isArray(s))n.push(s.map(t).join(H.value));else if(s&&"object"==typeof s){const e=(a.length?a:Object.keys(s)).map(e=>t(s[e]));n.push(e.join(H.value))}else n.push(t(s));w.value=n.join("\r\n"),s.success("转换成功")}catch(e){s.error((null==e?void 0:e.message)||"转换失败，请检查 JSON 是否有效")}}()}function U(){J.value="",O.value="",w.value=""}function D(){a(w.value)}function B(){J.value="name,age,city\nAlice,30,Beijing\nBob,25,Shanghai"}function K(){N.delimKey="tab",J.value="name\tage\tcity\nAlice\t30\tBeijing\nBob\t25\tShanghai"}function E(){O.value=JSON.stringify([{name:"Alice",age:30,city:"Beijing"},{name:"Bob",age:25,city:"Shanghai"}],null,2)}return(a,t)=>{const s=c("el-radio-button"),o=c("el-radio-group"),u=c("el-option"),r=c("el-select"),H=c("el-input"),$=c("el-switch"),M=c("el-button"),q=c("el-link"),F=c("el-text");return i(),d("div",_,[m(e,{title:n.title},null,8,["title"]),p("div",V,[p("div",x,[m(o,{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=e=>C.value=e)},{default:v(()=>[m(s,{label:"csv2json"},{default:v(()=>t[8]||(t[8]=[f("CSV/TSV → JSON",-1)])),_:1,__:[8]}),m(s,{label:"json2csv"},{default:v(()=>t[9]||(t[9]=[f("JSON → CSV/TSV",-1)])),_:1,__:[9]})]),_:1},8,["modelValue"]),p("div",b,[t[10]||(t[10]=p("span",{class:"text-sm text-gray-600"},"分隔符：",-1)),m(r,{modelValue:N.delimKey,"onUpdate:modelValue":t[1]||(t[1]=e=>N.delimKey=e),style:{width:"160px"}},{default:v(()=>[m(u,{label:"逗号 (,)",value:"comma"}),m(u,{label:"制表符 (Tab)",value:"tab"}),m(u,{label:"分号 (;)",value:"semicolon"}),m(u,{label:"竖线 (|)",value:"pipe"}),m(u,{label:"自定义",value:"custom"})]),_:1},8,["modelValue"]),"custom"===N.delimKey?(i(),y(H,{key:0,modelValue:N.customDelim,"onUpdate:modelValue":t[2]||(t[2]=e=>N.customDelim=e),placeholder:"自定义分隔符",style:{width:"140px"},maxlength:"3"},null,8,["modelValue"])):h("",!0)]),"csv2json"===C.value?(i(),y($,{key:0,modelValue:N.hasHeader,"onUpdate:modelValue":t[3]||(t[3]=e=>N.hasHeader=e),"active-text":"首行是列头","inactive-text":"自动生成列头"},null,8,["modelValue"])):(i(),y($,{key:1,modelValue:N.includeHeader,"onUpdate:modelValue":t[4]||(t[4]=e=>N.includeHeader=e),"active-text":"输出包含列头","inactive-text":"不包含列头"},null,8,["modelValue"])),m(M,{type:"primary",onClick:T},{default:v(()=>t[11]||(t[11]=[f("转换",-1)])),_:1,__:[11]}),m(M,{onClick:D},{default:v(()=>t[12]||(t[12]=[f("复制结果",-1)])),_:1,__:[12]}),m(M,{type:"danger",onClick:U},{default:v(()=>t[13]||(t[13]=[f("清空",-1)])),_:1,__:[13]})]),p("div",S,[t[17]||(t[17]=f(" 示例： ",-1)),m(q,{type:"primary",onClick:B},{default:v(()=>t[14]||(t[14]=[f("CSV",-1)])),_:1,__:[14]}),t[18]||(t[18]=p("span",{class:"mx-1"},"/",-1)),m(q,{type:"primary",onClick:K},{default:v(()=>t[15]||(t[15]=[f("TSV",-1)])),_:1,__:[15]}),t[19]||(t[19]=p("span",{class:"mx-1"},"/",-1)),m(q,{type:"primary",onClick:E},{default:v(()=>t[16]||(t[16]=[f("JSON",-1)])),_:1,__:[16]})]),p("div",j,["csv2json"===C.value?(i(),d("div",k,[t[20]||(t[20]=p("div",{class:"mb-2 text-sm text-gray-600"},"CSV/TSV 输入",-1)),m(H,{type:"textarea",rows:16,modelValue:J.value,"onUpdate:modelValue":t[5]||(t[5]=e=>J.value=e),placeholder:"粘贴 CSV/TSV 内容"},null,8,["modelValue"])])):h("",!0),"json2csv"===C.value?(i(),d("div",A,[t[21]||(t[21]=p("div",{class:"mb-2 text-sm text-gray-600"},"JSON 输入（数组）",-1)),m(H,{type:"textarea",rows:16,modelValue:O.value,"onUpdate:modelValue":t[6]||(t[6]=e=>O.value=e),placeholder:'如：[{"a":1},{"a":2}]'},null,8,["modelValue"])])):h("",!0),p("div",{class:g((C.value,"lg:col-span-2"))},[t[22]||(t[22]=p("div",{class:"mb-2 text-sm text-gray-600"},"结果",-1)),m(H,{type:"textarea",rows:16,modelValue:w.value,"onUpdate:modelValue":t[7]||(t[7]=e=>w.value=e),placeholder:"转换结果"},null,8,["modelValue"])],2)])]),m(l,{title:"描述"},{default:v(()=>[m(F,null,{default:v(()=>t[23]||(t[23]=[f(" - 支持分隔符选择（逗号/制表符/分号/竖线/自定义）与列头推断。",-1),p("br",null,null,-1),f(" - CSV→JSON：可指定首行是否列头；若否，将自动生成 col_1...。",-1),p("br",null,null,-1),f(" - JSON→CSV：自动合并对象键为列头；支持选择是否输出列头。",-1),p("br",null,null,-1),f(" - 支持复制、清空与示例填充。 ",-1)])),_:1,__:[23]})]),_:1})])}}}),[["__file","D:/dev/nodejs/tool-web1/tools-web/src/components/Tools/CsvJson/CsvJson.vue"]]);export{C as default};
