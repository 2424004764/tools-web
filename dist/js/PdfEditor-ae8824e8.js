var l=Object.defineProperty,e=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,u=(e,a,t)=>a in e?l(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,i=(l,i)=>{for(var n in i||(i={}))a.call(i,n)&&u(l,n,i[n]);if(e)for(var n of e(i))t.call(i,n)&&u(l,n,i[n]);return l},n=(l,e,a)=>new Promise((t,u)=>{var i=l=>{try{o(a.next(l))}catch(e){u(e)}},n=l=>{try{o(a.throw(l))}catch(e){u(e)}},o=l=>l.done?t(l.value):Promise.resolve(l.value).then(i,n);o((a=a.apply(l,e)).next())});import{f as o,_ as d}from"../assets/index-a02a0b09.js";import{_ as s}from"./chunk-08a8c02c.js";import{_ as r}from"./chunk-9c6aa90d.js";import{_ as c,w as f}from"./chunk-0cb65a34.js";import{E as v}from"./chunk-ebe7e565.js";import{d as p,q as m,r as _,t as h,al as g,ar as b,o as y,c as V,R as x,a as P,J as w,O as D,K as F,I as k,P as j,M as z,v as U}from"./chunk-bb5ca2a1.js";import"./chunk-04652fe6.js";import"./chunk-b2647718.js";const C={class:"pdf-editor"},E={class:"toolbar"},O={class:"main-content"},S={key:0,class:"edit-panel-top"},I={class:"canvas-area"},M={key:0,class:"upload-prompt"},R={key:1,class:"pdf-container"},A={class:"page-nav"},B={class:"space-y-3"},T=d(p({__name:"PdfEditor",setup(l){c.workerSrc=f;let e=null,a=null;const t=m({title:"PDF页眉页脚编辑器"}),u=_(!1),d=_(1),p=_(0),T=_(.8),$=_(!1),J=_(!1),L=_(!1),W=_(null),q=_({}),G=m({text:"",font:"sans-serif",size:14,align:"left"}),H=m({text:"",font:"sans-serif",size:12,align:"center"}),K=_("current"),N=()=>n(this,null,function*(){try{const l=yield o(()=>import("./chunk-0cb65a34.js").then(l=>l.p),["js/chunk-0cb65a34.js","assets/index-a02a0b09.js","js/chunk-bb5ca2a1.js","js/chunk-ebe7e565.js","js/chunk-04652fe6.js","js/chunk-b2647718.js","assets/index-5f044577.css"]);e=l}catch(l){v.error("PDF.js 库加载失败")}});h(()=>{N()});const Q=l=>n(this,null,function*(){if(!(null==l?void 0:l.raw))return;const e=l.raw;"application/pdf"===e.type?yield X(e):v.error("请选择PDF文件")}),X=l=>n(this,null,function*(){if(e){J.value=!0,u.value=!1;try{const t=yield l.arrayBuffer();a=yield e.getDocument({data:t}).promise,p.value=a.numPages,d.value=1,u.value=!0,yield U(),yield Y(1),v.success("PDF加载成功")}catch(t){v.error("PDF加载失败")}finally{J.value=!1}}else v.error("PDF.js 库未加载完成")}),Y=l=>n(this,null,function*(){if(a&&(yield U(),W.value))try{d.value=l;const e=yield a.getPage(l),t=e.getViewport({scale:1.5*T.value}),u=W.value,i=u.getContext("2d");if(!i)return;u.height=t.height,u.width=t.width,yield e.render({canvasContext:i,viewport:t}).promise,Z(i,u.width,u.height,l)}catch(e){v.error("渲染页面失败")}}),Z=(l,e,a,t)=>{var u,i;const n=q.value[t];if(n){if(null==(u=n.header)?void 0:u.text){l.font=`${n.header.size}px ${n.header.font}`,l.fillStyle="#000000",l.textBaseline="top";let a=20;"center"===n.header.align&&(a=e/2),"right"===n.header.align&&(a=e-20),l.textAlign=n.header.align;const u=n.header.text.replace("{page}",t.toString());l.fillText(u,a,20)}if(null==(i=n.footer)?void 0:i.text){l.font=`${n.footer.size}px ${n.footer.font}`,l.fillStyle="#000000",l.textBaseline="bottom";let u=20;"center"===n.footer.align&&(u=e/2),"right"===n.footer.align&&(u=e-20),l.textAlign=n.footer.align;const i=n.footer.text.replace("{page}",t.toString());l.fillText(i,u,a-20)}}},ll=()=>{d.value>1&&Y(d.value-1)},el=()=>{d.value<p.value&&Y(d.value+1)},al=()=>{T.value=Math.min(T.value+.1,2),Y(d.value)},tl=()=>{T.value=Math.max(T.value-.1,.5),Y(d.value)},ul=()=>{const l=K.value,e={header:i({},G),footer:i({},H)};if("current"===l)q.value[d.value]=e;else for(let a=1;a<=p.value;a++)q.value[a]=e;Y(d.value),v.success("设置已应用")},il=()=>n(this,null,function*(){if(a&&W.value){L.value=!0;try{const{jsPDF:l}=yield o(()=>import("./chunk-a8dbb3d4.js").then(l=>l.j),["js/chunk-a8dbb3d4.js","assets/index-a02a0b09.js","js/chunk-bb5ca2a1.js","js/chunk-ebe7e565.js","js/chunk-04652fe6.js","js/chunk-b2647718.js","assets/index-5f044577.css"]),e=new l({orientation:"portrait",unit:"pt",format:"a4"});for(let t=1;t<=p.value;t++){t>1&&e.addPage();const l=yield a.getPage(t),u=l.getViewport({scale:1.5}),i=document.createElement("canvas"),n=i.getContext("2d");i.height=u.height,i.width=u.width,yield l.render({canvasContext:n,viewport:u}).promise,Z(n,i.width,i.height,t);const o=i.toDataURL("image/jpeg",.95),d=e.internal.pageSize.getWidth(),s=e.internal.pageSize.getHeight();e.addImage(o,"JPEG",0,0,d,s)}e.save("edited-document.pdf"),v.success("PDF导出成功")}catch(l){v.error("PDF导出失败")}finally{L.value=!1}}});return(l,e)=>{const a=g("el-button"),i=g("el-upload"),n=g("el-divider"),o=g("el-switch"),c=g("el-button-group"),f=g("el-input"),v=g("el-form-item"),m=g("el-option"),_=g("el-select"),h=g("el-input-number"),U=g("el-form"),J=g("el-card"),q=g("el-col"),N=g("el-row"),X=g("el-empty"),Y=g("el-text"),Z=b("loading");return y(),V("div",null,[x(s,{info:t},null,8,["info"]),P("div",C,[P("div",E,[x(i,{"auto-upload":!1,"show-file-list":!1,accept:".pdf","on-change":Q},{default:w(()=>[x(a,{type:"primary"},{default:w(()=>e[10]||(e[10]=[D("上传PDF",-1)])),_:1,__:[10]})]),_:1}),F((y(),k(a,{onClick:il,disabled:!u.value},{default:w(()=>e[11]||(e[11]=[D("导出PDF",-1)])),_:1,__:[11]},8,["disabled"])),[[Z,L.value]]),x(n,{direction:"vertical"}),x(o,{modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=l=>$.value=l),"active-text":"编辑模式"},null,8,["modelValue"]),x(n,{direction:"vertical"}),x(c,null,{default:w(()=>[x(a,{onClick:tl,disabled:!u.value},{default:w(()=>e[12]||(e[12]=[D("缩小",-1)])),_:1,__:[12]},8,["disabled"]),x(a,{disabled:""},{default:w(()=>[D(j(Math.round(100*T.value))+"%",1)]),_:1}),x(a,{onClick:al,disabled:!u.value},{default:w(()=>e[13]||(e[13]=[D("放大",-1)])),_:1,__:[13]},8,["disabled"])]),_:1})]),P("div",O,[$.value&&u.value?(y(),V("div",S,[x(N,{gutter:20},{default:w(()=>[x(q,{span:8},{default:w(()=>[x(J,{header:"页眉设置"},{default:w(()=>[x(U,{"label-width":"80px",size:"small"},{default:w(()=>[x(v,{label:"文本内容"},{default:w(()=>[x(f,{modelValue:G.text,"onUpdate:modelValue":e[1]||(e[1]=l=>G.text=l),placeholder:"输入页眉文本，使用 {page} 表示页码"},null,8,["modelValue"])]),_:1}),x(v,{label:"字体"},{default:w(()=>[x(_,{modelValue:G.font,"onUpdate:modelValue":e[2]||(e[2]=l=>G.font=l)},{default:w(()=>[x(m,{label:"无衬线",value:"sans-serif"}),x(m,{label:"衬线",value:"serif"}),x(m,{label:"等宽",value:"monospace"})]),_:1},8,["modelValue"])]),_:1}),x(v,{label:"字号"},{default:w(()=>[x(h,{modelValue:G.size,"onUpdate:modelValue":e[3]||(e[3]=l=>G.size=l),min:8,max:32},null,8,["modelValue"])]),_:1}),x(v,{label:"对齐"},{default:w(()=>[x(_,{modelValue:G.align,"onUpdate:modelValue":e[4]||(e[4]=l=>G.align=l)},{default:w(()=>[x(m,{label:"左对齐",value:"left"}),x(m,{label:"居中",value:"center"}),x(m,{label:"右对齐",value:"right"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),x(q,{span:8},{default:w(()=>[x(J,{header:"页脚设置"},{default:w(()=>[x(U,{"label-width":"80px",size:"small"},{default:w(()=>[x(v,{label:"文本内容"},{default:w(()=>[x(f,{modelValue:H.text,"onUpdate:modelValue":e[5]||(e[5]=l=>H.text=l),placeholder:"输入页脚文本，使用 {page} 表示页码"},null,8,["modelValue"])]),_:1}),x(v,{label:"字体"},{default:w(()=>[x(_,{modelValue:H.font,"onUpdate:modelValue":e[6]||(e[6]=l=>H.font=l)},{default:w(()=>[x(m,{label:"无衬线",value:"sans-serif"}),x(m,{label:"衬线",value:"serif"}),x(m,{label:"等宽",value:"monospace"})]),_:1},8,["modelValue"])]),_:1}),x(v,{label:"字号"},{default:w(()=>[x(h,{modelValue:H.size,"onUpdate:modelValue":e[7]||(e[7]=l=>H.size=l),min:8,max:32},null,8,["modelValue"])]),_:1}),x(v,{label:"对齐"},{default:w(()=>[x(_,{modelValue:H.align,"onUpdate:modelValue":e[8]||(e[8]=l=>H.align=l)},{default:w(()=>[x(m,{label:"左对齐",value:"left"}),x(m,{label:"居中",value:"center"}),x(m,{label:"右对齐",value:"right"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),x(q,{span:8},{default:w(()=>[x(J,{header:"应用设置"},{default:w(()=>[x(U,{"label-width":"80px",size:"small"},{default:w(()=>[x(v,{label:"应用范围"},{default:w(()=>[x(_,{modelValue:K.value,"onUpdate:modelValue":e[9]||(e[9]=l=>K.value=l)},{default:w(()=>[x(m,{label:"当前页",value:"current"}),x(m,{label:"所有页",value:"all"})]),_:1},8,["modelValue"])]),_:1}),x(v,null,{default:w(()=>[x(a,{type:"primary",onClick:ul,style:{width:"100%"}},{default:w(()=>e[14]||(e[14]=[D("应用设置",-1)])),_:1,__:[14]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])):z("",!0),P("div",I,[u.value?(y(),V("div",R,[P("canvas",{ref_key:"canvasRef",ref:W,class:"pdf-canvas"},null,512),P("div",A,[x(a,{onClick:ll,disabled:d.value<=1},{default:w(()=>e[15]||(e[15]=[D("上一页",-1)])),_:1,__:[15]},8,["disabled"]),P("span",null,"第 "+j(d.value)+" 页，共 "+j(p.value)+" 页",1),x(a,{onClick:el,disabled:d.value>=p.value},{default:w(()=>e[16]||(e[16]=[D("下一页",-1)])),_:1,__:[16]},8,["disabled"])])])):(y(),V("div",M,[x(X,{description:"请上传PDF文件开始编辑"})]))])])]),x(r,{title:"工具说明"},{default:w(()=>[P("div",B,[x(Y,null,{default:w(()=>e[17]||(e[17]=[P("strong",null,"功能介绍：",-1),D("在线PDF页眉页脚编辑工具，支持为PDF文档添加自定义页眉和页脚，可设置文本内容、字体样式、字号大小和对齐方式。 ",-1)])),_:1,__:[17]}),x(n),x(Y,null,{default:w(()=>e[18]||(e[18]=[P("strong",null,"主要特性：",-1),P("ul",{class:"list-disc list-inside mt-2 ml-4"},[P("li",null,"支持自定义页眉和页脚文本内容"),P("li",null,"使用 {page} 占位符自动显示当前页码"),P("li",null,"提供无衬线、衬线、等宽三种字体选择"),P("li",null,"支持 8-32px 字号范围调整"),P("li",null,"支持左对齐、居中、右对齐三种对齐方式"),P("li",null,"可选择应用到当前页或所有页面"),P("li",null,"实时预览编辑效果"),P("li",null,"导出包含页眉页脚的完整PDF文档")],-1)])),_:1,__:[18]}),x(n),x(Y,null,{default:w(()=>e[19]||(e[19]=[P("strong",null,"使用说明：",-1),P("ol",{class:"list-decimal list-inside mt-2 ml-4"},[P("li",null,'点击"上传PDF"按钮选择需要编辑的PDF文件'),P("li",null,'打开"编辑模式"开关，显示编辑面板'),P("li",null,"在页眉设置区域输入文本，选择字体、字号和对齐方式"),P("li",null,"在页脚设置区域输入文本，选择字体、字号和对齐方式"),P("li",null,"在文本中输入 {page} 可自动显示当前页码"),P("li",null,'选择应用范围（当前页/所有页），点击"应用设置"'),P("li",null,"使用上一页/下一页按钮查看各页效果"),P("li",null,'确认无误后点击"导出PDF"下载编辑后的文档')],-1)])),_:1,__:[19]}),x(n),x(Y,null,{default:w(()=>e[20]||(e[20]=[P("strong",null,"使用技巧：",-1),P("ul",{class:"list-disc list-inside mt-2 ml-4"},[P("li",null,'在页脚输入"第 {page} 页"可显示为"第 1 页"、"第 2 页"等'),P("li",null,"在页眉输入公司名称或文档标题，统一文档风格"),P("li",null,"使用缩放按钮调整预览大小，方便查看细节"),P("li",null,'选择"所有页"可一次性为整个文档添加页眉页脚')],-1)])),_:1,__:[20]}),x(n),x(Y,null,{default:w(()=>e[21]||(e[21]=[P("strong",null,"注意事项：",-1),P("ul",{class:"list-disc list-inside mt-2 ml-4"},[P("li",null,"支持的PDF文件大小建议不超过50MB"),P("li",null,"页眉页脚会覆盖在PDF原有内容之上"),P("li",null,"导出的PDF文件为图片格式，文件大小可能增加"),P("li",null,"建议在应用前先预览效果，确保位置和样式符合需求")],-1)])),_:1,__:[21]})])]),_:1})])}}}),[["__scopeId","data-v-30aed286"]]);export{T as default};
