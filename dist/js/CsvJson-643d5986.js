import{_ as e}from"./chunk-daa3b765.js";import{_ as l}from"./chunk-9c6aa90d.js";import{c as a}from"../assets/index-ff751073.js";import{E as t}from"./chunk-0a8d181f.js";import{d as s,q as n,r as o,b as u,al as r,o as c,c as i,R as d,a as m,J as p,O as v,I as y,M as f,D as h}from"./chunk-bb5ca2a1.js";import"./chunk-96adf8d3.js";import"./chunk-b045bb46.js";const g={class:"flex flex-col mt-3 flex-1"},V={class:"p-4 rounded-2xl bg-white"},_={class:"flex flex-wrap items-center gap-3"},x={class:"flex items-center gap-2"},S={class:"mt-3 text-sm text-gray-500"},b={class:"mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4"},j={key:0,class:"lg:col-span-1"},k={key:1,class:"lg:col-span-1"},A=s({__name:"CsvJson",setup(s){const A=n({title:"CSV/TSV ↔ JSON 互转"}),C=o("csv2json"),O=o(""),J=o(""),N=o(""),w=n({delimKey:"comma",customDelim:"",hasHeader:!0,includeHeader:!0}),H=u(()=>{switch(w.delimKey){case"comma":return",";case"tab":return"\t";case"semicolon":return";";case"pipe":return"|";case"custom":return w.customDelim||","}});function U(){"csv2json"===C.value?function(){try{const e=function(e,l){const a=[];let t="",s=[],n=!1;const o=e.replace(/\r\n/g,"\n"),u=o.length;for(let r=0;r<u;r++){const e=o[r];'"'===e?n&&'"'===o[r+1]?(t+='"',r++):n=!n:e!==l||n?"\n"!==e||n?t+=e:(s.push(t),a.push(s),s=[],t=""):(s.push(t),t="")}for(s.push(t),a.push(s);a.length&&1===a[a.length-1].length&&""===a[a.length-1][0];)a.pop();return a}(O.value||"",H.value);if(!e.length)return void(N.value="[]");let l=[],a=[];if(w.hasHeader)l=e[0].map((e,l)=>(null!=e?e:"").toString().trim()||`col_${l+1}`),a=e.slice(1);else{const t=Math.max(...e.map(e=>e.length));l=Array.from({length:t},(e,l)=>`col_${l+1}`),a=e}const s=a.map(e=>{const a={};return l.forEach((l,t)=>{var s;a[l]=null!=(s=e[t])?s:""}),a});N.value=JSON.stringify(s,null,2),t.success("转换成功")}catch(e){t.error((null==e?void 0:e.message)||"转换失败")}}():function(){try{const e=JSON.parse(J.value||"[]"),l=Array.isArray(e)?e:[e];if(!l.length)return void(N.value="");let a=[];if(w.includeHeader)if("object"!=typeof l[0]||Array.isArray(l[0])){if(Array.isArray(l[0])){const e=Math.max(...l.map(e=>Array.isArray(e)?e.length:0));a=Array.from({length:e},(e,l)=>`col_${l+1}`)}}else{const e=new Set;for(const a of l)a&&"object"==typeof a&&!Array.isArray(a)&&Object.keys(a).forEach(l=>e.add(l));a=Array.from(e)}const s=e=>{const l=null==e?"":String(e),a=H.value,t=l.includes('"')||l.includes("\n")||l.includes("\r")||l.includes(a),s=l.replace(/"/g,'""');return t?`"${s}"`:s},n=[];w.includeHeader&&a.length&&n.push(a.map(s).join(H.value));for(const t of l)if(Array.isArray(t))n.push(t.map(s).join(H.value));else if(t&&"object"==typeof t){const e=(a.length?a:Object.keys(t)).map(e=>s(t[e]));n.push(e.join(H.value))}else n.push(s(t));N.value=n.join("\r\n"),t.success("转换成功")}catch(e){t.error((null==e?void 0:e.message)||"转换失败，请检查 JSON 是否有效")}}()}function T(){O.value="",J.value="",N.value=""}function B(){a(N.value)}function K(){O.value="name,age,city\nAlice,30,Beijing\nBob,25,Shanghai"}function D(){w.delimKey="tab",O.value="name\tage\tcity\nAlice\t30\tBeijing\nBob\t25\tShanghai"}function $(){J.value=JSON.stringify([{name:"Alice",age:30,city:"Beijing"},{name:"Bob",age:25,city:"Shanghai"}],null,2)}return(a,t)=>{const s=r("el-radio-button"),n=r("el-radio-group"),o=r("el-option"),u=r("el-select"),H=r("el-input"),E=r("el-switch"),M=r("el-button"),q=r("el-link"),I=r("el-text");return c(),i("div",g,[d(e,{title:A.title},null,8,["title"]),m("div",V,[m("div",_,[d(n,{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=e=>C.value=e)},{default:p(()=>[d(s,{label:"csv2json"},{default:p(()=>t[8]||(t[8]=[v("CSV/TSV → JSON",-1)])),_:1,__:[8]}),d(s,{label:"json2csv"},{default:p(()=>t[9]||(t[9]=[v("JSON → CSV/TSV",-1)])),_:1,__:[9]})]),_:1},8,["modelValue"]),m("div",x,[t[10]||(t[10]=m("span",{class:"text-sm text-gray-600"},"分隔符：",-1)),d(u,{modelValue:w.delimKey,"onUpdate:modelValue":t[1]||(t[1]=e=>w.delimKey=e),style:{width:"160px"}},{default:p(()=>[d(o,{label:"逗号 (,)",value:"comma"}),d(o,{label:"制表符 (Tab)",value:"tab"}),d(o,{label:"分号 (;)",value:"semicolon"}),d(o,{label:"竖线 (|)",value:"pipe"}),d(o,{label:"自定义",value:"custom"})]),_:1},8,["modelValue"]),"custom"===w.delimKey?(c(),y(H,{key:0,modelValue:w.customDelim,"onUpdate:modelValue":t[2]||(t[2]=e=>w.customDelim=e),placeholder:"自定义分隔符",style:{width:"140px"},maxlength:"3"},null,8,["modelValue"])):f("",!0)]),"csv2json"===C.value?(c(),y(E,{key:0,modelValue:w.hasHeader,"onUpdate:modelValue":t[3]||(t[3]=e=>w.hasHeader=e),"active-text":"首行是列头","inactive-text":"自动生成列头"},null,8,["modelValue"])):(c(),y(E,{key:1,modelValue:w.includeHeader,"onUpdate:modelValue":t[4]||(t[4]=e=>w.includeHeader=e),"active-text":"输出包含列头","inactive-text":"不包含列头"},null,8,["modelValue"])),d(M,{type:"primary",onClick:U},{default:p(()=>t[11]||(t[11]=[v("转换",-1)])),_:1,__:[11]}),d(M,{onClick:B},{default:p(()=>t[12]||(t[12]=[v("复制结果",-1)])),_:1,__:[12]}),d(M,{type:"danger",onClick:T},{default:p(()=>t[13]||(t[13]=[v("清空",-1)])),_:1,__:[13]})]),m("div",S,[t[17]||(t[17]=v(" 示例： ",-1)),d(q,{type:"primary",onClick:K},{default:p(()=>t[14]||(t[14]=[v("CSV",-1)])),_:1,__:[14]}),t[18]||(t[18]=m("span",{class:"mx-1"},"/",-1)),d(q,{type:"primary",onClick:D},{default:p(()=>t[15]||(t[15]=[v("TSV",-1)])),_:1,__:[15]}),t[19]||(t[19]=m("span",{class:"mx-1"},"/",-1)),d(q,{type:"primary",onClick:$},{default:p(()=>t[16]||(t[16]=[v("JSON",-1)])),_:1,__:[16]})]),m("div",b,["csv2json"===C.value?(c(),i("div",j,[t[20]||(t[20]=m("div",{class:"mb-2 text-sm text-gray-600"},"CSV/TSV 输入",-1)),d(H,{type:"textarea",rows:16,modelValue:O.value,"onUpdate:modelValue":t[5]||(t[5]=e=>O.value=e),placeholder:"粘贴 CSV/TSV 内容"},null,8,["modelValue"])])):f("",!0),"json2csv"===C.value?(c(),i("div",k,[t[21]||(t[21]=m("div",{class:"mb-2 text-sm text-gray-600"},"JSON 输入（数组）",-1)),d(H,{type:"textarea",rows:16,modelValue:J.value,"onUpdate:modelValue":t[6]||(t[6]=e=>J.value=e),placeholder:'如：[{"a":1},{"a":2}]'},null,8,["modelValue"])])):f("",!0),m("div",{class:h((C.value,"lg:col-span-2"))},[t[22]||(t[22]=m("div",{class:"mb-2 text-sm text-gray-600"},"结果",-1)),d(H,{type:"textarea",rows:16,modelValue:N.value,"onUpdate:modelValue":t[7]||(t[7]=e=>N.value=e),placeholder:"转换结果"},null,8,["modelValue"])],2)])]),d(l,{title:"描述"},{default:p(()=>[d(I,null,{default:p(()=>t[23]||(t[23]=[v(" - 支持分隔符选择（逗号/制表符/分号/竖线/自定义）与列头推断。",-1),m("br",null,null,-1),v(" - CSV→JSON：可指定首行是否列头；若否，将自动生成 col_1...。",-1),m("br",null,null,-1),v(" - JSON→CSV：自动合并对象键为列头；支持选择是否输出列头。",-1),m("br",null,null,-1),v(" - 支持复制、清空与示例填充。 ",-1)])),_:1,__:[23]})]),_:1})])}}});export{A as default};
