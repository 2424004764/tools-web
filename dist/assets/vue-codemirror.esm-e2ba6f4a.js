import{S as Gg,d as Vg,Q as El,T as qg,H as Yg,o as Xg,P as Oi,I as _g,K as jg,U as Jg}from"./index-b28f8b3c.js";var sc={exports:{}};(function(f,t){(function(i,r){f.exports=r()})(Gg,function(){var i=navigator.userAgent,r=navigator.platform,s=/gecko\/\d/i.test(i),h=/MSIE \d/.test(i),u=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(i),d=/Edge\/(\d+)/.exec(i),p=h||u||d,v=p&&(h?document.documentMode||6:+(d||u)[1]),y=!d&&/WebKit\//.test(i),x=y&&/Qt\/\d+\.\d+/.test(i),S=!d&&/Chrome\/(\d+)/.exec(i),A=S&&+S[1],M=/Opera\//.test(i),D=/Apple Computer/.test(navigator.vendor),N=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(i),P=/PhantomJS/.test(i),H=D&&(/Mobile\/\w+/.test(i)||navigator.maxTouchPoints>2),Y=/Android/.test(i),J=H||Y||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(i),q=H||/Mac/.test(r),et=/\bCrOS\b/.test(i),Q=/win/i.test(r),pt=M&&i.match(/Version\/(\d*\.\d*)/);pt&&(pt=Number(pt[1])),pt&&pt>=15&&(M=!1,y=!0);var vt=q&&(x||M&&(pt==null||pt<12.11)),St=s||p&&v>=9;function ot(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var tt=function(e,n){var l=e.className,o=ot(n).exec(l);if(o){var a=l.slice(o.index+o[0].length);e.className=l.slice(0,o.index)+(a?o[1]+a:"")}};function ht(e){for(var n=e.childNodes.length;n>0;--n)e.removeChild(e.firstChild);return e}function lt(e,n){return ht(e).appendChild(n)}function G(e,n,l,o){var a=document.createElement(e);if(l&&(a.className=l),o&&(a.style.cssText=o),typeof n=="string")a.appendChild(document.createTextNode(n));else if(n)for(var c=0;c<n.length;++c)a.appendChild(n[c]);return a}function ae(e,n,l,o){var a=G(e,n,l,o);return a.setAttribute("role","presentation"),a}var Se;document.createRange?Se=function(e,n,l,o){var a=document.createRange();return a.setEnd(o||e,l),a.setStart(e,n),a}:Se=function(e,n,l){var o=document.body.createTextRange();try{o.moveToElementText(e.parentNode)}catch{return o}return o.collapse(!0),o.moveEnd("character",l),o.moveStart("character",n),o};function Ce(e,n){if(n.nodeType==3&&(n=n.parentNode),e.contains)return e.contains(n);do if(n.nodeType==11&&(n=n.host),n==e)return!0;while(n=n.parentNode)}function Bt(e){var n=e.ownerDocument||e,l;try{l=e.activeElement}catch{l=n.body||null}for(;l&&l.shadowRoot&&l.shadowRoot.activeElement;)l=l.shadowRoot.activeElement;return l}function Ge(e,n){var l=e.className;ot(n).test(l)||(e.className+=(l?" ":"")+n)}function ke(e,n){for(var l=e.split(" "),o=0;o<l.length;o++)l[o]&&!ot(l[o]).test(n)&&(n+=" "+l[o]);return n}var qt=function(e){e.select()};H?qt=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:p&&(qt=function(e){try{e.select()}catch{}});function ee(e){return e.display.wrapper.ownerDocument}function ve(e){return ye(e.display.wrapper)}function ye(e){return e.getRootNode?e.getRootNode():e.ownerDocument}function oi(e){return ee(e).defaultView}function cn(e){var n=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,n)}}function zi(e,n,l){n||(n={});for(var o in e)e.hasOwnProperty(o)&&(l!==!1||!n.hasOwnProperty(o))&&(n[o]=e[o]);return n}function De(e,n,l,o,a){n==null&&(n=e.search(/[^\s\u00a0]/),n==-1&&(n=e.length));for(var c=o||0,g=a||0;;){var m=e.indexOf("	",c);if(m<0||m>=n)return g+(n-c);g+=m-c,g+=l-g%l,c=m+1}}var bi=function(){this.id=null,this.f=null,this.time=0,this.handler=cn(this.onTimeout,this)};bi.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},bi.prototype.set=function(e,n){this.f=n;var l=+new Date+e;(!this.id||l<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=l)};function _t(e,n){for(var l=0;l<e.length;++l)if(e[l]==n)return l;return-1}var Xa=50,Qr={toString:function(){return"CodeMirror.Pass"}},Ve={scroll:!1},xo={origin:"*mouse"},Qn={origin:"+move"};function So(e,n,l){for(var o=0,a=0;;){var c=e.indexOf("	",o);c==-1&&(c=e.length);var g=c-o;if(c==e.length||a+g>=n)return o+Math.min(g,n-a);if(a+=c-o,a+=l-a%l,o=c+1,a>=n)return o}}var $r=[""];function Co(e){for(;$r.length<=e;)$r.push(ct($r)+" ");return $r[e]}function ct(e){return e[e.length-1]}function ts(e,n){for(var l=[],o=0;o<e.length;o++)l[o]=n(e[o],o);return l}function Dd(e,n,l){for(var o=0,a=l(n);o<e.length&&l(e[o])<=a;)o++;e.splice(o,0,n)}function _a(){}function ja(e,n){var l;return Object.create?l=Object.create(e):(_a.prototype=e,l=new _a),n&&zi(n,l),l}var Nd=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function ko(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Nd.test(e))}function es(e,n){return n?n.source.indexOf("\\w")>-1&&ko(e)?!0:n.test(e):ko(e)}function Ja(e){for(var n in e)if(e.hasOwnProperty(n)&&e[n])return!1;return!0}var Pd=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Ao(e){return e.charCodeAt(0)>=768&&Pd.test(e)}function Za(e,n,l){for(;(l<0?n>0:n<e.length)&&Ao(e.charAt(n));)n+=l;return n}function $n(e,n,l){for(var o=n>l?-1:1;;){if(n==l)return n;var a=(n+l)/2,c=o<0?Math.ceil(a):Math.floor(a);if(c==n)return e(c)?n:l;e(c)?l=c:n=c+o}}function Ed(e,n,l,o){if(!e)return o(n,l,"ltr",0);for(var a=!1,c=0;c<e.length;++c){var g=e[c];(g.from<l&&g.to>n||n==l&&g.to==n)&&(o(Math.max(g.from,n),Math.min(g.to,l),g.level==1?"rtl":"ltr",c),a=!0)}a||o(n,l,"ltr")}var tr=null;function er(e,n,l){var o;tr=null;for(var a=0;a<e.length;++a){var c=e[a];if(c.from<n&&c.to>n)return a;c.to==n&&(c.from!=c.to&&l=="before"?o=a:tr=a),c.from==n&&(c.from!=c.to&&l!="before"?o=a:tr=a)}return o??tr}var Bd=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function l(w){return w<=247?e.charAt(w):1424<=w&&w<=1524?"R":1536<=w&&w<=1785?n.charAt(w-1536):1774<=w&&w<=2220?"r":8192<=w&&w<=8203?"w":w==8204?"b":"L"}var o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,a=/[stwN]/,c=/[LRr]/,g=/[Lb1n]/,m=/[1n]/;function b(w,C,k){this.level=w,this.from=C,this.to=k}return function(w,C){var k=C=="ltr"?"L":"R";if(w.length==0||C=="ltr"&&!o.test(w))return!1;for(var L=w.length,T=[],O=0;O<L;++O)T.push(l(w.charCodeAt(O)));for(var E=0,R=k;E<L;++E){var I=T[E];I=="m"?T[E]=R:R=I}for(var F=0,W=k;F<L;++F){var U=T[F];U=="1"&&W=="r"?T[F]="n":c.test(U)&&(W=U,U=="r"&&(T[F]="R"))}for(var Z=1,_=T[0];Z<L-1;++Z){var rt=T[Z];rt=="+"&&_=="1"&&T[Z+1]=="1"?T[Z]="1":rt==","&&_==T[Z+1]&&(_=="1"||_=="n")&&(T[Z]=_),_=rt}for(var yt=0;yt<L;++yt){var Gt=T[yt];if(Gt==",")T[yt]="N";else if(Gt=="%"){var Mt=void 0;for(Mt=yt+1;Mt<L&&T[Mt]=="%";++Mt);for(var we=yt&&T[yt-1]=="!"||Mt<L&&T[Mt]=="1"?"1":"N",ce=yt;ce<Mt;++ce)T[ce]=we;yt=Mt-1}}for(var Nt=0,de=k;Nt<L;++Nt){var Yt=T[Nt];de=="L"&&Yt=="1"?T[Nt]="L":c.test(Yt)&&(de=Yt)}for(var Rt=0;Rt<L;++Rt)if(a.test(T[Rt])){var Pt=void 0;for(Pt=Rt+1;Pt<L&&a.test(T[Pt]);++Pt);for(var Tt=(Rt?T[Rt-1]:k)=="L",pe=(Pt<L?T[Pt]:k)=="L",En=Tt==pe?Tt?"L":"R":k,Li=Rt;Li<Pt;++Li)T[Li]=En;Rt=Pt-1}for(var Jt=[],je,Vt=0;Vt<L;)if(g.test(T[Vt])){var Nl=Vt;for(++Vt;Vt<L&&g.test(T[Vt]);++Vt);Jt.push(new b(0,Nl,Vt))}else{var di=Vt,Qi=Jt.length,$i=C=="rtl"?1:0;for(++Vt;Vt<L&&T[Vt]!="L";++Vt);for(var ne=di;ne<Vt;)if(m.test(T[ne])){di<ne&&(Jt.splice(Qi,0,new b(1,di,ne)),Qi+=$i);var Bn=ne;for(++ne;ne<Vt&&m.test(T[ne]);++ne);Jt.splice(Qi,0,new b(2,Bn,ne)),Qi+=$i,di=ne}else++ne;di<Vt&&Jt.splice(Qi,0,new b(1,di,Vt))}return C=="ltr"&&(Jt[0].level==1&&(je=w.match(/^\s+/))&&(Jt[0].from=je[0].length,Jt.unshift(new b(0,0,je[0].length))),ct(Jt).level==1&&(je=w.match(/\s+$/))&&(ct(Jt).to-=je[0].length,Jt.push(new b(0,L-je[0].length,L)))),C=="rtl"?Jt.reverse():Jt}}();function li(e,n){var l=e.order;return l==null&&(l=e.order=Bd(e.text,n)),l}var Qa=[],$=function(e,n,l){if(e.addEventListener)e.addEventListener(n,l,!1);else if(e.attachEvent)e.attachEvent("on"+n,l);else{var o=e._handlers||(e._handlers={});o[n]=(o[n]||Qa).concat(l)}};function Mo(e,n){return e._handlers&&e._handlers[n]||Qa}function Ae(e,n,l){if(e.removeEventListener)e.removeEventListener(n,l,!1);else if(e.detachEvent)e.detachEvent("on"+n,l);else{var o=e._handlers,a=o&&o[n];if(a){var c=_t(a,l);c>-1&&(o[n]=a.slice(0,c).concat(a.slice(c+1)))}}}function Ot(e,n){var l=Mo(e,n);if(l.length)for(var o=Array.prototype.slice.call(arguments,2),a=0;a<l.length;++a)l[a].apply(null,o)}function Ft(e,n,l){return typeof n=="string"&&(n={type:n,preventDefault:function(){this.defaultPrevented=!0}}),Ot(e,l||n.type,e,n),To(n)||n.codemirrorIgnore}function $a(e){var n=e._handlers&&e._handlers.cursorActivity;if(n)for(var l=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),o=0;o<n.length;++o)_t(l,n[o])==-1&&l.push(n[o])}function Ne(e,n){return Mo(e,n).length>0}function dn(e){e.prototype.on=function(n,l){$(this,n,l)},e.prototype.off=function(n,l){Ae(this,n,l)}}function he(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function th(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function To(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==!1}function ir(e){he(e),th(e)}function Lo(e){return e.target||e.srcElement}function eh(e){var n=e.which;return n==null&&(e.button&1?n=1:e.button&2?n=3:e.button&4&&(n=2)),q&&e.ctrlKey&&n==1&&(n=3),n}var Rd=function(){if(p&&v<9)return!1;var e=G("div");return"draggable"in e||"dragDrop"in e}(),Oo;function Id(e){if(Oo==null){var n=G("span","​");lt(e,G("span",[n,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(Oo=n.offsetWidth<=1&&n.offsetHeight>2&&!(p&&v<8))}var l=Oo?G("span","​"):G("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return l.setAttribute("cm-text",""),l}var Do;function Wd(e){if(Do!=null)return Do;var n=lt(e,document.createTextNode("AخA")),l=Se(n,0,1).getBoundingClientRect(),o=Se(n,1,2).getBoundingClientRect();return ht(e),!l||l.left==l.right?!1:Do=o.right-l.right<3}var No=`

b`.split(/\n/).length!=3?function(e){for(var n=0,l=[],o=e.length;n<=o;){var a=e.indexOf(`
`,n);a==-1&&(a=e.length);var c=e.slice(n,e.charAt(a-1)=="\r"?a-1:a),g=c.indexOf("\r");g!=-1?(l.push(c.slice(0,g)),n+=g+1):(l.push(c),n=a+1)}return l}:function(e){return e.split(/\r\n?|\n/)},Hd=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch{return!1}}:function(e){var n;try{n=e.ownerDocument.selection.createRange()}catch{}return!n||n.parentElement()!=e?!1:n.compareEndPoints("StartToEnd",n)!=0},Fd=function(){var e=G("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),Po=null;function zd(e){if(Po!=null)return Po;var n=lt(e,G("span","x")),l=n.getBoundingClientRect(),o=Se(n,0,1).getBoundingClientRect();return Po=Math.abs(l.left-o.left)>1}var Eo={},pn={};function Kd(e,n){arguments.length>2&&(n.dependencies=Array.prototype.slice.call(arguments,2)),Eo[e]=n}function Ud(e,n){pn[e]=n}function is(e){if(typeof e=="string"&&pn.hasOwnProperty(e))e=pn[e];else if(e&&typeof e.name=="string"&&pn.hasOwnProperty(e.name)){var n=pn[e.name];typeof n=="string"&&(n={name:n}),e=ja(n,e),e.name=n.name}else{if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return is("application/xml");if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return is("application/json")}return typeof e=="string"?{name:e}:e||{name:"null"}}function Bo(e,n){n=is(n);var l=Eo[n.name];if(!l)return Bo(e,"text/plain");var o=l(e,n);if(gn.hasOwnProperty(n.name)){var a=gn[n.name];for(var c in a)a.hasOwnProperty(c)&&(o.hasOwnProperty(c)&&(o["_"+c]=o[c]),o[c]=a[c])}if(o.name=n.name,n.helperType&&(o.helperType=n.helperType),n.modeProps)for(var g in n.modeProps)o[g]=n.modeProps[g];return o}var gn={};function Gd(e,n){var l=gn.hasOwnProperty(e)?gn[e]:gn[e]={};zi(n,l)}function Ki(e,n){if(n===!0)return n;if(e.copyState)return e.copyState(n);var l={};for(var o in n){var a=n[o];a instanceof Array&&(a=a.concat([])),l[o]=a}return l}function Ro(e,n){for(var l;e.innerMode&&(l=e.innerMode(n),!(!l||l.mode==e));)n=l.state,e=l.mode;return l||{mode:e,state:n}}function ih(e,n,l){return e.startState?e.startState(n,l):!0}var Dt=function(e,n,l){this.pos=this.start=0,this.string=e,this.tabSize=n||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=l};Dt.prototype.eol=function(){return this.pos>=this.string.length},Dt.prototype.sol=function(){return this.pos==this.lineStart},Dt.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Dt.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Dt.prototype.eat=function(e){var n=this.string.charAt(this.pos),l;if(typeof e=="string"?l=n==e:l=n&&(e.test?e.test(n):e(n)),l)return++this.pos,n},Dt.prototype.eatWhile=function(e){for(var n=this.pos;this.eat(e););return this.pos>n},Dt.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},Dt.prototype.skipToEnd=function(){this.pos=this.string.length},Dt.prototype.skipTo=function(e){var n=this.string.indexOf(e,this.pos);if(n>-1)return this.pos=n,!0},Dt.prototype.backUp=function(e){this.pos-=e},Dt.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=De(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?De(this.string,this.lineStart,this.tabSize):0)},Dt.prototype.indentation=function(){return De(this.string,null,this.tabSize)-(this.lineStart?De(this.string,this.lineStart,this.tabSize):0)},Dt.prototype.match=function(e,n,l){if(typeof e=="string"){var o=function(g){return l?g.toLowerCase():g},a=this.string.substr(this.pos,e.length);if(o(a)==o(e))return n!==!1&&(this.pos+=e.length),!0}else{var c=this.string.slice(this.pos).match(e);return c&&c.index>0?null:(c&&n!==!1&&(this.pos+=c[0].length),c)}},Dt.prototype.current=function(){return this.string.slice(this.start,this.pos)},Dt.prototype.hideFirstChars=function(e,n){this.lineStart+=e;try{return n()}finally{this.lineStart-=e}},Dt.prototype.lookAhead=function(e){var n=this.lineOracle;return n&&n.lookAhead(e)},Dt.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function X(e,n){if(n-=e.first,n<0||n>=e.size)throw new Error("There is no line "+(n+e.first)+" in the document.");for(var l=e;!l.lines;)for(var o=0;;++o){var a=l.children[o],c=a.chunkSize();if(n<c){l=a;break}n-=c}return l.lines[n]}function Ui(e,n,l){var o=[],a=n.line;return e.iter(n.line,l.line+1,function(c){var g=c.text;a==l.line&&(g=g.slice(0,l.ch)),a==n.line&&(g=g.slice(n.ch)),o.push(g),++a}),o}function Io(e,n,l){var o=[];return e.iter(n,l,function(a){o.push(a.text)}),o}function qe(e,n){var l=n-e.height;if(l)for(var o=e;o;o=o.parent)o.height+=l}function gt(e){if(e.parent==null)return null;for(var n=e.parent,l=_t(n.lines,e),o=n.parent;o;n=o,o=o.parent)for(var a=0;o.children[a]!=n;++a)l+=o.children[a].chunkSize();return l+n.first}function Gi(e,n){var l=e.first;t:do{for(var o=0;o<e.children.length;++o){var a=e.children[o],c=a.height;if(n<c){e=a;continue t}n-=c,l+=a.chunkSize()}return l}while(!e.lines);for(var g=0;g<e.lines.length;++g){var m=e.lines[g],b=m.height;if(n<b)break;n-=b}return l+g}function nr(e,n){return n>=e.first&&n<e.first+e.size}function Wo(e,n){return String(e.lineNumberFormatter(n+e.firstLineNumber))}function B(e,n,l){if(l===void 0&&(l=null),!(this instanceof B))return new B(e,n,l);this.line=e,this.ch=n,this.sticky=l}function it(e,n){return e.line-n.line||e.ch-n.ch}function Ho(e,n){return e.sticky==n.sticky&&it(e,n)==0}function Fo(e){return B(e.line,e.ch)}function ns(e,n){return it(e,n)<0?n:e}function rs(e,n){return it(e,n)<0?e:n}function nh(e,n){return Math.max(e.first,Math.min(n,e.first+e.size-1))}function nt(e,n){if(n.line<e.first)return B(e.first,0);var l=e.first+e.size-1;return n.line>l?B(l,X(e,l).text.length):Vd(n,X(e,n.line).text.length)}function Vd(e,n){var l=e.ch;return l==null||l>n?B(e.line,n):l<0?B(e.line,0):e}function rh(e,n){for(var l=[],o=0;o<n.length;o++)l[o]=nt(e,n[o]);return l}var ss=function(e,n){this.state=e,this.lookAhead=n},Ye=function(e,n,l,o){this.state=n,this.doc=e,this.line=l,this.maxLookAhead=o||0,this.baseTokens=null,this.baseTokenPos=1};Ye.prototype.lookAhead=function(e){var n=this.doc.getLine(this.line+e);return n!=null&&e>this.maxLookAhead&&(this.maxLookAhead=e),n},Ye.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var n=this.baseTokens[this.baseTokenPos+1];return{type:n&&n.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},Ye.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},Ye.fromSaved=function(e,n,l){return n instanceof ss?new Ye(e,Ki(e.mode,n.state),l,n.lookAhead):new Ye(e,Ki(e.mode,n),l)},Ye.prototype.save=function(e){var n=e!==!1?Ki(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new ss(n,this.maxLookAhead):n};function sh(e,n,l,o){var a=[e.state.modeGen],c={};uh(e,n.text,e.doc.mode,l,function(w,C){return a.push(w,C)},c,o);for(var g=l.state,m=function(w){l.baseTokens=a;var C=e.state.overlays[w],k=1,L=0;l.state=!0,uh(e,n.text,C.mode,l,function(T,O){for(var E=k;L<T;){var R=a[k];R>T&&a.splice(k,1,T,a[k+1],R),k+=2,L=Math.min(T,R)}if(O)if(C.opaque)a.splice(E,k-E,T,"overlay "+O),k=E+2;else for(;E<k;E+=2){var I=a[E+1];a[E+1]=(I?I+" ":"")+"overlay "+O}},c),l.state=g,l.baseTokens=null,l.baseTokenPos=1},b=0;b<e.state.overlays.length;++b)m(b);return{styles:a,classes:c.bgClass||c.textClass?c:null}}function oh(e,n,l){if(!n.styles||n.styles[0]!=e.state.modeGen){var o=rr(e,gt(n)),a=n.text.length>e.options.maxHighlightLength&&Ki(e.doc.mode,o.state),c=sh(e,n,o);a&&(o.state=a),n.stateAfter=o.save(!a),n.styles=c.styles,c.classes?n.styleClasses=c.classes:n.styleClasses&&(n.styleClasses=null),l===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return n.styles}function rr(e,n,l){var o=e.doc,a=e.display;if(!o.mode.startState)return new Ye(o,!0,n);var c=qd(e,n,l),g=c>o.first&&X(o,c-1).stateAfter,m=g?Ye.fromSaved(o,g,c):new Ye(o,ih(o.mode),c);return o.iter(c,n,function(b){zo(e,b.text,m);var w=m.line;b.stateAfter=w==n-1||w%5==0||w>=a.viewFrom&&w<a.viewTo?m.save():null,m.nextLine()}),l&&(o.modeFrontier=m.line),m}function zo(e,n,l,o){var a=e.doc.mode,c=new Dt(n,e.options.tabSize,l);for(c.start=c.pos=o||0,n==""&&lh(a,l.state);!c.eol();)Ko(a,c,l.state),c.start=c.pos}function lh(e,n){if(e.blankLine)return e.blankLine(n);if(e.innerMode){var l=Ro(e,n);if(l.mode.blankLine)return l.mode.blankLine(l.state)}}function Ko(e,n,l,o){for(var a=0;a<10;a++){o&&(o[0]=Ro(e,l).mode);var c=e.token(n,l);if(n.pos>n.start)return c}throw new Error("Mode "+e.name+" failed to advance stream.")}var ah=function(e,n,l){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=n||null,this.state=l};function hh(e,n,l,o){var a=e.doc,c=a.mode,g;n=nt(a,n);var m=X(a,n.line),b=rr(e,n.line,l),w=new Dt(m.text,e.options.tabSize,b),C;for(o&&(C=[]);(o||w.pos<n.ch)&&!w.eol();)w.start=w.pos,g=Ko(c,w,b.state),o&&C.push(new ah(w,g,Ki(a.mode,b.state)));return o?C:new ah(w,g,b.state)}function fh(e,n){if(e)for(;;){var l=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!l)break;e=e.slice(0,l.index)+e.slice(l.index+l[0].length);var o=l[1]?"bgClass":"textClass";n[o]==null?n[o]=l[2]:new RegExp("(?:^|\\s)"+l[2]+"(?:$|\\s)").test(n[o])||(n[o]+=" "+l[2])}return e}function uh(e,n,l,o,a,c,g){var m=l.flattenSpans;m==null&&(m=e.options.flattenSpans);var b=0,w=null,C=new Dt(n,e.options.tabSize,o),k,L=e.options.addModeClass&&[null];for(n==""&&fh(lh(l,o.state),c);!C.eol();){if(C.pos>e.options.maxHighlightLength?(m=!1,g&&zo(e,n,o,C.pos),C.pos=n.length,k=null):k=fh(Ko(l,C,o.state,L),c),L){var T=L[0].name;T&&(k="m-"+(k?T+" "+k:T))}if(!m||w!=k){for(;b<C.start;)b=Math.min(C.start,b+5e3),a(b,w);w=k}C.start=C.pos}for(;b<C.pos;){var O=Math.min(C.pos,b+5e3);a(O,w),b=O}}function qd(e,n,l){for(var o,a,c=e.doc,g=l?-1:n-(e.doc.mode.innerMode?1e3:100),m=n;m>g;--m){if(m<=c.first)return c.first;var b=X(c,m-1),w=b.stateAfter;if(w&&(!l||m+(w instanceof ss?w.lookAhead:0)<=c.modeFrontier))return m;var C=De(b.text,null,e.options.tabSize);(a==null||o>C)&&(a=m-1,o=C)}return a}function Yd(e,n){if(e.modeFrontier=Math.min(e.modeFrontier,n),!(e.highlightFrontier<n-10)){for(var l=e.first,o=n-1;o>l;o--){var a=X(e,o).stateAfter;if(a&&(!(a instanceof ss)||o+a.lookAhead<n)){l=o+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,l)}}var ch=!1,ai=!1;function Xd(){ch=!0}function _d(){ai=!0}function os(e,n,l){this.marker=e,this.from=n,this.to=l}function sr(e,n){if(e)for(var l=0;l<e.length;++l){var o=e[l];if(o.marker==n)return o}}function jd(e,n){for(var l,o=0;o<e.length;++o)e[o]!=n&&(l||(l=[])).push(e[o]);return l}function Jd(e,n,l){var o=l&&window.WeakSet&&(l.markedSpans||(l.markedSpans=new WeakSet));o&&e.markedSpans&&o.has(e.markedSpans)?e.markedSpans.push(n):(e.markedSpans=e.markedSpans?e.markedSpans.concat([n]):[n],o&&o.add(e.markedSpans)),n.marker.attachLine(e)}function Zd(e,n,l){var o;if(e)for(var a=0;a<e.length;++a){var c=e[a],g=c.marker,m=c.from==null||(g.inclusiveLeft?c.from<=n:c.from<n);if(m||c.from==n&&g.type=="bookmark"&&(!l||!c.marker.insertLeft)){var b=c.to==null||(g.inclusiveRight?c.to>=n:c.to>n);(o||(o=[])).push(new os(g,c.from,b?null:c.to))}}return o}function Qd(e,n,l){var o;if(e)for(var a=0;a<e.length;++a){var c=e[a],g=c.marker,m=c.to==null||(g.inclusiveRight?c.to>=n:c.to>n);if(m||c.from==n&&g.type=="bookmark"&&(!l||c.marker.insertLeft)){var b=c.from==null||(g.inclusiveLeft?c.from<=n:c.from<n);(o||(o=[])).push(new os(g,b?null:c.from-n,c.to==null?null:c.to-n))}}return o}function Uo(e,n){if(n.full)return null;var l=nr(e,n.from.line)&&X(e,n.from.line).markedSpans,o=nr(e,n.to.line)&&X(e,n.to.line).markedSpans;if(!l&&!o)return null;var a=n.from.ch,c=n.to.ch,g=it(n.from,n.to)==0,m=Zd(l,a,g),b=Qd(o,c,g),w=n.text.length==1,C=ct(n.text).length+(w?a:0);if(m)for(var k=0;k<m.length;++k){var L=m[k];if(L.to==null){var T=sr(b,L.marker);T?w&&(L.to=T.to==null?null:T.to+C):L.to=a}}if(b)for(var O=0;O<b.length;++O){var E=b[O];if(E.to!=null&&(E.to+=C),E.from==null){var R=sr(m,E.marker);R||(E.from=C,w&&(m||(m=[])).push(E))}else E.from+=C,w&&(m||(m=[])).push(E)}m&&(m=dh(m)),b&&b!=m&&(b=dh(b));var I=[m];if(!w){var F=n.text.length-2,W;if(F>0&&m)for(var U=0;U<m.length;++U)m[U].to==null&&(W||(W=[])).push(new os(m[U].marker,null,null));for(var Z=0;Z<F;++Z)I.push(W);I.push(b)}return I}function dh(e){for(var n=0;n<e.length;++n){var l=e[n];l.from!=null&&l.from==l.to&&l.marker.clearWhenEmpty!==!1&&e.splice(n--,1)}return e.length?e:null}function $d(e,n,l){var o=null;if(e.iter(n.line,l.line+1,function(T){if(T.markedSpans)for(var O=0;O<T.markedSpans.length;++O){var E=T.markedSpans[O].marker;E.readOnly&&(!o||_t(o,E)==-1)&&(o||(o=[])).push(E)}}),!o)return null;for(var a=[{from:n,to:l}],c=0;c<o.length;++c)for(var g=o[c],m=g.find(0),b=0;b<a.length;++b){var w=a[b];if(!(it(w.to,m.from)<0||it(w.from,m.to)>0)){var C=[b,1],k=it(w.from,m.from),L=it(w.to,m.to);(k<0||!g.inclusiveLeft&&!k)&&C.push({from:w.from,to:m.from}),(L>0||!g.inclusiveRight&&!L)&&C.push({from:m.to,to:w.to}),a.splice.apply(a,C),b+=C.length-3}}return a}function ph(e){var n=e.markedSpans;if(n){for(var l=0;l<n.length;++l)n[l].marker.detachLine(e);e.markedSpans=null}}function gh(e,n){if(n){for(var l=0;l<n.length;++l)n[l].marker.attachLine(e);e.markedSpans=n}}function ls(e){return e.inclusiveLeft?-1:0}function as(e){return e.inclusiveRight?1:0}function Go(e,n){var l=e.lines.length-n.lines.length;if(l!=0)return l;var o=e.find(),a=n.find(),c=it(o.from,a.from)||ls(e)-ls(n);if(c)return-c;var g=it(o.to,a.to)||as(e)-as(n);return g||n.id-e.id}function mh(e,n){var l=ai&&e.markedSpans,o;if(l)for(var a=void 0,c=0;c<l.length;++c)a=l[c],a.marker.collapsed&&(n?a.from:a.to)==null&&(!o||Go(o,a.marker)<0)&&(o=a.marker);return o}function vh(e){return mh(e,!0)}function hs(e){return mh(e,!1)}function tp(e,n){var l=ai&&e.markedSpans,o;if(l)for(var a=0;a<l.length;++a){var c=l[a];c.marker.collapsed&&(c.from==null||c.from<n)&&(c.to==null||c.to>n)&&(!o||Go(o,c.marker)<0)&&(o=c.marker)}return o}function yh(e,n,l,o,a){var c=X(e,n),g=ai&&c.markedSpans;if(g)for(var m=0;m<g.length;++m){var b=g[m];if(b.marker.collapsed){var w=b.marker.find(0),C=it(w.from,l)||ls(b.marker)-ls(a),k=it(w.to,o)||as(b.marker)-as(a);if(!(C>=0&&k<=0||C<=0&&k>=0)&&(C<=0&&(b.marker.inclusiveRight&&a.inclusiveLeft?it(w.to,l)>=0:it(w.to,l)>0)||C>=0&&(b.marker.inclusiveRight&&a.inclusiveLeft?it(w.from,o)<=0:it(w.from,o)<0)))return!0}}}function Ie(e){for(var n;n=vh(e);)e=n.find(-1,!0).line;return e}function ep(e){for(var n;n=hs(e);)e=n.find(1,!0).line;return e}function ip(e){for(var n,l;n=hs(e);)e=n.find(1,!0).line,(l||(l=[])).push(e);return l}function Vo(e,n){var l=X(e,n),o=Ie(l);return l==o?n:gt(o)}function bh(e,n){if(n>e.lastLine())return n;var l=X(e,n),o;if(!wi(e,l))return n;for(;o=hs(l);)l=o.find(1,!0).line;return gt(l)+1}function wi(e,n){var l=ai&&n.markedSpans;if(l){for(var o=void 0,a=0;a<l.length;++a)if(o=l[a],!!o.marker.collapsed){if(o.from==null)return!0;if(!o.marker.widgetNode&&o.from==0&&o.marker.inclusiveLeft&&qo(e,n,o))return!0}}}function qo(e,n,l){if(l.to==null){var o=l.marker.find(1,!0);return qo(e,o.line,sr(o.line.markedSpans,l.marker))}if(l.marker.inclusiveRight&&l.to==n.text.length)return!0;for(var a=void 0,c=0;c<n.markedSpans.length;++c)if(a=n.markedSpans[c],a.marker.collapsed&&!a.marker.widgetNode&&a.from==l.to&&(a.to==null||a.to!=l.from)&&(a.marker.inclusiveLeft||l.marker.inclusiveRight)&&qo(e,n,a))return!0}function hi(e){e=Ie(e);for(var n=0,l=e.parent,o=0;o<l.lines.length;++o){var a=l.lines[o];if(a==e)break;n+=a.height}for(var c=l.parent;c;l=c,c=l.parent)for(var g=0;g<c.children.length;++g){var m=c.children[g];if(m==l)break;n+=m.height}return n}function fs(e){if(e.height==0)return 0;for(var n=e.text.length,l,o=e;l=vh(o);){var a=l.find(0,!0);o=a.from.line,n+=a.from.ch-a.to.ch}for(o=e;l=hs(o);){var c=l.find(0,!0);n-=o.text.length-c.from.ch,o=c.to.line,n+=o.text.length-c.to.ch}return n}function Yo(e){var n=e.display,l=e.doc;n.maxLine=X(l,l.first),n.maxLineLength=fs(n.maxLine),n.maxLineChanged=!0,l.iter(function(o){var a=fs(o);a>n.maxLineLength&&(n.maxLineLength=a,n.maxLine=o)})}var mn=function(e,n,l){this.text=e,gh(this,n),this.height=l?l(this):1};mn.prototype.lineNo=function(){return gt(this)},dn(mn);function np(e,n,l,o){e.text=n,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),ph(e),gh(e,l);var a=o?o(e):1;a!=e.height&&qe(e,a)}function rp(e){e.parent=null,ph(e)}var sp={},op={};function wh(e,n){if(!e||/^\s*$/.test(e))return null;var l=n.addModeClass?op:sp;return l[e]||(l[e]=e.replace(/\S+/g,"cm-$&"))}function xh(e,n){var l=ae("span",null,null,y?"padding-right: .1px":null),o={pre:ae("pre",[l],"CodeMirror-line"),content:l,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};n.measure={};for(var a=0;a<=(n.rest?n.rest.length:0);a++){var c=a?n.rest[a-1]:n.line,g=void 0;o.pos=0,o.addToken=ap,Wd(e.display.measure)&&(g=li(c,e.doc.direction))&&(o.addToken=fp(o.addToken,g)),o.map=[];var m=n!=e.display.externalMeasured&&gt(c);up(c,o,oh(e,c,m)),c.styleClasses&&(c.styleClasses.bgClass&&(o.bgClass=ke(c.styleClasses.bgClass,o.bgClass||"")),c.styleClasses.textClass&&(o.textClass=ke(c.styleClasses.textClass,o.textClass||""))),o.map.length==0&&o.map.push(0,0,o.content.appendChild(Id(e.display.measure))),a==0?(n.measure.map=o.map,n.measure.cache={}):((n.measure.maps||(n.measure.maps=[])).push(o.map),(n.measure.caches||(n.measure.caches=[])).push({}))}if(y){var b=o.content.lastChild;(/\bcm-tab\b/.test(b.className)||b.querySelector&&b.querySelector(".cm-tab"))&&(o.content.className="cm-tab-wrap-hack")}return Ot(e,"renderLine",e,n.line,o.pre),o.pre.className&&(o.textClass=ke(o.pre.className,o.textClass||"")),o}function lp(e){var n=G("span","•","cm-invalidchar");return n.title="\\u"+e.charCodeAt(0).toString(16),n.setAttribute("aria-label",n.title),n}function ap(e,n,l,o,a,c,g){if(n){var m=e.splitSpaces?hp(n,e.trailingSpace):n,b=e.cm.state.specialChars,w=!1,C;if(!b.test(n))e.col+=n.length,C=document.createTextNode(m),e.map.push(e.pos,e.pos+n.length,C),p&&v<9&&(w=!0),e.pos+=n.length;else{C=document.createDocumentFragment();for(var k=0;;){b.lastIndex=k;var L=b.exec(n),T=L?L.index-k:n.length-k;if(T){var O=document.createTextNode(m.slice(k,k+T));p&&v<9?C.appendChild(G("span",[O])):C.appendChild(O),e.map.push(e.pos,e.pos+T,O),e.col+=T,e.pos+=T}if(!L)break;k+=T+1;var E=void 0;if(L[0]=="	"){var R=e.cm.options.tabSize,I=R-e.col%R;E=C.appendChild(G("span",Co(I),"cm-tab")),E.setAttribute("role","presentation"),E.setAttribute("cm-text","	"),e.col+=I}else L[0]=="\r"||L[0]==`
`?(E=C.appendChild(G("span",L[0]=="\r"?"␍":"␤","cm-invalidchar")),E.setAttribute("cm-text",L[0]),e.col+=1):(E=e.cm.options.specialCharPlaceholder(L[0]),E.setAttribute("cm-text",L[0]),p&&v<9?C.appendChild(G("span",[E])):C.appendChild(E),e.col+=1);e.map.push(e.pos,e.pos+1,E),e.pos++}}if(e.trailingSpace=m.charCodeAt(n.length-1)==32,l||o||a||w||c||g){var F=l||"";o&&(F+=o),a&&(F+=a);var W=G("span",[C],F,c);if(g)for(var U in g)g.hasOwnProperty(U)&&U!="style"&&U!="class"&&W.setAttribute(U,g[U]);return e.content.appendChild(W)}e.content.appendChild(C)}}function hp(e,n){if(e.length>1&&!/  /.test(e))return e;for(var l=n,o="",a=0;a<e.length;a++){var c=e.charAt(a);c==" "&&l&&(a==e.length-1||e.charCodeAt(a+1)==32)&&(c=" "),o+=c,l=c==" "}return o}function fp(e,n){return function(l,o,a,c,g,m,b){a=a?a+" cm-force-border":"cm-force-border";for(var w=l.pos,C=w+o.length;;){for(var k=void 0,L=0;L<n.length&&(k=n[L],!(k.to>w&&k.from<=w));L++);if(k.to>=C)return e(l,o,a,c,g,m,b);e(l,o.slice(0,k.to-w),a,c,null,m,b),c=null,o=o.slice(k.to-w),w=k.to}}}function Sh(e,n,l,o){var a=!o&&l.widgetNode;a&&e.map.push(e.pos,e.pos+n,a),!o&&e.cm.display.input.needsContentAttribute&&(a||(a=e.content.appendChild(document.createElement("span"))),a.setAttribute("cm-marker",l.id)),a&&(e.cm.display.input.setUneditable(a),e.content.appendChild(a)),e.pos+=n,e.trailingSpace=!1}function up(e,n,l){var o=e.markedSpans,a=e.text,c=0;if(!o){for(var g=1;g<l.length;g+=2)n.addToken(n,a.slice(c,c=l[g]),wh(l[g+1],n.cm.options));return}for(var m=a.length,b=0,w=1,C="",k,L,T=0,O,E,R,I,F;;){if(T==b){O=E=R=L="",F=null,I=null,T=1/0;for(var W=[],U=void 0,Z=0;Z<o.length;++Z){var _=o[Z],rt=_.marker;if(rt.type=="bookmark"&&_.from==b&&rt.widgetNode)W.push(rt);else if(_.from<=b&&(_.to==null||_.to>b||rt.collapsed&&_.to==b&&_.from==b)){if(_.to!=null&&_.to!=b&&T>_.to&&(T=_.to,E=""),rt.className&&(O+=" "+rt.className),rt.css&&(L=(L?L+";":"")+rt.css),rt.startStyle&&_.from==b&&(R+=" "+rt.startStyle),rt.endStyle&&_.to==T&&(U||(U=[])).push(rt.endStyle,_.to),rt.title&&((F||(F={})).title=rt.title),rt.attributes)for(var yt in rt.attributes)(F||(F={}))[yt]=rt.attributes[yt];rt.collapsed&&(!I||Go(I.marker,rt)<0)&&(I=_)}else _.from>b&&T>_.from&&(T=_.from)}if(U)for(var Gt=0;Gt<U.length;Gt+=2)U[Gt+1]==T&&(E+=" "+U[Gt]);if(!I||I.from==b)for(var Mt=0;Mt<W.length;++Mt)Sh(n,0,W[Mt]);if(I&&(I.from||0)==b){if(Sh(n,(I.to==null?m+1:I.to)-b,I.marker,I.from==null),I.to==null)return;I.to==b&&(I=!1)}}if(b>=m)break;for(var we=Math.min(m,T);;){if(C){var ce=b+C.length;if(!I){var Nt=ce>we?C.slice(0,we-b):C;n.addToken(n,Nt,k?k+O:O,R,b+Nt.length==T?E:"",L,F)}if(ce>=we){C=C.slice(we-b),b=we;break}b=ce,R=""}C=a.slice(c,c=l[w++]),k=wh(l[w++],n.cm.options)}}}function Ch(e,n,l){this.line=n,this.rest=ip(n),this.size=this.rest?gt(ct(this.rest))-l+1:1,this.node=this.text=null,this.hidden=wi(e,n)}function us(e,n,l){for(var o=[],a,c=n;c<l;c=a){var g=new Ch(e.doc,X(e.doc,c),c);a=c+g.size,o.push(g)}return o}var vn=null;function cp(e){vn?vn.ops.push(e):e.ownsGroup=vn={ops:[e],delayedCallbacks:[]}}function dp(e){var n=e.delayedCallbacks,l=0;do{for(;l<n.length;l++)n[l].call(null);for(var o=0;o<e.ops.length;o++){var a=e.ops[o];if(a.cursorActivityHandlers)for(;a.cursorActivityCalled<a.cursorActivityHandlers.length;)a.cursorActivityHandlers[a.cursorActivityCalled++].call(null,a.cm)}}while(l<n.length)}function pp(e,n){var l=e.ownsGroup;if(l)try{dp(l)}finally{vn=null,n(l)}}var or=null;function zt(e,n){var l=Mo(e,n);if(l.length){var o=Array.prototype.slice.call(arguments,2),a;vn?a=vn.delayedCallbacks:or?a=or:(a=or=[],setTimeout(gp,0));for(var c=function(m){a.push(function(){return l[m].apply(null,o)})},g=0;g<l.length;++g)c(g)}}function gp(){var e=or;or=null;for(var n=0;n<e.length;++n)e[n]()}function kh(e,n,l,o){for(var a=0;a<n.changes.length;a++){var c=n.changes[a];c=="text"?vp(e,n):c=="gutter"?Mh(e,n,l,o):c=="class"?Xo(e,n):c=="widget"&&yp(e,n,o)}n.changes=null}function lr(e){return e.node==e.text&&(e.node=G("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),p&&v<8&&(e.node.style.zIndex=2)),e.node}function mp(e,n){var l=n.bgClass?n.bgClass+" "+(n.line.bgClass||""):n.line.bgClass;if(l&&(l+=" CodeMirror-linebackground"),n.background)l?n.background.className=l:(n.background.parentNode.removeChild(n.background),n.background=null);else if(l){var o=lr(n);n.background=o.insertBefore(G("div",null,l),o.firstChild),e.display.input.setUneditable(n.background)}}function Ah(e,n){var l=e.display.externalMeasured;return l&&l.line==n.line?(e.display.externalMeasured=null,n.measure=l.measure,l.built):xh(e,n)}function vp(e,n){var l=n.text.className,o=Ah(e,n);n.text==n.node&&(n.node=o.pre),n.text.parentNode.replaceChild(o.pre,n.text),n.text=o.pre,o.bgClass!=n.bgClass||o.textClass!=n.textClass?(n.bgClass=o.bgClass,n.textClass=o.textClass,Xo(e,n)):l&&(n.text.className=l)}function Xo(e,n){mp(e,n),n.line.wrapClass?lr(n).className=n.line.wrapClass:n.node!=n.text&&(n.node.className="");var l=n.textClass?n.textClass+" "+(n.line.textClass||""):n.line.textClass;n.text.className=l||""}function Mh(e,n,l,o){if(n.gutter&&(n.node.removeChild(n.gutter),n.gutter=null),n.gutterBackground&&(n.node.removeChild(n.gutterBackground),n.gutterBackground=null),n.line.gutterClass){var a=lr(n);n.gutterBackground=G("div",null,"CodeMirror-gutter-background "+n.line.gutterClass,"left: "+(e.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px; width: "+o.gutterTotalWidth+"px"),e.display.input.setUneditable(n.gutterBackground),a.insertBefore(n.gutterBackground,n.text)}var c=n.line.gutterMarkers;if(e.options.lineNumbers||c){var g=lr(n),m=n.gutter=G("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px");if(m.setAttribute("aria-hidden","true"),e.display.input.setUneditable(m),g.insertBefore(m,n.text),n.line.gutterClass&&(m.className+=" "+n.line.gutterClass),e.options.lineNumbers&&(!c||!c["CodeMirror-linenumbers"])&&(n.lineNumber=m.appendChild(G("div",Wo(e.options,l),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+o.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),c)for(var b=0;b<e.display.gutterSpecs.length;++b){var w=e.display.gutterSpecs[b].className,C=c.hasOwnProperty(w)&&c[w];C&&m.appendChild(G("div",[C],"CodeMirror-gutter-elt","left: "+o.gutterLeft[w]+"px; width: "+o.gutterWidth[w]+"px"))}}}function yp(e,n,l){n.alignable&&(n.alignable=null);for(var o=ot("CodeMirror-linewidget"),a=n.node.firstChild,c=void 0;a;a=c)c=a.nextSibling,o.test(a.className)&&n.node.removeChild(a);Th(e,n,l)}function bp(e,n,l,o){var a=Ah(e,n);return n.text=n.node=a.pre,a.bgClass&&(n.bgClass=a.bgClass),a.textClass&&(n.textClass=a.textClass),Xo(e,n),Mh(e,n,l,o),Th(e,n,o),n.node}function Th(e,n,l){if(Lh(e,n.line,n,l,!0),n.rest)for(var o=0;o<n.rest.length;o++)Lh(e,n.rest[o],n,l,!1)}function Lh(e,n,l,o,a){if(n.widgets)for(var c=lr(l),g=0,m=n.widgets;g<m.length;++g){var b=m[g],w=G("div",[b.node],"CodeMirror-linewidget"+(b.className?" "+b.className:""));b.handleMouseEvents||w.setAttribute("cm-ignore-events","true"),wp(b,w,l,o),e.display.input.setUneditable(w),a&&b.above?c.insertBefore(w,l.gutter||l.text):c.appendChild(w),zt(b,"redraw")}}function wp(e,n,l,o){if(e.noHScroll){(l.alignable||(l.alignable=[])).push(n);var a=o.wrapperWidth;n.style.left=o.fixedPos+"px",e.coverGutter||(a-=o.gutterTotalWidth,n.style.paddingLeft=o.gutterTotalWidth+"px"),n.style.width=a+"px"}e.coverGutter&&(n.style.zIndex=5,n.style.position="relative",e.noHScroll||(n.style.marginLeft=-o.gutterTotalWidth+"px"))}function ar(e){if(e.height!=null)return e.height;var n=e.doc.cm;if(!n)return 0;if(!Ce(document.body,e.node)){var l="position: relative;";e.coverGutter&&(l+="margin-left: -"+n.display.gutters.offsetWidth+"px;"),e.noHScroll&&(l+="width: "+n.display.wrapper.clientWidth+"px;"),lt(n.display.measure,G("div",[e.node],null,l))}return e.height=e.node.parentNode.offsetHeight}function fi(e,n){for(var l=Lo(n);l!=e.wrapper;l=l.parentNode)if(!l||l.nodeType==1&&l.getAttribute("cm-ignore-events")=="true"||l.parentNode==e.sizer&&l!=e.mover)return!0}function cs(e){return e.lineSpace.offsetTop}function _o(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Oh(e){if(e.cachedPaddingH)return e.cachedPaddingH;var n=lt(e.measure,G("pre","x","CodeMirror-line-like")),l=window.getComputedStyle?window.getComputedStyle(n):n.currentStyle,o={left:parseInt(l.paddingLeft),right:parseInt(l.paddingRight)};return!isNaN(o.left)&&!isNaN(o.right)&&(e.cachedPaddingH=o),o}function Xe(e){return Xa-e.display.nativeBarWidth}function Vi(e){return e.display.scroller.clientWidth-Xe(e)-e.display.barWidth}function jo(e){return e.display.scroller.clientHeight-Xe(e)-e.display.barHeight}function xp(e,n,l){var o=e.options.lineWrapping,a=o&&Vi(e);if(!n.measure.heights||o&&n.measure.width!=a){var c=n.measure.heights=[];if(o){n.measure.width=a;for(var g=n.text.firstChild.getClientRects(),m=0;m<g.length-1;m++){var b=g[m],w=g[m+1];Math.abs(b.bottom-w.bottom)>2&&c.push((b.bottom+w.top)/2-l.top)}}c.push(l.bottom-l.top)}}function Dh(e,n,l){if(e.line==n)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var o=0;o<e.rest.length;o++)if(e.rest[o]==n)return{map:e.measure.maps[o],cache:e.measure.caches[o]};for(var a=0;a<e.rest.length;a++)if(gt(e.rest[a])>l)return{map:e.measure.maps[a],cache:e.measure.caches[a],before:!0}}}function Sp(e,n){n=Ie(n);var l=gt(n),o=e.display.externalMeasured=new Ch(e.doc,n,l);o.lineN=l;var a=o.built=xh(e,o);return o.text=a.pre,lt(e.display.lineMeasure,a.pre),o}function Nh(e,n,l,o){return _e(e,yn(e,n),l,o)}function Jo(e,n){if(n>=e.display.viewFrom&&n<e.display.viewTo)return e.display.view[Xi(e,n)];var l=e.display.externalMeasured;if(l&&n>=l.lineN&&n<l.lineN+l.size)return l}function yn(e,n){var l=gt(n),o=Jo(e,l);o&&!o.text?o=null:o&&o.changes&&(kh(e,o,l,el(e)),e.curOp.forceUpdate=!0),o||(o=Sp(e,n));var a=Dh(o,n,l);return{line:n,view:o,rect:null,map:a.map,cache:a.cache,before:a.before,hasHeights:!1}}function _e(e,n,l,o,a){n.before&&(l=-1);var c=l+(o||""),g;return n.cache.hasOwnProperty(c)?g=n.cache[c]:(n.rect||(n.rect=n.view.text.getBoundingClientRect()),n.hasHeights||(xp(e,n.view,n.rect),n.hasHeights=!0),g=kp(e,n,l,o),g.bogus||(n.cache[c]=g)),{left:g.left,right:g.right,top:a?g.rtop:g.top,bottom:a?g.rbottom:g.bottom}}var Ph={left:0,right:0,top:0,bottom:0};function Eh(e,n,l){for(var o,a,c,g,m,b,w=0;w<e.length;w+=3)if(m=e[w],b=e[w+1],n<m?(a=0,c=1,g="left"):n<b?(a=n-m,c=a+1):(w==e.length-3||n==b&&e[w+3]>n)&&(c=b-m,a=c-1,n>=b&&(g="right")),a!=null){if(o=e[w+2],m==b&&l==(o.insertLeft?"left":"right")&&(g=l),l=="left"&&a==0)for(;w&&e[w-2]==e[w-3]&&e[w-1].insertLeft;)o=e[(w-=3)+2],g="left";if(l=="right"&&a==b-m)for(;w<e.length-3&&e[w+3]==e[w+4]&&!e[w+5].insertLeft;)o=e[(w+=3)+2],g="right";break}return{node:o,start:a,end:c,collapse:g,coverStart:m,coverEnd:b}}function Cp(e,n){var l=Ph;if(n=="left")for(var o=0;o<e.length&&(l=e[o]).left==l.right;o++);else for(var a=e.length-1;a>=0&&(l=e[a]).left==l.right;a--);return l}function kp(e,n,l,o){var a=Eh(n.map,l,o),c=a.node,g=a.start,m=a.end,b=a.collapse,w;if(c.nodeType==3){for(var C=0;C<4;C++){for(;g&&Ao(n.line.text.charAt(a.coverStart+g));)--g;for(;a.coverStart+m<a.coverEnd&&Ao(n.line.text.charAt(a.coverStart+m));)++m;if(p&&v<9&&g==0&&m==a.coverEnd-a.coverStart?w=c.parentNode.getBoundingClientRect():w=Cp(Se(c,g,m).getClientRects(),o),w.left||w.right||g==0)break;m=g,g=g-1,b="right"}p&&v<11&&(w=Ap(e.display.measure,w))}else{g>0&&(b=o="right");var k;e.options.lineWrapping&&(k=c.getClientRects()).length>1?w=k[o=="right"?k.length-1:0]:w=c.getBoundingClientRect()}if(p&&v<9&&!g&&(!w||!w.left&&!w.right)){var L=c.parentNode.getClientRects()[0];L?w={left:L.left,right:L.left+wn(e.display),top:L.top,bottom:L.bottom}:w=Ph}for(var T=w.top-n.rect.top,O=w.bottom-n.rect.top,E=(T+O)/2,R=n.view.measure.heights,I=0;I<R.length-1&&!(E<R[I]);I++);var F=I?R[I-1]:0,W=R[I],U={left:(b=="right"?w.right:w.left)-n.rect.left,right:(b=="left"?w.left:w.right)-n.rect.left,top:F,bottom:W};return!w.left&&!w.right&&(U.bogus=!0),e.options.singleCursorHeightPerLine||(U.rtop=T,U.rbottom=O),U}function Ap(e,n){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!zd(e))return n;var l=screen.logicalXDPI/screen.deviceXDPI,o=screen.logicalYDPI/screen.deviceYDPI;return{left:n.left*l,right:n.right*l,top:n.top*o,bottom:n.bottom*o}}function Bh(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var n=0;n<e.rest.length;n++)e.measure.caches[n]={}}function Rh(e){e.display.externalMeasure=null,ht(e.display.lineMeasure);for(var n=0;n<e.display.view.length;n++)Bh(e.display.view[n])}function hr(e){Rh(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Ih(e){return S&&Y?-(e.body.getBoundingClientRect().left-parseInt(getComputedStyle(e.body).marginLeft)):e.defaultView.pageXOffset||(e.documentElement||e.body).scrollLeft}function Wh(e){return S&&Y?-(e.body.getBoundingClientRect().top-parseInt(getComputedStyle(e.body).marginTop)):e.defaultView.pageYOffset||(e.documentElement||e.body).scrollTop}function Zo(e){var n=Ie(e),l=n.widgets,o=0;if(l)for(var a=0;a<l.length;++a)l[a].above&&(o+=ar(l[a]));return o}function ds(e,n,l,o,a){if(!a){var c=Zo(n);l.top+=c,l.bottom+=c}if(o=="line")return l;o||(o="local");var g=hi(n);if(o=="local"?g+=cs(e.display):g-=e.display.viewOffset,o=="page"||o=="window"){var m=e.display.lineSpace.getBoundingClientRect();g+=m.top+(o=="window"?0:Wh(ee(e)));var b=m.left+(o=="window"?0:Ih(ee(e)));l.left+=b,l.right+=b}return l.top+=g,l.bottom+=g,l}function Hh(e,n,l){if(l=="div")return n;var o=n.left,a=n.top;if(l=="page")o-=Ih(ee(e)),a-=Wh(ee(e));else if(l=="local"||!l){var c=e.display.sizer.getBoundingClientRect();o+=c.left,a+=c.top}var g=e.display.lineSpace.getBoundingClientRect();return{left:o-g.left,top:a-g.top}}function ps(e,n,l,o,a){return o||(o=X(e.doc,n.line)),ds(e,o,Nh(e,o,n.ch,a),l)}function We(e,n,l,o,a,c){o=o||X(e.doc,n.line),a||(a=yn(e,o));function g(O,E){var R=_e(e,a,O,E?"right":"left",c);return E?R.left=R.right:R.right=R.left,ds(e,o,R,l)}var m=li(o,e.doc.direction),b=n.ch,w=n.sticky;if(b>=o.text.length?(b=o.text.length,w="before"):b<=0&&(b=0,w="after"),!m)return g(w=="before"?b-1:b,w=="before");function C(O,E,R){var I=m[E],F=I.level==1;return g(R?O-1:O,F!=R)}var k=er(m,b,w),L=tr,T=C(b,k,w=="before");return L!=null&&(T.other=C(b,L,w!="before")),T}function Fh(e,n){var l=0;n=nt(e.doc,n),e.options.lineWrapping||(l=wn(e.display)*n.ch);var o=X(e.doc,n.line),a=hi(o)+cs(e.display);return{left:l,right:l,top:a,bottom:a+o.height}}function Qo(e,n,l,o,a){var c=B(e,n,l);return c.xRel=a,o&&(c.outside=o),c}function $o(e,n,l){var o=e.doc;if(l+=e.display.viewOffset,l<0)return Qo(o.first,0,null,-1,-1);var a=Gi(o,l),c=o.first+o.size-1;if(a>c)return Qo(o.first+o.size-1,X(o,c).text.length,null,1,1);n<0&&(n=0);for(var g=X(o,a);;){var m=Mp(e,g,a,n,l),b=tp(g,m.ch+(m.xRel>0||m.outside>0?1:0));if(!b)return m;var w=b.find(1);if(w.line==a)return w;g=X(o,a=w.line)}}function zh(e,n,l,o){o-=Zo(n);var a=n.text.length,c=$n(function(g){return _e(e,l,g-1).bottom<=o},a,0);return a=$n(function(g){return _e(e,l,g).top>o},c,a),{begin:c,end:a}}function Kh(e,n,l,o){l||(l=yn(e,n));var a=ds(e,n,_e(e,l,o),"line").top;return zh(e,n,l,a)}function tl(e,n,l,o){return e.bottom<=l?!1:e.top>l?!0:(o?e.left:e.right)>n}function Mp(e,n,l,o,a){a-=hi(n);var c=yn(e,n),g=Zo(n),m=0,b=n.text.length,w=!0,C=li(n,e.doc.direction);if(C){var k=(e.options.lineWrapping?Lp:Tp)(e,n,l,c,C,o,a);w=k.level!=1,m=w?k.from:k.to-1,b=w?k.to:k.from-1}var L=null,T=null,O=$n(function(Z){var _=_e(e,c,Z);return _.top+=g,_.bottom+=g,tl(_,o,a,!1)?(_.top<=a&&_.left<=o&&(L=Z,T=_),!0):!1},m,b),E,R,I=!1;if(T){var F=o-T.left<T.right-o,W=F==w;O=L+(W?0:1),R=W?"after":"before",E=F?T.left:T.right}else{!w&&(O==b||O==m)&&O++,R=O==0?"after":O==n.text.length?"before":_e(e,c,O-(w?1:0)).bottom+g<=a==w?"after":"before";var U=We(e,B(l,O,R),"line",n,c);E=U.left,I=a<U.top?-1:a>=U.bottom?1:0}return O=Za(n.text,O,1),Qo(l,O,R,I,o-E)}function Tp(e,n,l,o,a,c,g){var m=$n(function(k){var L=a[k],T=L.level!=1;return tl(We(e,B(l,T?L.to:L.from,T?"before":"after"),"line",n,o),c,g,!0)},0,a.length-1),b=a[m];if(m>0){var w=b.level!=1,C=We(e,B(l,w?b.from:b.to,w?"after":"before"),"line",n,o);tl(C,c,g,!0)&&C.top>g&&(b=a[m-1])}return b}function Lp(e,n,l,o,a,c,g){var m=zh(e,n,o,g),b=m.begin,w=m.end;/\s/.test(n.text.charAt(w-1))&&w--;for(var C=null,k=null,L=0;L<a.length;L++){var T=a[L];if(!(T.from>=w||T.to<=b)){var O=T.level!=1,E=_e(e,o,O?Math.min(w,T.to)-1:Math.max(b,T.from)).right,R=E<c?c-E+1e9:E-c;(!C||k>R)&&(C=T,k=R)}}return C||(C=a[a.length-1]),C.from<b&&(C={from:b,to:C.to,level:C.level}),C.to>w&&(C={from:C.from,to:w,level:C.level}),C}var qi;function bn(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(qi==null){qi=G("pre",null,"CodeMirror-line-like");for(var n=0;n<49;++n)qi.appendChild(document.createTextNode("x")),qi.appendChild(G("br"));qi.appendChild(document.createTextNode("x"))}lt(e.measure,qi);var l=qi.offsetHeight/50;return l>3&&(e.cachedTextHeight=l),ht(e.measure),l||1}function wn(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var n=G("span","xxxxxxxxxx"),l=G("pre",[n],"CodeMirror-line-like");lt(e.measure,l);var o=n.getBoundingClientRect(),a=(o.right-o.left)/10;return a>2&&(e.cachedCharWidth=a),a||10}function el(e){for(var n=e.display,l={},o={},a=n.gutters.clientLeft,c=n.gutters.firstChild,g=0;c;c=c.nextSibling,++g){var m=e.display.gutterSpecs[g].className;l[m]=c.offsetLeft+c.clientLeft+a,o[m]=c.clientWidth}return{fixedPos:il(n),gutterTotalWidth:n.gutters.offsetWidth,gutterLeft:l,gutterWidth:o,wrapperWidth:n.wrapper.clientWidth}}function il(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Uh(e){var n=bn(e.display),l=e.options.lineWrapping,o=l&&Math.max(5,e.display.scroller.clientWidth/wn(e.display)-3);return function(a){if(wi(e.doc,a))return 0;var c=0;if(a.widgets)for(var g=0;g<a.widgets.length;g++)a.widgets[g].height&&(c+=a.widgets[g].height);return l?c+(Math.ceil(a.text.length/o)||1)*n:c+n}}function nl(e){var n=e.doc,l=Uh(e);n.iter(function(o){var a=l(o);a!=o.height&&qe(o,a)})}function Yi(e,n,l,o){var a=e.display;if(!l&&Lo(n).getAttribute("cm-not-content")=="true")return null;var c,g,m=a.lineSpace.getBoundingClientRect();try{c=n.clientX-m.left,g=n.clientY-m.top}catch{return null}var b=$o(e,c,g),w;if(o&&b.xRel>0&&(w=X(e.doc,b.line).text).length==b.ch){var C=De(w,w.length,e.options.tabSize)-w.length;b=B(b.line,Math.max(0,Math.round((c-Oh(e.display).left)/wn(e.display))-C))}return b}function Xi(e,n){if(n>=e.display.viewTo||(n-=e.display.viewFrom,n<0))return null;for(var l=e.display.view,o=0;o<l.length;o++)if(n-=l[o].size,n<0)return o}function fe(e,n,l,o){n==null&&(n=e.doc.first),l==null&&(l=e.doc.first+e.doc.size),o||(o=0);var a=e.display;if(o&&l<a.viewTo&&(a.updateLineNumbers==null||a.updateLineNumbers>n)&&(a.updateLineNumbers=n),e.curOp.viewChanged=!0,n>=a.viewTo)ai&&Vo(e.doc,n)<a.viewTo&&Si(e);else if(l<=a.viewFrom)ai&&bh(e.doc,l+o)>a.viewFrom?Si(e):(a.viewFrom+=o,a.viewTo+=o);else if(n<=a.viewFrom&&l>=a.viewTo)Si(e);else if(n<=a.viewFrom){var c=gs(e,l,l+o,1);c?(a.view=a.view.slice(c.index),a.viewFrom=c.lineN,a.viewTo+=o):Si(e)}else if(l>=a.viewTo){var g=gs(e,n,n,-1);g?(a.view=a.view.slice(0,g.index),a.viewTo=g.lineN):Si(e)}else{var m=gs(e,n,n,-1),b=gs(e,l,l+o,1);m&&b?(a.view=a.view.slice(0,m.index).concat(us(e,m.lineN,b.lineN)).concat(a.view.slice(b.index)),a.viewTo+=o):Si(e)}var w=a.externalMeasured;w&&(l<w.lineN?w.lineN+=o:n<w.lineN+w.size&&(a.externalMeasured=null))}function xi(e,n,l){e.curOp.viewChanged=!0;var o=e.display,a=e.display.externalMeasured;if(a&&n>=a.lineN&&n<a.lineN+a.size&&(o.externalMeasured=null),!(n<o.viewFrom||n>=o.viewTo)){var c=o.view[Xi(e,n)];if(c.node!=null){var g=c.changes||(c.changes=[]);_t(g,l)==-1&&g.push(l)}}}function Si(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function gs(e,n,l,o){var a=Xi(e,n),c,g=e.display.view;if(!ai||l==e.doc.first+e.doc.size)return{index:a,lineN:l};for(var m=e.display.viewFrom,b=0;b<a;b++)m+=g[b].size;if(m!=n){if(o>0){if(a==g.length-1)return null;c=m+g[a].size-n,a++}else c=m-n;n+=c,l+=c}for(;Vo(e.doc,l)!=l;){if(a==(o<0?0:g.length-1))return null;l+=o*g[a-(o<0?1:0)].size,a+=o}return{index:a,lineN:l}}function Op(e,n,l){var o=e.display,a=o.view;a.length==0||n>=o.viewTo||l<=o.viewFrom?(o.view=us(e,n,l),o.viewFrom=n):(o.viewFrom>n?o.view=us(e,n,o.viewFrom).concat(o.view):o.viewFrom<n&&(o.view=o.view.slice(Xi(e,n))),o.viewFrom=n,o.viewTo<l?o.view=o.view.concat(us(e,o.viewTo,l)):o.viewTo>l&&(o.view=o.view.slice(0,Xi(e,l)))),o.viewTo=l}function Gh(e){for(var n=e.display.view,l=0,o=0;o<n.length;o++){var a=n[o];!a.hidden&&(!a.node||a.changes)&&++l}return l}function fr(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Vh(e,n){n===void 0&&(n=!0);var l=e.doc,o={},a=o.cursors=document.createDocumentFragment(),c=o.selection=document.createDocumentFragment(),g=e.options.$customCursor;g&&(n=!0);for(var m=0;m<l.sel.ranges.length;m++)if(!(!n&&m==l.sel.primIndex)){var b=l.sel.ranges[m];if(!(b.from().line>=e.display.viewTo||b.to().line<e.display.viewFrom)){var w=b.empty();if(g){var C=g(e,b);C&&rl(e,C,a)}else(w||e.options.showCursorWhenSelecting)&&rl(e,b.head,a);w||Dp(e,b,c)}}return o}function rl(e,n,l){var o=We(e,n,"div",null,null,!e.options.singleCursorHeightPerLine),a=l.appendChild(G("div"," ","CodeMirror-cursor"));if(a.style.left=o.left+"px",a.style.top=o.top+"px",a.style.height=Math.max(0,o.bottom-o.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var c=ps(e,n,"div",null,null),g=c.right-c.left;a.style.width=(g>0?g:e.defaultCharWidth())+"px"}if(o.other){var m=l.appendChild(G("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));m.style.display="",m.style.left=o.other.left+"px",m.style.top=o.other.top+"px",m.style.height=(o.other.bottom-o.other.top)*.85+"px"}}function ms(e,n){return e.top-n.top||e.left-n.left}function Dp(e,n,l){var o=e.display,a=e.doc,c=document.createDocumentFragment(),g=Oh(e.display),m=g.left,b=Math.max(o.sizerWidth,Vi(e)-o.sizer.offsetLeft)-g.right,w=a.direction=="ltr";function C(W,U,Z,_){U<0&&(U=0),U=Math.round(U),_=Math.round(_),c.appendChild(G("div",null,"CodeMirror-selected","position: absolute; left: "+W+`px;
                             top: `+U+"px; width: "+(Z??b-W)+`px;
                             height: `+(_-U)+"px"))}function k(W,U,Z){var _=X(a,W),rt=_.text.length,yt,Gt;function Mt(Nt,de){return ps(e,B(W,Nt),"div",_,de)}function we(Nt,de,Yt){var Rt=Kh(e,_,null,Nt),Pt=de=="ltr"==(Yt=="after")?"left":"right",Tt=Yt=="after"?Rt.begin:Rt.end-(/\s/.test(_.text.charAt(Rt.end-1))?2:1);return Mt(Tt,Pt)[Pt]}var ce=li(_,a.direction);return Ed(ce,U||0,Z??rt,function(Nt,de,Yt,Rt){var Pt=Yt=="ltr",Tt=Mt(Nt,Pt?"left":"right"),pe=Mt(de-1,Pt?"right":"left"),En=U==null&&Nt==0,Li=Z==null&&de==rt,Jt=Rt==0,je=!ce||Rt==ce.length-1;if(pe.top-Tt.top<=3){var Vt=(w?En:Li)&&Jt,Nl=(w?Li:En)&&je,di=Vt?m:(Pt?Tt:pe).left,Qi=Nl?b:(Pt?pe:Tt).right;C(di,Tt.top,Qi-di,Tt.bottom)}else{var $i,ne,Bn,Pl;Pt?($i=w&&En&&Jt?m:Tt.left,ne=w?b:we(Nt,Yt,"before"),Bn=w?m:we(de,Yt,"after"),Pl=w&&Li&&je?b:pe.right):($i=w?we(Nt,Yt,"before"):m,ne=!w&&En&&Jt?b:Tt.right,Bn=!w&&Li&&je?m:pe.left,Pl=w?we(de,Yt,"after"):b),C($i,Tt.top,ne-$i,Tt.bottom),Tt.bottom<pe.top&&C(m,Tt.bottom,null,pe.top),C(Bn,pe.top,Pl-Bn,pe.bottom)}(!yt||ms(Tt,yt)<0)&&(yt=Tt),ms(pe,yt)<0&&(yt=pe),(!Gt||ms(Tt,Gt)<0)&&(Gt=Tt),ms(pe,Gt)<0&&(Gt=pe)}),{start:yt,end:Gt}}var L=n.from(),T=n.to();if(L.line==T.line)k(L.line,L.ch,T.ch);else{var O=X(a,L.line),E=X(a,T.line),R=Ie(O)==Ie(E),I=k(L.line,L.ch,R?O.text.length+1:null).end,F=k(T.line,R?0:null,T.ch).start;R&&(I.top<F.top-2?(C(I.right,I.top,null,I.bottom),C(m,F.top,F.left,F.bottom)):C(I.right,I.top,F.left-I.right,I.bottom)),I.bottom<F.top&&C(m,I.bottom,null,F.top)}l.appendChild(c)}function sl(e){if(e.state.focused){var n=e.display;clearInterval(n.blinker);var l=!0;n.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?n.blinker=setInterval(function(){e.hasFocus()||xn(e),n.cursorDiv.style.visibility=(l=!l)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(n.cursorDiv.style.visibility="hidden")}}function qh(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||ll(e))}function ol(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&xn(e))},100)}function ll(e,n){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),e.options.readOnly!="nocursor"&&(e.state.focused||(Ot(e,"focus",e,n),e.state.focused=!0,Ge(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(e.display.input.reset(),y&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),sl(e))}function xn(e,n){e.state.delayingBlurEvent||(e.state.focused&&(Ot(e,"blur",e,n),e.state.focused=!1,tt(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function vs(e){for(var n=e.display,l=n.lineDiv.offsetTop,o=Math.max(0,n.scroller.getBoundingClientRect().top),a=n.lineDiv.getBoundingClientRect().top,c=0,g=0;g<n.view.length;g++){var m=n.view[g],b=e.options.lineWrapping,w=void 0,C=0;if(!m.hidden){if(a+=m.line.height,p&&v<8){var k=m.node.offsetTop+m.node.offsetHeight;w=k-l,l=k}else{var L=m.node.getBoundingClientRect();w=L.bottom-L.top,!b&&m.text.firstChild&&(C=m.text.firstChild.getBoundingClientRect().right-L.left-1)}var T=m.line.height-w;if((T>.005||T<-.005)&&(a<o&&(c-=T),qe(m.line,w),Yh(m.line),m.rest))for(var O=0;O<m.rest.length;O++)Yh(m.rest[O]);if(C>e.display.sizerWidth){var E=Math.ceil(C/wn(e.display));E>e.display.maxLineLength&&(e.display.maxLineLength=E,e.display.maxLine=m.line,e.display.maxLineChanged=!0)}}}Math.abs(c)>2&&(n.scroller.scrollTop+=c)}function Yh(e){if(e.widgets)for(var n=0;n<e.widgets.length;++n){var l=e.widgets[n],o=l.node.parentNode;o&&(l.height=o.offsetHeight)}}function ys(e,n,l){var o=l&&l.top!=null?Math.max(0,l.top):e.scroller.scrollTop;o=Math.floor(o-cs(e));var a=l&&l.bottom!=null?l.bottom:o+e.wrapper.clientHeight,c=Gi(n,o),g=Gi(n,a);if(l&&l.ensure){var m=l.ensure.from.line,b=l.ensure.to.line;m<c?(c=m,g=Gi(n,hi(X(n,m))+e.wrapper.clientHeight)):Math.min(b,n.lastLine())>=g&&(c=Gi(n,hi(X(n,b))-e.wrapper.clientHeight),g=b)}return{from:c,to:Math.max(g,c+1)}}function Np(e,n){if(!Ft(e,"scrollCursorIntoView")){var l=e.display,o=l.sizer.getBoundingClientRect(),a=null,c=l.wrapper.ownerDocument;if(n.top+o.top<0?a=!0:n.bottom+o.top>(c.defaultView.innerHeight||c.documentElement.clientHeight)&&(a=!1),a!=null&&!P){var g=G("div","​",null,`position: absolute;
                         top: `+(n.top-l.viewOffset-cs(e.display))+`px;
                         height: `+(n.bottom-n.top+Xe(e)+l.barHeight)+`px;
                         left: `+n.left+"px; width: "+Math.max(2,n.right-n.left)+"px;");e.display.lineSpace.appendChild(g),g.scrollIntoView(a),e.display.lineSpace.removeChild(g)}}}function Pp(e,n,l,o){o==null&&(o=0);var a;!e.options.lineWrapping&&n==l&&(l=n.sticky=="before"?B(n.line,n.ch+1,"before"):n,n=n.ch?B(n.line,n.sticky=="before"?n.ch-1:n.ch,"after"):n);for(var c=0;c<5;c++){var g=!1,m=We(e,n),b=!l||l==n?m:We(e,l);a={left:Math.min(m.left,b.left),top:Math.min(m.top,b.top)-o,right:Math.max(m.left,b.left),bottom:Math.max(m.bottom,b.bottom)+o};var w=al(e,a),C=e.doc.scrollTop,k=e.doc.scrollLeft;if(w.scrollTop!=null&&(cr(e,w.scrollTop),Math.abs(e.doc.scrollTop-C)>1&&(g=!0)),w.scrollLeft!=null&&(_i(e,w.scrollLeft),Math.abs(e.doc.scrollLeft-k)>1&&(g=!0)),!g)break}return a}function Ep(e,n){var l=al(e,n);l.scrollTop!=null&&cr(e,l.scrollTop),l.scrollLeft!=null&&_i(e,l.scrollLeft)}function al(e,n){var l=e.display,o=bn(e.display);n.top<0&&(n.top=0);var a=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:l.scroller.scrollTop,c=jo(e),g={};n.bottom-n.top>c&&(n.bottom=n.top+c);var m=e.doc.height+_o(l),b=n.top<o,w=n.bottom>m-o;if(n.top<a)g.scrollTop=b?0:n.top;else if(n.bottom>a+c){var C=Math.min(n.top,(w?m:n.bottom)-c);C!=a&&(g.scrollTop=C)}var k=e.options.fixedGutter?0:l.gutters.offsetWidth,L=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:l.scroller.scrollLeft-k,T=Vi(e)-l.gutters.offsetWidth,O=n.right-n.left>T;return O&&(n.right=n.left+T),n.left<10?g.scrollLeft=0:n.left<L?g.scrollLeft=Math.max(0,n.left+k-(O?0:10)):n.right>T+L-3&&(g.scrollLeft=n.right+(O?0:10)-T),g}function hl(e,n){n!=null&&(bs(e),e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+n)}function Sn(e){bs(e);var n=e.getCursor();e.curOp.scrollToPos={from:n,to:n,margin:e.options.cursorScrollMargin}}function ur(e,n,l){(n!=null||l!=null)&&bs(e),n!=null&&(e.curOp.scrollLeft=n),l!=null&&(e.curOp.scrollTop=l)}function Bp(e,n){bs(e),e.curOp.scrollToPos=n}function bs(e){var n=e.curOp.scrollToPos;if(n){e.curOp.scrollToPos=null;var l=Fh(e,n.from),o=Fh(e,n.to);Xh(e,l,o,n.margin)}}function Xh(e,n,l,o){var a=al(e,{left:Math.min(n.left,l.left),top:Math.min(n.top,l.top)-o,right:Math.max(n.right,l.right),bottom:Math.max(n.bottom,l.bottom)+o});ur(e,a.scrollLeft,a.scrollTop)}function cr(e,n){Math.abs(e.doc.scrollTop-n)<2||(s||ul(e,{top:n}),_h(e,n,!0),s&&ul(e),gr(e,100))}function _h(e,n,l){n=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,n)),!(e.display.scroller.scrollTop==n&&!l)&&(e.doc.scrollTop=n,e.display.scrollbars.setScrollTop(n),e.display.scroller.scrollTop!=n&&(e.display.scroller.scrollTop=n))}function _i(e,n,l,o){n=Math.max(0,Math.min(n,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),!((l?n==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-n)<2)&&!o)&&(e.doc.scrollLeft=n,$h(e),e.display.scroller.scrollLeft!=n&&(e.display.scroller.scrollLeft=n),e.display.scrollbars.setScrollLeft(n))}function dr(e){var n=e.display,l=n.gutters.offsetWidth,o=Math.round(e.doc.height+_o(e.display));return{clientHeight:n.scroller.clientHeight,viewHeight:n.wrapper.clientHeight,scrollWidth:n.scroller.scrollWidth,clientWidth:n.scroller.clientWidth,viewWidth:n.wrapper.clientWidth,barLeft:e.options.fixedGutter?l:0,docHeight:o,scrollHeight:o+Xe(e)+n.barHeight,nativeBarWidth:n.nativeBarWidth,gutterWidth:l}}var ji=function(e,n,l){this.cm=l;var o=this.vert=G("div",[G("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),a=this.horiz=G("div",[G("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");o.tabIndex=a.tabIndex=-1,e(o),e(a),$(o,"scroll",function(){o.clientHeight&&n(o.scrollTop,"vertical")}),$(a,"scroll",function(){a.clientWidth&&n(a.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,p&&v<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};ji.prototype.update=function(e){var n=e.scrollWidth>e.clientWidth+1,l=e.scrollHeight>e.clientHeight+1,o=e.nativeBarWidth;if(l){this.vert.style.display="block",this.vert.style.bottom=n?o+"px":"0";var a=e.viewHeight-(n?o:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+a)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(n){this.horiz.style.display="block",this.horiz.style.right=l?o+"px":"0",this.horiz.style.left=e.barLeft+"px";var c=e.viewWidth-e.barLeft-(l?o:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+c)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(o==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:l?o:0,bottom:n?o:0}},ji.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},ji.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},ji.prototype.zeroWidthHack=function(){var e=q&&!N?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new bi,this.disableVert=new bi},ji.prototype.enableZeroWidthBar=function(e,n,l){e.style.visibility="";function o(){var a=e.getBoundingClientRect(),c=l=="vert"?document.elementFromPoint(a.right-1,(a.top+a.bottom)/2):document.elementFromPoint((a.right+a.left)/2,a.bottom-1);c!=e?e.style.visibility="hidden":n.set(1e3,o)}n.set(1e3,o)},ji.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var pr=function(){};pr.prototype.update=function(){return{bottom:0,right:0}},pr.prototype.setScrollLeft=function(){},pr.prototype.setScrollTop=function(){},pr.prototype.clear=function(){};function Cn(e,n){n||(n=dr(e));var l=e.display.barWidth,o=e.display.barHeight;jh(e,n);for(var a=0;a<4&&l!=e.display.barWidth||o!=e.display.barHeight;a++)l!=e.display.barWidth&&e.options.lineWrapping&&vs(e),jh(e,dr(e)),l=e.display.barWidth,o=e.display.barHeight}function jh(e,n){var l=e.display,o=l.scrollbars.update(n);l.sizer.style.paddingRight=(l.barWidth=o.right)+"px",l.sizer.style.paddingBottom=(l.barHeight=o.bottom)+"px",l.heightForcer.style.borderBottom=o.bottom+"px solid transparent",o.right&&o.bottom?(l.scrollbarFiller.style.display="block",l.scrollbarFiller.style.height=o.bottom+"px",l.scrollbarFiller.style.width=o.right+"px"):l.scrollbarFiller.style.display="",o.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(l.gutterFiller.style.display="block",l.gutterFiller.style.height=o.bottom+"px",l.gutterFiller.style.width=n.gutterWidth+"px"):l.gutterFiller.style.display=""}var Jh={native:ji,null:pr};function Zh(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&tt(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new Jh[e.options.scrollbarStyle](function(n){e.display.wrapper.insertBefore(n,e.display.scrollbarFiller),$(n,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),n.setAttribute("cm-not-content","true")},function(n,l){l=="horizontal"?_i(e,n):cr(e,n)},e),e.display.scrollbars.addClass&&Ge(e.display.wrapper,e.display.scrollbars.addClass)}var Rp=0;function Ji(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Rp,markArrays:null},cp(e.curOp)}function Zi(e){var n=e.curOp;n&&pp(n,function(l){for(var o=0;o<l.ops.length;o++)l.ops[o].cm.curOp=null;Ip(l)})}function Ip(e){for(var n=e.ops,l=0;l<n.length;l++)Wp(n[l]);for(var o=0;o<n.length;o++)Hp(n[o]);for(var a=0;a<n.length;a++)Fp(n[a]);for(var c=0;c<n.length;c++)zp(n[c]);for(var g=0;g<n.length;g++)Kp(n[g])}function Wp(e){var n=e.cm,l=n.display;Gp(n),e.updateMaxLine&&Yo(n),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<l.viewFrom||e.scrollToPos.to.line>=l.viewTo)||l.maxLineChanged&&n.options.lineWrapping,e.update=e.mustUpdate&&new ws(n,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Hp(e){e.updatedDisplay=e.mustUpdate&&fl(e.cm,e.update)}function Fp(e){var n=e.cm,l=n.display;e.updatedDisplay&&vs(n),e.barMeasure=dr(n),l.maxLineChanged&&!n.options.lineWrapping&&(e.adjustWidthTo=Nh(n,l.maxLine,l.maxLine.text.length).left+3,n.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(l.scroller.clientWidth,l.sizer.offsetLeft+e.adjustWidthTo+Xe(n)+n.display.barWidth),e.maxScrollLeft=Math.max(0,l.sizer.offsetLeft+e.adjustWidthTo-Vi(n))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=l.input.prepareSelection())}function zp(e){var n=e.cm;e.adjustWidthTo!=null&&(n.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<n.doc.scrollLeft&&_i(n,Math.min(n.display.scroller.scrollLeft,e.maxScrollLeft),!0),n.display.maxLineChanged=!1);var l=e.focus&&e.focus==Bt(ve(n));e.preparedSelection&&n.display.input.showSelection(e.preparedSelection,l),(e.updatedDisplay||e.startHeight!=n.doc.height)&&Cn(n,e.barMeasure),e.updatedDisplay&&dl(n,e.barMeasure),e.selectionChanged&&sl(n),n.state.focused&&e.updateInput&&n.display.input.reset(e.typing),l&&qh(e.cm)}function Kp(e){var n=e.cm,l=n.display,o=n.doc;if(e.updatedDisplay&&Qh(n,e.update),l.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(l.wheelStartX=l.wheelStartY=null),e.scrollTop!=null&&_h(n,e.scrollTop,e.forceScroll),e.scrollLeft!=null&&_i(n,e.scrollLeft,!0,!0),e.scrollToPos){var a=Pp(n,nt(o,e.scrollToPos.from),nt(o,e.scrollToPos.to),e.scrollToPos.margin);Np(n,a)}var c=e.maybeHiddenMarkers,g=e.maybeUnhiddenMarkers;if(c)for(var m=0;m<c.length;++m)c[m].lines.length||Ot(c[m],"hide");if(g)for(var b=0;b<g.length;++b)g[b].lines.length&&Ot(g[b],"unhide");l.wrapper.offsetHeight&&(o.scrollTop=n.display.scroller.scrollTop),e.changeObjs&&Ot(n,"changes",n,e.changeObjs),e.update&&e.update.finish()}function be(e,n){if(e.curOp)return n();Ji(e);try{return n()}finally{Zi(e)}}function Kt(e,n){return function(){if(e.curOp)return n.apply(e,arguments);Ji(e);try{return n.apply(e,arguments)}finally{Zi(e)}}}function ie(e){return function(){if(this.curOp)return e.apply(this,arguments);Ji(this);try{return e.apply(this,arguments)}finally{Zi(this)}}}function Ut(e){return function(){var n=this.cm;if(!n||n.curOp)return e.apply(this,arguments);Ji(n);try{return e.apply(this,arguments)}finally{Zi(n)}}}function gr(e,n){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(n,cn(Up,e))}function Up(e){var n=e.doc;if(!(n.highlightFrontier>=e.display.viewTo)){var l=+new Date+e.options.workTime,o=rr(e,n.highlightFrontier),a=[];n.iter(o.line,Math.min(n.first+n.size,e.display.viewTo+500),function(c){if(o.line>=e.display.viewFrom){var g=c.styles,m=c.text.length>e.options.maxHighlightLength?Ki(n.mode,o.state):null,b=sh(e,c,o,!0);m&&(o.state=m),c.styles=b.styles;var w=c.styleClasses,C=b.classes;C?c.styleClasses=C:w&&(c.styleClasses=null);for(var k=!g||g.length!=c.styles.length||w!=C&&(!w||!C||w.bgClass!=C.bgClass||w.textClass!=C.textClass),L=0;!k&&L<g.length;++L)k=g[L]!=c.styles[L];k&&a.push(o.line),c.stateAfter=o.save(),o.nextLine()}else c.text.length<=e.options.maxHighlightLength&&zo(e,c.text,o),c.stateAfter=o.line%5==0?o.save():null,o.nextLine();if(+new Date>l)return gr(e,e.options.workDelay),!0}),n.highlightFrontier=o.line,n.modeFrontier=Math.max(n.modeFrontier,o.line),a.length&&be(e,function(){for(var c=0;c<a.length;c++)xi(e,a[c],"text")})}}var ws=function(e,n,l){var o=e.display;this.viewport=n,this.visible=ys(o,e.doc,n),this.editorIsHidden=!o.wrapper.offsetWidth,this.wrapperHeight=o.wrapper.clientHeight,this.wrapperWidth=o.wrapper.clientWidth,this.oldDisplayWidth=Vi(e),this.force=l,this.dims=el(e),this.events=[]};ws.prototype.signal=function(e,n){Ne(e,n)&&this.events.push(arguments)},ws.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ot.apply(null,this.events[e])};function Gp(e){var n=e.display;!n.scrollbarsClipped&&n.scroller.offsetWidth&&(n.nativeBarWidth=n.scroller.offsetWidth-n.scroller.clientWidth,n.heightForcer.style.height=Xe(e)+"px",n.sizer.style.marginBottom=-n.nativeBarWidth+"px",n.sizer.style.borderRightWidth=Xe(e)+"px",n.scrollbarsClipped=!0)}function Vp(e){if(e.hasFocus())return null;var n=Bt(ve(e));if(!n||!Ce(e.display.lineDiv,n))return null;var l={activeElt:n};if(window.getSelection){var o=oi(e).getSelection();o.anchorNode&&o.extend&&Ce(e.display.lineDiv,o.anchorNode)&&(l.anchorNode=o.anchorNode,l.anchorOffset=o.anchorOffset,l.focusNode=o.focusNode,l.focusOffset=o.focusOffset)}return l}function qp(e){if(!(!e||!e.activeElt||e.activeElt==Bt(ye(e.activeElt)))&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&Ce(document.body,e.anchorNode)&&Ce(document.body,e.focusNode))){var n=e.activeElt.ownerDocument,l=n.defaultView.getSelection(),o=n.createRange();o.setEnd(e.anchorNode,e.anchorOffset),o.collapse(!1),l.removeAllRanges(),l.addRange(o),l.extend(e.focusNode,e.focusOffset)}}function fl(e,n){var l=e.display,o=e.doc;if(n.editorIsHidden)return Si(e),!1;if(!n.force&&n.visible.from>=l.viewFrom&&n.visible.to<=l.viewTo&&(l.updateLineNumbers==null||l.updateLineNumbers>=l.viewTo)&&l.renderedView==l.view&&Gh(e)==0)return!1;tf(e)&&(Si(e),n.dims=el(e));var a=o.first+o.size,c=Math.max(n.visible.from-e.options.viewportMargin,o.first),g=Math.min(a,n.visible.to+e.options.viewportMargin);l.viewFrom<c&&c-l.viewFrom<20&&(c=Math.max(o.first,l.viewFrom)),l.viewTo>g&&l.viewTo-g<20&&(g=Math.min(a,l.viewTo)),ai&&(c=Vo(e.doc,c),g=bh(e.doc,g));var m=c!=l.viewFrom||g!=l.viewTo||l.lastWrapHeight!=n.wrapperHeight||l.lastWrapWidth!=n.wrapperWidth;Op(e,c,g),l.viewOffset=hi(X(e.doc,l.viewFrom)),e.display.mover.style.top=l.viewOffset+"px";var b=Gh(e);if(!m&&b==0&&!n.force&&l.renderedView==l.view&&(l.updateLineNumbers==null||l.updateLineNumbers>=l.viewTo))return!1;var w=Vp(e);return b>4&&(l.lineDiv.style.display="none"),Yp(e,l.updateLineNumbers,n.dims),b>4&&(l.lineDiv.style.display=""),l.renderedView=l.view,qp(w),ht(l.cursorDiv),ht(l.selectionDiv),l.gutters.style.height=l.sizer.style.minHeight=0,m&&(l.lastWrapHeight=n.wrapperHeight,l.lastWrapWidth=n.wrapperWidth,gr(e,400)),l.updateLineNumbers=null,!0}function Qh(e,n){for(var l=n.viewport,o=!0;;o=!1){if(!o||!e.options.lineWrapping||n.oldDisplayWidth==Vi(e)){if(l&&l.top!=null&&(l={top:Math.min(e.doc.height+_o(e.display)-jo(e),l.top)}),n.visible=ys(e.display,e.doc,l),n.visible.from>=e.display.viewFrom&&n.visible.to<=e.display.viewTo)break}else o&&(n.visible=ys(e.display,e.doc,l));if(!fl(e,n))break;vs(e);var a=dr(e);fr(e),Cn(e,a),dl(e,a),n.force=!1}n.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(n.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function ul(e,n){var l=new ws(e,n);if(fl(e,l)){vs(e),Qh(e,l);var o=dr(e);fr(e),Cn(e,o),dl(e,o),l.finish()}}function Yp(e,n,l){var o=e.display,a=e.options.lineNumbers,c=o.lineDiv,g=c.firstChild;function m(O){var E=O.nextSibling;return y&&q&&e.display.currentWheelTarget==O?O.style.display="none":O.parentNode.removeChild(O),E}for(var b=o.view,w=o.viewFrom,C=0;C<b.length;C++){var k=b[C];if(!k.hidden)if(!k.node||k.node.parentNode!=c){var L=bp(e,k,w,l);c.insertBefore(L,g)}else{for(;g!=k.node;)g=m(g);var T=a&&n!=null&&n<=w&&k.lineNumber;k.changes&&(_t(k.changes,"gutter")>-1&&(T=!1),kh(e,k,w,l)),T&&(ht(k.lineNumber),k.lineNumber.appendChild(document.createTextNode(Wo(e.options,w)))),g=k.node.nextSibling}w+=k.size}for(;g;)g=m(g)}function cl(e){var n=e.gutters.offsetWidth;e.sizer.style.marginLeft=n+"px",zt(e,"gutterChanged",e)}function dl(e,n){e.display.sizer.style.minHeight=n.docHeight+"px",e.display.heightForcer.style.top=n.docHeight+"px",e.display.gutters.style.height=n.docHeight+e.display.barHeight+Xe(e)+"px"}function $h(e){var n=e.display,l=n.view;if(!(!n.alignWidgets&&(!n.gutters.firstChild||!e.options.fixedGutter))){for(var o=il(n)-n.scroller.scrollLeft+e.doc.scrollLeft,a=n.gutters.offsetWidth,c=o+"px",g=0;g<l.length;g++)if(!l[g].hidden){e.options.fixedGutter&&(l[g].gutter&&(l[g].gutter.style.left=c),l[g].gutterBackground&&(l[g].gutterBackground.style.left=c));var m=l[g].alignable;if(m)for(var b=0;b<m.length;b++)m[b].style.left=c}e.options.fixedGutter&&(n.gutters.style.left=o+a+"px")}}function tf(e){if(!e.options.lineNumbers)return!1;var n=e.doc,l=Wo(e.options,n.first+n.size-1),o=e.display;if(l.length!=o.lineNumChars){var a=o.measure.appendChild(G("div",[G("div",l)],"CodeMirror-linenumber CodeMirror-gutter-elt")),c=a.firstChild.offsetWidth,g=a.offsetWidth-c;return o.lineGutter.style.width="",o.lineNumInnerWidth=Math.max(c,o.lineGutter.offsetWidth-g)+1,o.lineNumWidth=o.lineNumInnerWidth+g,o.lineNumChars=o.lineNumInnerWidth?l.length:-1,o.lineGutter.style.width=o.lineNumWidth+"px",cl(e.display),!0}return!1}function pl(e,n){for(var l=[],o=!1,a=0;a<e.length;a++){var c=e[a],g=null;if(typeof c!="string"&&(g=c.style,c=c.className),c=="CodeMirror-linenumbers")if(n)o=!0;else continue;l.push({className:c,style:g})}return n&&!o&&l.push({className:"CodeMirror-linenumbers",style:null}),l}function ef(e){var n=e.gutters,l=e.gutterSpecs;ht(n),e.lineGutter=null;for(var o=0;o<l.length;++o){var a=l[o],c=a.className,g=a.style,m=n.appendChild(G("div",null,"CodeMirror-gutter "+c));g&&(m.style.cssText=g),c=="CodeMirror-linenumbers"&&(e.lineGutter=m,m.style.width=(e.lineNumWidth||1)+"px")}n.style.display=l.length?"":"none",cl(e)}function mr(e){ef(e.display),fe(e),$h(e)}function Xp(e,n,l,o){var a=this;this.input=l,a.scrollbarFiller=G("div",null,"CodeMirror-scrollbar-filler"),a.scrollbarFiller.setAttribute("cm-not-content","true"),a.gutterFiller=G("div",null,"CodeMirror-gutter-filler"),a.gutterFiller.setAttribute("cm-not-content","true"),a.lineDiv=ae("div",null,"CodeMirror-code"),a.selectionDiv=G("div",null,null,"position: relative; z-index: 1"),a.cursorDiv=G("div",null,"CodeMirror-cursors"),a.measure=G("div",null,"CodeMirror-measure"),a.lineMeasure=G("div",null,"CodeMirror-measure"),a.lineSpace=ae("div",[a.measure,a.lineMeasure,a.selectionDiv,a.cursorDiv,a.lineDiv],null,"position: relative; outline: none");var c=ae("div",[a.lineSpace],"CodeMirror-lines");a.mover=G("div",[c],null,"position: relative"),a.sizer=G("div",[a.mover],"CodeMirror-sizer"),a.sizerWidth=null,a.heightForcer=G("div",null,null,"position: absolute; height: "+Xa+"px; width: 1px;"),a.gutters=G("div",null,"CodeMirror-gutters"),a.lineGutter=null,a.scroller=G("div",[a.sizer,a.heightForcer,a.gutters],"CodeMirror-scroll"),a.scroller.setAttribute("tabIndex","-1"),a.wrapper=G("div",[a.scrollbarFiller,a.gutterFiller,a.scroller],"CodeMirror"),S&&A>=105&&(a.wrapper.style.clipPath="inset(0px)"),a.wrapper.setAttribute("translate","no"),p&&v<8&&(a.gutters.style.zIndex=-1,a.scroller.style.paddingRight=0),!y&&!(s&&J)&&(a.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(a.wrapper):e(a.wrapper)),a.viewFrom=a.viewTo=n.first,a.reportedViewFrom=a.reportedViewTo=n.first,a.view=[],a.renderedView=null,a.externalMeasured=null,a.viewOffset=0,a.lastWrapHeight=a.lastWrapWidth=0,a.updateLineNumbers=null,a.nativeBarWidth=a.barHeight=a.barWidth=0,a.scrollbarsClipped=!1,a.lineNumWidth=a.lineNumInnerWidth=a.lineNumChars=null,a.alignWidgets=!1,a.cachedCharWidth=a.cachedTextHeight=a.cachedPaddingH=null,a.maxLine=null,a.maxLineLength=0,a.maxLineChanged=!1,a.wheelDX=a.wheelDY=a.wheelStartX=a.wheelStartY=null,a.shift=!1,a.selForContextMenu=null,a.activeTouch=null,a.gutterSpecs=pl(o.gutters,o.lineNumbers),ef(a),l.init(a)}var xs=0,ui=null;p?ui=-.53:s?ui=15:S?ui=-.7:D&&(ui=-1/3);function nf(e){var n=e.wheelDeltaX,l=e.wheelDeltaY;return n==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(n=e.detail),l==null&&e.detail&&e.axis==e.VERTICAL_AXIS?l=e.detail:l==null&&(l=e.wheelDelta),{x:n,y:l}}function _p(e){var n=nf(e);return n.x*=ui,n.y*=ui,n}function rf(e,n){S&&A==102&&(e.display.chromeScrollHack==null?e.display.sizer.style.pointerEvents="none":clearTimeout(e.display.chromeScrollHack),e.display.chromeScrollHack=setTimeout(function(){e.display.chromeScrollHack=null,e.display.sizer.style.pointerEvents=""},100));var l=nf(n),o=l.x,a=l.y,c=ui;n.deltaMode===0&&(o=n.deltaX,a=n.deltaY,c=1);var g=e.display,m=g.scroller,b=m.scrollWidth>m.clientWidth,w=m.scrollHeight>m.clientHeight;if(o&&b||a&&w){if(a&&q&&y){t:for(var C=n.target,k=g.view;C!=m;C=C.parentNode)for(var L=0;L<k.length;L++)if(k[L].node==C){e.display.currentWheelTarget=C;break t}}if(o&&!s&&!M&&c!=null){a&&w&&cr(e,Math.max(0,m.scrollTop+a*c)),_i(e,Math.max(0,m.scrollLeft+o*c)),(!a||a&&w)&&he(n),g.wheelStartX=null;return}if(a&&c!=null){var T=a*c,O=e.doc.scrollTop,E=O+g.wrapper.clientHeight;T<0?O=Math.max(0,O+T-50):E=Math.min(e.doc.height,E+T+50),ul(e,{top:O,bottom:E})}xs<20&&n.deltaMode!==0&&(g.wheelStartX==null?(g.wheelStartX=m.scrollLeft,g.wheelStartY=m.scrollTop,g.wheelDX=o,g.wheelDY=a,setTimeout(function(){if(g.wheelStartX!=null){var R=m.scrollLeft-g.wheelStartX,I=m.scrollTop-g.wheelStartY,F=I&&g.wheelDY&&I/g.wheelDY||R&&g.wheelDX&&R/g.wheelDX;g.wheelStartX=g.wheelStartY=null,F&&(ui=(ui*xs+F)/(xs+1),++xs)}},200)):(g.wheelDX+=o,g.wheelDY+=a))}}var Me=function(e,n){this.ranges=e,this.primIndex=n};Me.prototype.primary=function(){return this.ranges[this.primIndex]},Me.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var n=0;n<this.ranges.length;n++){var l=this.ranges[n],o=e.ranges[n];if(!Ho(l.anchor,o.anchor)||!Ho(l.head,o.head))return!1}return!0},Me.prototype.deepCopy=function(){for(var e=[],n=0;n<this.ranges.length;n++)e[n]=new ft(Fo(this.ranges[n].anchor),Fo(this.ranges[n].head));return new Me(e,this.primIndex)},Me.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},Me.prototype.contains=function(e,n){n||(n=e);for(var l=0;l<this.ranges.length;l++){var o=this.ranges[l];if(it(n,o.from())>=0&&it(e,o.to())<=0)return l}return-1};var ft=function(e,n){this.anchor=e,this.head=n};ft.prototype.from=function(){return rs(this.anchor,this.head)},ft.prototype.to=function(){return ns(this.anchor,this.head)},ft.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function He(e,n,l){var o=e&&e.options.selectionsMayTouch,a=n[l];n.sort(function(L,T){return it(L.from(),T.from())}),l=_t(n,a);for(var c=1;c<n.length;c++){var g=n[c],m=n[c-1],b=it(m.to(),g.from());if(o&&!g.empty()?b>0:b>=0){var w=rs(m.from(),g.from()),C=ns(m.to(),g.to()),k=m.empty()?g.from()==g.head:m.from()==m.head;c<=l&&--l,n.splice(--c,2,new ft(k?C:w,k?w:C))}}return new Me(n,l)}function Ci(e,n){return new Me([new ft(e,n||e)],0)}function ki(e){return e.text?B(e.from.line+e.text.length-1,ct(e.text).length+(e.text.length==1?e.from.ch:0)):e.to}function sf(e,n){if(it(e,n.from)<0)return e;if(it(e,n.to)<=0)return ki(n);var l=e.line+n.text.length-(n.to.line-n.from.line)-1,o=e.ch;return e.line==n.to.line&&(o+=ki(n).ch-n.to.ch),B(l,o)}function gl(e,n){for(var l=[],o=0;o<e.sel.ranges.length;o++){var a=e.sel.ranges[o];l.push(new ft(sf(a.anchor,n),sf(a.head,n)))}return He(e.cm,l,e.sel.primIndex)}function of(e,n,l){return e.line==n.line?B(l.line,e.ch-n.ch+l.ch):B(l.line+(e.line-n.line),e.ch)}function jp(e,n,l){for(var o=[],a=B(e.first,0),c=a,g=0;g<n.length;g++){var m=n[g],b=of(m.from,a,c),w=of(ki(m),a,c);if(a=m.to,c=w,l=="around"){var C=e.sel.ranges[g],k=it(C.head,C.anchor)<0;o[g]=new ft(k?w:b,k?b:w)}else o[g]=new ft(b,b)}return new Me(o,e.sel.primIndex)}function ml(e){e.doc.mode=Bo(e.options,e.doc.modeOption),vr(e)}function vr(e){e.doc.iter(function(n){n.stateAfter&&(n.stateAfter=null),n.styles&&(n.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,gr(e,100),e.state.modeGen++,e.curOp&&fe(e)}function lf(e,n){return n.from.ch==0&&n.to.ch==0&&ct(n.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function vl(e,n,l,o){function a(F){return l?l[F]:null}function c(F,W,U){np(F,W,U,o),zt(F,"change",F,n)}function g(F,W){for(var U=[],Z=F;Z<W;++Z)U.push(new mn(w[Z],a(Z),o));return U}var m=n.from,b=n.to,w=n.text,C=X(e,m.line),k=X(e,b.line),L=ct(w),T=a(w.length-1),O=b.line-m.line;if(n.full)e.insert(0,g(0,w.length)),e.remove(w.length,e.size-w.length);else if(lf(e,n)){var E=g(0,w.length-1);c(k,k.text,T),O&&e.remove(m.line,O),E.length&&e.insert(m.line,E)}else if(C==k)if(w.length==1)c(C,C.text.slice(0,m.ch)+L+C.text.slice(b.ch),T);else{var R=g(1,w.length-1);R.push(new mn(L+C.text.slice(b.ch),T,o)),c(C,C.text.slice(0,m.ch)+w[0],a(0)),e.insert(m.line+1,R)}else if(w.length==1)c(C,C.text.slice(0,m.ch)+w[0]+k.text.slice(b.ch),a(0)),e.remove(m.line+1,O);else{c(C,C.text.slice(0,m.ch)+w[0],a(0)),c(k,L+k.text.slice(b.ch),T);var I=g(1,w.length-1);O>1&&e.remove(m.line+1,O-1),e.insert(m.line+1,I)}zt(e,"change",e,n)}function Ai(e,n,l){function o(a,c,g){if(a.linked)for(var m=0;m<a.linked.length;++m){var b=a.linked[m];if(b.doc!=c){var w=g&&b.sharedHist;l&&!w||(n(b.doc,w),o(b.doc,a,w))}}}o(e,null,!0)}function af(e,n){if(n.cm)throw new Error("This document is already in use.");e.doc=n,n.cm=e,nl(e),ml(e),hf(e),e.options.direction=n.direction,e.options.lineWrapping||Yo(e),e.options.mode=n.modeOption,fe(e)}function hf(e){(e.doc.direction=="rtl"?Ge:tt)(e.display.lineDiv,"CodeMirror-rtl")}function Jp(e){be(e,function(){hf(e),fe(e)})}function Ss(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function yl(e,n){var l={from:Fo(n.from),to:ki(n),text:Ui(e,n.from,n.to)};return cf(e,l,n.from.line,n.to.line+1),Ai(e,function(o){return cf(o,l,n.from.line,n.to.line+1)},!0),l}function ff(e){for(;e.length;){var n=ct(e);if(n.ranges)e.pop();else break}}function Zp(e,n){if(n)return ff(e.done),ct(e.done);if(e.done.length&&!ct(e.done).ranges)return ct(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),ct(e.done)}function uf(e,n,l,o){var a=e.history;a.undone.length=0;var c=+new Date,g,m;if((a.lastOp==o||a.lastOrigin==n.origin&&n.origin&&(n.origin.charAt(0)=="+"&&a.lastModTime>c-(e.cm?e.cm.options.historyEventDelay:500)||n.origin.charAt(0)=="*"))&&(g=Zp(a,a.lastOp==o)))m=ct(g.changes),it(n.from,n.to)==0&&it(n.from,m.to)==0?m.to=ki(n):g.changes.push(yl(e,n));else{var b=ct(a.done);for((!b||!b.ranges)&&Cs(e.sel,a.done),g={changes:[yl(e,n)],generation:a.generation},a.done.push(g);a.done.length>a.undoDepth;)a.done.shift(),a.done[0].ranges||a.done.shift()}a.done.push(l),a.generation=++a.maxGeneration,a.lastModTime=a.lastSelTime=c,a.lastOp=a.lastSelOp=o,a.lastOrigin=a.lastSelOrigin=n.origin,m||Ot(e,"historyAdded")}function Qp(e,n,l,o){var a=n.charAt(0);return a=="*"||a=="+"&&l.ranges.length==o.ranges.length&&l.somethingSelected()==o.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function $p(e,n,l,o){var a=e.history,c=o&&o.origin;l==a.lastSelOp||c&&a.lastSelOrigin==c&&(a.lastModTime==a.lastSelTime&&a.lastOrigin==c||Qp(e,c,ct(a.done),n))?a.done[a.done.length-1]=n:Cs(n,a.done),a.lastSelTime=+new Date,a.lastSelOrigin=c,a.lastSelOp=l,o&&o.clearRedo!==!1&&ff(a.undone)}function Cs(e,n){var l=ct(n);l&&l.ranges&&l.equals(e)||n.push(e)}function cf(e,n,l,o){var a=n["spans_"+e.id],c=0;e.iter(Math.max(e.first,l),Math.min(e.first+e.size,o),function(g){g.markedSpans&&((a||(a=n["spans_"+e.id]={}))[c]=g.markedSpans),++c})}function tg(e){if(!e)return null;for(var n,l=0;l<e.length;++l)e[l].marker.explicitlyCleared?n||(n=e.slice(0,l)):n&&n.push(e[l]);return n?n.length?n:null:e}function eg(e,n){var l=n["spans_"+e.id];if(!l)return null;for(var o=[],a=0;a<n.text.length;++a)o.push(tg(l[a]));return o}function df(e,n){var l=eg(e,n),o=Uo(e,n);if(!l)return o;if(!o)return l;for(var a=0;a<l.length;++a){var c=l[a],g=o[a];if(c&&g)t:for(var m=0;m<g.length;++m){for(var b=g[m],w=0;w<c.length;++w)if(c[w].marker==b.marker)continue t;c.push(b)}else g&&(l[a]=g)}return l}function kn(e,n,l){for(var o=[],a=0;a<e.length;++a){var c=e[a];if(c.ranges){o.push(l?Me.prototype.deepCopy.call(c):c);continue}var g=c.changes,m=[];o.push({changes:m});for(var b=0;b<g.length;++b){var w=g[b],C=void 0;if(m.push({from:w.from,to:w.to,text:w.text}),n)for(var k in w)(C=k.match(/^spans_(\d+)$/))&&_t(n,Number(C[1]))>-1&&(ct(m)[k]=w[k],delete w[k])}}return o}function bl(e,n,l,o){if(o){var a=e.anchor;if(l){var c=it(n,a)<0;c!=it(l,a)<0?(a=n,n=l):c!=it(n,l)<0&&(n=l)}return new ft(a,n)}else return new ft(l||n,n)}function ks(e,n,l,o,a){a==null&&(a=e.cm&&(e.cm.display.shift||e.extend)),jt(e,new Me([bl(e.sel.primary(),n,l,a)],0),o)}function pf(e,n,l){for(var o=[],a=e.cm&&(e.cm.display.shift||e.extend),c=0;c<e.sel.ranges.length;c++)o[c]=bl(e.sel.ranges[c],n[c],null,a);var g=He(e.cm,o,e.sel.primIndex);jt(e,g,l)}function wl(e,n,l,o){var a=e.sel.ranges.slice(0);a[n]=l,jt(e,He(e.cm,a,e.sel.primIndex),o)}function gf(e,n,l,o){jt(e,Ci(n,l),o)}function ig(e,n,l){var o={ranges:n.ranges,update:function(a){this.ranges=[];for(var c=0;c<a.length;c++)this.ranges[c]=new ft(nt(e,a[c].anchor),nt(e,a[c].head))},origin:l&&l.origin};return Ot(e,"beforeSelectionChange",e,o),e.cm&&Ot(e.cm,"beforeSelectionChange",e.cm,o),o.ranges!=n.ranges?He(e.cm,o.ranges,o.ranges.length-1):n}function mf(e,n,l){var o=e.history.done,a=ct(o);a&&a.ranges?(o[o.length-1]=n,As(e,n,l)):jt(e,n,l)}function jt(e,n,l){As(e,n,l),$p(e,e.sel,e.cm?e.cm.curOp.id:NaN,l)}function As(e,n,l){(Ne(e,"beforeSelectionChange")||e.cm&&Ne(e.cm,"beforeSelectionChange"))&&(n=ig(e,n,l));var o=l&&l.bias||(it(n.primary().head,e.sel.primary().head)<0?-1:1);vf(e,bf(e,n,o,!0)),!(l&&l.scroll===!1)&&e.cm&&e.cm.getOption("readOnly")!="nocursor"&&Sn(e.cm)}function vf(e,n){n.equals(e.sel)||(e.sel=n,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,$a(e.cm)),zt(e,"cursorActivity",e))}function yf(e){vf(e,bf(e,e.sel,null,!1))}function bf(e,n,l,o){for(var a,c=0;c<n.ranges.length;c++){var g=n.ranges[c],m=n.ranges.length==e.sel.ranges.length&&e.sel.ranges[c],b=Ms(e,g.anchor,m&&m.anchor,l,o),w=g.head==g.anchor?b:Ms(e,g.head,m&&m.head,l,o);(a||b!=g.anchor||w!=g.head)&&(a||(a=n.ranges.slice(0,c)),a[c]=new ft(b,w))}return a?He(e.cm,a,n.primIndex):n}function An(e,n,l,o,a){var c=X(e,n.line);if(c.markedSpans)for(var g=0;g<c.markedSpans.length;++g){var m=c.markedSpans[g],b=m.marker,w="selectLeft"in b?!b.selectLeft:b.inclusiveLeft,C="selectRight"in b?!b.selectRight:b.inclusiveRight;if((m.from==null||(w?m.from<=n.ch:m.from<n.ch))&&(m.to==null||(C?m.to>=n.ch:m.to>n.ch))){if(a&&(Ot(b,"beforeCursorEnter"),b.explicitlyCleared))if(c.markedSpans){--g;continue}else break;if(!b.atomic)continue;if(l){var k=b.find(o<0?1:-1),L=void 0;if((o<0?C:w)&&(k=wf(e,k,-o,k&&k.line==n.line?c:null)),k&&k.line==n.line&&(L=it(k,l))&&(o<0?L<0:L>0))return An(e,k,n,o,a)}var T=b.find(o<0?-1:1);return(o<0?w:C)&&(T=wf(e,T,o,T.line==n.line?c:null)),T?An(e,T,n,o,a):null}}return n}function Ms(e,n,l,o,a){var c=o||1,g=An(e,n,l,c,a)||!a&&An(e,n,l,c,!0)||An(e,n,l,-c,a)||!a&&An(e,n,l,-c,!0);return g||(e.cantEdit=!0,B(e.first,0))}function wf(e,n,l,o){return l<0&&n.ch==0?n.line>e.first?nt(e,B(n.line-1)):null:l>0&&n.ch==(o||X(e,n.line)).text.length?n.line<e.first+e.size-1?B(n.line+1,0):null:new B(n.line,n.ch+l)}function xf(e){e.setSelection(B(e.firstLine(),0),B(e.lastLine()),Ve)}function Sf(e,n,l){var o={canceled:!1,from:n.from,to:n.to,text:n.text,origin:n.origin,cancel:function(){return o.canceled=!0}};return l&&(o.update=function(a,c,g,m){a&&(o.from=nt(e,a)),c&&(o.to=nt(e,c)),g&&(o.text=g),m!==void 0&&(o.origin=m)}),Ot(e,"beforeChange",e,o),e.cm&&Ot(e.cm,"beforeChange",e.cm,o),o.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:o.from,to:o.to,text:o.text,origin:o.origin}}function Mn(e,n,l){if(e.cm){if(!e.cm.curOp)return Kt(e.cm,Mn)(e,n,l);if(e.cm.state.suppressEdits)return}if(!((Ne(e,"beforeChange")||e.cm&&Ne(e.cm,"beforeChange"))&&(n=Sf(e,n,!0),!n))){var o=ch&&!l&&$d(e,n.from,n.to);if(o)for(var a=o.length-1;a>=0;--a)Cf(e,{from:o[a].from,to:o[a].to,text:a?[""]:n.text,origin:n.origin});else Cf(e,n)}}function Cf(e,n){if(!(n.text.length==1&&n.text[0]==""&&it(n.from,n.to)==0)){var l=gl(e,n);uf(e,n,l,e.cm?e.cm.curOp.id:NaN),yr(e,n,l,Uo(e,n));var o=[];Ai(e,function(a,c){!c&&_t(o,a.history)==-1&&(Tf(a.history,n),o.push(a.history)),yr(a,n,null,Uo(a,n))})}}function Ts(e,n,l){var o=e.cm&&e.cm.state.suppressEdits;if(!(o&&!l)){for(var a=e.history,c,g=e.sel,m=n=="undo"?a.done:a.undone,b=n=="undo"?a.undone:a.done,w=0;w<m.length&&(c=m[w],!(l?c.ranges&&!c.equals(e.sel):!c.ranges));w++);if(w!=m.length){for(a.lastOrigin=a.lastSelOrigin=null;;)if(c=m.pop(),c.ranges){if(Cs(c,b),l&&!c.equals(e.sel)){jt(e,c,{clearRedo:!1});return}g=c}else if(o){m.push(c);return}else break;var C=[];Cs(g,b),b.push({changes:C,generation:a.generation}),a.generation=c.generation||++a.maxGeneration;for(var k=Ne(e,"beforeChange")||e.cm&&Ne(e.cm,"beforeChange"),L=function(E){var R=c.changes[E];if(R.origin=n,k&&!Sf(e,R,!1))return m.length=0,{};C.push(yl(e,R));var I=E?gl(e,R):ct(m);yr(e,R,I,df(e,R)),!E&&e.cm&&e.cm.scrollIntoView({from:R.from,to:ki(R)});var F=[];Ai(e,function(W,U){!U&&_t(F,W.history)==-1&&(Tf(W.history,R),F.push(W.history)),yr(W,R,null,df(W,R))})},T=c.changes.length-1;T>=0;--T){var O=L(T);if(O)return O.v}}}}function kf(e,n){if(n!=0&&(e.first+=n,e.sel=new Me(ts(e.sel.ranges,function(a){return new ft(B(a.anchor.line+n,a.anchor.ch),B(a.head.line+n,a.head.ch))}),e.sel.primIndex),e.cm)){fe(e.cm,e.first,e.first-n,n);for(var l=e.cm.display,o=l.viewFrom;o<l.viewTo;o++)xi(e.cm,o,"gutter")}}function yr(e,n,l,o){if(e.cm&&!e.cm.curOp)return Kt(e.cm,yr)(e,n,l,o);if(n.to.line<e.first){kf(e,n.text.length-1-(n.to.line-n.from.line));return}if(!(n.from.line>e.lastLine())){if(n.from.line<e.first){var a=n.text.length-1-(e.first-n.from.line);kf(e,a),n={from:B(e.first,0),to:B(n.to.line+a,n.to.ch),text:[ct(n.text)],origin:n.origin}}var c=e.lastLine();n.to.line>c&&(n={from:n.from,to:B(c,X(e,c).text.length),text:[n.text[0]],origin:n.origin}),n.removed=Ui(e,n.from,n.to),l||(l=gl(e,n)),e.cm?ng(e.cm,n,o):vl(e,n,o),As(e,l,Ve),e.cantEdit&&Ms(e,B(e.firstLine(),0))&&(e.cantEdit=!1)}}function ng(e,n,l){var o=e.doc,a=e.display,c=n.from,g=n.to,m=!1,b=c.line;e.options.lineWrapping||(b=gt(Ie(X(o,c.line))),o.iter(b,g.line+1,function(T){if(T==a.maxLine)return m=!0,!0})),o.sel.contains(n.from,n.to)>-1&&$a(e),vl(o,n,l,Uh(e)),e.options.lineWrapping||(o.iter(b,c.line+n.text.length,function(T){var O=fs(T);O>a.maxLineLength&&(a.maxLine=T,a.maxLineLength=O,a.maxLineChanged=!0,m=!1)}),m&&(e.curOp.updateMaxLine=!0)),Yd(o,c.line),gr(e,400);var w=n.text.length-(g.line-c.line)-1;n.full?fe(e):c.line==g.line&&n.text.length==1&&!lf(e.doc,n)?xi(e,c.line,"text"):fe(e,c.line,g.line+1,w);var C=Ne(e,"changes"),k=Ne(e,"change");if(k||C){var L={from:c,to:g,text:n.text,removed:n.removed,origin:n.origin};k&&zt(e,"change",e,L),C&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(L)}e.display.selForContextMenu=null}function Tn(e,n,l,o,a){var c;o||(o=l),it(o,l)<0&&(c=[o,l],l=c[0],o=c[1]),typeof n=="string"&&(n=e.splitLines(n)),Mn(e,{from:l,to:o,text:n,origin:a})}function Af(e,n,l,o){l<e.line?e.line+=o:n<e.line&&(e.line=n,e.ch=0)}function Mf(e,n,l,o){for(var a=0;a<e.length;++a){var c=e[a],g=!0;if(c.ranges){c.copied||(c=e[a]=c.deepCopy(),c.copied=!0);for(var m=0;m<c.ranges.length;m++)Af(c.ranges[m].anchor,n,l,o),Af(c.ranges[m].head,n,l,o);continue}for(var b=0;b<c.changes.length;++b){var w=c.changes[b];if(l<w.from.line)w.from=B(w.from.line+o,w.from.ch),w.to=B(w.to.line+o,w.to.ch);else if(n<=w.to.line){g=!1;break}}g||(e.splice(0,a+1),a=0)}}function Tf(e,n){var l=n.from.line,o=n.to.line,a=n.text.length-(o-l)-1;Mf(e.done,l,o,a),Mf(e.undone,l,o,a)}function br(e,n,l,o){var a=n,c=n;return typeof n=="number"?c=X(e,nh(e,n)):a=gt(n),a==null?null:(o(c,a)&&e.cm&&xi(e.cm,a,l),c)}function wr(e){this.lines=e,this.parent=null;for(var n=0,l=0;l<e.length;++l)e[l].parent=this,n+=e[l].height;this.height=n}wr.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,n){for(var l=e,o=e+n;l<o;++l){var a=this.lines[l];this.height-=a.height,rp(a),zt(a,"delete")}this.lines.splice(e,n)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,n,l){this.height+=l,this.lines=this.lines.slice(0,e).concat(n).concat(this.lines.slice(e));for(var o=0;o<n.length;++o)n[o].parent=this},iterN:function(e,n,l){for(var o=e+n;e<o;++e)if(l(this.lines[e]))return!0}};function xr(e){this.children=e;for(var n=0,l=0,o=0;o<e.length;++o){var a=e[o];n+=a.chunkSize(),l+=a.height,a.parent=this}this.size=n,this.height=l,this.parent=null}xr.prototype={chunkSize:function(){return this.size},removeInner:function(e,n){this.size-=n;for(var l=0;l<this.children.length;++l){var o=this.children[l],a=o.chunkSize();if(e<a){var c=Math.min(n,a-e),g=o.height;if(o.removeInner(e,c),this.height-=g-o.height,a==c&&(this.children.splice(l--,1),o.parent=null),(n-=c)==0)break;e=0}else e-=a}if(this.size-n<25&&(this.children.length>1||!(this.children[0]instanceof wr))){var m=[];this.collapse(m),this.children=[new wr(m)],this.children[0].parent=this}},collapse:function(e){for(var n=0;n<this.children.length;++n)this.children[n].collapse(e)},insertInner:function(e,n,l){this.size+=n.length,this.height+=l;for(var o=0;o<this.children.length;++o){var a=this.children[o],c=a.chunkSize();if(e<=c){if(a.insertInner(e,n,l),a.lines&&a.lines.length>50){for(var g=a.lines.length%25+25,m=g;m<a.lines.length;){var b=new wr(a.lines.slice(m,m+=25));a.height-=b.height,this.children.splice(++o,0,b),b.parent=this}a.lines=a.lines.slice(0,g),this.maybeSpill()}break}e-=c}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var n=e.children.splice(e.children.length-5,5),l=new xr(n);if(e.parent){e.size-=l.size,e.height-=l.height;var a=_t(e.parent.children,e);e.parent.children.splice(a+1,0,l)}else{var o=new xr(e.children);o.parent=e,e.children=[o,l],e=o}l.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,n,l){for(var o=0;o<this.children.length;++o){var a=this.children[o],c=a.chunkSize();if(e<c){var g=Math.min(n,c-e);if(a.iterN(e,g,l))return!0;if((n-=g)==0)break;e=0}else e-=c}}};var Sr=function(e,n,l){if(l)for(var o in l)l.hasOwnProperty(o)&&(this[o]=l[o]);this.doc=e,this.node=n};Sr.prototype.clear=function(){var e=this.doc.cm,n=this.line.widgets,l=this.line,o=gt(l);if(!(o==null||!n)){for(var a=0;a<n.length;++a)n[a]==this&&n.splice(a--,1);n.length||(l.widgets=null);var c=ar(this);qe(l,Math.max(0,l.height-c)),e&&(be(e,function(){Lf(e,l,-c),xi(e,o,"widget")}),zt(e,"lineWidgetCleared",e,this,o))}},Sr.prototype.changed=function(){var e=this,n=this.height,l=this.doc.cm,o=this.line;this.height=null;var a=ar(this)-n;a&&(wi(this.doc,o)||qe(o,o.height+a),l&&be(l,function(){l.curOp.forceUpdate=!0,Lf(l,o,a),zt(l,"lineWidgetChanged",l,e,gt(o))}))},dn(Sr);function Lf(e,n,l){hi(n)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&hl(e,l)}function rg(e,n,l,o){var a=new Sr(e,l,o),c=e.cm;return c&&a.noHScroll&&(c.display.alignWidgets=!0),br(e,n,"widget",function(g){var m=g.widgets||(g.widgets=[]);if(a.insertAt==null?m.push(a):m.splice(Math.min(m.length,Math.max(0,a.insertAt)),0,a),a.line=g,c&&!wi(e,g)){var b=hi(g)<e.scrollTop;qe(g,g.height+ar(a)),b&&hl(c,a.height),c.curOp.forceUpdate=!0}return!0}),c&&zt(c,"lineWidgetAdded",c,a,typeof n=="number"?n:gt(n)),a}var Of=0,Mi=function(e,n){this.lines=[],this.type=n,this.doc=e,this.id=++Of};Mi.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,n=e&&!e.curOp;if(n&&Ji(e),Ne(this,"clear")){var l=this.find();l&&zt(this,"clear",l.from,l.to)}for(var o=null,a=null,c=0;c<this.lines.length;++c){var g=this.lines[c],m=sr(g.markedSpans,this);e&&!this.collapsed?xi(e,gt(g),"text"):e&&(m.to!=null&&(a=gt(g)),m.from!=null&&(o=gt(g))),g.markedSpans=jd(g.markedSpans,m),m.from==null&&this.collapsed&&!wi(this.doc,g)&&e&&qe(g,bn(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var b=0;b<this.lines.length;++b){var w=Ie(this.lines[b]),C=fs(w);C>e.display.maxLineLength&&(e.display.maxLine=w,e.display.maxLineLength=C,e.display.maxLineChanged=!0)}o!=null&&e&&this.collapsed&&fe(e,o,a+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&yf(e.doc)),e&&zt(e,"markerCleared",e,this,o,a),n&&Zi(e),this.parent&&this.parent.clear()}},Mi.prototype.find=function(e,n){e==null&&this.type=="bookmark"&&(e=1);for(var l,o,a=0;a<this.lines.length;++a){var c=this.lines[a],g=sr(c.markedSpans,this);if(g.from!=null&&(l=B(n?c:gt(c),g.from),e==-1))return l;if(g.to!=null&&(o=B(n?c:gt(c),g.to),e==1))return o}return l&&{from:l,to:o}},Mi.prototype.changed=function(){var e=this,n=this.find(-1,!0),l=this,o=this.doc.cm;!n||!o||be(o,function(){var a=n.line,c=gt(n.line),g=Jo(o,c);if(g&&(Bh(g),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,!wi(l.doc,a)&&l.height!=null){var m=l.height;l.height=null;var b=ar(l)-m;b&&qe(a,a.height+b)}zt(o,"markerChanged",o,e)})},Mi.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var n=this.doc.cm.curOp;(!n.maybeHiddenMarkers||_t(n.maybeHiddenMarkers,this)==-1)&&(n.maybeUnhiddenMarkers||(n.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Mi.prototype.detachLine=function(e){if(this.lines.splice(_t(this.lines,e),1),!this.lines.length&&this.doc.cm){var n=this.doc.cm.curOp;(n.maybeHiddenMarkers||(n.maybeHiddenMarkers=[])).push(this)}},dn(Mi);function Ln(e,n,l,o,a){if(o&&o.shared)return sg(e,n,l,o,a);if(e.cm&&!e.cm.curOp)return Kt(e.cm,Ln)(e,n,l,o,a);var c=new Mi(e,a),g=it(n,l);if(o&&zi(o,c,!1),g>0||g==0&&c.clearWhenEmpty!==!1)return c;if(c.replacedWith&&(c.collapsed=!0,c.widgetNode=ae("span",[c.replacedWith],"CodeMirror-widget"),o.handleMouseEvents||c.widgetNode.setAttribute("cm-ignore-events","true"),o.insertLeft&&(c.widgetNode.insertLeft=!0)),c.collapsed){if(yh(e,n.line,n,l,c)||n.line!=l.line&&yh(e,l.line,n,l,c))throw new Error("Inserting collapsed marker partially overlapping an existing one");_d()}c.addToHistory&&uf(e,{from:n,to:l,origin:"markText"},e.sel,NaN);var m=n.line,b=e.cm,w;if(e.iter(m,l.line+1,function(k){b&&c.collapsed&&!b.options.lineWrapping&&Ie(k)==b.display.maxLine&&(w=!0),c.collapsed&&m!=n.line&&qe(k,0),Jd(k,new os(c,m==n.line?n.ch:null,m==l.line?l.ch:null),e.cm&&e.cm.curOp),++m}),c.collapsed&&e.iter(n.line,l.line+1,function(k){wi(e,k)&&qe(k,0)}),c.clearOnEnter&&$(c,"beforeCursorEnter",function(){return c.clear()}),c.readOnly&&(Xd(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),c.collapsed&&(c.id=++Of,c.atomic=!0),b){if(w&&(b.curOp.updateMaxLine=!0),c.collapsed)fe(b,n.line,l.line+1);else if(c.className||c.startStyle||c.endStyle||c.css||c.attributes||c.title)for(var C=n.line;C<=l.line;C++)xi(b,C,"text");c.atomic&&yf(b.doc),zt(b,"markerAdded",b,c)}return c}var Cr=function(e,n){this.markers=e,this.primary=n;for(var l=0;l<e.length;++l)e[l].parent=this};Cr.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();zt(this,"clear")}},Cr.prototype.find=function(e,n){return this.primary.find(e,n)},dn(Cr);function sg(e,n,l,o,a){o=zi(o),o.shared=!1;var c=[Ln(e,n,l,o,a)],g=c[0],m=o.widgetNode;return Ai(e,function(b){m&&(o.widgetNode=m.cloneNode(!0)),c.push(Ln(b,nt(b,n),nt(b,l),o,a));for(var w=0;w<b.linked.length;++w)if(b.linked[w].isParent)return;g=ct(c)}),new Cr(c,g)}function Df(e){return e.findMarks(B(e.first,0),e.clipPos(B(e.lastLine())),function(n){return n.parent})}function og(e,n){for(var l=0;l<n.length;l++){var o=n[l],a=o.find(),c=e.clipPos(a.from),g=e.clipPos(a.to);if(it(c,g)){var m=Ln(e,c,g,o.primary,o.primary.type);o.markers.push(m),m.parent=o}}}function lg(e){for(var n=function(o){var a=e[o],c=[a.primary.doc];Ai(a.primary.doc,function(b){return c.push(b)});for(var g=0;g<a.markers.length;g++){var m=a.markers[g];_t(c,m.doc)==-1&&(m.parent=null,a.markers.splice(g--,1))}},l=0;l<e.length;l++)n(l)}var ag=0,ue=function(e,n,l,o,a){if(!(this instanceof ue))return new ue(e,n,l,o,a);l==null&&(l=0),xr.call(this,[new wr([new mn("",null)])]),this.first=l,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=l;var c=B(l,0);this.sel=Ci(c),this.history=new Ss(null),this.id=++ag,this.modeOption=n,this.lineSep=o,this.direction=a=="rtl"?"rtl":"ltr",this.extend=!1,typeof e=="string"&&(e=this.splitLines(e)),vl(this,{from:c,to:c,text:e}),jt(this,Ci(c),Ve)};ue.prototype=ja(xr.prototype,{constructor:ue,iter:function(e,n,l){l?this.iterN(e-this.first,n-e,l):this.iterN(this.first,this.first+this.size,e)},insert:function(e,n){for(var l=0,o=0;o<n.length;++o)l+=n[o].height;this.insertInner(e-this.first,n,l)},remove:function(e,n){this.removeInner(e-this.first,n)},getValue:function(e){var n=Io(this,this.first,this.first+this.size);return e===!1?n:n.join(e||this.lineSeparator())},setValue:Ut(function(e){var n=B(this.first,0),l=this.first+this.size-1;Mn(this,{from:n,to:B(l,X(this,l).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&ur(this.cm,0,0),jt(this,Ci(n),Ve)}),replaceRange:function(e,n,l,o){n=nt(this,n),l=l?nt(this,l):n,Tn(this,e,n,l,o)},getRange:function(e,n,l){var o=Ui(this,nt(this,e),nt(this,n));return l===!1?o:l===""?o.join(""):o.join(l||this.lineSeparator())},getLine:function(e){var n=this.getLineHandle(e);return n&&n.text},getLineHandle:function(e){if(nr(this,e))return X(this,e)},getLineNumber:function(e){return gt(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=X(this,e)),Ie(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return nt(this,e)},getCursor:function(e){var n=this.sel.primary(),l;return e==null||e=="head"?l=n.head:e=="anchor"?l=n.anchor:e=="end"||e=="to"||e===!1?l=n.to():l=n.from(),l},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Ut(function(e,n,l){gf(this,nt(this,typeof e=="number"?B(e,n||0):e),null,l)}),setSelection:Ut(function(e,n,l){gf(this,nt(this,e),nt(this,n||e),l)}),extendSelection:Ut(function(e,n,l){ks(this,nt(this,e),n&&nt(this,n),l)}),extendSelections:Ut(function(e,n){pf(this,rh(this,e),n)}),extendSelectionsBy:Ut(function(e,n){var l=ts(this.sel.ranges,e);pf(this,rh(this,l),n)}),setSelections:Ut(function(e,n,l){if(e.length){for(var o=[],a=0;a<e.length;a++)o[a]=new ft(nt(this,e[a].anchor),nt(this,e[a].head||e[a].anchor));n==null&&(n=Math.min(e.length-1,this.sel.primIndex)),jt(this,He(this.cm,o,n),l)}}),addSelection:Ut(function(e,n,l){var o=this.sel.ranges.slice(0);o.push(new ft(nt(this,e),nt(this,n||e))),jt(this,He(this.cm,o,o.length-1),l)}),getSelection:function(e){for(var n=this.sel.ranges,l,o=0;o<n.length;o++){var a=Ui(this,n[o].from(),n[o].to());l=l?l.concat(a):a}return e===!1?l:l.join(e||this.lineSeparator())},getSelections:function(e){for(var n=[],l=this.sel.ranges,o=0;o<l.length;o++){var a=Ui(this,l[o].from(),l[o].to());e!==!1&&(a=a.join(e||this.lineSeparator())),n[o]=a}return n},replaceSelection:function(e,n,l){for(var o=[],a=0;a<this.sel.ranges.length;a++)o[a]=e;this.replaceSelections(o,n,l||"+input")},replaceSelections:Ut(function(e,n,l){for(var o=[],a=this.sel,c=0;c<a.ranges.length;c++){var g=a.ranges[c];o[c]={from:g.from(),to:g.to(),text:this.splitLines(e[c]),origin:l}}for(var m=n&&n!="end"&&jp(this,o,n),b=o.length-1;b>=0;b--)Mn(this,o[b]);m?mf(this,m):this.cm&&Sn(this.cm)}),undo:Ut(function(){Ts(this,"undo")}),redo:Ut(function(){Ts(this,"redo")}),undoSelection:Ut(function(){Ts(this,"undo",!0)}),redoSelection:Ut(function(){Ts(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,n=0,l=0,o=0;o<e.done.length;o++)e.done[o].ranges||++n;for(var a=0;a<e.undone.length;a++)e.undone[a].ranges||++l;return{undo:n,redo:l}},clearHistory:function(){var e=this;this.history=new Ss(this.history),Ai(this,function(n){return n.history=e.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:kn(this.history.done),undone:kn(this.history.undone)}},setHistory:function(e){var n=this.history=new Ss(this.history);n.done=kn(e.done.slice(0),null,!0),n.undone=kn(e.undone.slice(0),null,!0)},setGutterMarker:Ut(function(e,n,l){return br(this,e,"gutter",function(o){var a=o.gutterMarkers||(o.gutterMarkers={});return a[n]=l,!l&&Ja(a)&&(o.gutterMarkers=null),!0})}),clearGutter:Ut(function(e){var n=this;this.iter(function(l){l.gutterMarkers&&l.gutterMarkers[e]&&br(n,l,"gutter",function(){return l.gutterMarkers[e]=null,Ja(l.gutterMarkers)&&(l.gutterMarkers=null),!0})})}),lineInfo:function(e){var n;if(typeof e=="number"){if(!nr(this,e)||(n=e,e=X(this,e),!e))return null}else if(n=gt(e),n==null)return null;return{line:n,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Ut(function(e,n,l){return br(this,e,n=="gutter"?"gutter":"class",function(o){var a=n=="text"?"textClass":n=="background"?"bgClass":n=="gutter"?"gutterClass":"wrapClass";if(!o[a])o[a]=l;else{if(ot(l).test(o[a]))return!1;o[a]+=" "+l}return!0})}),removeLineClass:Ut(function(e,n,l){return br(this,e,n=="gutter"?"gutter":"class",function(o){var a=n=="text"?"textClass":n=="background"?"bgClass":n=="gutter"?"gutterClass":"wrapClass",c=o[a];if(c)if(l==null)o[a]=null;else{var g=c.match(ot(l));if(!g)return!1;var m=g.index+g[0].length;o[a]=c.slice(0,g.index)+(!g.index||m==c.length?"":" ")+c.slice(m)||null}else return!1;return!0})}),addLineWidget:Ut(function(e,n,l){return rg(this,e,n,l)}),removeLineWidget:function(e){e.clear()},markText:function(e,n,l){return Ln(this,nt(this,e),nt(this,n),l,l&&l.type||"range")},setBookmark:function(e,n){var l={replacedWith:n&&(n.nodeType==null?n.widget:n),insertLeft:n&&n.insertLeft,clearWhenEmpty:!1,shared:n&&n.shared,handleMouseEvents:n&&n.handleMouseEvents};return e=nt(this,e),Ln(this,e,e,l,"bookmark")},findMarksAt:function(e){e=nt(this,e);var n=[],l=X(this,e.line).markedSpans;if(l)for(var o=0;o<l.length;++o){var a=l[o];(a.from==null||a.from<=e.ch)&&(a.to==null||a.to>=e.ch)&&n.push(a.marker.parent||a.marker)}return n},findMarks:function(e,n,l){e=nt(this,e),n=nt(this,n);var o=[],a=e.line;return this.iter(e.line,n.line+1,function(c){var g=c.markedSpans;if(g)for(var m=0;m<g.length;m++){var b=g[m];!(b.to!=null&&a==e.line&&e.ch>=b.to||b.from==null&&a!=e.line||b.from!=null&&a==n.line&&b.from>=n.ch)&&(!l||l(b.marker))&&o.push(b.marker.parent||b.marker)}++a}),o},getAllMarks:function(){var e=[];return this.iter(function(n){var l=n.markedSpans;if(l)for(var o=0;o<l.length;++o)l[o].from!=null&&e.push(l[o].marker)}),e},posFromIndex:function(e){var n,l=this.first,o=this.lineSeparator().length;return this.iter(function(a){var c=a.text.length+o;if(c>e)return n=e,!0;e-=c,++l}),nt(this,B(l,n))},indexFromPos:function(e){e=nt(this,e);var n=e.ch;if(e.line<this.first||e.ch<0)return 0;var l=this.lineSeparator().length;return this.iter(this.first,e.line,function(o){n+=o.text.length+l}),n},copy:function(e){var n=new ue(Io(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return n.scrollTop=this.scrollTop,n.scrollLeft=this.scrollLeft,n.sel=this.sel,n.extend=!1,e&&(n.history.undoDepth=this.history.undoDepth,n.setHistory(this.getHistory())),n},linkedDoc:function(e){e||(e={});var n=this.first,l=this.first+this.size;e.from!=null&&e.from>n&&(n=e.from),e.to!=null&&e.to<l&&(l=e.to);var o=new ue(Io(this,n,l),e.mode||this.modeOption,n,this.lineSep,this.direction);return e.sharedHist&&(o.history=this.history),(this.linked||(this.linked=[])).push({doc:o,sharedHist:e.sharedHist}),o.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],og(o,Df(this)),o},unlinkDoc:function(e){if(e instanceof Ct&&(e=e.doc),this.linked)for(var n=0;n<this.linked.length;++n){var l=this.linked[n];if(l.doc==e){this.linked.splice(n,1),e.unlinkDoc(this),lg(Df(this));break}}if(e.history==this.history){var o=[e.id];Ai(e,function(a){return o.push(a.id)},!0),e.history=new Ss(null),e.history.done=kn(this.history.done,o),e.history.undone=kn(this.history.undone,o)}},iterLinkedDocs:function(e){Ai(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):No(e)},lineSeparator:function(){return this.lineSep||`
`},setDirection:Ut(function(e){e!="rtl"&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(n){return n.order=null}),this.cm&&Jp(this.cm))})}),ue.prototype.eachLine=ue.prototype.iter;var Nf=0;function hg(e){var n=this;if(Pf(n),!(Ft(n,e)||fi(n.display,e))){he(e),p&&(Nf=+new Date);var l=Yi(n,e,!0),o=e.dataTransfer.files;if(!(!l||n.isReadOnly()))if(o&&o.length&&window.FileReader&&window.File)for(var a=o.length,c=Array(a),g=0,m=function(){++g==a&&Kt(n,function(){l=nt(n.doc,l);var T={from:l,to:l,text:n.doc.splitLines(c.filter(function(O){return O!=null}).join(n.doc.lineSeparator())),origin:"paste"};Mn(n.doc,T),mf(n.doc,Ci(nt(n.doc,l),nt(n.doc,ki(T))))})()},b=function(T,O){if(n.options.allowDropFileTypes&&_t(n.options.allowDropFileTypes,T.type)==-1){m();return}var E=new FileReader;E.onerror=function(){return m()},E.onload=function(){var R=E.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(R)){m();return}c[O]=R,m()},E.readAsText(T)},w=0;w<o.length;w++)b(o[w],w);else{if(n.state.draggingText&&n.doc.sel.contains(l)>-1){n.state.draggingText(e),setTimeout(function(){return n.display.input.focus()},20);return}try{var C=e.dataTransfer.getData("Text");if(C){var k;if(n.state.draggingText&&!n.state.draggingText.copy&&(k=n.listSelections()),As(n.doc,Ci(l,l)),k)for(var L=0;L<k.length;++L)Tn(n.doc,"",k[L].anchor,k[L].head,"drag");n.replaceSelection(C,"around","paste"),n.display.input.focus()}}catch{}}}}function fg(e,n){if(p&&(!e.state.draggingText||+new Date-Nf<100)){ir(n);return}if(!(Ft(e,n)||fi(e.display,n))&&(n.dataTransfer.setData("Text",e.getSelection()),n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setDragImage&&!D)){var l=G("img",null,null,"position: fixed; left: 0; top: 0;");l.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",M&&(l.width=l.height=1,e.display.wrapper.appendChild(l),l._top=l.offsetTop),n.dataTransfer.setDragImage(l,0,0),M&&l.parentNode.removeChild(l)}}function ug(e,n){var l=Yi(e,n);if(l){var o=document.createDocumentFragment();rl(e,l,o),e.display.dragCursor||(e.display.dragCursor=G("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),lt(e.display.dragCursor,o)}}function Pf(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Ef(e){if(document.getElementsByClassName){for(var n=document.getElementsByClassName("CodeMirror"),l=[],o=0;o<n.length;o++){var a=n[o].CodeMirror;a&&l.push(a)}l.length&&l[0].operation(function(){for(var c=0;c<l.length;c++)e(l[c])})}}var Bf=!1;function cg(){Bf||(dg(),Bf=!0)}function dg(){var e;$(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,Ef(pg)},100))}),$(window,"blur",function(){return Ef(xn)})}function pg(e){var n=e.display;n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.scrollbarsClipped=!1,e.setSize()}for(var Ti={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},kr=0;kr<10;kr++)Ti[kr+48]=Ti[kr+96]=String(kr);for(var Ls=65;Ls<=90;Ls++)Ti[Ls]=String.fromCharCode(Ls);for(var Ar=1;Ar<=12;Ar++)Ti[Ar+111]=Ti[Ar+63235]="F"+Ar;var ci={};ci.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ci.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ci.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},ci.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ci.default=q?ci.macDefault:ci.pcDefault;function gg(e){var n=e.split(/-(?!$)/);e=n[n.length-1];for(var l,o,a,c,g=0;g<n.length-1;g++){var m=n[g];if(/^(cmd|meta|m)$/i.test(m))c=!0;else if(/^a(lt)?$/i.test(m))l=!0;else if(/^(c|ctrl|control)$/i.test(m))o=!0;else if(/^s(hift)?$/i.test(m))a=!0;else throw new Error("Unrecognized modifier name: "+m)}return l&&(e="Alt-"+e),o&&(e="Ctrl-"+e),c&&(e="Cmd-"+e),a&&(e="Shift-"+e),e}function mg(e){var n={};for(var l in e)if(e.hasOwnProperty(l)){var o=e[l];if(/^(name|fallthrough|(de|at)tach)$/.test(l))continue;if(o=="..."){delete e[l];continue}for(var a=ts(l.split(" "),gg),c=0;c<a.length;c++){var g=void 0,m=void 0;c==a.length-1?(m=a.join(" "),g=o):(m=a.slice(0,c+1).join(" "),g="...");var b=n[m];if(!b)n[m]=g;else if(b!=g)throw new Error("Inconsistent bindings for "+m)}delete e[l]}for(var w in n)e[w]=n[w];return e}function On(e,n,l,o){n=Os(n);var a=n.call?n.call(e,o):n[e];if(a===!1)return"nothing";if(a==="...")return"multi";if(a!=null&&l(a))return"handled";if(n.fallthrough){if(Object.prototype.toString.call(n.fallthrough)!="[object Array]")return On(e,n.fallthrough,l,o);for(var c=0;c<n.fallthrough.length;c++){var g=On(e,n.fallthrough[c],l,o);if(g)return g}}}function Rf(e){var n=typeof e=="string"?e:Ti[e.keyCode];return n=="Ctrl"||n=="Alt"||n=="Shift"||n=="Mod"}function If(e,n,l){var o=e;return n.altKey&&o!="Alt"&&(e="Alt-"+e),(vt?n.metaKey:n.ctrlKey)&&o!="Ctrl"&&(e="Ctrl-"+e),(vt?n.ctrlKey:n.metaKey)&&o!="Mod"&&(e="Cmd-"+e),!l&&n.shiftKey&&o!="Shift"&&(e="Shift-"+e),e}function Wf(e,n){if(M&&e.keyCode==34&&e.char)return!1;var l=Ti[e.keyCode];return l==null||e.altGraphKey?!1:(e.keyCode==3&&e.code&&(l=e.code),If(l,e,n))}function Os(e){return typeof e=="string"?ci[e]:e}function Dn(e,n){for(var l=e.doc.sel.ranges,o=[],a=0;a<l.length;a++){for(var c=n(l[a]);o.length&&it(c.from,ct(o).to)<=0;){var g=o.pop();if(it(g.from,c.from)<0){c.from=g.from;break}}o.push(c)}be(e,function(){for(var m=o.length-1;m>=0;m--)Tn(e.doc,"",o[m].from,o[m].to,"+delete");Sn(e)})}function xl(e,n,l){var o=Za(e.text,n+l,l);return o<0||o>e.text.length?null:o}function Sl(e,n,l){var o=xl(e,n.ch,l);return o==null?null:new B(n.line,o,l<0?"after":"before")}function Cl(e,n,l,o,a){if(e){n.doc.direction=="rtl"&&(a=-a);var c=li(l,n.doc.direction);if(c){var g=a<0?ct(c):c[0],m=a<0==(g.level==1),b=m?"after":"before",w;if(g.level>0||n.doc.direction=="rtl"){var C=yn(n,l);w=a<0?l.text.length-1:0;var k=_e(n,C,w).top;w=$n(function(L){return _e(n,C,L).top==k},a<0==(g.level==1)?g.from:g.to-1,w),b=="before"&&(w=xl(l,w,1))}else w=a<0?g.to:g.from;return new B(o,w,b)}}return new B(o,a<0?l.text.length:0,a<0?"before":"after")}function vg(e,n,l,o){var a=li(n,e.doc.direction);if(!a)return Sl(n,l,o);l.ch>=n.text.length?(l.ch=n.text.length,l.sticky="before"):l.ch<=0&&(l.ch=0,l.sticky="after");var c=er(a,l.ch,l.sticky),g=a[c];if(e.doc.direction=="ltr"&&g.level%2==0&&(o>0?g.to>l.ch:g.from<l.ch))return Sl(n,l,o);var m=function(I,F){return xl(n,I instanceof B?I.ch:I,F)},b,w=function(I){return e.options.lineWrapping?(b=b||yn(e,n),Kh(e,n,b,I)):{begin:0,end:n.text.length}},C=w(l.sticky=="before"?m(l,-1):l.ch);if(e.doc.direction=="rtl"||g.level==1){var k=g.level==1==o<0,L=m(l,k?1:-1);if(L!=null&&(k?L<=g.to&&L<=C.end:L>=g.from&&L>=C.begin)){var T=k?"before":"after";return new B(l.line,L,T)}}var O=function(I,F,W){for(var U=function(yt,Gt){return Gt?new B(l.line,m(yt,1),"before"):new B(l.line,yt,"after")};I>=0&&I<a.length;I+=F){var Z=a[I],_=F>0==(Z.level!=1),rt=_?W.begin:m(W.end,-1);if(Z.from<=rt&&rt<Z.to||(rt=_?Z.from:m(Z.to,-1),W.begin<=rt&&rt<W.end))return U(rt,_)}},E=O(c+o,o,C);if(E)return E;var R=o>0?C.end:m(C.begin,-1);return R!=null&&!(o>0&&R==n.text.length)&&(E=O(o>0?0:a.length-1,o,w(R)),E)?E:null}var Mr={selectAll:xf,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Ve)},killLine:function(e){return Dn(e,function(n){if(n.empty()){var l=X(e.doc,n.head.line).text.length;return n.head.ch==l&&n.head.line<e.lastLine()?{from:n.head,to:B(n.head.line+1,0)}:{from:n.head,to:B(n.head.line,l)}}else return{from:n.from(),to:n.to()}})},deleteLine:function(e){return Dn(e,function(n){return{from:B(n.from().line,0),to:nt(e.doc,B(n.to().line+1,0))}})},delLineLeft:function(e){return Dn(e,function(n){return{from:B(n.from().line,0),to:n.from()}})},delWrappedLineLeft:function(e){return Dn(e,function(n){var l=e.charCoords(n.head,"div").top+5,o=e.coordsChar({left:0,top:l},"div");return{from:o,to:n.from()}})},delWrappedLineRight:function(e){return Dn(e,function(n){var l=e.charCoords(n.head,"div").top+5,o=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:l},"div");return{from:n.from(),to:o}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(B(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(B(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(n){return Hf(e,n.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(n){return Ff(e,n.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(n){return yg(e,n.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(n){var l=e.cursorCoords(n.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:l},"div")},Qn)},goLineLeft:function(e){return e.extendSelectionsBy(function(n){var l=e.cursorCoords(n.head,"div").top+5;return e.coordsChar({left:0,top:l},"div")},Qn)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(n){var l=e.cursorCoords(n.head,"div").top+5,o=e.coordsChar({left:0,top:l},"div");return o.ch<e.getLine(o.line).search(/\S/)?Ff(e,n.head):o},Qn)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("	")},insertSoftTab:function(e){for(var n=[],l=e.listSelections(),o=e.options.tabSize,a=0;a<l.length;a++){var c=l[a].from(),g=De(e.getLine(c.line),c.ch,o);n.push(Co(o-g%o))}e.replaceSelections(n)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return be(e,function(){for(var n=e.listSelections(),l=[],o=0;o<n.length;o++)if(n[o].empty()){var a=n[o].head,c=X(e.doc,a.line).text;if(c){if(a.ch==c.length&&(a=new B(a.line,a.ch-1)),a.ch>0)a=new B(a.line,a.ch+1),e.replaceRange(c.charAt(a.ch-1)+c.charAt(a.ch-2),B(a.line,a.ch-2),a,"+transpose");else if(a.line>e.doc.first){var g=X(e.doc,a.line-1).text;g&&(a=new B(a.line,1),e.replaceRange(c.charAt(0)+e.doc.lineSeparator()+g.charAt(g.length-1),B(a.line-1,g.length-1),a,"+transpose"))}}l.push(new ft(a,a))}e.setSelections(l)})},newlineAndIndent:function(e){return be(e,function(){for(var n=e.listSelections(),l=n.length-1;l>=0;l--)e.replaceRange(e.doc.lineSeparator(),n[l].anchor,n[l].head,"+input");n=e.listSelections();for(var o=0;o<n.length;o++)e.indentLine(n[o].from().line,null,!0);Sn(e)})},openLine:function(e){return e.replaceSelection(`
`,"start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Hf(e,n){var l=X(e.doc,n),o=Ie(l);return o!=l&&(n=gt(o)),Cl(!0,e,o,n,1)}function yg(e,n){var l=X(e.doc,n),o=ep(l);return o!=l&&(n=gt(o)),Cl(!0,e,l,n,-1)}function Ff(e,n){var l=Hf(e,n.line),o=X(e.doc,l.line),a=li(o,e.doc.direction);if(!a||a[0].level==0){var c=Math.max(l.ch,o.text.search(/\S/)),g=n.line==l.line&&n.ch<=c&&n.ch;return B(l.line,g?0:c,l.sticky)}return l}function Ds(e,n,l){if(typeof n=="string"&&(n=Mr[n],!n))return!1;e.display.input.ensurePolled();var o=e.display.shift,a=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),l&&(e.display.shift=!1),a=n(e)!=Qr}finally{e.display.shift=o,e.state.suppressEdits=!1}return a}function bg(e,n,l){for(var o=0;o<e.state.keyMaps.length;o++){var a=On(n,e.state.keyMaps[o],l,e);if(a)return a}return e.options.extraKeys&&On(n,e.options.extraKeys,l,e)||On(n,e.options.keyMap,l,e)}var wg=new bi;function Tr(e,n,l,o){var a=e.state.keySeq;if(a){if(Rf(n))return"handled";if(/\'$/.test(n)?e.state.keySeq=null:wg.set(50,function(){e.state.keySeq==a&&(e.state.keySeq=null,e.display.input.reset())}),zf(e,a+" "+n,l,o))return!0}return zf(e,n,l,o)}function zf(e,n,l,o){var a=bg(e,n,o);return a=="multi"&&(e.state.keySeq=n),a=="handled"&&zt(e,"keyHandled",e,n,l),(a=="handled"||a=="multi")&&(he(l),sl(e)),!!a}function Kf(e,n){var l=Wf(n,!0);return l?n.shiftKey&&!e.state.keySeq?Tr(e,"Shift-"+l,n,function(o){return Ds(e,o,!0)})||Tr(e,l,n,function(o){if(typeof o=="string"?/^go[A-Z]/.test(o):o.motion)return Ds(e,o)}):Tr(e,l,n,function(o){return Ds(e,o)}):!1}function xg(e,n,l){return Tr(e,"'"+l+"'",n,function(o){return Ds(e,o,!0)})}var kl=null;function Uf(e){var n=this;if(!(e.target&&e.target!=n.display.input.getField())&&(n.curOp.focus=Bt(ve(n)),!Ft(n,e))){p&&v<11&&e.keyCode==27&&(e.returnValue=!1);var l=e.keyCode;n.display.shift=l==16||e.shiftKey;var o=Kf(n,e);M&&(kl=o?l:null,!o&&l==88&&!Fd&&(q?e.metaKey:e.ctrlKey)&&n.replaceSelection("",null,"cut")),s&&!q&&!o&&l==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),l==18&&!/\bCodeMirror-crosshair\b/.test(n.display.lineDiv.className)&&Sg(n)}}function Sg(e){var n=e.display.lineDiv;Ge(n,"CodeMirror-crosshair");function l(o){(o.keyCode==18||!o.altKey)&&(tt(n,"CodeMirror-crosshair"),Ae(document,"keyup",l),Ae(document,"mouseover",l))}$(document,"keyup",l),$(document,"mouseover",l)}function Gf(e){e.keyCode==16&&(this.doc.sel.shift=!1),Ft(this,e)}function Vf(e){var n=this;if(!(e.target&&e.target!=n.display.input.getField())&&!(fi(n.display,e)||Ft(n,e)||e.ctrlKey&&!e.altKey||q&&e.metaKey)){var l=e.keyCode,o=e.charCode;if(M&&l==kl){kl=null,he(e);return}if(!(M&&(!e.which||e.which<10)&&Kf(n,e))){var a=String.fromCharCode(o??l);a!="\b"&&(xg(n,e,a)||n.display.input.onKeyPress(e))}}}var Cg=400,Al=function(e,n,l){this.time=e,this.pos=n,this.button=l};Al.prototype.compare=function(e,n,l){return this.time+Cg>e&&it(n,this.pos)==0&&l==this.button};var Lr,Or;function kg(e,n){var l=+new Date;return Or&&Or.compare(l,e,n)?(Lr=Or=null,"triple"):Lr&&Lr.compare(l,e,n)?(Or=new Al(l,e,n),Lr=null,"double"):(Lr=new Al(l,e,n),Or=null,"single")}function qf(e){var n=this,l=n.display;if(!(Ft(n,e)||l.activeTouch&&l.input.supportsTouch())){if(l.input.ensurePolled(),l.shift=e.shiftKey,fi(l,e)){y||(l.scroller.draggable=!1,setTimeout(function(){return l.scroller.draggable=!0},100));return}if(!Ml(n,e)){var o=Yi(n,e),a=eh(e),c=o?kg(o,a):"single";oi(n).focus(),a==1&&n.state.selectingText&&n.state.selectingText(e),!(o&&Ag(n,a,o,c,e))&&(a==1?o?Tg(n,o,c,e):Lo(e)==l.scroller&&he(e):a==2?(o&&ks(n.doc,o),setTimeout(function(){return l.input.focus()},20)):a==3&&(St?n.display.input.onContextMenu(e):ol(n)))}}}function Ag(e,n,l,o,a){var c="Click";return o=="double"?c="Double"+c:o=="triple"&&(c="Triple"+c),c=(n==1?"Left":n==2?"Middle":"Right")+c,Tr(e,If(c,a),a,function(g){if(typeof g=="string"&&(g=Mr[g]),!g)return!1;var m=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),m=g(e,l)!=Qr}finally{e.state.suppressEdits=!1}return m})}function Mg(e,n,l){var o=e.getOption("configureMouse"),a=o?o(e,n,l):{};if(a.unit==null){var c=et?l.shiftKey&&l.metaKey:l.altKey;a.unit=c?"rectangle":n=="single"?"char":n=="double"?"word":"line"}return(a.extend==null||e.doc.extend)&&(a.extend=e.doc.extend||l.shiftKey),a.addNew==null&&(a.addNew=q?l.metaKey:l.ctrlKey),a.moveOnDrag==null&&(a.moveOnDrag=!(q?l.altKey:l.ctrlKey)),a}function Tg(e,n,l,o){p?setTimeout(cn(qh,e),0):e.curOp.focus=Bt(ve(e));var a=Mg(e,l,o),c=e.doc.sel,g;e.options.dragDrop&&Rd&&!e.isReadOnly()&&l=="single"&&(g=c.contains(n))>-1&&(it((g=c.ranges[g]).from(),n)<0||n.xRel>0)&&(it(g.to(),n)>0||n.xRel<0)?Lg(e,o,n,a):Og(e,o,n,a)}function Lg(e,n,l,o){var a=e.display,c=!1,g=Kt(e,function(w){y&&(a.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:ol(e)),Ae(a.wrapper.ownerDocument,"mouseup",g),Ae(a.wrapper.ownerDocument,"mousemove",m),Ae(a.scroller,"dragstart",b),Ae(a.scroller,"drop",g),c||(he(w),o.addNew||ks(e.doc,l,null,null,o.extend),y&&!D||p&&v==9?setTimeout(function(){a.wrapper.ownerDocument.body.focus({preventScroll:!0}),a.input.focus()},20):a.input.focus())}),m=function(w){c=c||Math.abs(n.clientX-w.clientX)+Math.abs(n.clientY-w.clientY)>=10},b=function(){return c=!0};y&&(a.scroller.draggable=!0),e.state.draggingText=g,g.copy=!o.moveOnDrag,$(a.wrapper.ownerDocument,"mouseup",g),$(a.wrapper.ownerDocument,"mousemove",m),$(a.scroller,"dragstart",b),$(a.scroller,"drop",g),e.state.delayingBlurEvent=!0,setTimeout(function(){return a.input.focus()},20),a.scroller.dragDrop&&a.scroller.dragDrop()}function Yf(e,n,l){if(l=="char")return new ft(n,n);if(l=="word")return e.findWordAt(n);if(l=="line")return new ft(B(n.line,0),nt(e.doc,B(n.line+1,0)));var o=l(e,n);return new ft(o.from,o.to)}function Og(e,n,l,o){p&&ol(e);var a=e.display,c=e.doc;he(n);var g,m,b=c.sel,w=b.ranges;if(o.addNew&&!o.extend?(m=c.sel.contains(l),m>-1?g=w[m]:g=new ft(l,l)):(g=c.sel.primary(),m=c.sel.primIndex),o.unit=="rectangle")o.addNew||(g=new ft(l,l)),l=Yi(e,n,!0,!0),m=-1;else{var C=Yf(e,l,o.unit);o.extend?g=bl(g,C.anchor,C.head,o.extend):g=C}o.addNew?m==-1?(m=w.length,jt(c,He(e,w.concat([g]),m),{scroll:!1,origin:"*mouse"})):w.length>1&&w[m].empty()&&o.unit=="char"&&!o.extend?(jt(c,He(e,w.slice(0,m).concat(w.slice(m+1)),0),{scroll:!1,origin:"*mouse"}),b=c.sel):wl(c,m,g,xo):(m=0,jt(c,new Me([g],0),xo),b=c.sel);var k=l;function L(W){if(it(k,W)!=0)if(k=W,o.unit=="rectangle"){for(var U=[],Z=e.options.tabSize,_=De(X(c,l.line).text,l.ch,Z),rt=De(X(c,W.line).text,W.ch,Z),yt=Math.min(_,rt),Gt=Math.max(_,rt),Mt=Math.min(l.line,W.line),we=Math.min(e.lastLine(),Math.max(l.line,W.line));Mt<=we;Mt++){var ce=X(c,Mt).text,Nt=So(ce,yt,Z);yt==Gt?U.push(new ft(B(Mt,Nt),B(Mt,Nt))):ce.length>Nt&&U.push(new ft(B(Mt,Nt),B(Mt,So(ce,Gt,Z))))}U.length||U.push(new ft(l,l)),jt(c,He(e,b.ranges.slice(0,m).concat(U),m),{origin:"*mouse",scroll:!1}),e.scrollIntoView(W)}else{var de=g,Yt=Yf(e,W,o.unit),Rt=de.anchor,Pt;it(Yt.anchor,Rt)>0?(Pt=Yt.head,Rt=rs(de.from(),Yt.anchor)):(Pt=Yt.anchor,Rt=ns(de.to(),Yt.head));var Tt=b.ranges.slice(0);Tt[m]=Dg(e,new ft(nt(c,Rt),Pt)),jt(c,He(e,Tt,m),xo)}}var T=a.wrapper.getBoundingClientRect(),O=0;function E(W){var U=++O,Z=Yi(e,W,!0,o.unit=="rectangle");if(Z)if(it(Z,k)!=0){e.curOp.focus=Bt(ve(e)),L(Z);var _=ys(a,c);(Z.line>=_.to||Z.line<_.from)&&setTimeout(Kt(e,function(){O==U&&E(W)}),150)}else{var rt=W.clientY<T.top?-20:W.clientY>T.bottom?20:0;rt&&setTimeout(Kt(e,function(){O==U&&(a.scroller.scrollTop+=rt,E(W))}),50)}}function R(W){e.state.selectingText=!1,O=1/0,W&&(he(W),a.input.focus()),Ae(a.wrapper.ownerDocument,"mousemove",I),Ae(a.wrapper.ownerDocument,"mouseup",F),c.history.lastSelOrigin=null}var I=Kt(e,function(W){W.buttons===0||!eh(W)?R(W):E(W)}),F=Kt(e,R);e.state.selectingText=F,$(a.wrapper.ownerDocument,"mousemove",I),$(a.wrapper.ownerDocument,"mouseup",F)}function Dg(e,n){var l=n.anchor,o=n.head,a=X(e.doc,l.line);if(it(l,o)==0&&l.sticky==o.sticky)return n;var c=li(a);if(!c)return n;var g=er(c,l.ch,l.sticky),m=c[g];if(m.from!=l.ch&&m.to!=l.ch)return n;var b=g+(m.from==l.ch==(m.level!=1)?0:1);if(b==0||b==c.length)return n;var w;if(o.line!=l.line)w=(o.line-l.line)*(e.doc.direction=="ltr"?1:-1)>0;else{var C=er(c,o.ch,o.sticky),k=C-g||(o.ch-l.ch)*(m.level==1?-1:1);C==b-1||C==b?w=k<0:w=k>0}var L=c[b+(w?-1:0)],T=w==(L.level==1),O=T?L.from:L.to,E=T?"after":"before";return l.ch==O&&l.sticky==E?n:new ft(new B(l.line,O,E),o)}function Xf(e,n,l,o){var a,c;if(n.touches)a=n.touches[0].clientX,c=n.touches[0].clientY;else try{a=n.clientX,c=n.clientY}catch{return!1}if(a>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;o&&he(n);var g=e.display,m=g.lineDiv.getBoundingClientRect();if(c>m.bottom||!Ne(e,l))return To(n);c-=m.top-g.viewOffset;for(var b=0;b<e.display.gutterSpecs.length;++b){var w=g.gutters.childNodes[b];if(w&&w.getBoundingClientRect().right>=a){var C=Gi(e.doc,c),k=e.display.gutterSpecs[b];return Ot(e,l,e,C,k.className,n),To(n)}}}function Ml(e,n){return Xf(e,n,"gutterClick",!0)}function _f(e,n){fi(e.display,n)||Ng(e,n)||Ft(e,n,"contextmenu")||St||e.display.input.onContextMenu(n)}function Ng(e,n){return Ne(e,"gutterContextMenu")?Xf(e,n,"gutterContextMenu",!1):!1}function jf(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),hr(e)}var Nn={toString:function(){return"CodeMirror.Init"}},Jf={},Ns={};function Pg(e){var n=e.optionHandlers;function l(o,a,c,g){e.defaults[o]=a,c&&(n[o]=g?function(m,b,w){w!=Nn&&c(m,b,w)}:c)}e.defineOption=l,e.Init=Nn,l("value","",function(o,a){return o.setValue(a)},!0),l("mode",null,function(o,a){o.doc.modeOption=a,ml(o)},!0),l("indentUnit",2,ml,!0),l("indentWithTabs",!1),l("smartIndent",!0),l("tabSize",4,function(o){vr(o),hr(o),fe(o)},!0),l("lineSeparator",null,function(o,a){if(o.doc.lineSep=a,!!a){var c=[],g=o.doc.first;o.doc.iter(function(b){for(var w=0;;){var C=b.text.indexOf(a,w);if(C==-1)break;w=C+a.length,c.push(B(g,C))}g++});for(var m=c.length-1;m>=0;m--)Tn(o.doc,a,c[m],B(c[m].line,c[m].ch+a.length))}}),l("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,function(o,a,c){o.state.specialChars=new RegExp(a.source+(a.test("	")?"":"|	"),"g"),c!=Nn&&o.refresh()}),l("specialCharPlaceholder",lp,function(o){return o.refresh()},!0),l("electricChars",!0),l("inputStyle",J?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),l("spellcheck",!1,function(o,a){return o.getInputField().spellcheck=a},!0),l("autocorrect",!1,function(o,a){return o.getInputField().autocorrect=a},!0),l("autocapitalize",!1,function(o,a){return o.getInputField().autocapitalize=a},!0),l("rtlMoveVisually",!Q),l("wholeLineUpdateBefore",!0),l("theme","default",function(o){jf(o),mr(o)},!0),l("keyMap","default",function(o,a,c){var g=Os(a),m=c!=Nn&&Os(c);m&&m.detach&&m.detach(o,g),g.attach&&g.attach(o,m||null)}),l("extraKeys",null),l("configureMouse",null),l("lineWrapping",!1,Bg,!0),l("gutters",[],function(o,a){o.display.gutterSpecs=pl(a,o.options.lineNumbers),mr(o)},!0),l("fixedGutter",!0,function(o,a){o.display.gutters.style.left=a?il(o.display)+"px":"0",o.refresh()},!0),l("coverGutterNextToScrollbar",!1,function(o){return Cn(o)},!0),l("scrollbarStyle","native",function(o){Zh(o),Cn(o),o.display.scrollbars.setScrollTop(o.doc.scrollTop),o.display.scrollbars.setScrollLeft(o.doc.scrollLeft)},!0),l("lineNumbers",!1,function(o,a){o.display.gutterSpecs=pl(o.options.gutters,a),mr(o)},!0),l("firstLineNumber",1,mr,!0),l("lineNumberFormatter",function(o){return o},mr,!0),l("showCursorWhenSelecting",!1,fr,!0),l("resetSelectionOnContextMenu",!0),l("lineWiseCopyCut",!0),l("pasteLinesPerSelection",!0),l("selectionsMayTouch",!1),l("readOnly",!1,function(o,a){a=="nocursor"&&(xn(o),o.display.input.blur()),o.display.input.readOnlyChanged(a)}),l("screenReaderLabel",null,function(o,a){a=a===""?null:a,o.display.input.screenReaderLabelChanged(a)}),l("disableInput",!1,function(o,a){a||o.display.input.reset()},!0),l("dragDrop",!0,Eg),l("allowDropFileTypes",null),l("cursorBlinkRate",530),l("cursorScrollMargin",0),l("cursorHeight",1,fr,!0),l("singleCursorHeightPerLine",!0,fr,!0),l("workTime",100),l("workDelay",100),l("flattenSpans",!0,vr,!0),l("addModeClass",!1,vr,!0),l("pollInterval",100),l("undoDepth",200,function(o,a){return o.doc.history.undoDepth=a}),l("historyEventDelay",1250),l("viewportMargin",10,function(o){return o.refresh()},!0),l("maxHighlightLength",1e4,vr,!0),l("moveInputWithCursor",!0,function(o,a){a||o.display.input.resetPosition()}),l("tabindex",null,function(o,a){return o.display.input.getField().tabIndex=a||""}),l("autofocus",null),l("direction","ltr",function(o,a){return o.doc.setDirection(a)},!0),l("phrases",null)}function Eg(e,n,l){var o=l&&l!=Nn;if(!n!=!o){var a=e.display.dragFunctions,c=n?$:Ae;c(e.display.scroller,"dragstart",a.start),c(e.display.scroller,"dragenter",a.enter),c(e.display.scroller,"dragover",a.over),c(e.display.scroller,"dragleave",a.leave),c(e.display.scroller,"drop",a.drop)}}function Bg(e){e.options.lineWrapping?(Ge(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(tt(e.display.wrapper,"CodeMirror-wrap"),Yo(e)),nl(e),fe(e),hr(e),setTimeout(function(){return Cn(e)},100)}function Ct(e,n){var l=this;if(!(this instanceof Ct))return new Ct(e,n);this.options=n=n?zi(n):{},zi(Jf,n,!1);var o=n.value;typeof o=="string"?o=new ue(o,n.mode,null,n.lineSeparator,n.direction):n.mode&&(o.modeOption=n.mode),this.doc=o;var a=new Ct.inputStyles[n.inputStyle](this),c=this.display=new Xp(e,o,a,n);c.wrapper.CodeMirror=this,jf(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Zh(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new bi,keySeq:null,specialChars:null},n.autofocus&&!J&&c.input.focus(),p&&v<11&&setTimeout(function(){return l.display.input.reset(!0)},20),Rg(this),cg(),Ji(this),this.curOp.forceUpdate=!0,af(this,o),n.autofocus&&!J||this.hasFocus()?setTimeout(function(){l.hasFocus()&&!l.state.focused&&ll(l)},20):xn(this);for(var g in Ns)Ns.hasOwnProperty(g)&&Ns[g](this,n[g],Nn);tf(this),n.finishInit&&n.finishInit(this);for(var m=0;m<Tl.length;++m)Tl[m](this);Zi(this),y&&n.lineWrapping&&getComputedStyle(c.lineDiv).textRendering=="optimizelegibility"&&(c.lineDiv.style.textRendering="auto")}Ct.defaults=Jf,Ct.optionHandlers=Ns;function Rg(e){var n=e.display;$(n.scroller,"mousedown",Kt(e,qf)),p&&v<11?$(n.scroller,"dblclick",Kt(e,function(b){if(!Ft(e,b)){var w=Yi(e,b);if(!(!w||Ml(e,b)||fi(e.display,b))){he(b);var C=e.findWordAt(w);ks(e.doc,C.anchor,C.head)}}})):$(n.scroller,"dblclick",function(b){return Ft(e,b)||he(b)}),$(n.scroller,"contextmenu",function(b){return _f(e,b)}),$(n.input.getField(),"contextmenu",function(b){n.scroller.contains(b.target)||_f(e,b)});var l,o={end:0};function a(){n.activeTouch&&(l=setTimeout(function(){return n.activeTouch=null},1e3),o=n.activeTouch,o.end=+new Date)}function c(b){if(b.touches.length!=1)return!1;var w=b.touches[0];return w.radiusX<=1&&w.radiusY<=1}function g(b,w){if(w.left==null)return!0;var C=w.left-b.left,k=w.top-b.top;return C*C+k*k>20*20}$(n.scroller,"touchstart",function(b){if(!Ft(e,b)&&!c(b)&&!Ml(e,b)){n.input.ensurePolled(),clearTimeout(l);var w=+new Date;n.activeTouch={start:w,moved:!1,prev:w-o.end<=300?o:null},b.touches.length==1&&(n.activeTouch.left=b.touches[0].pageX,n.activeTouch.top=b.touches[0].pageY)}}),$(n.scroller,"touchmove",function(){n.activeTouch&&(n.activeTouch.moved=!0)}),$(n.scroller,"touchend",function(b){var w=n.activeTouch;if(w&&!fi(n,b)&&w.left!=null&&!w.moved&&new Date-w.start<300){var C=e.coordsChar(n.activeTouch,"page"),k;!w.prev||g(w,w.prev)?k=new ft(C,C):!w.prev.prev||g(w,w.prev.prev)?k=e.findWordAt(C):k=new ft(B(C.line,0),nt(e.doc,B(C.line+1,0))),e.setSelection(k.anchor,k.head),e.focus(),he(b)}a()}),$(n.scroller,"touchcancel",a),$(n.scroller,"scroll",function(){n.scroller.clientHeight&&(cr(e,n.scroller.scrollTop),_i(e,n.scroller.scrollLeft,!0),Ot(e,"scroll",e))}),$(n.scroller,"mousewheel",function(b){return rf(e,b)}),$(n.scroller,"DOMMouseScroll",function(b){return rf(e,b)}),$(n.wrapper,"scroll",function(){return n.wrapper.scrollTop=n.wrapper.scrollLeft=0}),n.dragFunctions={enter:function(b){Ft(e,b)||ir(b)},over:function(b){Ft(e,b)||(ug(e,b),ir(b))},start:function(b){return fg(e,b)},drop:Kt(e,hg),leave:function(b){Ft(e,b)||Pf(e)}};var m=n.input.getField();$(m,"keyup",function(b){return Gf.call(e,b)}),$(m,"keydown",Kt(e,Uf)),$(m,"keypress",Kt(e,Vf)),$(m,"focus",function(b){return ll(e,b)}),$(m,"blur",function(b){return xn(e,b)})}var Tl=[];Ct.defineInitHook=function(e){return Tl.push(e)};function Dr(e,n,l,o){var a=e.doc,c;l==null&&(l="add"),l=="smart"&&(a.mode.indent?c=rr(e,n).state:l="prev");var g=e.options.tabSize,m=X(a,n),b=De(m.text,null,g);m.stateAfter&&(m.stateAfter=null);var w=m.text.match(/^\s*/)[0],C;if(!o&&!/\S/.test(m.text))C=0,l="not";else if(l=="smart"&&(C=a.mode.indent(c,m.text.slice(w.length),m.text),C==Qr||C>150)){if(!o)return;l="prev"}l=="prev"?n>a.first?C=De(X(a,n-1).text,null,g):C=0:l=="add"?C=b+e.options.indentUnit:l=="subtract"?C=b-e.options.indentUnit:typeof l=="number"&&(C=b+l),C=Math.max(0,C);var k="",L=0;if(e.options.indentWithTabs)for(var T=Math.floor(C/g);T;--T)L+=g,k+="	";if(L<C&&(k+=Co(C-L)),k!=w)return Tn(a,k,B(n,0),B(n,w.length),"+input"),m.stateAfter=null,!0;for(var O=0;O<a.sel.ranges.length;O++){var E=a.sel.ranges[O];if(E.head.line==n&&E.head.ch<w.length){var R=B(n,w.length);wl(a,O,new ft(R,R));break}}}var Fe=null;function Ps(e){Fe=e}function Ll(e,n,l,o,a){var c=e.doc;e.display.shift=!1,o||(o=c.sel);var g=+new Date-200,m=a=="paste"||e.state.pasteIncoming>g,b=No(n),w=null;if(m&&o.ranges.length>1)if(Fe&&Fe.text.join(`
`)==n){if(o.ranges.length%Fe.text.length==0){w=[];for(var C=0;C<Fe.text.length;C++)w.push(c.splitLines(Fe.text[C]))}}else b.length==o.ranges.length&&e.options.pasteLinesPerSelection&&(w=ts(b,function(I){return[I]}));for(var k=e.curOp.updateInput,L=o.ranges.length-1;L>=0;L--){var T=o.ranges[L],O=T.from(),E=T.to();T.empty()&&(l&&l>0?O=B(O.line,O.ch-l):e.state.overwrite&&!m?E=B(E.line,Math.min(X(c,E.line).text.length,E.ch+ct(b).length)):m&&Fe&&Fe.lineWise&&Fe.text.join(`
`)==b.join(`
`)&&(O=E=B(O.line,0)));var R={from:O,to:E,text:w?w[L%w.length]:b,origin:a||(m?"paste":e.state.cutIncoming>g?"cut":"+input")};Mn(e.doc,R),zt(e,"inputRead",e,R)}n&&!m&&Qf(e,n),Sn(e),e.curOp.updateInput<2&&(e.curOp.updateInput=k),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Zf(e,n){var l=e.clipboardData&&e.clipboardData.getData("Text");if(l)return e.preventDefault(),!n.isReadOnly()&&!n.options.disableInput&&n.hasFocus()&&be(n,function(){return Ll(n,l,0,null,"paste")}),!0}function Qf(e,n){if(!(!e.options.electricChars||!e.options.smartIndent))for(var l=e.doc.sel,o=l.ranges.length-1;o>=0;o--){var a=l.ranges[o];if(!(a.head.ch>100||o&&l.ranges[o-1].head.line==a.head.line)){var c=e.getModeAt(a.head),g=!1;if(c.electricChars){for(var m=0;m<c.electricChars.length;m++)if(n.indexOf(c.electricChars.charAt(m))>-1){g=Dr(e,a.head.line,"smart");break}}else c.electricInput&&c.electricInput.test(X(e.doc,a.head.line).text.slice(0,a.head.ch))&&(g=Dr(e,a.head.line,"smart"));g&&zt(e,"electricInput",e,a.head.line)}}}function $f(e){for(var n=[],l=[],o=0;o<e.doc.sel.ranges.length;o++){var a=e.doc.sel.ranges[o].head.line,c={anchor:B(a,0),head:B(a+1,0)};l.push(c),n.push(e.getRange(c.anchor,c.head))}return{text:n,ranges:l}}function Ol(e,n,l,o){e.setAttribute("autocorrect",l?"on":"off"),e.setAttribute("autocapitalize",o?"on":"off"),e.setAttribute("spellcheck",!!n)}function tu(){var e=G("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),n=G("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return y?e.style.width="1000px":e.setAttribute("wrap","off"),H&&(e.style.border="1px solid black"),n}function Ig(e){var n=e.optionHandlers,l=e.helpers={};e.prototype={constructor:e,focus:function(){oi(this).focus(),this.display.input.focus()},setOption:function(o,a){var c=this.options,g=c[o];c[o]==a&&o!="mode"||(c[o]=a,n.hasOwnProperty(o)&&Kt(this,n[o])(this,a,g),Ot(this,"optionChange",this,o))},getOption:function(o){return this.options[o]},getDoc:function(){return this.doc},addKeyMap:function(o,a){this.state.keyMaps[a?"push":"unshift"](Os(o))},removeKeyMap:function(o){for(var a=this.state.keyMaps,c=0;c<a.length;++c)if(a[c]==o||a[c].name==o)return a.splice(c,1),!0},addOverlay:ie(function(o,a){var c=o.token?o:e.getMode(this.options,o);if(c.startState)throw new Error("Overlays may not be stateful.");Dd(this.state.overlays,{mode:c,modeSpec:o,opaque:a&&a.opaque,priority:a&&a.priority||0},function(g){return g.priority}),this.state.modeGen++,fe(this)}),removeOverlay:ie(function(o){for(var a=this.state.overlays,c=0;c<a.length;++c){var g=a[c].modeSpec;if(g==o||typeof o=="string"&&g.name==o){a.splice(c,1),this.state.modeGen++,fe(this);return}}}),indentLine:ie(function(o,a,c){typeof a!="string"&&typeof a!="number"&&(a==null?a=this.options.smartIndent?"smart":"prev":a=a?"add":"subtract"),nr(this.doc,o)&&Dr(this,o,a,c)}),indentSelection:ie(function(o){for(var a=this.doc.sel.ranges,c=-1,g=0;g<a.length;g++){var m=a[g];if(m.empty())m.head.line>c&&(Dr(this,m.head.line,o,!0),c=m.head.line,g==this.doc.sel.primIndex&&Sn(this));else{var b=m.from(),w=m.to(),C=Math.max(c,b.line);c=Math.min(this.lastLine(),w.line-(w.ch?0:1))+1;for(var k=C;k<c;++k)Dr(this,k,o);var L=this.doc.sel.ranges;b.ch==0&&a.length==L.length&&L[g].from().ch>0&&wl(this.doc,g,new ft(b,L[g].to()),Ve)}}}),getTokenAt:function(o,a){return hh(this,o,a)},getLineTokens:function(o,a){return hh(this,B(o),a,!0)},getTokenTypeAt:function(o){o=nt(this.doc,o);var a=oh(this,X(this.doc,o.line)),c=0,g=(a.length-1)/2,m=o.ch,b;if(m==0)b=a[2];else for(;;){var w=c+g>>1;if((w?a[w*2-1]:0)>=m)g=w;else if(a[w*2+1]<m)c=w+1;else{b=a[w*2+2];break}}var C=b?b.indexOf("overlay "):-1;return C<0?b:C==0?null:b.slice(0,C-1)},getModeAt:function(o){var a=this.doc.mode;return a.innerMode?e.innerMode(a,this.getTokenAt(o).state).mode:a},getHelper:function(o,a){return this.getHelpers(o,a)[0]},getHelpers:function(o,a){var c=[];if(!l.hasOwnProperty(a))return c;var g=l[a],m=this.getModeAt(o);if(typeof m[a]=="string")g[m[a]]&&c.push(g[m[a]]);else if(m[a])for(var b=0;b<m[a].length;b++){var w=g[m[a][b]];w&&c.push(w)}else m.helperType&&g[m.helperType]?c.push(g[m.helperType]):g[m.name]&&c.push(g[m.name]);for(var C=0;C<g._global.length;C++){var k=g._global[C];k.pred(m,this)&&_t(c,k.val)==-1&&c.push(k.val)}return c},getStateAfter:function(o,a){var c=this.doc;return o=nh(c,o??c.first+c.size-1),rr(this,o+1,a).state},cursorCoords:function(o,a){var c,g=this.doc.sel.primary();return o==null?c=g.head:typeof o=="object"?c=nt(this.doc,o):c=o?g.from():g.to(),We(this,c,a||"page")},charCoords:function(o,a){return ps(this,nt(this.doc,o),a||"page")},coordsChar:function(o,a){return o=Hh(this,o,a||"page"),$o(this,o.left,o.top)},lineAtHeight:function(o,a){return o=Hh(this,{top:o,left:0},a||"page").top,Gi(this.doc,o+this.display.viewOffset)},heightAtLine:function(o,a,c){var g=!1,m;if(typeof o=="number"){var b=this.doc.first+this.doc.size-1;o<this.doc.first?o=this.doc.first:o>b&&(o=b,g=!0),m=X(this.doc,o)}else m=o;return ds(this,m,{top:0,left:0},a||"page",c||g).top+(g?this.doc.height-hi(m):0)},defaultTextHeight:function(){return bn(this.display)},defaultCharWidth:function(){return wn(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(o,a,c,g,m){var b=this.display;o=We(this,nt(this.doc,o));var w=o.bottom,C=o.left;if(a.style.position="absolute",a.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(a),b.sizer.appendChild(a),g=="over")w=o.top;else if(g=="above"||g=="near"){var k=Math.max(b.wrapper.clientHeight,this.doc.height),L=Math.max(b.sizer.clientWidth,b.lineSpace.clientWidth);(g=="above"||o.bottom+a.offsetHeight>k)&&o.top>a.offsetHeight?w=o.top-a.offsetHeight:o.bottom+a.offsetHeight<=k&&(w=o.bottom),C+a.offsetWidth>L&&(C=L-a.offsetWidth)}a.style.top=w+"px",a.style.left=a.style.right="",m=="right"?(C=b.sizer.clientWidth-a.offsetWidth,a.style.right="0px"):(m=="left"?C=0:m=="middle"&&(C=(b.sizer.clientWidth-a.offsetWidth)/2),a.style.left=C+"px"),c&&Ep(this,{left:C,top:w,right:C+a.offsetWidth,bottom:w+a.offsetHeight})},triggerOnKeyDown:ie(Uf),triggerOnKeyPress:ie(Vf),triggerOnKeyUp:Gf,triggerOnMouseDown:ie(qf),execCommand:function(o){if(Mr.hasOwnProperty(o))return Mr[o].call(null,this)},triggerElectric:ie(function(o){Qf(this,o)}),findPosH:function(o,a,c,g){var m=1;a<0&&(m=-1,a=-a);for(var b=nt(this.doc,o),w=0;w<a&&(b=Dl(this.doc,b,m,c,g),!b.hitSide);++w);return b},moveH:ie(function(o,a){var c=this;this.extendSelectionsBy(function(g){return c.display.shift||c.doc.extend||g.empty()?Dl(c.doc,g.head,o,a,c.options.rtlMoveVisually):o<0?g.from():g.to()},Qn)}),deleteH:ie(function(o,a){var c=this.doc.sel,g=this.doc;c.somethingSelected()?g.replaceSelection("",null,"+delete"):Dn(this,function(m){var b=Dl(g,m.head,o,a,!1);return o<0?{from:b,to:m.head}:{from:m.head,to:b}})}),findPosV:function(o,a,c,g){var m=1,b=g;a<0&&(m=-1,a=-a);for(var w=nt(this.doc,o),C=0;C<a;++C){var k=We(this,w,"div");if(b==null?b=k.left:k.left=b,w=eu(this,k,m,c),w.hitSide)break}return w},moveV:ie(function(o,a){var c=this,g=this.doc,m=[],b=!this.display.shift&&!g.extend&&g.sel.somethingSelected();if(g.extendSelectionsBy(function(C){if(b)return o<0?C.from():C.to();var k=We(c,C.head,"div");C.goalColumn!=null&&(k.left=C.goalColumn),m.push(k.left);var L=eu(c,k,o,a);return a=="page"&&C==g.sel.primary()&&hl(c,ps(c,L,"div").top-k.top),L},Qn),m.length)for(var w=0;w<g.sel.ranges.length;w++)g.sel.ranges[w].goalColumn=m[w]}),findWordAt:function(o){var a=this.doc,c=X(a,o.line).text,g=o.ch,m=o.ch;if(c){var b=this.getHelper(o,"wordChars");(o.sticky=="before"||m==c.length)&&g?--g:++m;for(var w=c.charAt(g),C=es(w,b)?function(k){return es(k,b)}:/\s/.test(w)?function(k){return/\s/.test(k)}:function(k){return!/\s/.test(k)&&!es(k)};g>0&&C(c.charAt(g-1));)--g;for(;m<c.length&&C(c.charAt(m));)++m}return new ft(B(o.line,g),B(o.line,m))},toggleOverwrite:function(o){o!=null&&o==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Ge(this.display.cursorDiv,"CodeMirror-overwrite"):tt(this.display.cursorDiv,"CodeMirror-overwrite"),Ot(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Bt(ve(this))},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:ie(function(o,a){ur(this,o,a)}),getScrollInfo:function(){var o=this.display.scroller;return{left:o.scrollLeft,top:o.scrollTop,height:o.scrollHeight-Xe(this)-this.display.barHeight,width:o.scrollWidth-Xe(this)-this.display.barWidth,clientHeight:jo(this),clientWidth:Vi(this)}},scrollIntoView:ie(function(o,a){o==null?(o={from:this.doc.sel.primary().head,to:null},a==null&&(a=this.options.cursorScrollMargin)):typeof o=="number"?o={from:B(o,0),to:null}:o.from==null&&(o={from:o,to:null}),o.to||(o.to=o.from),o.margin=a||0,o.from.line!=null?Bp(this,o):Xh(this,o.from,o.to,o.margin)}),setSize:ie(function(o,a){var c=this,g=function(b){return typeof b=="number"||/^\d+$/.test(String(b))?b+"px":b};o!=null&&(this.display.wrapper.style.width=g(o)),a!=null&&(this.display.wrapper.style.height=g(a)),this.options.lineWrapping&&Rh(this);var m=this.display.viewFrom;this.doc.iter(m,this.display.viewTo,function(b){if(b.widgets){for(var w=0;w<b.widgets.length;w++)if(b.widgets[w].noHScroll){xi(c,m,"widget");break}}++m}),this.curOp.forceUpdate=!0,Ot(this,"refresh",this)}),operation:function(o){return be(this,o)},startOperation:function(){return Ji(this)},endOperation:function(){return Zi(this)},refresh:ie(function(){var o=this.display.cachedTextHeight;fe(this),this.curOp.forceUpdate=!0,hr(this),ur(this,this.doc.scrollLeft,this.doc.scrollTop),cl(this.display),(o==null||Math.abs(o-bn(this.display))>.5||this.options.lineWrapping)&&nl(this),Ot(this,"refresh",this)}),swapDoc:ie(function(o){var a=this.doc;return a.cm=null,this.state.selectingText&&this.state.selectingText(),af(this,o),hr(this),this.display.input.reset(),ur(this,o.scrollLeft,o.scrollTop),this.curOp.forceScroll=!0,zt(this,"swapDoc",this,a),a}),phrase:function(o){var a=this.options.phrases;return a&&Object.prototype.hasOwnProperty.call(a,o)?a[o]:o},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},dn(e),e.registerHelper=function(o,a,c){l.hasOwnProperty(o)||(l[o]=e[o]={_global:[]}),l[o][a]=c},e.registerGlobalHelper=function(o,a,c,g){e.registerHelper(o,a,g),l[o]._global.push({pred:c,val:g})}}function Dl(e,n,l,o,a){var c=n,g=l,m=X(e,n.line),b=a&&e.direction=="rtl"?-l:l;function w(){var F=n.line+b;return F<e.first||F>=e.first+e.size?!1:(n=new B(F,n.ch,n.sticky),m=X(e,F))}function C(F){var W;if(o=="codepoint"){var U=m.text.charCodeAt(n.ch+(l>0?0:-1));if(isNaN(U))W=null;else{var Z=l>0?U>=55296&&U<56320:U>=56320&&U<57343;W=new B(n.line,Math.max(0,Math.min(m.text.length,n.ch+l*(Z?2:1))),-l)}}else a?W=vg(e.cm,m,n,l):W=Sl(m,n,l);if(W==null)if(!F&&w())n=Cl(a,e.cm,m,n.line,b);else return!1;else n=W;return!0}if(o=="char"||o=="codepoint")C();else if(o=="column")C(!0);else if(o=="word"||o=="group")for(var k=null,L=o=="group",T=e.cm&&e.cm.getHelper(n,"wordChars"),O=!0;!(l<0&&!C(!O));O=!1){var E=m.text.charAt(n.ch)||`
`,R=es(E,T)?"w":L&&E==`
`?"n":!L||/\s/.test(E)?null:"p";if(L&&!O&&!R&&(R="s"),k&&k!=R){l<0&&(l=1,C(),n.sticky="after");break}if(R&&(k=R),l>0&&!C(!O))break}var I=Ms(e,n,c,g,!0);return Ho(c,I)&&(I.hitSide=!0),I}function eu(e,n,l,o){var a=e.doc,c=n.left,g;if(o=="page"){var m=Math.min(e.display.wrapper.clientHeight,oi(e).innerHeight||a(e).documentElement.clientHeight),b=Math.max(m-.5*bn(e.display),3);g=(l>0?n.bottom:n.top)+l*b}else o=="line"&&(g=l>0?n.bottom+3:n.top-3);for(var w;w=$o(e,c,g),!!w.outside;){if(l<0?g<=0:g>=a.height){w.hitSide=!0;break}g+=l*5}return w}var mt=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new bi,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};mt.prototype.init=function(e){var n=this,l=this,o=l.cm,a=l.div=e.lineDiv;a.contentEditable=!0,Ol(a,o.options.spellcheck,o.options.autocorrect,o.options.autocapitalize);function c(m){for(var b=m.target;b;b=b.parentNode){if(b==a)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(b.className))break}return!1}$(a,"paste",function(m){!c(m)||Ft(o,m)||Zf(m,o)||v<=11&&setTimeout(Kt(o,function(){return n.updateFromDOM()}),20)}),$(a,"compositionstart",function(m){n.composing={data:m.data,done:!1}}),$(a,"compositionupdate",function(m){n.composing||(n.composing={data:m.data,done:!1})}),$(a,"compositionend",function(m){n.composing&&(m.data!=n.composing.data&&n.readFromDOMSoon(),n.composing.done=!0)}),$(a,"touchstart",function(){return l.forceCompositionEnd()}),$(a,"input",function(){n.composing||n.readFromDOMSoon()});function g(m){if(!(!c(m)||Ft(o,m))){if(o.somethingSelected())Ps({lineWise:!1,text:o.getSelections()}),m.type=="cut"&&o.replaceSelection("",null,"cut");else if(o.options.lineWiseCopyCut){var b=$f(o);Ps({lineWise:!0,text:b.text}),m.type=="cut"&&o.operation(function(){o.setSelections(b.ranges,0,Ve),o.replaceSelection("",null,"cut")})}else return;if(m.clipboardData){m.clipboardData.clearData();var w=Fe.text.join(`
`);if(m.clipboardData.setData("Text",w),m.clipboardData.getData("Text")==w){m.preventDefault();return}}var C=tu(),k=C.firstChild;Ol(k),o.display.lineSpace.insertBefore(C,o.display.lineSpace.firstChild),k.value=Fe.text.join(`
`);var L=Bt(ye(a));qt(k),setTimeout(function(){o.display.lineSpace.removeChild(C),L.focus(),L==a&&l.showPrimarySelection()},50)}}$(a,"copy",g),$(a,"cut",g)},mt.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},mt.prototype.prepareSelection=function(){var e=Vh(this.cm,!1);return e.focus=Bt(ye(this.div))==this.div,e},mt.prototype.showSelection=function(e,n){!e||!this.cm.display.view.length||((e.focus||n)&&this.showPrimarySelection(),this.showMultipleSelections(e))},mt.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},mt.prototype.showPrimarySelection=function(){var e=this.getSelection(),n=this.cm,l=n.doc.sel.primary(),o=l.from(),a=l.to();if(n.display.viewTo==n.display.viewFrom||o.line>=n.display.viewTo||a.line<n.display.viewFrom){e.removeAllRanges();return}var c=Es(n,e.anchorNode,e.anchorOffset),g=Es(n,e.focusNode,e.focusOffset);if(!(c&&!c.bad&&g&&!g.bad&&it(rs(c,g),o)==0&&it(ns(c,g),a)==0)){var m=n.display.view,b=o.line>=n.display.viewFrom&&iu(n,o)||{node:m[0].measure.map[2],offset:0},w=a.line<n.display.viewTo&&iu(n,a);if(!w){var C=m[m.length-1].measure,k=C.maps?C.maps[C.maps.length-1]:C.map;w={node:k[k.length-1],offset:k[k.length-2]-k[k.length-3]}}if(!b||!w){e.removeAllRanges();return}var L=e.rangeCount&&e.getRangeAt(0),T;try{T=Se(b.node,b.offset,w.offset,w.node)}catch{}T&&(!s&&n.state.focused?(e.collapse(b.node,b.offset),T.collapsed||(e.removeAllRanges(),e.addRange(T))):(e.removeAllRanges(),e.addRange(T)),L&&e.anchorNode==null?e.addRange(L):s&&this.startGracePeriod()),this.rememberSelection()}},mt.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},mt.prototype.showMultipleSelections=function(e){lt(this.cm.display.cursorDiv,e.cursors),lt(this.cm.display.selectionDiv,e.selection)},mt.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},mt.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var n=e.getRangeAt(0).commonAncestorContainer;return Ce(this.div,n)},mt.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||Bt(ye(this.div))!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},mt.prototype.blur=function(){this.div.blur()},mt.prototype.getField=function(){return this.div},mt.prototype.supportsTouch=function(){return!0},mt.prototype.receivedFocus=function(){var e=this,n=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):be(this.cm,function(){return n.cm.curOp.selectionChanged=!0});function l(){n.cm.state.focused&&(n.pollSelection(),n.polling.set(n.cm.options.pollInterval,l))}this.polling.set(this.cm.options.pollInterval,l)},mt.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},mt.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var e=this.getSelection(),n=this.cm;if(Y&&S&&this.cm.display.gutterSpecs.length&&Wg(e.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var l=Es(n,e.anchorNode,e.anchorOffset),o=Es(n,e.focusNode,e.focusOffset);l&&o&&be(n,function(){jt(n.doc,Ci(l,o),Ve),(l.bad||o.bad)&&(n.curOp.selectionChanged=!0)})}}},mt.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,n=e.display,l=e.doc.sel.primary(),o=l.from(),a=l.to();if(o.ch==0&&o.line>e.firstLine()&&(o=B(o.line-1,X(e.doc,o.line-1).length)),a.ch==X(e.doc,a.line).text.length&&a.line<e.lastLine()&&(a=B(a.line+1,0)),o.line<n.viewFrom||a.line>n.viewTo-1)return!1;var c,g,m;o.line==n.viewFrom||(c=Xi(e,o.line))==0?(g=gt(n.view[0].line),m=n.view[0].node):(g=gt(n.view[c].line),m=n.view[c-1].node.nextSibling);var b=Xi(e,a.line),w,C;if(b==n.view.length-1?(w=n.viewTo-1,C=n.lineDiv.lastChild):(w=gt(n.view[b+1].line)-1,C=n.view[b+1].node.previousSibling),!m)return!1;for(var k=e.doc.splitLines(Hg(e,m,C,g,w)),L=Ui(e.doc,B(g,0),B(w,X(e.doc,w).text.length));k.length>1&&L.length>1;)if(ct(k)==ct(L))k.pop(),L.pop(),w--;else if(k[0]==L[0])k.shift(),L.shift(),g++;else break;for(var T=0,O=0,E=k[0],R=L[0],I=Math.min(E.length,R.length);T<I&&E.charCodeAt(T)==R.charCodeAt(T);)++T;for(var F=ct(k),W=ct(L),U=Math.min(F.length-(k.length==1?T:0),W.length-(L.length==1?T:0));O<U&&F.charCodeAt(F.length-O-1)==W.charCodeAt(W.length-O-1);)++O;if(k.length==1&&L.length==1&&g==o.line)for(;T&&T>o.ch&&F.charCodeAt(F.length-O-1)==W.charCodeAt(W.length-O-1);)T--,O++;k[k.length-1]=F.slice(0,F.length-O).replace(/^\u200b+/,""),k[0]=k[0].slice(T).replace(/\u200b+$/,"");var Z=B(g,T),_=B(w,L.length?ct(L).length-O:0);if(k.length>1||k[0]||it(Z,_))return Tn(e.doc,k,Z,_,"+input"),!0},mt.prototype.ensurePolled=function(){this.forceCompositionEnd()},mt.prototype.reset=function(){this.forceCompositionEnd()},mt.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},mt.prototype.readFromDOMSoon=function(){var e=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing)if(e.composing.done)e.composing=null;else return;e.updateFromDOM()},80))},mt.prototype.updateFromDOM=function(){var e=this;(this.cm.isReadOnly()||!this.pollContent())&&be(this.cm,function(){return fe(e.cm)})},mt.prototype.setUneditable=function(e){e.contentEditable="false"},mt.prototype.onKeyPress=function(e){e.charCode==0||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Kt(this.cm,Ll)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0))},mt.prototype.readOnlyChanged=function(e){this.div.contentEditable=String(e!="nocursor")},mt.prototype.onContextMenu=function(){},mt.prototype.resetPosition=function(){},mt.prototype.needsContentAttribute=!0;function iu(e,n){var l=Jo(e,n.line);if(!l||l.hidden)return null;var o=X(e.doc,n.line),a=Dh(l,o,n.line),c=li(o,e.doc.direction),g="left";if(c){var m=er(c,n.ch);g=m%2?"right":"left"}var b=Eh(a.map,n.ch,g);return b.offset=b.collapse=="right"?b.end:b.start,b}function Wg(e){for(var n=e;n;n=n.parentNode)if(/CodeMirror-gutter-wrapper/.test(n.className))return!0;return!1}function Pn(e,n){return n&&(e.bad=!0),e}function Hg(e,n,l,o,a){var c="",g=!1,m=e.doc.lineSeparator(),b=!1;function w(T){return function(O){return O.id==T}}function C(){g&&(c+=m,b&&(c+=m),g=b=!1)}function k(T){T&&(C(),c+=T)}function L(T){if(T.nodeType==1){var O=T.getAttribute("cm-text");if(O){k(O);return}var E=T.getAttribute("cm-marker"),R;if(E){var I=e.findMarks(B(o,0),B(a+1,0),w(+E));I.length&&(R=I[0].find(0))&&k(Ui(e.doc,R.from,R.to).join(m));return}if(T.getAttribute("contenteditable")=="false")return;var F=/^(pre|div|p|li|table|br)$/i.test(T.nodeName);if(!/^br$/i.test(T.nodeName)&&T.textContent.length==0)return;F&&C();for(var W=0;W<T.childNodes.length;W++)L(T.childNodes[W]);/^(pre|p)$/i.test(T.nodeName)&&(b=!0),F&&(g=!0)}else T.nodeType==3&&k(T.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;L(n),n!=l;)n=n.nextSibling,b=!1;return c}function Es(e,n,l){var o;if(n==e.display.lineDiv){if(o=e.display.lineDiv.childNodes[l],!o)return Pn(e.clipPos(B(e.display.viewTo-1)),!0);n=null,l=0}else for(o=n;;o=o.parentNode){if(!o||o==e.display.lineDiv)return null;if(o.parentNode&&o.parentNode==e.display.lineDiv)break}for(var a=0;a<e.display.view.length;a++){var c=e.display.view[a];if(c.node==o)return Fg(c,n,l)}}function Fg(e,n,l){var o=e.text.firstChild,a=!1;if(!n||!Ce(o,n))return Pn(B(gt(e.line),0),!0);if(n==o&&(a=!0,n=o.childNodes[l],l=0,!n)){var c=e.rest?ct(e.rest):e.line;return Pn(B(gt(c),c.text.length),a)}var g=n.nodeType==3?n:null,m=n;for(!g&&n.childNodes.length==1&&n.firstChild.nodeType==3&&(g=n.firstChild,l&&(l=g.nodeValue.length));m.parentNode!=o;)m=m.parentNode;var b=e.measure,w=b.maps;function C(R,I,F){for(var W=-1;W<(w?w.length:0);W++)for(var U=W<0?b.map:w[W],Z=0;Z<U.length;Z+=3){var _=U[Z+2];if(_==R||_==I){var rt=gt(W<0?e.line:e.rest[W]),yt=U[Z]+F;return(F<0||_!=R)&&(yt=U[Z+(F?1:0)]),B(rt,yt)}}}var k=C(g,m,l);if(k)return Pn(k,a);for(var L=m.nextSibling,T=g?g.nodeValue.length-l:0;L;L=L.nextSibling){if(k=C(L,L.firstChild,0),k)return Pn(B(k.line,k.ch-T),a);T+=L.textContent.length}for(var O=m.previousSibling,E=l;O;O=O.previousSibling){if(k=C(O,O.firstChild,-1),k)return Pn(B(k.line,k.ch+E),a);E+=O.textContent.length}}var Lt=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new bi,this.hasSelection=!1,this.composing=null,this.resetting=!1};Lt.prototype.init=function(e){var n=this,l=this,o=this.cm;this.createField(e);var a=this.textarea;e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),H&&(a.style.width="0px"),$(a,"input",function(){p&&v>=9&&n.hasSelection&&(n.hasSelection=null),l.poll()}),$(a,"paste",function(g){Ft(o,g)||Zf(g,o)||(o.state.pasteIncoming=+new Date,l.fastPoll())});function c(g){if(!Ft(o,g)){if(o.somethingSelected())Ps({lineWise:!1,text:o.getSelections()});else if(o.options.lineWiseCopyCut){var m=$f(o);Ps({lineWise:!0,text:m.text}),g.type=="cut"?o.setSelections(m.ranges,null,Ve):(l.prevInput="",a.value=m.text.join(`
`),qt(a))}else return;g.type=="cut"&&(o.state.cutIncoming=+new Date)}}$(a,"cut",c),$(a,"copy",c),$(e.scroller,"paste",function(g){if(!(fi(e,g)||Ft(o,g))){if(!a.dispatchEvent){o.state.pasteIncoming=+new Date,l.focus();return}var m=new Event("paste");m.clipboardData=g.clipboardData,a.dispatchEvent(m)}}),$(e.lineSpace,"selectstart",function(g){fi(e,g)||he(g)}),$(a,"compositionstart",function(){var g=o.getCursor("from");l.composing&&l.composing.range.clear(),l.composing={start:g,range:o.markText(g,o.getCursor("to"),{className:"CodeMirror-composing"})}}),$(a,"compositionend",function(){l.composing&&(l.poll(),l.composing.range.clear(),l.composing=null)})},Lt.prototype.createField=function(e){this.wrapper=tu(),this.textarea=this.wrapper.firstChild;var n=this.cm.options;Ol(this.textarea,n.spellcheck,n.autocorrect,n.autocapitalize)},Lt.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},Lt.prototype.prepareSelection=function(){var e=this.cm,n=e.display,l=e.doc,o=Vh(e);if(e.options.moveInputWithCursor){var a=We(e,l.sel.primary().head,"div"),c=n.wrapper.getBoundingClientRect(),g=n.lineDiv.getBoundingClientRect();o.teTop=Math.max(0,Math.min(n.wrapper.clientHeight-10,a.top+g.top-c.top)),o.teLeft=Math.max(0,Math.min(n.wrapper.clientWidth-10,a.left+g.left-c.left))}return o},Lt.prototype.showSelection=function(e){var n=this.cm,l=n.display;lt(l.cursorDiv,e.cursors),lt(l.selectionDiv,e.selection),e.teTop!=null&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Lt.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing&&e)){var n=this.cm;if(this.resetting=!0,n.somethingSelected()){this.prevInput="";var l=n.getSelection();this.textarea.value=l,n.state.focused&&qt(this.textarea),p&&v>=9&&(this.hasSelection=l)}else e||(this.prevInput=this.textarea.value="",p&&v>=9&&(this.hasSelection=null));this.resetting=!1}},Lt.prototype.getField=function(){return this.textarea},Lt.prototype.supportsTouch=function(){return!1},Lt.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!J||Bt(ye(this.textarea))!=this.textarea))try{this.textarea.focus()}catch{}},Lt.prototype.blur=function(){this.textarea.blur()},Lt.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Lt.prototype.receivedFocus=function(){this.slowPoll()},Lt.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},Lt.prototype.fastPoll=function(){var e=!1,n=this;n.pollingFast=!0;function l(){var o=n.poll();!o&&!e?(e=!0,n.polling.set(60,l)):(n.pollingFast=!1,n.slowPoll())}n.polling.set(20,l)},Lt.prototype.poll=function(){var e=this,n=this.cm,l=this.textarea,o=this.prevInput;if(this.contextMenuPending||this.resetting||!n.state.focused||Hd(l)&&!o&&!this.composing||n.isReadOnly()||n.options.disableInput||n.state.keySeq)return!1;var a=l.value;if(a==o&&!n.somethingSelected())return!1;if(p&&v>=9&&this.hasSelection===a||q&&/[\uf700-\uf7ff]/.test(a))return n.display.input.reset(),!1;if(n.doc.sel==n.display.selForContextMenu){var c=a.charCodeAt(0);if(c==8203&&!o&&(o="​"),c==8666)return this.reset(),this.cm.execCommand("undo")}for(var g=0,m=Math.min(o.length,a.length);g<m&&o.charCodeAt(g)==a.charCodeAt(g);)++g;return be(n,function(){Ll(n,a.slice(g),o.length-g,null,e.composing?"*compose":null),a.length>1e3||a.indexOf(`
`)>-1?l.value=e.prevInput="":e.prevInput=a,e.composing&&(e.composing.range.clear(),e.composing.range=n.markText(e.composing.start,n.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Lt.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Lt.prototype.onKeyPress=function(){p&&v>=9&&(this.hasSelection=null),this.fastPoll()},Lt.prototype.onContextMenu=function(e){var n=this,l=n.cm,o=l.display,a=n.textarea;n.contextMenuPending&&n.contextMenuPending();var c=Yi(l,e),g=o.scroller.scrollTop;if(!c||M)return;var m=l.options.resetSelectionOnContextMenu;m&&l.doc.sel.contains(c)==-1&&Kt(l,jt)(l.doc,Ci(c),Ve);var b=a.style.cssText,w=n.wrapper.style.cssText,C=n.wrapper.offsetParent.getBoundingClientRect();n.wrapper.style.cssText="position: static",a.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(e.clientY-C.top-5)+"px; left: "+(e.clientX-C.left-5)+`px;
      z-index: 1000; background: `+(p?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var k;y&&(k=a.ownerDocument.defaultView.scrollY),o.input.focus(),y&&a.ownerDocument.defaultView.scrollTo(null,k),o.input.reset(),l.somethingSelected()||(a.value=n.prevInput=" "),n.contextMenuPending=T,o.selForContextMenu=l.doc.sel,clearTimeout(o.detectingSelectAll);function L(){if(a.selectionStart!=null){var E=l.somethingSelected(),R="​"+(E?a.value:"");a.value="⇚",a.value=R,n.prevInput=E?"":"​",a.selectionStart=1,a.selectionEnd=R.length,o.selForContextMenu=l.doc.sel}}function T(){if(n.contextMenuPending==T&&(n.contextMenuPending=!1,n.wrapper.style.cssText=w,a.style.cssText=b,p&&v<9&&o.scrollbars.setScrollTop(o.scroller.scrollTop=g),a.selectionStart!=null)){(!p||p&&v<9)&&L();var E=0,R=function(){o.selForContextMenu==l.doc.sel&&a.selectionStart==0&&a.selectionEnd>0&&n.prevInput=="​"?Kt(l,xf)(l):E++<10?o.detectingSelectAll=setTimeout(R,500):(o.selForContextMenu=null,o.input.reset())};o.detectingSelectAll=setTimeout(R,200)}}if(p&&v>=9&&L(),St){ir(e);var O=function(){Ae(window,"mouseup",O),setTimeout(T,20)};$(window,"mouseup",O)}else setTimeout(T,50)},Lt.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled=e=="nocursor",this.textarea.readOnly=!!e},Lt.prototype.setUneditable=function(){},Lt.prototype.needsContentAttribute=!1;function zg(e,n){if(n=n?zi(n):{},n.value=e.value,!n.tabindex&&e.tabIndex&&(n.tabindex=e.tabIndex),!n.placeholder&&e.placeholder&&(n.placeholder=e.placeholder),n.autofocus==null){var l=Bt(ye(e));n.autofocus=l==e||e.getAttribute("autofocus")!=null&&l==document.body}function o(){e.value=m.getValue()}var a;if(e.form&&($(e.form,"submit",o),!n.leaveSubmitMethodAlone)){var c=e.form;a=c.submit;try{var g=c.submit=function(){o(),c.submit=a,c.submit(),c.submit=g}}catch{}}n.finishInit=function(b){b.save=o,b.getTextArea=function(){return e},b.toTextArea=function(){b.toTextArea=isNaN,o(),e.parentNode.removeChild(b.getWrapperElement()),e.style.display="",e.form&&(Ae(e.form,"submit",o),!n.leaveSubmitMethodAlone&&typeof e.form.submit=="function"&&(e.form.submit=a))}},e.style.display="none";var m=Ct(function(b){return e.parentNode.insertBefore(b,e.nextSibling)},n);return m}function Kg(e){e.off=Ae,e.on=$,e.wheelEventPixels=_p,e.Doc=ue,e.splitLines=No,e.countColumn=De,e.findColumn=So,e.isWordChar=ko,e.Pass=Qr,e.signal=Ot,e.Line=mn,e.changeEnd=ki,e.scrollbarModel=Jh,e.Pos=B,e.cmpPos=it,e.modes=Eo,e.mimeModes=pn,e.resolveMode=is,e.getMode=Bo,e.modeExtensions=gn,e.extendMode=Gd,e.copyState=Ki,e.startState=ih,e.innerMode=Ro,e.commands=Mr,e.keyMap=ci,e.keyName=Wf,e.isModifierKey=Rf,e.lookupKey=On,e.normalizeKeyMap=mg,e.StringStream=Dt,e.SharedTextMarker=Cr,e.TextMarker=Mi,e.LineWidget=Sr,e.e_preventDefault=he,e.e_stopPropagation=th,e.e_stop=ir,e.addClass=Ge,e.contains=Ce,e.rmClass=tt,e.keyNames=Ti}Pg(Ct),Ig(Ct);var Ug="iter insert remove copy getEditor constructor".split(" ");for(var Bs in ue.prototype)ue.prototype.hasOwnProperty(Bs)&&_t(Ug,Bs)<0&&(Ct.prototype[Bs]=function(e){return function(){return e.apply(this.doc,arguments)}}(ue.prototype[Bs]));return dn(ue),Ct.inputStyles={textarea:Lt,contenteditable:mt},Ct.defineMode=function(e){!Ct.defaults.mode&&e!="null"&&(Ct.defaults.mode=e),Kd.apply(this,arguments)},Ct.defineMIME=Ud,Ct.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),Ct.defineMIME("text/plain","null"),Ct.defineExtension=function(e,n){Ct.prototype[e]=n},Ct.defineDocExtension=function(e,n){ue.prototype[e]=n},Ct.fromTextArea=zg,Kg(Ct),Ct.version="5.65.19",Ct})})(sc);var Zg=sc.exports;let _l=[],oc=[];(()=>{let f="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=0,i=0;t<f.length;t++)(t%2?oc:_l).push(i=i+f[t])})();function Qg(f){if(f<768)return!1;for(let t=0,i=_l.length;;){let r=t+i>>1;if(f<_l[r])i=r;else if(f>=oc[r])t=r+1;else return!0;if(t==i)return!1}}function nu(f){return f>=127462&&f<=127487}const ru=8205;function $g(f,t,i=!0,r=!0){return(i?lc:t0)(f,t,r)}function lc(f,t,i){if(t==f.length)return t;t&&ac(f.charCodeAt(t))&&hc(f.charCodeAt(t-1))&&t--;let r=Bl(f,t);for(t+=su(r);t<f.length;){let s=Bl(f,t);if(r==ru||s==ru||i&&Qg(s))t+=su(s),r=s;else if(nu(s)){let h=0,u=t-2;for(;u>=0&&nu(Bl(f,u));)h++,u-=2;if(h%2==0)break;t+=2}else break}return t}function t0(f,t,i){for(;t>0;){let r=lc(f,t-2,i);if(r<t)return r;t--}return 0}function Bl(f,t){let i=f.charCodeAt(t);if(!hc(i)||t+1==f.length)return i;let r=f.charCodeAt(t+1);return ac(r)?(i-55296<<10)+(r-56320)+65536:i}function ac(f){return f>=56320&&f<57344}function hc(f){return f>=55296&&f<56320}function su(f){return f<65536?1:2}class dt{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,i,r){[t,i]=Un(this,t,i);let s=[];return this.decompose(0,t,s,2),r.length&&r.decompose(0,r.length,s,3),this.decompose(i,this.length,s,1),ti.from(s,this.length-(i-t)+r.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,i=this.length){[t,i]=Un(this,t,i);let r=[];return this.decompose(t,i,r,0),ti.from(r,i-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let i=this.scanIdentical(t,1),r=this.length-this.scanIdentical(t,-1),s=new Hr(this),h=new Hr(t);for(let u=i,d=i;;){if(s.next(u),h.next(u),u=0,s.lineBreak!=h.lineBreak||s.done!=h.done||s.value!=h.value)return!1;if(d+=s.value.length,s.done||d>=r)return!0}}iter(t=1){return new Hr(this,t)}iterRange(t,i=this.length){return new fc(this,t,i)}iterLines(t,i){let r;if(t==null)r=this.iter();else{i==null&&(i=this.lines+1);let s=this.line(t).from;r=this.iterRange(s,Math.max(s,i==this.lines+1?this.length:i<=1?0:this.line(i-1).to))}return new uc(r)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?dt.empty:t.length<=32?new Et(t):ti.from(Et.split(t,[]))}}class Et extends dt{constructor(t,i=e0(t)){super(),this.text=t,this.length=i}get lines(){return this.text.length}get children(){return null}lineInner(t,i,r,s){for(let h=0;;h++){let u=this.text[h],d=s+u.length;if((i?r:d)>=t)return new i0(s,d,r,u);s=d+1,r++}}decompose(t,i,r,s){let h=t<=0&&i>=this.length?this:new Et(ou(this.text,t,i),Math.min(i,this.length)-Math.max(0,t));if(s&1){let u=r.pop(),d=Qs(h.text,u.text.slice(),0,h.length);if(d.length<=32)r.push(new Et(d,u.length+h.length));else{let p=d.length>>1;r.push(new Et(d.slice(0,p)),new Et(d.slice(p)))}}else r.push(h)}replace(t,i,r){if(!(r instanceof Et))return super.replace(t,i,r);[t,i]=Un(this,t,i);let s=Qs(this.text,Qs(r.text,ou(this.text,0,t)),i),h=this.length+r.length-(i-t);return s.length<=32?new Et(s,h):ti.from(Et.split(s,[]),h)}sliceString(t,i=this.length,r=`
`){[t,i]=Un(this,t,i);let s="";for(let h=0,u=0;h<=i&&u<this.text.length;u++){let d=this.text[u],p=h+d.length;h>t&&u&&(s+=r),t<p&&i>h&&(s+=d.slice(Math.max(0,t-h),i-h)),h=p+1}return s}flatten(t){for(let i of this.text)t.push(i)}scanIdentical(){return 0}static split(t,i){let r=[],s=-1;for(let h of t)r.push(h),s+=h.length+1,r.length==32&&(i.push(new Et(r,s)),r=[],s=-1);return s>-1&&i.push(new Et(r,s)),i}}class ti extends dt{constructor(t,i){super(),this.children=t,this.length=i,this.lines=0;for(let r of t)this.lines+=r.lines}lineInner(t,i,r,s){for(let h=0;;h++){let u=this.children[h],d=s+u.length,p=r+u.lines-1;if((i?p:d)>=t)return u.lineInner(t,i,r,s);s=d+1,r=p+1}}decompose(t,i,r,s){for(let h=0,u=0;u<=i&&h<this.children.length;h++){let d=this.children[h],p=u+d.length;if(t<=p&&i>=u){let v=s&((u<=t?1:0)|(p>=i?2:0));u>=t&&p<=i&&!v?r.push(d):d.decompose(t-u,i-u,r,v)}u=p+1}}replace(t,i,r){if([t,i]=Un(this,t,i),r.lines<this.lines)for(let s=0,h=0;s<this.children.length;s++){let u=this.children[s],d=h+u.length;if(t>=h&&i<=d){let p=u.replace(t-h,i-h,r),v=this.lines-u.lines+p.lines;if(p.lines<v>>5-1&&p.lines>v>>5+1){let y=this.children.slice();return y[s]=p,new ti(y,this.length-(i-t)+r.length)}return super.replace(h,d,p)}h=d+1}return super.replace(t,i,r)}sliceString(t,i=this.length,r=`
`){[t,i]=Un(this,t,i);let s="";for(let h=0,u=0;h<this.children.length&&u<=i;h++){let d=this.children[h],p=u+d.length;u>t&&h&&(s+=r),t<p&&i>u&&(s+=d.sliceString(t-u,i-u,r)),u=p+1}return s}flatten(t){for(let i of this.children)i.flatten(t)}scanIdentical(t,i){if(!(t instanceof ti))return 0;let r=0,[s,h,u,d]=i>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;s+=i,h+=i){if(s==u||h==d)return r;let p=this.children[s],v=t.children[h];if(p!=v)return r+p.scanIdentical(v,i);r+=p.length+1}}static from(t,i=t.reduce((r,s)=>r+s.length+1,-1)){let r=0;for(let A of t)r+=A.lines;if(r<32){let A=[];for(let M of t)M.flatten(A);return new Et(A,i)}let s=Math.max(32,r>>5),h=s<<1,u=s>>1,d=[],p=0,v=-1,y=[];function x(A){let M;if(A.lines>h&&A instanceof ti)for(let D of A.children)x(D);else A.lines>u&&(p>u||!p)?(S(),d.push(A)):A instanceof Et&&p&&(M=y[y.length-1])instanceof Et&&A.lines+M.lines<=32?(p+=A.lines,v+=A.length+1,y[y.length-1]=new Et(M.text.concat(A.text),M.length+1+A.length)):(p+A.lines>s&&S(),p+=A.lines,v+=A.length+1,y.push(A))}function S(){p!=0&&(d.push(y.length==1?y[0]:ti.from(y,v)),v=-1,p=y.length=0)}for(let A of t)x(A);return S(),d.length==1?d[0]:new ti(d,i)}}dt.empty=new Et([""],0);function e0(f){let t=-1;for(let i of f)t+=i.length+1;return t}function Qs(f,t,i=0,r=1e9){for(let s=0,h=0,u=!0;h<f.length&&s<=r;h++){let d=f[h],p=s+d.length;p>=i&&(p>r&&(d=d.slice(0,r-s)),s<i&&(d=d.slice(i-s)),u?(t[t.length-1]+=d,u=!1):t.push(d)),s=p+1}return t}function ou(f,t,i){return Qs(f,[""],t,i)}class Hr{constructor(t,i=1){this.dir=i,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[i>0?1:(t instanceof Et?t.text.length:t.children.length)<<1]}nextInner(t,i){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,s=this.nodes[r],h=this.offsets[r],u=h>>1,d=s instanceof Et?s.text.length:s.children.length;if(u==(i>0?d:0)){if(r==0)return this.done=!0,this.value="",this;i>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((h&1)==(i>0?0:1)){if(this.offsets[r]+=i,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(s instanceof Et){let p=s.text[u+(i<0?-1:0)];if(this.offsets[r]+=i,p.length>Math.max(0,t))return this.value=t==0?p:i>0?p.slice(t):p.slice(0,p.length-t),this;t-=p.length}else{let p=s.children[u+(i<0?-1:0)];t>p.length?(t-=p.length,this.offsets[r]+=i):(i<0&&this.offsets[r]--,this.nodes.push(p),this.offsets.push(i>0?1:(p instanceof Et?p.text.length:p.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class fc{constructor(t,i,r){this.value="",this.done=!1,this.cursor=new Hr(t,i>r?-1:1),this.pos=i>r?t.length:0,this.from=Math.min(i,r),this.to=Math.max(i,r)}nextInner(t,i){if(i<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,i<0?this.pos-this.to:this.from-this.pos);let r=i<0?this.pos-this.from:this.to-this.pos;t>r&&(t=r),r-=t;let{value:s}=this.cursor.next(t);return this.pos+=(s.length+t)*i,this.value=s.length<=r?s:i<0?s.slice(s.length-r):s.slice(0,r),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class uc{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:i,lineBreak:r,value:s}=this.inner.next(t);return i&&this.afterBreak?(this.value="",this.afterBreak=!1):i?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(dt.prototype[Symbol.iterator]=function(){return this.iter()},Hr.prototype[Symbol.iterator]=fc.prototype[Symbol.iterator]=uc.prototype[Symbol.iterator]=function(){return this});class i0{constructor(t,i,r,s){this.from=t,this.to=i,this.number=r,this.text=s}get length(){return this.to-this.from}}function Un(f,t,i){return t=Math.max(0,Math.min(f.length,t)),[t,Math.max(t,Math.min(f.length,i))]}function ii(f,t,i=!0,r=!0){return $g(f,t,i,r)}function n0(f){return f>=56320&&f<57344}function r0(f){return f>=55296&&f<56320}function s0(f,t){let i=f.charCodeAt(t);if(!r0(i)||t+1==f.length)return i;let r=f.charCodeAt(t+1);return n0(r)?(i-55296<<10)+(r-56320)+65536:i}function o0(f){return f<65536?1:2}const jl=/\r\n?|\n/;var Le=function(f){return f[f.Simple=0]="Simple",f[f.TrackDel=1]="TrackDel",f[f.TrackBefore=2]="TrackBefore",f[f.TrackAfter=3]="TrackAfter",f}(Le||(Le={}));class mi{constructor(t){this.sections=t}get length(){let t=0;for(let i=0;i<this.sections.length;i+=2)t+=this.sections[i];return t}get newLength(){let t=0;for(let i=0;i<this.sections.length;i+=2){let r=this.sections[i+1];t+=r<0?this.sections[i]:r}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let i=0,r=0,s=0;i<this.sections.length;){let h=this.sections[i++],u=this.sections[i++];u<0?(t(r,s,h),s+=h):s+=u,r+=h}}iterChangedRanges(t,i=!1){Jl(this,t,i)}get invertedDesc(){let t=[];for(let i=0;i<this.sections.length;){let r=this.sections[i++],s=this.sections[i++];s<0?t.push(r,s):t.push(s,r)}return new mi(t)}composeDesc(t){return this.empty?t:t.empty?this:cc(this,t)}mapDesc(t,i=!1){return t.empty?this:Zl(this,t,i)}mapPos(t,i=-1,r=Le.Simple){let s=0,h=0;for(let u=0;u<this.sections.length;){let d=this.sections[u++],p=this.sections[u++],v=s+d;if(p<0){if(v>t)return h+(t-s);h+=d}else{if(r!=Le.Simple&&v>=t&&(r==Le.TrackDel&&s<t&&v>t||r==Le.TrackBefore&&s<t||r==Le.TrackAfter&&v>t))return null;if(v>t||v==t&&i<0&&!d)return t==s||i<0?h:h+p;h+=p}s=v}if(t>s)throw new RangeError(`Position ${t} is out of range for changeset of length ${s}`);return h}touchesRange(t,i=t){for(let r=0,s=0;r<this.sections.length&&s<=i;){let h=this.sections[r++],u=this.sections[r++],d=s+h;if(u>=0&&s<=i&&d>=t)return s<t&&d>i?"cover":!0;s=d}return!1}toString(){let t="";for(let i=0;i<this.sections.length;){let r=this.sections[i++],s=this.sections[i++];t+=(t?" ":"")+r+(s>=0?":"+s:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(i=>typeof i!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new mi(t)}static create(t){return new mi(t)}}class Xt extends mi{constructor(t,i){super(t),this.inserted=i}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Jl(this,(i,r,s,h,u)=>t=t.replace(s,s+(r-i),u),!1),t}mapDesc(t,i=!1){return Zl(this,t,i,!0)}invert(t){let i=this.sections.slice(),r=[];for(let s=0,h=0;s<i.length;s+=2){let u=i[s],d=i[s+1];if(d>=0){i[s]=d,i[s+1]=u;let p=s>>1;for(;r.length<p;)r.push(dt.empty);r.push(u?t.slice(h,h+u):dt.empty)}h+=u}return new Xt(i,r)}compose(t){return this.empty?t:t.empty?this:cc(this,t,!0)}map(t,i=!1){return t.empty?this:Zl(this,t,i,!0)}iterChanges(t,i=!1){Jl(this,t,i)}get desc(){return mi.create(this.sections)}filter(t){let i=[],r=[],s=[],h=new Ur(this);t:for(let u=0,d=0;;){let p=u==t.length?1e9:t[u++];for(;d<p||d==p&&h.len==0;){if(h.done)break t;let y=Math.min(h.len,p-d);re(s,y,-1);let x=h.ins==-1?-1:h.off==0?h.ins:0;re(i,y,x),x>0&&Ei(r,i,h.text),h.forward(y),d+=y}let v=t[u++];for(;d<v;){if(h.done)break t;let y=Math.min(h.len,v-d);re(i,y,-1),re(s,y,h.ins==-1?-1:h.off==0?h.ins:0),h.forward(y),d+=y}}return{changes:new Xt(i,r),filtered:mi.create(s)}}toJSON(){let t=[];for(let i=0;i<this.sections.length;i+=2){let r=this.sections[i],s=this.sections[i+1];s<0?t.push(r):s==0?t.push([r]):t.push([r].concat(this.inserted[i>>1].toJSON()))}return t}static of(t,i,r){let s=[],h=[],u=0,d=null;function p(y=!1){if(!y&&!s.length)return;u<i&&re(s,i-u,-1);let x=new Xt(s,h);d=d?d.compose(x.map(d)):x,s=[],h=[],u=0}function v(y){if(Array.isArray(y))for(let x of y)v(x);else if(y instanceof Xt){if(y.length!=i)throw new RangeError(`Mismatched change set length (got ${y.length}, expected ${i})`);p(),d=d?d.compose(y.map(d)):y}else{let{from:x,to:S=x,insert:A}=y;if(x>S||x<0||S>i)throw new RangeError(`Invalid change range ${x} to ${S} (in doc of length ${i})`);let M=A?typeof A=="string"?dt.of(A.split(r||jl)):A:dt.empty,D=M.length;if(x==S&&D==0)return;x<u&&p(),x>u&&re(s,x-u,-1),re(s,S-x,D),Ei(h,s,M),u=S}}return v(t),p(!d),d}static empty(t){return new Xt(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let i=[],r=[];for(let s=0;s<t.length;s++){let h=t[s];if(typeof h=="number")i.push(h,-1);else{if(!Array.isArray(h)||typeof h[0]!="number"||h.some((u,d)=>d&&typeof u!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(h.length==1)i.push(h[0],0);else{for(;r.length<s;)r.push(dt.empty);r[s]=dt.of(h.slice(1)),i.push(h[0],r[s].length)}}}return new Xt(i,r)}static createSet(t,i){return new Xt(t,i)}}function re(f,t,i,r=!1){if(t==0&&i<=0)return;let s=f.length-2;s>=0&&i<=0&&i==f[s+1]?f[s]+=t:s>=0&&t==0&&f[s]==0?f[s+1]+=i:r?(f[s]+=t,f[s+1]+=i):f.push(t,i)}function Ei(f,t,i){if(i.length==0)return;let r=t.length-2>>1;if(r<f.length)f[f.length-1]=f[f.length-1].append(i);else{for(;f.length<r;)f.push(dt.empty);f.push(i)}}function Jl(f,t,i){let r=f.inserted;for(let s=0,h=0,u=0;u<f.sections.length;){let d=f.sections[u++],p=f.sections[u++];if(p<0)s+=d,h+=d;else{let v=s,y=h,x=dt.empty;for(;v+=d,y+=p,p&&r&&(x=x.append(r[u-2>>1])),!(i||u==f.sections.length||f.sections[u+1]<0);)d=f.sections[u++],p=f.sections[u++];t(s,v,h,y,x),s=v,h=y}}}function Zl(f,t,i,r=!1){let s=[],h=r?[]:null,u=new Ur(f),d=new Ur(t);for(let p=-1;;){if(u.done&&d.len||d.done&&u.len)throw new Error("Mismatched change set lengths");if(u.ins==-1&&d.ins==-1){let v=Math.min(u.len,d.len);re(s,v,-1),u.forward(v),d.forward(v)}else if(d.ins>=0&&(u.ins<0||p==u.i||u.off==0&&(d.len<u.len||d.len==u.len&&!i))){let v=d.len;for(re(s,d.ins,-1);v;){let y=Math.min(u.len,v);u.ins>=0&&p<u.i&&u.len<=y&&(re(s,0,u.ins),h&&Ei(h,s,u.text),p=u.i),u.forward(y),v-=y}d.next()}else if(u.ins>=0){let v=0,y=u.len;for(;y;)if(d.ins==-1){let x=Math.min(y,d.len);v+=x,y-=x,d.forward(x)}else if(d.ins==0&&d.len<y)y-=d.len,d.next();else break;re(s,v,p<u.i?u.ins:0),h&&p<u.i&&Ei(h,s,u.text),p=u.i,u.forward(u.len-y)}else{if(u.done&&d.done)return h?Xt.createSet(s,h):mi.create(s);throw new Error("Mismatched change set lengths")}}}function cc(f,t,i=!1){let r=[],s=i?[]:null,h=new Ur(f),u=new Ur(t);for(let d=!1;;){if(h.done&&u.done)return s?Xt.createSet(r,s):mi.create(r);if(h.ins==0)re(r,h.len,0,d),h.next();else if(u.len==0&&!u.done)re(r,0,u.ins,d),s&&Ei(s,r,u.text),u.next();else{if(h.done||u.done)throw new Error("Mismatched change set lengths");{let p=Math.min(h.len2,u.len),v=r.length;if(h.ins==-1){let y=u.ins==-1?-1:u.off?0:u.ins;re(r,p,y,d),s&&y&&Ei(s,r,u.text)}else u.ins==-1?(re(r,h.off?0:h.len,p,d),s&&Ei(s,r,h.textBit(p))):(re(r,h.off?0:h.len,u.off?0:u.ins,d),s&&!u.off&&Ei(s,r,u.text));d=(h.ins>p||u.ins>=0&&u.len>p)&&(d||r.length>v),h.forward2(p),u.forward(p)}}}}class Ur{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length?dt.empty:t[i]}textBit(t){let{inserted:i}=this.set,r=this.i-2>>1;return r>=i.length&&!t?dt.empty:i[r].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class rn{constructor(t,i,r){this.from=t,this.to=i,this.flags=r}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,i=-1){let r,s;return this.empty?r=s=t.mapPos(this.from,i):(r=t.mapPos(this.from,1),s=t.mapPos(this.to,-1)),r==this.from&&s==this.to?this:new rn(r,s,this.flags)}extend(t,i=t){if(t<=this.anchor&&i>=this.anchor)return j.range(t,i);let r=Math.abs(t-this.anchor)>Math.abs(i-this.anchor)?t:i;return j.range(this.anchor,r)}eq(t,i=!1){return this.anchor==t.anchor&&this.head==t.head&&(!i||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return j.range(t.anchor,t.head)}static create(t,i,r){return new rn(t,i,r)}}class j{constructor(t,i){this.ranges=t,this.mainIndex=i}map(t,i=-1){return t.empty?this:j.create(this.ranges.map(r=>r.map(t,i)),this.mainIndex)}eq(t,i=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(t.ranges[r],i))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new j([this.main],0)}addRange(t,i=!0){return j.create([t].concat(this.ranges),i?0:this.mainIndex+1)}replaceRange(t,i=this.mainIndex){let r=this.ranges.slice();return r[i]=t,j.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new j(t.ranges.map(i=>rn.fromJSON(i)),t.main)}static single(t,i=t){return new j([j.range(t,i)],0)}static create(t,i=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,s=0;s<t.length;s++){let h=t[s];if(h.empty?h.from<=r:h.from<r)return j.normalized(t.slice(),i);r=h.to}return new j(t,i)}static cursor(t,i=0,r,s){return rn.create(t,t,(i==0?0:i<0?8:16)|(r==null?7:Math.min(6,r))|(s??16777215)<<6)}static range(t,i,r,s){let h=(r??16777215)<<6|(s==null?7:Math.min(6,s));return i<t?rn.create(i,t,48|h):rn.create(t,i,(i>t?8:0)|h)}static normalized(t,i=0){let r=t[i];t.sort((s,h)=>s.from-h.from),i=t.indexOf(r);for(let s=1;s<t.length;s++){let h=t[s],u=t[s-1];if(h.empty?h.from<=u.to:h.from<u.to){let d=u.from,p=Math.max(h.to,u.to);s<=i&&i--,t.splice(--s,2,h.anchor>h.head?j.range(p,d):j.range(d,p))}}return new j(t,i)}}function dc(f,t){for(let i of f.ranges)if(i.to>t)throw new RangeError("Selection points outside of document")}let Na=0;class st{constructor(t,i,r,s,h){this.combine=t,this.compareInput=i,this.compare=r,this.isStatic=s,this.id=Na++,this.default=t([]),this.extensions=typeof h=="function"?h(this):h}get reader(){return this}static define(t={}){return new st(t.combine||(i=>i),t.compareInput||((i,r)=>i===r),t.compare||(t.combine?(i,r)=>i===r:Pa),!!t.static,t.enables)}of(t){return new $s([],this,0,t)}compute(t,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new $s(t,this,1,i)}computeN(t,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new $s(t,this,2,i)}from(t,i){return i||(i=r=>r),this.compute([t],r=>i(r.field(t)))}}function Pa(f,t){return f==t||f.length==t.length&&f.every((i,r)=>i===t[r])}class $s{constructor(t,i,r,s){this.dependencies=t,this.facet=i,this.type=r,this.value=s,this.id=Na++}dynamicSlot(t){var i;let r=this.value,s=this.facet.compareInput,h=this.id,u=t[h]>>1,d=this.type==2,p=!1,v=!1,y=[];for(let x of this.dependencies)x=="doc"?p=!0:x=="selection"?v=!0:((i=t[x.id])!==null&&i!==void 0?i:1)&1||y.push(t[x.id]);return{create(x){return x.values[u]=r(x),1},update(x,S){if(p&&S.docChanged||v&&(S.docChanged||S.selection)||Ql(x,y)){let A=r(x);if(d?!lu(A,x.values[u],s):!s(A,x.values[u]))return x.values[u]=A,1}return 0},reconfigure:(x,S)=>{let A,M=S.config.address[h];if(M!=null){let D=oo(S,M);if(this.dependencies.every(N=>N instanceof st?S.facet(N)===x.facet(N):N instanceof un?S.field(N,!1)==x.field(N,!1):!0)||(d?lu(A=r(x),D,s):s(A=r(x),D)))return x.values[u]=D,0}else A=r(x);return x.values[u]=A,1}}}}function lu(f,t,i){if(f.length!=t.length)return!1;for(let r=0;r<f.length;r++)if(!i(f[r],t[r]))return!1;return!0}function Ql(f,t){let i=!1;for(let r of t)Fr(f,r)&1&&(i=!0);return i}function l0(f,t,i){let r=i.map(p=>f[p.id]),s=i.map(p=>p.type),h=r.filter(p=>!(p&1)),u=f[t.id]>>1;function d(p){let v=[];for(let y=0;y<r.length;y++){let x=oo(p,r[y]);if(s[y]==2)for(let S of x)v.push(S);else v.push(x)}return t.combine(v)}return{create(p){for(let v of r)Fr(p,v);return p.values[u]=d(p),1},update(p,v){if(!Ql(p,h))return 0;let y=d(p);return t.compare(y,p.values[u])?0:(p.values[u]=y,1)},reconfigure(p,v){let y=Ql(p,r),x=v.config.facets[t.id],S=v.facet(t);if(x&&!y&&Pa(i,x))return p.values[u]=S,0;let A=d(p);return t.compare(A,S)?(p.values[u]=S,0):(p.values[u]=A,1)}}}const Rs=st.define({static:!0});class un{constructor(t,i,r,s,h){this.id=t,this.createF=i,this.updateF=r,this.compareF=s,this.spec=h,this.provides=void 0}static define(t){let i=new un(Na++,t.create,t.update,t.compare||((r,s)=>r===s),t);return t.provide&&(i.provides=t.provide(i)),i}create(t){let i=t.facet(Rs).find(r=>r.field==this);return((i==null?void 0:i.create)||this.createF)(t)}slot(t){let i=t[this.id]>>1;return{create:r=>(r.values[i]=this.create(r),1),update:(r,s)=>{let h=r.values[i],u=this.updateF(h,s);return this.compareF(h,u)?0:(r.values[i]=u,1)},reconfigure:(r,s)=>{let h=r.facet(Rs),u=s.facet(Rs),d;return(d=h.find(p=>p.field==this))&&d!=u.find(p=>p.field==this)?(r.values[i]=d.create(r),1):s.config.address[this.id]!=null?(r.values[i]=s.field(this),0):(r.values[i]=this.create(r),1)}}}init(t){return[this,Rs.of({field:this,create:t})]}get extension(){return this}}const en={lowest:4,low:3,default:2,high:1,highest:0};function Nr(f){return t=>new gc(t,f)}const pc={highest:Nr(en.highest),high:Nr(en.high),default:Nr(en.default),low:Nr(en.low),lowest:Nr(en.lowest)};class gc{constructor(t,i){this.inner=t,this.prec=i}}class _r{of(t){return new $l(this,t)}reconfigure(t){return _r.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class $l{constructor(t,i){this.compartment=t,this.inner=i}}class so{constructor(t,i,r,s,h,u){for(this.base=t,this.compartments=i,this.dynamicSlots=r,this.address=s,this.staticValues=h,this.facets=u,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(t){let i=this.address[t.id];return i==null?t.default:this.staticValues[i>>1]}static resolve(t,i,r){let s=[],h=Object.create(null),u=new Map;for(let S of a0(t,i,u))S instanceof un?s.push(S):(h[S.facet.id]||(h[S.facet.id]=[])).push(S);let d=Object.create(null),p=[],v=[];for(let S of s)d[S.id]=v.length<<1,v.push(A=>S.slot(A));let y=r==null?void 0:r.config.facets;for(let S in h){let A=h[S],M=A[0].facet,D=y&&y[S]||[];if(A.every(N=>N.type==0))if(d[M.id]=p.length<<1|1,Pa(D,A))p.push(r.facet(M));else{let N=M.combine(A.map(P=>P.value));p.push(r&&M.compare(N,r.facet(M))?r.facet(M):N)}else{for(let N of A)N.type==0?(d[N.id]=p.length<<1|1,p.push(N.value)):(d[N.id]=v.length<<1,v.push(P=>N.dynamicSlot(P)));d[M.id]=v.length<<1,v.push(N=>l0(N,M,A))}}let x=v.map(S=>S(d));return new so(t,u,x,d,p,h)}}function a0(f,t,i){let r=[[],[],[],[],[]],s=new Map;function h(u,d){let p=s.get(u);if(p!=null){if(p<=d)return;let v=r[p].indexOf(u);v>-1&&r[p].splice(v,1),u instanceof $l&&i.delete(u.compartment)}if(s.set(u,d),Array.isArray(u))for(let v of u)h(v,d);else if(u instanceof $l){if(i.has(u.compartment))throw new RangeError("Duplicate use of compartment in extensions");let v=t.get(u.compartment)||u.inner;i.set(u.compartment,v),h(v,d)}else if(u instanceof gc)h(u.inner,u.prec);else if(u instanceof un)r[d].push(u),u.provides&&h(u.provides,d);else if(u instanceof $s)r[d].push(u),u.facet.extensions&&h(u.facet.extensions,en.default);else{let v=u.extension;if(!v)throw new Error(`Unrecognized extension value in extension set (${u}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);h(v,d)}}return h(f,en.default),r.reduce((u,d)=>u.concat(d))}function Fr(f,t){if(t&1)return 2;let i=t>>1,r=f.status[i];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;f.status[i]=4;let s=f.computeSlot(f,f.config.dynamicSlots[i]);return f.status[i]=2|s}function oo(f,t){return t&1?f.config.staticValues[t>>1]:f.values[t>>1]}const mc=st.define(),ta=st.define({combine:f=>f.some(t=>t),static:!0}),vc=st.define({combine:f=>f.length?f[0]:void 0,static:!0}),yc=st.define(),bc=st.define(),wc=st.define(),xc=st.define({combine:f=>f.length?f[0]:!1});class Zn{constructor(t,i){this.type=t,this.value=i}static define(){return new h0}}class h0{of(t){return new Zn(this,t)}}class f0{constructor(t){this.map=t}of(t){return new Wt(this,t)}}class Wt{constructor(t,i){this.type=t,this.value=i}map(t){let i=this.type.map(this.value,t);return i===void 0?void 0:i==this.value?this:new Wt(this.type,i)}is(t){return this.type==t}static define(t={}){return new f0(t.map||(i=>i))}static mapEffects(t,i){if(!t.length)return t;let r=[];for(let s of t){let h=s.map(i);h&&r.push(h)}return r}}Wt.reconfigure=Wt.define();Wt.appendConfig=Wt.define();class oe{constructor(t,i,r,s,h,u){this.startState=t,this.changes=i,this.selection=r,this.effects=s,this.annotations=h,this.scrollIntoView=u,this._doc=null,this._state=null,r&&dc(r,i.newLength),h.some(d=>d.type==oe.time)||(this.annotations=h.concat(oe.time.of(Date.now())))}static create(t,i,r,s,h,u){return new oe(t,i,r,s,h,u)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let i of this.annotations)if(i.type==t)return i.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let i=this.annotation(oe.userEvent);return!!(i&&(i==t||i.length>t.length&&i.slice(0,t.length)==t&&i[t.length]=="."))}}oe.time=Zn.define();oe.userEvent=Zn.define();oe.addToHistory=Zn.define();oe.remote=Zn.define();function u0(f,t){let i=[];for(let r=0,s=0;;){let h,u;if(r<f.length&&(s==t.length||t[s]>=f[r]))h=f[r++],u=f[r++];else if(s<t.length)h=t[s++],u=t[s++];else return i;!i.length||i[i.length-1]<h?i.push(h,u):i[i.length-1]<u&&(i[i.length-1]=u)}}function Sc(f,t,i){var r;let s,h,u;return i?(s=t.changes,h=Xt.empty(t.changes.length),u=f.changes.compose(t.changes)):(s=t.changes.map(f.changes),h=f.changes.mapDesc(t.changes,!0),u=f.changes.compose(s)),{changes:u,selection:t.selection?t.selection.map(h):(r=f.selection)===null||r===void 0?void 0:r.map(s),effects:Wt.mapEffects(f.effects,s).concat(Wt.mapEffects(t.effects,h)),annotations:f.annotations.length?f.annotations.concat(t.annotations):t.annotations,scrollIntoView:f.scrollIntoView||t.scrollIntoView}}function ea(f,t,i){let r=t.selection,s=Fn(t.annotations);return t.userEvent&&(s=s.concat(oe.userEvent.of(t.userEvent))),{changes:t.changes instanceof Xt?t.changes:Xt.of(t.changes||[],i,f.facet(vc)),selection:r&&(r instanceof j?r:j.single(r.anchor,r.head)),effects:Fn(t.effects),annotations:s,scrollIntoView:!!t.scrollIntoView}}function Cc(f,t,i){let r=ea(f,t.length?t[0]:{},f.doc.length);t.length&&t[0].filter===!1&&(i=!1);for(let h=1;h<t.length;h++){t[h].filter===!1&&(i=!1);let u=!!t[h].sequential;r=Sc(r,ea(f,t[h],u?r.changes.newLength:f.doc.length),u)}let s=oe.create(f,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return d0(i?c0(s):s)}function c0(f){let t=f.startState,i=!0;for(let s of t.facet(yc)){let h=s(f);if(h===!1){i=!1;break}Array.isArray(h)&&(i=i===!0?h:u0(i,h))}if(i!==!0){let s,h;if(i===!1)h=f.changes.invertedDesc,s=Xt.empty(t.doc.length);else{let u=f.changes.filter(i);s=u.changes,h=u.filtered.mapDesc(u.changes).invertedDesc}f=oe.create(t,s,f.selection&&f.selection.map(h),Wt.mapEffects(f.effects,h),f.annotations,f.scrollIntoView)}let r=t.facet(bc);for(let s=r.length-1;s>=0;s--){let h=r[s](f);h instanceof oe?f=h:Array.isArray(h)&&h.length==1&&h[0]instanceof oe?f=h[0]:f=Cc(t,Fn(h),!1)}return f}function d0(f){let t=f.startState,i=t.facet(wc),r=f;for(let s=i.length-1;s>=0;s--){let h=i[s](f);h&&Object.keys(h).length&&(r=Sc(r,ea(t,h,f.changes.newLength),!0))}return r==f?f:oe.create(t,f.changes,f.selection,r.effects,r.annotations,r.scrollIntoView)}const p0=[];function Fn(f){return f==null?p0:Array.isArray(f)?f:[f]}var gi=function(f){return f[f.Word=0]="Word",f[f.Space=1]="Space",f[f.Other=2]="Other",f}(gi||(gi={}));const g0=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ia;try{ia=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function m0(f){if(ia)return ia.test(f);for(let t=0;t<f.length;t++){let i=f[t];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||g0.test(i)))return!0}return!1}function v0(f){return t=>{if(!/\S/.test(t))return gi.Space;if(m0(t))return gi.Word;for(let i=0;i<f.length;i++)if(t.indexOf(f[i])>-1)return gi.Word;return gi.Other}}class ut{constructor(t,i,r,s,h,u){this.config=t,this.doc=i,this.selection=r,this.values=s,this.status=t.statusTemplate.slice(),this.computeSlot=h,u&&(u._state=this);for(let d=0;d<this.config.dynamicSlots.length;d++)Fr(this,d<<1);this.computeSlot=null}field(t,i=!0){let r=this.config.address[t.id];if(r==null){if(i)throw new RangeError("Field is not present in this state");return}return Fr(this,r),oo(this,r)}update(...t){return Cc(this,t,!0)}applyTransaction(t){let i=this.config,{base:r,compartments:s}=i;for(let d of t.effects)d.is(_r.reconfigure)?(i&&(s=new Map,i.compartments.forEach((p,v)=>s.set(v,p)),i=null),s.set(d.value.compartment,d.value.extension)):d.is(Wt.reconfigure)?(i=null,r=d.value):d.is(Wt.appendConfig)&&(i=null,r=Fn(r).concat(d.value));let h;i?h=t.startState.values.slice():(i=so.resolve(r,s,this),h=new ut(i,this.doc,this.selection,i.dynamicSlots.map(()=>null),(p,v)=>v.reconfigure(p,this),null).values);let u=t.startState.facet(ta)?t.newSelection:t.newSelection.asSingle();new ut(i,t.newDoc,u,h,(d,p)=>p.update(d,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:t},range:j.cursor(i.from+t.length)}))}changeByRange(t){let i=this.selection,r=t(i.ranges[0]),s=this.changes(r.changes),h=[r.range],u=Fn(r.effects);for(let d=1;d<i.ranges.length;d++){let p=t(i.ranges[d]),v=this.changes(p.changes),y=v.map(s);for(let S=0;S<d;S++)h[S]=h[S].map(y);let x=s.mapDesc(v,!0);h.push(p.range.map(x)),s=s.compose(y),u=Wt.mapEffects(u,y).concat(Wt.mapEffects(Fn(p.effects),x))}return{changes:s,selection:j.create(h,i.mainIndex),effects:u}}changes(t=[]){return t instanceof Xt?t:Xt.of(t,this.doc.length,this.facet(ut.lineSeparator))}toText(t){return dt.of(t.split(this.facet(ut.lineSeparator)||jl))}sliceDoc(t=0,i=this.doc.length){return this.doc.sliceString(t,i,this.lineBreak)}facet(t){let i=this.config.address[t.id];return i==null?t.default:(Fr(this,i),oo(this,i))}toJSON(t){let i={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let r in t){let s=t[r];s instanceof un&&this.config.address[s.id]!=null&&(i[r]=s.spec.toJSON(this.field(t[r]),this))}return i}static fromJSON(t,i={},r){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(r){for(let h in r)if(Object.prototype.hasOwnProperty.call(t,h)){let u=r[h],d=t[h];s.push(u.init(p=>u.spec.fromJSON(d,p)))}}return ut.create({doc:t.doc,selection:j.fromJSON(t.selection),extensions:i.extensions?s.concat([i.extensions]):s})}static create(t={}){let i=so.resolve(t.extensions||[],new Map),r=t.doc instanceof dt?t.doc:dt.of((t.doc||"").split(i.staticFacet(ut.lineSeparator)||jl)),s=t.selection?t.selection instanceof j?t.selection:j.single(t.selection.anchor,t.selection.head):j.single(0);return dc(s,r.length),i.staticFacet(ta)||(s=s.asSingle()),new ut(i,r,s,i.dynamicSlots.map(()=>null),(h,u)=>u.create(h),null)}get tabSize(){return this.facet(ut.tabSize)}get lineBreak(){return this.facet(ut.lineSeparator)||`
`}get readOnly(){return this.facet(xc)}phrase(t,...i){for(let r of this.facet(ut.phrases))if(Object.prototype.hasOwnProperty.call(r,t)){t=r[t];break}return i.length&&(t=t.replace(/\$(\$|\d*)/g,(r,s)=>{if(s=="$")return"$";let h=+(s||1);return!h||h>i.length?r:i[h-1]})),t}languageDataAt(t,i,r=-1){let s=[];for(let h of this.facet(mc))for(let u of h(this,i,r))Object.prototype.hasOwnProperty.call(u,t)&&s.push(u[t]);return s}charCategorizer(t){return v0(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:i,from:r,length:s}=this.doc.lineAt(t),h=this.charCategorizer(t),u=t-r,d=t-r;for(;u>0;){let p=ii(i,u,!1);if(h(i.slice(p,u))!=gi.Word)break;u=p}for(;d<s;){let p=ii(i,d);if(h(i.slice(d,p))!=gi.Word)break;d=p}return u==d?null:j.range(u+r,d+r)}}ut.allowMultipleSelections=ta;ut.tabSize=st.define({combine:f=>f.length?f[0]:4});ut.lineSeparator=vc;ut.readOnly=xc;ut.phrases=st.define({compare(f,t){let i=Object.keys(f),r=Object.keys(t);return i.length==r.length&&i.every(s=>f[s]==t[s])}});ut.languageData=mc;ut.changeFilter=yc;ut.transactionFilter=bc;ut.transactionExtender=wc;_r.reconfigure=Wt.define();class Gn{eq(t){return this==t}range(t,i=t){return na.create(t,i,this)}}Gn.prototype.startSide=Gn.prototype.endSide=0;Gn.prototype.point=!1;Gn.prototype.mapMode=Le.TrackDel;let na=class kc{constructor(t,i,r){this.from=t,this.to=i,this.value=r}static create(t,i,r){return new kc(t,i,r)}};function ra(f,t){return f.from-t.from||f.value.startSide-t.value.startSide}class Ea{constructor(t,i,r,s){this.from=t,this.to=i,this.value=r,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(t,i,r,s=0){let h=r?this.to:this.from;for(let u=s,d=h.length;;){if(u==d)return u;let p=u+d>>1,v=h[p]-t||(r?this.value[p].endSide:this.value[p].startSide)-i;if(p==u)return v>=0?u:d;v>=0?d=p:u=p+1}}between(t,i,r,s){for(let h=this.findIndex(i,-1e9,!0),u=this.findIndex(r,1e9,!1,h);h<u;h++)if(s(this.from[h]+t,this.to[h]+t,this.value[h])===!1)return!1}map(t,i){let r=[],s=[],h=[],u=-1,d=-1;for(let p=0;p<this.value.length;p++){let v=this.value[p],y=this.from[p]+t,x=this.to[p]+t,S,A;if(y==x){let M=i.mapPos(y,v.startSide,v.mapMode);if(M==null||(S=A=M,v.startSide!=v.endSide&&(A=i.mapPos(y,v.endSide),A<S)))continue}else if(S=i.mapPos(y,v.startSide),A=i.mapPos(x,v.endSide),S>A||S==A&&v.startSide>0&&v.endSide<=0)continue;(A-S||v.endSide-v.startSide)<0||(u<0&&(u=S),v.point&&(d=Math.max(d,A-S)),r.push(v),s.push(S-u),h.push(A-u))}return{mapped:r.length?new Ea(s,h,r,d):null,pos:u}}}class At{constructor(t,i,r,s){this.chunkPos=t,this.chunk=i,this.nextLayer=r,this.maxPoint=s}static create(t,i,r,s){return new At(t,i,r,s)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let i of this.chunk)t+=i.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:i=[],sort:r=!1,filterFrom:s=0,filterTo:h=this.length}=t,u=t.filter;if(i.length==0&&!u)return this;if(r&&(i=i.slice().sort(ra)),this.isEmpty)return i.length?At.of(i):this;let d=new Ac(this,null,-1).goto(0),p=0,v=[],y=new lo;for(;d.value||p<i.length;)if(p<i.length&&(d.from-i[p].from||d.startSide-i[p].value.startSide)>=0){let x=i[p++];y.addInner(x.from,x.to,x.value)||v.push(x)}else d.rangeIndex==1&&d.chunkIndex<this.chunk.length&&(p==i.length||this.chunkEnd(d.chunkIndex)<i[p].from)&&(!u||s>this.chunkEnd(d.chunkIndex)||h<this.chunkPos[d.chunkIndex])&&y.addChunk(this.chunkPos[d.chunkIndex],this.chunk[d.chunkIndex])?d.nextChunk():((!u||s>d.to||h<d.from||u(d.from,d.to,d.value))&&(y.addInner(d.from,d.to,d.value)||v.push(na.create(d.from,d.to,d.value))),d.next());return y.finishInner(this.nextLayer.isEmpty&&!v.length?At.empty:this.nextLayer.update({add:v,filter:u,filterFrom:s,filterTo:h}))}map(t){if(t.empty||this.isEmpty)return this;let i=[],r=[],s=-1;for(let u=0;u<this.chunk.length;u++){let d=this.chunkPos[u],p=this.chunk[u],v=t.touchesRange(d,d+p.length);if(v===!1)s=Math.max(s,p.maxPoint),i.push(p),r.push(t.mapPos(d));else if(v===!0){let{mapped:y,pos:x}=p.map(d,t);y&&(s=Math.max(s,y.maxPoint),i.push(y),r.push(x))}}let h=this.nextLayer.map(t);return i.length==0?h:new At(r,i,h||At.empty,s)}between(t,i,r){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let h=this.chunkPos[s],u=this.chunk[s];if(i>=h&&t<=h+u.length&&u.between(h,t-h,i-h,r)===!1)return}this.nextLayer.between(t,i,r)}}iter(t=0){return Gr.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,i=0){return Gr.from(t).goto(i)}static compare(t,i,r,s,h=-1){let u=t.filter(x=>x.maxPoint>0||!x.isEmpty&&x.maxPoint>=h),d=i.filter(x=>x.maxPoint>0||!x.isEmpty&&x.maxPoint>=h),p=au(u,d,r),v=new Pr(u,p,h),y=new Pr(d,p,h);r.iterGaps((x,S,A)=>hu(v,x,y,S,A,s)),r.empty&&r.length==0&&hu(v,0,y,0,0,s)}static eq(t,i,r=0,s){s==null&&(s=1e9-1);let h=t.filter(y=>!y.isEmpty&&i.indexOf(y)<0),u=i.filter(y=>!y.isEmpty&&t.indexOf(y)<0);if(h.length!=u.length)return!1;if(!h.length)return!0;let d=au(h,u),p=new Pr(h,d,0).goto(r),v=new Pr(u,d,0).goto(r);for(;;){if(p.to!=v.to||!sa(p.active,v.active)||p.point&&(!v.point||!p.point.eq(v.point)))return!1;if(p.to>s)return!0;p.next(),v.next()}}static spans(t,i,r,s,h=-1){let u=new Pr(t,null,h).goto(i),d=i,p=u.openStart;for(;;){let v=Math.min(u.to,r);if(u.point){let y=u.activeForPoint(u.to),x=u.pointFrom<i?y.length+1:u.point.startSide<0?y.length:Math.min(y.length,p);s.point(d,v,u.point,y,x,u.pointRank),p=Math.min(u.openEnd(v),y.length)}else v>d&&(s.span(d,v,u.active,p),p=u.openEnd(v));if(u.to>r)return p+(u.point&&u.to>r?1:0);d=u.to,u.next()}}static of(t,i=!1){let r=new lo;for(let s of t instanceof na?[t]:i?y0(t):t)r.add(s.from,s.to,s.value);return r.finish()}static join(t){if(!t.length)return At.empty;let i=t[t.length-1];for(let r=t.length-2;r>=0;r--)for(let s=t[r];s!=At.empty;s=s.nextLayer)i=new At(s.chunkPos,s.chunk,i,Math.max(s.maxPoint,i.maxPoint));return i}}At.empty=new At([],[],null,-1);function y0(f){if(f.length>1)for(let t=f[0],i=1;i<f.length;i++){let r=f[i];if(ra(t,r)>0)return f.slice().sort(ra);t=r}return f}At.empty.nextLayer=At.empty;class lo{finishChunk(t){this.chunks.push(new Ea(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,i,r){this.addInner(t,i,r)||(this.nextLayer||(this.nextLayer=new lo)).add(t,i,r)}addInner(t,i,r){let s=t-this.lastTo||r.startSide-this.last.endSide;if(s<=0&&(t-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(i-this.chunkStart),this.last=r,this.lastFrom=t,this.lastTo=i,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,i-t)),!0)}addChunk(t,i){if((t-this.lastTo||i.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,i.maxPoint),this.chunks.push(i),this.chunkPos.push(t);let r=i.value.length-1;return this.last=i.value[r],this.lastFrom=i.from[r]+t,this.lastTo=i.to[r]+t,!0}finish(){return this.finishInner(At.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let i=At.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,i}}function au(f,t,i){let r=new Map;for(let h of f)for(let u=0;u<h.chunk.length;u++)h.chunk[u].maxPoint<=0&&r.set(h.chunk[u],h.chunkPos[u]);let s=new Set;for(let h of t)for(let u=0;u<h.chunk.length;u++){let d=r.get(h.chunk[u]);d!=null&&(i?i.mapPos(d):d)==h.chunkPos[u]&&!(i!=null&&i.touchesRange(d,d+h.chunk[u].length))&&s.add(h.chunk[u])}return s}class Ac{constructor(t,i,r,s=0){this.layer=t,this.skip=i,this.minPoint=r,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,i=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,i,!1),this}gotoInner(t,i,r){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<t||s.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],i,!0);(!r||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(t,i){(this.to-t||this.endSide-i)<0&&this.gotoInner(t,i,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],i=this.layer.chunk[this.chunkIndex],r=t+i.from[this.rangeIndex];if(this.from=r,this.to=t+i.to[this.rangeIndex],this.value=i.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Gr{constructor(t){this.heap=t}static from(t,i=null,r=-1){let s=[];for(let h=0;h<t.length;h++)for(let u=t[h];!u.isEmpty;u=u.nextLayer)u.maxPoint>=r&&s.push(new Ac(u,i,r,h));return s.length==1?s[0]:new Gr(s)}get startSide(){return this.value?this.value.startSide:0}goto(t,i=-1e9){for(let r of this.heap)r.goto(t,i);for(let r=this.heap.length>>1;r>=0;r--)Rl(this.heap,r);return this.next(),this}forward(t,i){for(let r of this.heap)r.forward(t,i);for(let r=this.heap.length>>1;r>=0;r--)Rl(this.heap,r);(this.to-t||this.value.endSide-i)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Rl(this.heap,0)}}}function Rl(f,t){for(let i=f[t];;){let r=(t<<1)+1;if(r>=f.length)break;let s=f[r];if(r+1<f.length&&s.compare(f[r+1])>=0&&(s=f[r+1],r++),i.compare(s)<0)break;f[r]=i,f[t]=s,t=r}}class Pr{constructor(t,i,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Gr.from(t,i,r)}goto(t,i=-1e9){return this.cursor.goto(t,i),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=i,this.openStart=-1,this.next(),this}forward(t,i){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-i)<0;)this.removeActive(this.minActive);this.cursor.forward(t,i)}removeActive(t){Is(this.active,t),Is(this.activeTo,t),Is(this.activeRank,t),this.minActive=fu(this.active,this.activeTo)}addActive(t){let i=0,{value:r,to:s,rank:h}=this.cursor;for(;i<this.activeRank.length&&(h-this.activeRank[i]||s-this.activeTo[i])>0;)i++;Ws(this.active,i,r),Ws(this.activeTo,i,s),Ws(this.activeRank,i,h),t&&Ws(t,i,this.cursor.from),this.minActive=fu(this.active,this.activeTo)}next(){let t=this.to,i=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>t){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),r&&Is(r,s)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let h=this.cursor.value;if(!h.point)this.addActive(r),this.cursor.next();else if(i&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=h,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=h.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let s=r.length-1;s>=0&&r[s]<t;s--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let i=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>t||this.activeTo[r]==t&&this.active[r].endSide>=this.point.endSide)&&i.push(this.active[r]);return i.reverse()}openEnd(t){let i=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>t;r--)i++;return i}}function hu(f,t,i,r,s,h){f.goto(t),i.goto(r);let u=r+s,d=r,p=r-t;for(;;){let v=f.to+p-i.to,y=v||f.endSide-i.endSide,x=y<0?f.to+p:i.to,S=Math.min(x,u);if(f.point||i.point?f.point&&i.point&&(f.point==i.point||f.point.eq(i.point))&&sa(f.activeForPoint(f.to),i.activeForPoint(i.to))||h.comparePoint(d,S,f.point,i.point):S>d&&!sa(f.active,i.active)&&h.compareRange(d,S,f.active,i.active),x>u)break;(v||f.openEnd!=i.openEnd)&&h.boundChange&&h.boundChange(x),d=x,y<=0&&f.next(),y>=0&&i.next()}}function sa(f,t){if(f.length!=t.length)return!1;for(let i=0;i<f.length;i++)if(f[i]!=t[i]&&!f[i].eq(t[i]))return!1;return!0}function Is(f,t){for(let i=t,r=f.length-1;i<r;i++)f[i]=f[i+1];f.pop()}function Ws(f,t,i){for(let r=f.length-1;r>=t;r--)f[r+1]=f[r];f[t]=i}function fu(f,t){let i=-1,r=1e9;for(let s=0;s<t.length;s++)(t[s]-r||f[s].endSide-f[i].endSide)<0&&(i=s,r=t[s]);return i}function b0(f,t,i=f.length){let r=0;for(let s=0;s<i&&s<f.length;)f.charCodeAt(s)==9?(r+=t-r%t,s++):(r++,s=ii(f,s));return r}function w0(f,t,i,r){for(let s=0,h=0;;){if(h>=t)return s;if(s==f.length)break;h+=f.charCodeAt(s)==9?i-h%i:1,s=ii(f,s)}return r===!0?-1:f.length}const oa="ͼ",uu=typeof Symbol>"u"?"__"+oa:Symbol.for(oa),la=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),cu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Ii{constructor(t,i){this.rules=[];let{finish:r}=i||{};function s(u){return/^@/.test(u)?[u]:u.split(/,\s*/)}function h(u,d,p,v){let y=[],x=/^@(\w+)\b/.exec(u[0]),S=x&&x[1]=="keyframes";if(x&&d==null)return p.push(u[0]+";");for(let A in d){let M=d[A];if(/&/.test(A))h(A.split(/,\s*/).map(D=>u.map(N=>D.replace(/&/,N))).reduce((D,N)=>D.concat(N)),M,p);else if(M&&typeof M=="object"){if(!x)throw new RangeError("The value of a property ("+A+") should be a primitive value.");h(s(A),M,y,S)}else M!=null&&y.push(A.replace(/_.*/,"").replace(/[A-Z]/g,D=>"-"+D.toLowerCase())+": "+M+";")}(y.length||S)&&p.push((r&&!x&&!v?u.map(r):u).join(", ")+" {"+y.join(" ")+"}")}for(let u in t)h(s(u),t[u],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=cu[uu]||1;return cu[uu]=t+1,oa+t.toString(36)}static mount(t,i,r){let s=t[la],h=r&&r.nonce;s?h&&s.setNonce(h):s=new x0(t,h),s.mount(Array.isArray(i)?i:[i],t)}}let du=new Map;class x0{constructor(t,i){let r=t.ownerDocument||t,s=r.defaultView;if(!t.head&&t.adoptedStyleSheets&&s.CSSStyleSheet){let h=du.get(r);if(h)return t[la]=h;this.sheet=new s.CSSStyleSheet,du.set(r,this)}else this.styleTag=r.createElement("style"),i&&this.styleTag.setAttribute("nonce",i);this.modules=[],t[la]=this}mount(t,i){let r=this.sheet,s=0,h=0;for(let u=0;u<t.length;u++){let d=t[u],p=this.modules.indexOf(d);if(p<h&&p>-1&&(this.modules.splice(p,1),h--,p=-1),p==-1){if(this.modules.splice(h++,0,d),r)for(let v=0;v<d.rules.length;v++)r.insertRule(d.rules[v],s++)}else{for(;h<p;)s+=this.modules[h++].rules.length;s+=d.rules.length,h++}}if(r)i.adoptedStyleSheets.indexOf(this.sheet)<0&&(i.adoptedStyleSheets=[this.sheet,...i.adoptedStyleSheets]);else{let u="";for(let p=0;p<this.modules.length;p++)u+=this.modules[p].getRules()+`
`;this.styleTag.textContent=u;let d=i.head||i;this.styleTag.parentNode!=d&&d.insertBefore(this.styleTag,d.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var Wi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Vr={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},S0=typeof navigator<"u"&&/Mac/.test(navigator.platform),C0=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Qt=0;Qt<10;Qt++)Wi[48+Qt]=Wi[96+Qt]=String(Qt);for(var Qt=1;Qt<=24;Qt++)Wi[Qt+111]="F"+Qt;for(var Qt=65;Qt<=90;Qt++)Wi[Qt]=String.fromCharCode(Qt+32),Vr[Qt]=String.fromCharCode(Qt);for(var Il in Wi)Vr.hasOwnProperty(Il)||(Vr[Il]=Wi[Il]);function k0(f){var t=S0&&f.metaKey&&f.shiftKey&&!f.ctrlKey&&!f.altKey||C0&&f.shiftKey&&f.key&&f.key.length==1||f.key=="Unidentified",i=!t&&f.key||(f.shiftKey?Vr:Wi)[f.keyCode]||f.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}function qr(f){let t;return f.nodeType==11?t=f.getSelection?f:f.ownerDocument:t=f,t.getSelection()}function aa(f,t){return t?f==t||f.contains(t.nodeType!=1?t.parentNode:t):!1}function to(f,t){if(!t.anchorNode)return!1;try{return aa(f,t.anchorNode)}catch{return!1}}function Vn(f){return f.nodeType==3?an(f,0,f.nodeValue.length).getClientRects():f.nodeType==1?f.getClientRects():[]}function zr(f,t,i,r){return i?pu(f,t,i,r,-1)||pu(f,t,i,r,1):!1}function ln(f){for(var t=0;;t++)if(f=f.previousSibling,!f)return t}function ao(f){return f.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(f.nodeName)}function pu(f,t,i,r,s){for(;;){if(f==i&&t==r)return!0;if(t==(s<0?0:si(f))){if(f.nodeName=="DIV")return!1;let h=f.parentNode;if(!h||h.nodeType!=1)return!1;t=ln(f)+(s<0?0:1),f=h}else if(f.nodeType==1){if(f=f.childNodes[t+(s<0?-1:0)],f.nodeType==1&&f.contentEditable=="false")return!1;t=s<0?si(f):0}else return!1}}function si(f){return f.nodeType==3?f.nodeValue.length:f.childNodes.length}function jr(f,t){let i=t?f.left:f.right;return{left:i,right:i,top:f.top,bottom:f.bottom}}function A0(f){let t=f.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:f.innerWidth,top:0,bottom:f.innerHeight}}function Mc(f,t){let i=t.width/f.offsetWidth,r=t.height/f.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.width-f.offsetWidth)<1)&&(i=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(t.height-f.offsetHeight)<1)&&(r=1),{scaleX:i,scaleY:r}}function M0(f,t,i,r,s,h,u,d){let p=f.ownerDocument,v=p.defaultView||window;for(let y=f,x=!1;y&&!x;)if(y.nodeType==1){let S,A=y==p.body,M=1,D=1;if(A)S=A0(v);else{if(/^(fixed|sticky)$/.test(getComputedStyle(y).position)&&(x=!0),y.scrollHeight<=y.clientHeight&&y.scrollWidth<=y.clientWidth){y=y.assignedSlot||y.parentNode;continue}let H=y.getBoundingClientRect();({scaleX:M,scaleY:D}=Mc(y,H)),S={left:H.left,right:H.left+y.clientWidth*M,top:H.top,bottom:H.top+y.clientHeight*D}}let N=0,P=0;if(s=="nearest")t.top<S.top?(P=t.top-(S.top+u),i>0&&t.bottom>S.bottom+P&&(P=t.bottom-S.bottom+u)):t.bottom>S.bottom&&(P=t.bottom-S.bottom+u,i<0&&t.top-P<S.top&&(P=t.top-(S.top+u)));else{let H=t.bottom-t.top,Y=S.bottom-S.top;P=(s=="center"&&H<=Y?t.top+H/2-Y/2:s=="start"||s=="center"&&i<0?t.top-u:t.bottom-Y+u)-S.top}if(r=="nearest"?t.left<S.left?(N=t.left-(S.left+h),i>0&&t.right>S.right+N&&(N=t.right-S.right+h)):t.right>S.right&&(N=t.right-S.right+h,i<0&&t.left<S.left+N&&(N=t.left-(S.left+h))):N=(r=="center"?t.left+(t.right-t.left)/2-(S.right-S.left)/2:r=="start"==d?t.left-h:t.right-(S.right-S.left)+h)-S.left,N||P)if(A)v.scrollBy(N,P);else{let H=0,Y=0;if(P){let J=y.scrollTop;y.scrollTop+=P/D,Y=(y.scrollTop-J)*D}if(N){let J=y.scrollLeft;y.scrollLeft+=N/M,H=(y.scrollLeft-J)*M}t={left:t.left-H,top:t.top-Y,right:t.right-H,bottom:t.bottom-Y},H&&Math.abs(H-N)<1&&(r="nearest"),Y&&Math.abs(Y-P)<1&&(s="nearest")}if(A)break;(t.top<S.top||t.bottom>S.bottom||t.left<S.left||t.right>S.right)&&(t={left:Math.max(t.left,S.left),right:Math.min(t.right,S.right),top:Math.max(t.top,S.top),bottom:Math.min(t.bottom,S.bottom)}),y=y.assignedSlot||y.parentNode}else if(y.nodeType==11)y=y.host;else break}function T0(f){let t=f.ownerDocument,i,r;for(let s=f.parentNode;s&&!(s==t.body||i&&r);)if(s.nodeType==1)!r&&s.scrollHeight>s.clientHeight&&(r=s),!i&&s.scrollWidth>s.clientWidth&&(i=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:i,y:r}}class L0{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:i,focusNode:r}=t;this.set(i,Math.min(t.anchorOffset,i?si(i):0),r,Math.min(t.focusOffset,r?si(r):0))}set(t,i,r,s){this.anchorNode=t,this.anchorOffset=i,this.focusNode=r,this.focusOffset=s}}let Rn=null;function Tc(f){if(f.setActive)return f.setActive();if(Rn)return f.focus(Rn);let t=[];for(let i=f;i&&(t.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(f.focus(Rn==null?{get preventScroll(){return Rn={preventScroll:!0},!0}}:void 0),!Rn){Rn=!1;for(let i=0;i<t.length;){let r=t[i++],s=t[i++],h=t[i++];r.scrollTop!=s&&(r.scrollTop=s),r.scrollLeft!=h&&(r.scrollLeft=h)}}}let gu;function an(f,t,i=t){let r=gu||(gu=document.createRange());return r.setEnd(f,i),r.setStart(f,t),r}function zn(f,t,i,r){let s={key:t,code:t,keyCode:i,which:i,cancelable:!0};r&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=r);let h=new KeyboardEvent("keydown",s);h.synthetic=!0,f.dispatchEvent(h);let u=new KeyboardEvent("keyup",s);return u.synthetic=!0,f.dispatchEvent(u),h.defaultPrevented||u.defaultPrevented}function O0(f){for(;f;){if(f&&(f.nodeType==9||f.nodeType==11&&f.host))return f;f=f.assignedSlot||f.parentNode}return null}function Lc(f){for(;f.attributes.length;)f.removeAttributeNode(f.attributes[0])}function D0(f,t){let i=t.focusNode,r=t.focusOffset;if(!i||t.anchorNode!=i||t.anchorOffset!=r)return!1;for(r=Math.min(r,si(i));;)if(r){if(i.nodeType!=1)return!1;let s=i.childNodes[r-1];s.contentEditable=="false"?r--:(i=s,r=si(i))}else{if(i==f)return!0;r=ln(i),i=i.parentNode}}function Oc(f){return f.scrollTop>Math.max(1,f.scrollHeight-f.clientHeight-4)}function Dc(f,t){for(let i=f,r=t;;){if(i.nodeType==3&&r>0)return{node:i,offset:r};if(i.nodeType==1&&r>0){if(i.contentEditable=="false")return null;i=i.childNodes[r-1],r=si(i)}else if(i.parentNode&&!ao(i))r=ln(i),i=i.parentNode;else return null}}function Nc(f,t){for(let i=f,r=t;;){if(i.nodeType==3&&r<i.nodeValue.length)return{node:i,offset:r};if(i.nodeType==1&&r<i.childNodes.length){if(i.contentEditable=="false")return null;i=i.childNodes[r],r=0}else if(i.parentNode&&!ao(i))r=ln(i)+1,i=i.parentNode;else return null}}class se{constructor(t,i,r=!0){this.node=t,this.offset=i,this.precise=r}static before(t,i){return new se(t.parentNode,ln(t),i)}static after(t,i){return new se(t.parentNode,ln(t)+1,i)}}const Ba=[];class wt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let i=this.posAtStart;for(let r of this.children){if(r==t)return i;i+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,i){if(this.flags&2){let r=this.dom,s=null,h;for(let u of this.children){if(u.flags&7){if(!u.dom&&(h=s?s.nextSibling:r.firstChild)){let d=wt.get(h);(!d||!d.parent&&d.canReuseDOM(u))&&u.reuseDOM(h)}u.sync(t,i),u.flags&=-8}if(h=s?s.nextSibling:r.firstChild,i&&!i.written&&i.node==r&&h!=u.dom&&(i.written=!0),u.dom.parentNode==r)for(;h&&h!=u.dom;)h=mu(h);else r.insertBefore(u.dom,h);s=u.dom}for(h=s?s.nextSibling:r.firstChild,h&&i&&i.node==r&&(i.written=!0);h;)h=mu(h)}else if(this.flags&1)for(let r of this.children)r.flags&7&&(r.sync(t,i),r.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,i){let r;if(t==this.dom)r=this.dom.childNodes[i];else{let s=si(t)==0?0:i==0?-1:1;for(;;){let h=t.parentNode;if(h==this.dom)break;s==0&&h.firstChild!=h.lastChild&&(t==h.firstChild?s=-1:s=1),t=h}s<0?r=t:r=t.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!wt.get(r);)r=r.nextSibling;if(!r)return this.length;for(let s=0,h=0;;s++){let u=this.children[s];if(u.dom==r)return h;h+=u.length+u.breakAfter}}domBoundsAround(t,i,r=0){let s=-1,h=-1,u=-1,d=-1;for(let p=0,v=r,y=r;p<this.children.length;p++){let x=this.children[p],S=v+x.length;if(v<t&&S>i)return x.domBoundsAround(t,i,v);if(S>=t&&s==-1&&(s=p,h=v),v>i&&x.dom.parentNode==this.dom){u=p,d=y;break}y=S,v=S+x.breakAfter}return{from:h,to:d<0?r+this.length:d,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:u<this.children.length&&u>=0?this.children[u].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let i=this.parent;i;i=i.parent){if(t&&(i.flags|=2),i.flags&1)return;i.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let i=t.parent;if(!i)return t;t=i}}replaceChildren(t,i,r=Ba){this.markDirty();for(let s=t;s<i;s++){let h=this.children[s];h.parent==this&&r.indexOf(h)<0&&h.destroy()}r.length<250?this.children.splice(t,i-t,...r):this.children=[].concat(this.children.slice(0,t),r,this.children.slice(i));for(let s=0;s<r.length;s++)r[s].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Pc(this.children,t,this.children.length)}childPos(t,i=1){return this.childCursor().findPos(t,i)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,i,r,s,h,u){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}wt.prototype.breakAfter=0;function mu(f){let t=f.nextSibling;return f.parentNode.removeChild(f),t}class Pc{constructor(t,i,r){this.children=t,this.pos=i,this.i=r,this.off=0}findPos(t,i=1){for(;;){if(t>this.pos||t==this.pos&&(i>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function Ec(f,t,i,r,s,h,u,d,p){let{children:v}=f,y=v.length?v[t]:null,x=h.length?h[h.length-1]:null,S=x?x.breakAfter:u;if(!(t==r&&y&&!u&&!S&&h.length<2&&y.merge(i,s,h.length?x:null,i==0,d,p))){if(r<v.length){let A=v[r];A&&(s<A.length||A.breakAfter&&(x!=null&&x.breakAfter))?(t==r&&(A=A.split(s),s=0),!S&&x&&A.merge(0,s,x,!0,0,p)?h[h.length-1]=A:((s||A.children.length&&!A.children[0].length)&&A.merge(0,s,null,!1,0,p),h.push(A))):A!=null&&A.breakAfter&&(x?x.breakAfter=1:u=1),r++}for(y&&(y.breakAfter=u,i>0&&(!u&&h.length&&y.merge(i,y.length,h[0],!1,d,0)?y.breakAfter=h.shift().breakAfter:(i<y.length||y.children.length&&y.children[y.children.length-1].length==0)&&y.merge(i,y.length,null,!1,d,0),t++));t<r&&h.length;)if(v[r-1].become(h[h.length-1]))r--,h.pop(),p=h.length?0:d;else if(v[t].become(h[0]))t++,h.shift(),d=h.length?0:p;else break;!h.length&&t&&r<v.length&&!v[t-1].breakAfter&&v[r].merge(0,0,v[t-1],!1,d,p)&&t--,(t<r||h.length)&&f.replaceChildren(t,r,h)}}function Bc(f,t,i,r,s,h){let u=f.childCursor(),{i:d,off:p}=u.findPos(i,1),{i:v,off:y}=u.findPos(t,-1),x=t-i;for(let S of r)x+=S.length;f.length+=x,Ec(f,v,y,d,p,r,0,s,h)}let xe=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},ha=typeof document<"u"?document:{documentElement:{style:{}}};const fa=/Edge\/(\d+)/.exec(xe.userAgent),Rc=/MSIE \d/.test(xe.userAgent),ua=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(xe.userAgent),vo=!!(Rc||ua||fa),vu=!vo&&/gecko\/(\d+)/i.test(xe.userAgent),Wl=!vo&&/Chrome\/(\d+)/.exec(xe.userAgent),yu="webkitFontSmoothing"in ha.documentElement.style,Ic=!vo&&/Apple Computer/.test(xe.vendor),bu=Ic&&(/Mobile\/\w+/.test(xe.userAgent)||xe.maxTouchPoints>2);var V={mac:bu||/Mac/.test(xe.platform),windows:/Win/.test(xe.platform),linux:/Linux|X11/.test(xe.platform),ie:vo,ie_version:Rc?ha.documentMode||6:ua?+ua[1]:fa?+fa[1]:0,gecko:vu,gecko_version:vu?+(/Firefox\/(\d+)/.exec(xe.userAgent)||[0,0])[1]:0,chrome:!!Wl,chrome_version:Wl?+Wl[1]:0,ios:bu,android:/Android\b/.test(xe.userAgent),webkit:yu,safari:Ic,webkit_version:yu?+(/\bAppleWebKit\/(\d+)/.exec(xe.userAgent)||[0,0])[1]:0,tabSize:ha.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const N0=256;class Ke extends wt{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,i){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(i&&i.node==this.dom&&(i.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,i,r){return this.flags&8||r&&(!(r instanceof Ke)||this.length-(i-t)+r.length>N0||r.flags&8)?!1:(this.text=this.text.slice(0,t)+(r?r.text:"")+this.text.slice(i),this.markDirty(),!0)}split(t){let i=new Ke(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),i.flags|=this.flags&8,i}localPosFromDOM(t,i){return t==this.dom?i:i?this.text.length:0}domAtPos(t){return new se(this.dom,t)}domBoundsAround(t,i,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,i){return P0(this.dom,t,i)}}class yi extends wt{constructor(t,i=[],r=0){super(),this.mark=t,this.children=i,this.length=r;for(let s of i)s.setParent(this)}setAttrs(t){if(Lc(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let i in this.mark.attrs)t.setAttribute(i,this.mark.attrs[i]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,i){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,i)}merge(t,i,r,s,h,u){return r&&(!(r instanceof yi&&r.mark.eq(this.mark))||t&&h<=0||i<this.length&&u<=0)?!1:(Bc(this,t,i,r?r.children.slice():[],h-1,u-1),this.markDirty(),!0)}split(t){let i=[],r=0,s=-1,h=0;for(let d of this.children){let p=r+d.length;p>t&&i.push(r<t?d.split(t-r):d),s<0&&r>=t&&(s=h),r=p,h++}let u=this.length-t;return this.length=t,s>-1&&(this.children.length=s,this.markDirty()),new yi(this.mark,i,u)}domAtPos(t){return Wc(this,t)}coordsAt(t,i){return Fc(this,t,i)}}function P0(f,t,i){let r=f.nodeValue.length;t>r&&(t=r);let s=t,h=t,u=0;t==0&&i<0||t==r&&i>=0?V.chrome||V.gecko||(t?(s--,u=1):h<r&&(h++,u=-1)):i<0?s--:h<r&&h++;let d=an(f,s,h).getClientRects();if(!d.length)return null;let p=d[(u?u<0:i>=0)?0:d.length-1];return V.safari&&!u&&p.width==0&&(p=Array.prototype.find.call(d,v=>v.width)||p),u?jr(p,u<0):p||null}class sn extends wt{static create(t,i,r){return new sn(t,i,r)}constructor(t,i,r){super(),this.widget=t,this.length=i,this.side=r,this.prevWidget=null}split(t){let i=sn.create(this.widget,this.length-t,this.side);return this.length-=t,i}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,i,r,s,h,u){return r&&(!(r instanceof sn)||!this.widget.compare(r.widget)||t>0&&h<=0||i<this.length&&u<=0)?!1:(this.length=t+(r?r.length:0)+(this.length-i),!0)}become(t){return t instanceof sn&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return dt.empty;let t=this;for(;t.parent;)t=t.parent;let{view:i}=t,r=i&&i.state.doc,s=this.posAtStart;return r?r.slice(s,s+this.length):dt.empty}domAtPos(t){return(this.length?t==0:this.side>0)?se.before(this.dom):se.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,i){let r=this.widget.coordsAt(this.dom,t,i);if(r)return r;let s=this.dom.getClientRects(),h=null;if(!s.length)return null;let u=this.side?this.side<0:t>0;for(let d=u?s.length-1:0;h=s[d],!(t>0?d==0:d==s.length-1||h.top<h.bottom);d+=u?-1:1);return jr(h,!u)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class qn extends wt{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof qn&&t.side==this.side}split(){return new qn(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?se.before(this.dom):se.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return dt.empty}get isHidden(){return!0}}Ke.prototype.children=sn.prototype.children=qn.prototype.children=Ba;function Wc(f,t){let i=f.dom,{children:r}=f,s=0;for(let h=0;s<r.length;s++){let u=r[s],d=h+u.length;if(!(d==h&&u.getSide()<=0)){if(t>h&&t<d&&u.dom.parentNode==i)return u.domAtPos(t-h);if(t<=h)break;h=d}}for(let h=s;h>0;h--){let u=r[h-1];if(u.dom.parentNode==i)return u.domAtPos(u.length)}for(let h=s;h<r.length;h++){let u=r[h];if(u.dom.parentNode==i)return u.domAtPos(0)}return new se(i,0)}function Hc(f,t,i){let r,{children:s}=f;i>0&&t instanceof yi&&s.length&&(r=s[s.length-1])instanceof yi&&r.mark.eq(t.mark)?Hc(r,t.children[0],i-1):(s.push(t),t.setParent(f)),f.length+=t.length}function Fc(f,t,i){let r=null,s=-1,h=null,u=-1;function d(v,y){for(let x=0,S=0;x<v.children.length&&S<=y;x++){let A=v.children[x],M=S+A.length;M>=y&&(A.children.length?d(A,y-S):(!h||h.isHidden&&(i>0||B0(h,A)))&&(M>y||S==M&&A.getSide()>0)?(h=A,u=y-S):(S<y||S==M&&A.getSide()<0&&!A.isHidden)&&(r=A,s=y-S)),S=M}}d(f,t);let p=(i<0?r:h)||r||h;return p?p.coordsAt(Math.max(0,p==r?s:u),i):E0(f)}function E0(f){let t=f.dom.lastChild;if(!t)return f.dom.getBoundingClientRect();let i=Vn(t);return i[i.length-1]||null}function B0(f,t){let i=f.coordsAt(0,1),r=t.coordsAt(0,1);return i&&r&&r.top<i.bottom}function ca(f,t){for(let i in f)i=="class"&&t.class?t.class+=" "+f.class:i=="style"&&t.style?t.style+=";"+f.style:t[i]=f[i];return t}const wu=Object.create(null);function ho(f,t,i){if(f==t)return!0;f||(f=wu),t||(t=wu);let r=Object.keys(f),s=Object.keys(t);if(r.length-(i&&r.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let h of r)if(h!=i&&(s.indexOf(h)==-1||f[h]!==t[h]))return!1;return!0}function da(f,t,i){let r=!1;if(t)for(let s in t)i&&s in i||(r=!0,s=="style"?f.style.cssText="":f.removeAttribute(s));if(i)for(let s in i)t&&t[s]==i[s]||(r=!0,s=="style"?f.style.cssText=i[s]:f.setAttribute(s,i[s]));return r}function R0(f){let t=Object.create(null);for(let i=0;i<f.attributes.length;i++){let r=f.attributes[i];t[r.name]=r.value}return t}class yo{eq(t){return!1}updateDOM(t,i){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,i,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var ri=function(f){return f[f.Text=0]="Text",f[f.WidgetBefore=1]="WidgetBefore",f[f.WidgetAfter=2]="WidgetAfter",f[f.WidgetRange=3]="WidgetRange",f}(ri||(ri={}));class Ht extends Gn{constructor(t,i,r,s){super(),this.startSide=t,this.endSide=i,this.widget=r,this.spec=s}get heightRelevant(){return!1}static mark(t){return new Jr(t)}static widget(t){let i=Math.max(-1e4,Math.min(1e4,t.side||0)),r=!!t.block;return i+=r&&!t.inlineOrder?i>0?3e8:-4e8:i>0?1e8:-1e8,new Hi(t,i,i,r,t.widget||null,!1)}static replace(t){let i=!!t.block,r,s;if(t.isBlockGap)r=-5e8,s=4e8;else{let{start:h,end:u}=zc(t,i);r=(h?i?-3e8:-1:5e8)-1,s=(u?i?2e8:1:-6e8)+1}return new Hi(t,r,s,i,t.widget||null,!0)}static line(t){return new Zr(t)}static set(t,i=!1){return At.of(t,i)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ht.none=At.empty;class Jr extends Ht{constructor(t){let{start:i,end:r}=zc(t);super(i?-1:5e8,r?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var i,r;return this==t||t instanceof Jr&&this.tagName==t.tagName&&(this.class||((i=this.attrs)===null||i===void 0?void 0:i.class))==(t.class||((r=t.attrs)===null||r===void 0?void 0:r.class))&&ho(this.attrs,t.attrs,"class")}range(t,i=t){if(t>=i)throw new RangeError("Mark decorations may not be empty");return super.range(t,i)}}Jr.prototype.point=!1;class Zr extends Ht{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof Zr&&this.spec.class==t.spec.class&&ho(this.spec.attributes,t.spec.attributes)}range(t,i=t){if(i!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,i)}}Zr.prototype.mapMode=Le.TrackBefore;Zr.prototype.point=!0;class Hi extends Ht{constructor(t,i,r,s,h,u){super(i,r,h,t),this.block=s,this.isReplace=u,this.mapMode=s?i<=0?Le.TrackBefore:Le.TrackAfter:Le.TrackDel}get type(){return this.startSide!=this.endSide?ri.WidgetRange:this.startSide<=0?ri.WidgetBefore:ri.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof Hi&&I0(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,i=t){if(this.isReplace&&(t>i||t==i&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&i!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,i)}}Hi.prototype.point=!0;function zc(f,t=!1){let{inclusiveStart:i,inclusiveEnd:r}=f;return i==null&&(i=f.inclusive),r==null&&(r=f.inclusive),{start:i??t,end:r??t}}function I0(f,t){return f==t||!!(f&&t&&f.compare(t))}function eo(f,t,i,r=0){let s=i.length-1;s>=0&&i[s]+r>=f?i[s]=Math.max(i[s],t):i.push(f,t)}class It extends wt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,i,r,s,h,u){if(r){if(!(r instanceof It))return!1;this.dom||r.transferDOM(this)}return s&&this.setDeco(r?r.attrs:null),Bc(this,t,i,r?r.children.slice():[],h,u),!0}split(t){let i=new It;if(i.breakAfter=this.breakAfter,this.length==0)return i;let{i:r,off:s}=this.childPos(t);s&&(i.append(this.children[r].split(s),0),this.children[r].merge(s,this.children[r].length,null,!1,0,0),r++);for(let h=r;h<this.children.length;h++)i.append(this.children[h],0);for(;r>0&&this.children[r-1].length==0;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=t,i}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){ho(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,i){Hc(this,t,i)}addLineDeco(t){let i=t.spec.attributes,r=t.spec.class;i&&(this.attrs=ca(i,this.attrs||{})),r&&(this.attrs=ca({class:r},this.attrs||{}))}domAtPos(t){return Wc(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,i){var r;this.dom?this.flags&4&&(Lc(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(da(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,i);let s=this.dom.lastChild;for(;s&&wt.get(s)instanceof yi;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((r=wt.get(s))===null||r===void 0?void 0:r.isEditable)==!1&&(!V.ios||!this.children.some(h=>h instanceof Ke))){let h=document.createElement("BR");h.cmIgnore=!0,this.dom.appendChild(h)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,i;for(let r of this.children){if(!(r instanceof Ke)||/[^ -~]/.test(r.text))return null;let s=Vn(r.dom);if(s.length!=1)return null;t+=s[0].width,i=s[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:i}:null}coordsAt(t,i){let r=Fc(this,t,i);if(!this.children.length&&r&&this.parent){let{heightOracle:s}=this.parent.view.viewState,h=r.bottom-r.top;if(Math.abs(h-s.lineHeight)<2&&s.textHeight<h){let u=(h-s.textHeight)/2;return{top:r.top+u,bottom:r.bottom-u,left:r.left,right:r.left}}}return r}become(t){return t instanceof It&&this.children.length==0&&t.children.length==0&&ho(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,i){for(let r=0,s=0;r<t.children.length;r++){let h=t.children[r],u=s+h.length;if(u>=i){if(h instanceof It)return h;if(u>i)break}s=u+h.breakAfter}return null}}class vi extends wt{constructor(t,i,r){super(),this.widget=t,this.length=i,this.deco=r,this.breakAfter=0,this.prevWidget=null}merge(t,i,r,s,h,u){return r&&(!(r instanceof vi)||!this.widget.compare(r.widget)||t>0&&h<=0||i<this.length&&u<=0)?!1:(this.length=t+(r?r.length:0)+(this.length-i),!0)}domAtPos(t){return t==0?se.before(this.dom):se.after(this.dom,t==this.length)}split(t){let i=this.length-t;this.length=t;let r=new vi(this.widget,i,this.deco);return r.breakAfter=this.breakAfter,r}get children(){return Ba}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):dt.empty}domBoundsAround(){return null}become(t){return t instanceof vi&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,i){let r=this.widget.coordsAt(this.dom,t,i);return r||(this.widget instanceof pa?null:jr(this.dom.getBoundingClientRect(),this.length?t==0:i<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:i,endSide:r}=this.deco;return i==r?!1:t<0?i<0:r>0}}class pa extends yo{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Kr{constructor(t,i,r,s){this.doc=t,this.pos=i,this.end=r,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=i}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof vi&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new It),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Hs(new qn(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof vi)&&this.getLine()}buildText(t,i,r){for(;t>0;){if(this.textOff==this.text.length){let{value:h,lineBreak:u,done:d}=this.cursor.next(this.skip);if(this.skip=0,d)throw new Error("Ran out of text content when drawing inline views");if(u){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=h,this.textOff=0}let s=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(i.slice(i.length-r)),this.getLine().append(Hs(new Ke(this.text.slice(this.textOff,this.textOff+s)),i),r),this.atCursorPos=!0,this.textOff+=s,t-=s,r=0}}span(t,i,r,s){this.buildText(i-t,r,s),this.pos=i,this.openStart<0&&(this.openStart=s)}point(t,i,r,s,h,u){if(this.disallowBlockEffectsFor[u]&&r instanceof Hi){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(i>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let d=i-t;if(r instanceof Hi)if(r.block)r.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new vi(r.widget||Yn.block,d,r));else{let p=sn.create(r.widget||Yn.inline,d,d?0:r.startSide),v=this.atCursorPos&&!p.isEditable&&h<=s.length&&(t<i||r.startSide>0),y=!p.isEditable&&(t<i||h>s.length||r.startSide<=0),x=this.getLine();this.pendingBuffer==2&&!v&&!p.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),v&&(x.append(Hs(new qn(1),s),h),h=s.length+Math.max(0,h-s.length)),x.append(Hs(p,s),h),this.atCursorPos=y,this.pendingBuffer=y?t<i||h>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);d&&(this.textOff+d<=this.text.length?this.textOff+=d:(this.skip+=d-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=i),this.openStart<0&&(this.openStart=h)}static build(t,i,r,s,h){let u=new Kr(t,i,r,h);return u.openEnd=At.spans(s,i,r,u),u.openStart<0&&(u.openStart=u.openEnd),u.finish(u.openEnd),u}}function Hs(f,t){for(let i of t)f=new yi(i,[f],f.length);return f}class Yn extends yo{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Yn.inline=new Yn("span");Yn.block=new Yn("div");var te=function(f){return f[f.LTR=0]="LTR",f[f.RTL=1]="RTL",f}(te||(te={}));const hn=te.LTR,Ra=te.RTL;function Kc(f){let t=[];for(let i=0;i<f.length;i++)t.push(1<<+f[i]);return t}const W0=Kc("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),H0=Kc("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),ga=Object.create(null),Je=[];for(let f of["()","[]","{}"]){let t=f.charCodeAt(0),i=f.charCodeAt(1);ga[t]=i,ga[i]=-t}function Uc(f){return f<=247?W0[f]:1424<=f&&f<=1524?2:1536<=f&&f<=1785?H0[f-1536]:1774<=f&&f<=2220?4:8192<=f&&f<=8204?256:64336<=f&&f<=65023?4:1}const F0=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Bi{get dir(){return this.level%2?Ra:hn}constructor(t,i,r){this.from=t,this.to=i,this.level=r}side(t,i){return this.dir==i==t?this.to:this.from}forward(t,i){return t==(this.dir==i)}static find(t,i,r,s){let h=-1;for(let u=0;u<t.length;u++){let d=t[u];if(d.from<=i&&d.to>=i){if(d.level==r)return u;(h<0||(s!=0?s<0?d.from<i:d.to>i:t[h].level>d.level))&&(h=u)}}if(h<0)throw new RangeError("Index out of range");return h}}function Gc(f,t){if(f.length!=t.length)return!1;for(let i=0;i<f.length;i++){let r=f[i],s=t[i];if(r.from!=s.from||r.to!=s.to||r.direction!=s.direction||!Gc(r.inner,s.inner))return!1}return!0}const bt=[];function z0(f,t,i,r,s){for(let h=0;h<=r.length;h++){let u=h?r[h-1].to:t,d=h<r.length?r[h].from:i,p=h?256:s;for(let v=u,y=p,x=p;v<d;v++){let S=Uc(f.charCodeAt(v));S==512?S=y:S==8&&x==4&&(S=16),bt[v]=S==4?2:S,S&7&&(x=S),y=S}for(let v=u,y=p,x=p;v<d;v++){let S=bt[v];if(S==128)v<d-1&&y==bt[v+1]&&y&24?S=bt[v]=y:bt[v]=256;else if(S==64){let A=v+1;for(;A<d&&bt[A]==64;)A++;let M=v&&y==8||A<i&&bt[A]==8?x==1?1:8:256;for(let D=v;D<A;D++)bt[D]=M;v=A-1}else S==8&&x==1&&(bt[v]=1);y=S,S&7&&(x=S)}}}function K0(f,t,i,r,s){let h=s==1?2:1;for(let u=0,d=0,p=0;u<=r.length;u++){let v=u?r[u-1].to:t,y=u<r.length?r[u].from:i;for(let x=v,S,A,M;x<y;x++)if(A=ga[S=f.charCodeAt(x)])if(A<0){for(let D=d-3;D>=0;D-=3)if(Je[D+1]==-A){let N=Je[D+2],P=N&2?s:N&4?N&1?h:s:0;P&&(bt[x]=bt[Je[D]]=P),d=D;break}}else{if(Je.length==189)break;Je[d++]=x,Je[d++]=S,Je[d++]=p}else if((M=bt[x])==2||M==1){let D=M==s;p=D?0:1;for(let N=d-3;N>=0;N-=3){let P=Je[N+2];if(P&2)break;if(D)Je[N+2]|=2;else{if(P&4)break;Je[N+2]|=4}}}}}function U0(f,t,i,r){for(let s=0,h=r;s<=i.length;s++){let u=s?i[s-1].to:f,d=s<i.length?i[s].from:t;for(let p=u;p<d;){let v=bt[p];if(v==256){let y=p+1;for(;;)if(y==d){if(s==i.length)break;y=i[s++].to,d=s<i.length?i[s].from:t}else if(bt[y]==256)y++;else break;let x=h==1,S=(y<t?bt[y]:r)==1,A=x==S?x?1:2:r;for(let M=y,D=s,N=D?i[D-1].to:f;M>p;)M==N&&(M=i[--D].from,N=D?i[D-1].to:f),bt[--M]=A;p=y}else h=v,p++}}}function ma(f,t,i,r,s,h,u){let d=r%2?2:1;if(r%2==s%2)for(let p=t,v=0;p<i;){let y=!0,x=!1;if(v==h.length||p<h[v].from){let D=bt[p];D!=d&&(y=!1,x=D==16)}let S=!y&&d==1?[]:null,A=y?r:r+1,M=p;t:for(;;)if(v<h.length&&M==h[v].from){if(x)break t;let D=h[v];if(!y)for(let N=D.to,P=v+1;;){if(N==i)break t;if(P<h.length&&h[P].from==N)N=h[P++].to;else{if(bt[N]==d)break t;break}}if(v++,S)S.push(D);else{D.from>p&&u.push(new Bi(p,D.from,A));let N=D.direction==hn!=!(A%2);va(f,N?r+1:r,s,D.inner,D.from,D.to,u),p=D.to}M=D.to}else{if(M==i||(y?bt[M]!=d:bt[M]==d))break;M++}S?ma(f,p,M,r+1,s,S,u):p<M&&u.push(new Bi(p,M,A)),p=M}else for(let p=i,v=h.length;p>t;){let y=!0,x=!1;if(!v||p>h[v-1].to){let D=bt[p-1];D!=d&&(y=!1,x=D==16)}let S=!y&&d==1?[]:null,A=y?r:r+1,M=p;t:for(;;)if(v&&M==h[v-1].to){if(x)break t;let D=h[--v];if(!y)for(let N=D.from,P=v;;){if(N==t)break t;if(P&&h[P-1].to==N)N=h[--P].from;else{if(bt[N-1]==d)break t;break}}if(S)S.push(D);else{D.to<p&&u.push(new Bi(D.to,p,A));let N=D.direction==hn!=!(A%2);va(f,N?r+1:r,s,D.inner,D.from,D.to,u),p=D.from}M=D.from}else{if(M==t||(y?bt[M-1]!=d:bt[M-1]==d))break;M--}S?ma(f,M,p,r+1,s,S,u):M<p&&u.push(new Bi(M,p,A)),p=M}}function va(f,t,i,r,s,h,u){let d=t%2?2:1;z0(f,s,h,r,d),K0(f,s,h,r,d),U0(s,h,r,d),ma(f,s,h,t,i,r,u)}function G0(f,t,i){if(!f)return[new Bi(0,0,t==Ra?1:0)];if(t==hn&&!i.length&&!F0.test(f))return Vc(f.length);if(i.length)for(;f.length>bt.length;)bt[bt.length]=256;let r=[],s=t==hn?0:1;return va(f,s,s,i,0,f.length,r),r}function Vc(f){return[new Bi(0,f,0)]}let qc="";function V0(f,t,i,r,s){var h;let u=r.head-f.from,d=Bi.find(t,u,(h=r.bidiLevel)!==null&&h!==void 0?h:-1,r.assoc),p=t[d],v=p.side(s,i);if(u==v){let S=d+=s?1:-1;if(S<0||S>=t.length)return null;p=t[d=S],u=p.side(!s,i),v=p.side(s,i)}let y=ii(f.text,u,p.forward(s,i));(y<p.from||y>p.to)&&(y=v),qc=f.text.slice(Math.min(u,y),Math.max(u,y));let x=d==(s?t.length-1:0)?null:t[d+(s?1:-1)];return x&&y==v&&x.level+(s?0:1)<p.level?j.cursor(x.side(!s,i)+f.from,x.forward(s,i)?1:-1,x.level):j.cursor(y+f.from,p.forward(s,i)?-1:1,p.level)}function q0(f,t,i){for(let r=t;r<i;r++){let s=Uc(f.charCodeAt(r));if(s==1)return hn;if(s==2||s==4)return Ra}return hn}const Yc=st.define(),Xc=st.define(),_c=st.define(),jc=st.define(),ya=st.define(),Jc=st.define(),Zc=st.define(),Ia=st.define(),Wa=st.define(),Qc=st.define({combine:f=>f.some(t=>t)}),Y0=st.define({combine:f=>f.some(t=>t)}),$c=st.define();class Kn{constructor(t,i="nearest",r="nearest",s=5,h=5,u=!1){this.range=t,this.y=i,this.x=r,this.yMargin=s,this.xMargin=h,this.isSnapshot=u}map(t){return t.empty?this:new Kn(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Kn(j.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Fs=Wt.define({map:(f,t)=>f.map(t)}),td=Wt.define();function ni(f,t,i){let r=f.facet(jc);r.length?r[0](t):window.onerror&&window.onerror(String(t),i,void 0,void 0,t)||(i?console.error(i+":",t):console.error(t))}const pi=st.define({combine:f=>f.length?f[0]:!0});let X0=0;const Wn=st.define({combine(f){return f.filter((t,i)=>{for(let r=0;r<i;r++)if(f[r].plugin==t.plugin)return!1;return!0})}});class fn{constructor(t,i,r,s,h){this.id=t,this.create=i,this.domEventHandlers=r,this.domEventObservers=s,this.baseExtensions=h(this),this.extension=this.baseExtensions.concat(Wn.of({plugin:this,arg:void 0}))}of(t){return this.baseExtensions.concat(Wn.of({plugin:this,arg:t}))}static define(t,i){const{eventHandlers:r,eventObservers:s,provide:h,decorations:u}=i||{};return new fn(X0++,t,r,s,d=>{let p=[];return u&&p.push(Yr.of(v=>{let y=v.plugin(d);return y?u(y):Ht.none})),h&&p.push(h(d)),p})}static fromClass(t,i){return fn.define((r,s)=>new t(r,s),i)}}class Hl{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(t){if(this.value){if(this.mustUpdate){let i=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(i)}catch(r){if(ni(i.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(t,this.spec.arg)}catch(i){ni(t.state,i,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var i;if(!((i=this.value)===null||i===void 0)&&i.destroy)try{this.value.destroy()}catch(r){ni(t.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const ed=st.define(),Ha=st.define(),Yr=st.define(),id=st.define(),Fa=st.define(),nd=st.define();function xu(f,t){let i=f.state.facet(nd);if(!i.length)return i;let r=i.map(h=>h instanceof Function?h(f):h),s=[];return At.spans(r,t.from,t.to,{point(){},span(h,u,d,p){let v=h-t.from,y=u-t.from,x=s;for(let S=d.length-1;S>=0;S--,p--){let A=d[S].spec.bidiIsolate,M;if(A==null&&(A=q0(t.text,v,y)),p>0&&x.length&&(M=x[x.length-1]).to==v&&M.direction==A)M.to=y,x=M.inner;else{let D={from:v,to:y,direction:A,inner:[]};x.push(D),x=D.inner}}}}),s}const rd=st.define();function sd(f){let t=0,i=0,r=0,s=0;for(let h of f.state.facet(rd)){let u=h(f);u&&(u.left!=null&&(t=Math.max(t,u.left)),u.right!=null&&(i=Math.max(i,u.right)),u.top!=null&&(r=Math.max(r,u.top)),u.bottom!=null&&(s=Math.max(s,u.bottom)))}return{left:t,right:i,top:r,bottom:s}}const Rr=st.define();class Ee{constructor(t,i,r,s){this.fromA=t,this.toA=i,this.fromB=r,this.toB=s}join(t){return new Ee(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let i=t.length,r=this;for(;i>0;i--){let s=t[i-1];if(!(s.fromA>r.toA)){if(s.toA<r.fromA)break;r=r.join(s),t.splice(i-1,1)}}return t.splice(i,0,r),t}static extendWithRanges(t,i){if(i.length==0)return t;let r=[];for(let s=0,h=0,u=0,d=0;;s++){let p=s==t.length?null:t[s],v=u-d,y=p?p.fromB:1e9;for(;h<i.length&&i[h]<y;){let x=i[h],S=i[h+1],A=Math.max(d,x),M=Math.min(y,S);if(A<=M&&new Ee(A+v,M+v,A,M).addToSet(r),S>y)break;h+=2}if(!p)return r;new Ee(p.fromA,p.toA,p.fromB,p.toB).addToSet(r),u=p.toA,d=p.toB}}}class fo{constructor(t,i,r){this.view=t,this.state=i,this.transactions=r,this.flags=0,this.startState=t.state,this.changes=Xt.empty(this.startState.doc.length);for(let h of r)this.changes=this.changes.compose(h.changes);let s=[];this.changes.iterChangedRanges((h,u,d,p)=>s.push(new Ee(h,u,d,p))),this.changedRanges=s}static create(t,i,r){return new fo(t,i,r)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Su extends wt{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Ht.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new It],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Ee(0,0,0,t.state.doc.length)],0,null)}update(t){var i;let r=t.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:v,toA:y})=>y<this.minWidthFrom||v>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((i=this.domChanged)===null||i===void 0)&&i.newSel?s=this.domChanged.newSel.head:!tm(t.changes,this.hasComposition)&&!t.selectionSet&&(s=t.state.selection.main.head));let h=s>-1?j0(this.view,t.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:v,to:y}=this.hasComposition;r=new Ee(v,y,t.changes.mapPos(v,-1),t.changes.mapPos(y,1)).addToSet(r.slice())}this.hasComposition=h?{from:h.range.fromB,to:h.range.toB}:null,(V.ie||V.chrome)&&!h&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let u=this.decorations,d=this.updateDeco(),p=Q0(u,d,t.changes);return r=Ee.extendWithRanges(r,p),!(this.flags&7)&&r.length==0?!1:(this.updateInner(r,t.startState.doc.length,h),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,i,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,i,r);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let u=V.chrome||V.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,u),this.flags&=-8,u&&(u.written||s.selectionRange.focusNode!=u.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(u=>u.flags&=-9);let h=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let u of this.children)u instanceof vi&&u.widget instanceof pa&&h.push(u.dom);s.updateGaps(h)}updateChildren(t,i,r){let s=r?r.range.addToSet(t.slice()):t,h=this.childCursor(i);for(let u=s.length-1;;u--){let d=u>=0?s[u]:null;if(!d)break;let{fromA:p,toA:v,fromB:y,toB:x}=d,S,A,M,D;if(r&&r.range.fromB<x&&r.range.toB>y){let J=Kr.build(this.view.state.doc,y,r.range.fromB,this.decorations,this.dynamicDecorationMap),q=Kr.build(this.view.state.doc,r.range.toB,x,this.decorations,this.dynamicDecorationMap);A=J.breakAtStart,M=J.openStart,D=q.openEnd;let et=this.compositionView(r);q.breakAtStart?et.breakAfter=1:q.content.length&&et.merge(et.length,et.length,q.content[0],!1,q.openStart,0)&&(et.breakAfter=q.content[0].breakAfter,q.content.shift()),J.content.length&&et.merge(0,0,J.content[J.content.length-1],!0,0,J.openEnd)&&J.content.pop(),S=J.content.concat(et).concat(q.content)}else({content:S,breakAtStart:A,openStart:M,openEnd:D}=Kr.build(this.view.state.doc,y,x,this.decorations,this.dynamicDecorationMap));let{i:N,off:P}=h.findPos(v,1),{i:H,off:Y}=h.findPos(p,-1);Ec(this,H,Y,N,P,S,A,M,D)}r&&this.fixCompositionDOM(r)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let i of t.transactions)for(let r of i.effects)r.is(td)&&(this.editContextFormatting=r.value)}compositionView(t){let i=new Ke(t.text.nodeValue);i.flags|=8;for(let{deco:s}of t.marks)i=new yi(s,[i],i.length);let r=new It;return r.append(i,0),r}fixCompositionDOM(t){let i=(h,u)=>{u.flags|=8|(u.children.some(p=>p.flags&7)?1:0),this.markedForComposition.add(u);let d=wt.get(h);d&&d!=u&&(d.dom=null),u.setDOM(h)},r=this.childPos(t.range.fromB,1),s=this.children[r.i];i(t.line,s);for(let h=t.marks.length-1;h>=-1;h--)r=s.childPos(r.off,1),s=s.children[r.i],i(h>=0?t.marks[h].node:t.text,s)}updateSelection(t=!1,i=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,s=r==this.dom,h=!s&&!(this.view.state.facet(pi)||this.dom.tabIndex>-1)&&to(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(s||i||h))return;let u=this.forceSelection;this.forceSelection=!1;let d=this.view.state.selection.main,p=this.moveToLine(this.domAtPos(d.anchor)),v=d.empty?p:this.moveToLine(this.domAtPos(d.head));if(V.gecko&&d.empty&&!this.hasComposition&&_0(p)){let x=document.createTextNode("");this.view.observer.ignore(()=>p.node.insertBefore(x,p.node.childNodes[p.offset]||null)),p=v=new se(x,0),u=!0}let y=this.view.observer.selectionRange;(u||!y.focusNode||(!zr(p.node,p.offset,y.anchorNode,y.anchorOffset)||!zr(v.node,v.offset,y.focusNode,y.focusOffset))&&!this.suppressWidgetCursorChange(y,d))&&(this.view.observer.ignore(()=>{V.android&&V.chrome&&this.dom.contains(y.focusNode)&&$0(y.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let x=qr(this.view.root);if(x)if(d.empty){if(V.gecko){let S=J0(p.node,p.offset);if(S&&S!=3){let A=(S==1?Dc:Nc)(p.node,p.offset);A&&(p=new se(A.node,A.offset))}}x.collapse(p.node,p.offset),d.bidiLevel!=null&&x.caretBidiLevel!==void 0&&(x.caretBidiLevel=d.bidiLevel)}else if(x.extend){x.collapse(p.node,p.offset);try{x.extend(v.node,v.offset)}catch{}}else{let S=document.createRange();d.anchor>d.head&&([p,v]=[v,p]),S.setEnd(v.node,v.offset),S.setStart(p.node,p.offset),x.removeAllRanges(),x.addRange(S)}h&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(p,v)),this.impreciseAnchor=p.precise?null:new se(y.anchorNode,y.anchorOffset),this.impreciseHead=v.precise?null:new se(y.focusNode,y.focusOffset)}suppressWidgetCursorChange(t,i){return this.hasComposition&&i.empty&&zr(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==i.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,i=t.state.selection.main,r=qr(t.root),{anchorNode:s,anchorOffset:h}=t.observer.selectionRange;if(!r||!i.empty||!i.assoc||!r.modify)return;let u=It.find(this,i.head);if(!u)return;let d=u.posAtStart;if(i.head==d||i.head==d+u.length)return;let p=this.coordsAt(i.head,-1),v=this.coordsAt(i.head,1);if(!p||!v||p.bottom>v.top)return;let y=this.domAtPos(i.head+i.assoc);r.collapse(y.node,y.offset),r.modify("move",i.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let x=t.observer.selectionRange;t.docView.posFromDOM(x.anchorNode,x.anchorOffset)!=i.from&&r.collapse(s,h)}moveToLine(t){let i=this.dom,r;if(t.node!=i)return t;for(let s=t.offset;!r&&s<i.childNodes.length;s++){let h=wt.get(i.childNodes[s]);h instanceof It&&(r=h.domAtPos(0))}for(let s=t.offset-1;!r&&s>=0;s--){let h=wt.get(i.childNodes[s]);h instanceof It&&(r=h.domAtPos(h.length))}return r?new se(r.node,r.offset,!0):t}nearest(t){for(let i=t;i;){let r=wt.get(i);if(r&&r.rootView==this)return r;i=i.parentNode}return null}posFromDOM(t,i){let r=this.nearest(t);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(t,i)+r.posAtStart}domAtPos(t){let{i,off:r}=this.childCursor().findPos(t,-1);for(;i<this.children.length-1;){let s=this.children[i];if(r<s.length||s instanceof It)break;i++,r=0}return this.children[i].domAtPos(r)}coordsAt(t,i){let r=null,s=0;for(let h=this.length,u=this.children.length-1;u>=0;u--){let d=this.children[u],p=h-d.breakAfter,v=p-d.length;if(p<t)break;if(v<=t&&(v<t||d.covers(-1))&&(p>t||d.covers(1))&&(!r||d instanceof It&&!(r instanceof It&&i>=0)))r=d,s=v;else if(r&&v==t&&p==t&&d instanceof vi&&Math.abs(i)<2){if(d.deco.startSide<0)break;u&&(r=null)}h=v}return r?r.coordsAt(t-s,i):null}coordsForChar(t){let{i,off:r}=this.childPos(t,1),s=this.children[i];if(!(s instanceof It))return null;for(;s.children.length;){let{i:d,off:p}=s.childPos(r,1);for(;;d++){if(d==s.children.length)return null;if((s=s.children[d]).length)break}r=p}if(!(s instanceof Ke))return null;let h=ii(s.text,r);if(h==r)return null;let u=an(s.dom,r,h).getClientRects();for(let d=0;d<u.length;d++){let p=u[d];if(d==u.length-1||p.top<p.bottom&&p.left<p.right)return p}return null}measureVisibleLineHeights(t){let i=[],{from:r,to:s}=t,h=this.view.contentDOM.clientWidth,u=h>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,d=-1,p=this.view.textDirection==te.LTR;for(let v=0,y=0;y<this.children.length;y++){let x=this.children[y],S=v+x.length;if(S>s)break;if(v>=r){let A=x.dom.getBoundingClientRect();if(i.push(A.height),u){let M=x.dom.lastChild,D=M?Vn(M):[];if(D.length){let N=D[D.length-1],P=p?N.right-A.left:A.right-N.left;P>d&&(d=P,this.minWidth=h,this.minWidthFrom=v,this.minWidthTo=S)}}}v=S+x.breakAfter}return i}textDirectionAt(t){let{i}=this.childPos(t,1);return getComputedStyle(this.children[i].dom).direction=="rtl"?te.RTL:te.LTR}measureTextSize(){for(let h of this.children)if(h instanceof It){let u=h.measureTextSize();if(u)return u}let t=document.createElement("div"),i,r,s;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let h=Vn(t.firstChild)[0];i=t.getBoundingClientRect().height,r=h?h.width/27:7,s=h?h.height:i,t.remove()}),{lineHeight:i,charWidth:r,textHeight:s}}childCursor(t=this.length){let i=this.children.length;return i&&(t-=this.children[--i].length),new Pc(this.children,t,i)}computeBlockGapDeco(){let t=[],i=this.view.viewState;for(let r=0,s=0;;s++){let h=s==i.viewports.length?null:i.viewports[s],u=h?h.from-1:this.length;if(u>r){let d=(i.lineBlockAt(u).bottom-i.lineBlockAt(r).top)/this.view.scaleY;t.push(Ht.replace({widget:new pa(d),block:!0,inclusive:!0,isBlockGap:!0}).range(r,u))}if(!h)break;r=h.to+1}return Ht.set(t)}updateDeco(){let t=1,i=this.view.state.facet(Yr).map(h=>(this.dynamicDecorationMap[t++]=typeof h=="function")?h(this.view):h),r=!1,s=this.view.state.facet(id).map((h,u)=>{let d=typeof h=="function";return d&&(r=!0),d?h(this.view):h});for(s.length&&(this.dynamicDecorationMap[t++]=r,i.push(At.join(s))),this.decorations=[this.editContextFormatting,...i,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let v=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=v.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let v of this.view.state.facet($c))try{if(v(this.view,t.range,t))return!0}catch(y){ni(this.view.state,y,"scroll handler")}let{range:i}=t,r=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1),s;if(!r)return;!i.empty&&(s=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(r={left:Math.min(r.left,s.left),top:Math.min(r.top,s.top),right:Math.max(r.right,s.right),bottom:Math.max(r.bottom,s.bottom)});let h=sd(this.view),u={left:r.left-h.left,top:r.top-h.top,right:r.right+h.right,bottom:r.bottom+h.bottom},{offsetWidth:d,offsetHeight:p}=this.view.scrollDOM;M0(this.view.scrollDOM,u,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,d),-d),Math.max(Math.min(t.yMargin,p),-p),this.view.textDirection==te.LTR)}}function _0(f){return f.node.nodeType==1&&f.node.firstChild&&(f.offset==0||f.node.childNodes[f.offset-1].contentEditable=="false")&&(f.offset==f.node.childNodes.length||f.node.childNodes[f.offset].contentEditable=="false")}function od(f,t){let i=f.observer.selectionRange;if(!i.focusNode)return null;let r=Dc(i.focusNode,i.focusOffset),s=Nc(i.focusNode,i.focusOffset),h=r||s;if(s&&r&&s.node!=r.node){let d=wt.get(s.node);if(!d||d instanceof Ke&&d.text!=s.node.nodeValue)h=s;else if(f.docView.lastCompositionAfterCursor){let p=wt.get(r.node);!p||p instanceof Ke&&p.text!=r.node.nodeValue||(h=s)}}if(f.docView.lastCompositionAfterCursor=h!=r,!h)return null;let u=t-h.offset;return{from:u,to:u+h.node.nodeValue.length,node:h.node}}function j0(f,t,i){let r=od(f,i);if(!r)return null;let{node:s,from:h,to:u}=r,d=s.nodeValue;if(/[\n\r]/.test(d)||f.state.doc.sliceString(r.from,r.to)!=d)return null;let p=t.invertedDesc,v=new Ee(p.mapPos(h),p.mapPos(u),h,u),y=[];for(let x=s.parentNode;;x=x.parentNode){let S=wt.get(x);if(S instanceof yi)y.push({node:x,deco:S.mark});else{if(S instanceof It||x.nodeName=="DIV"&&x.parentNode==f.contentDOM)return{range:v,text:s,marks:y,line:x};if(x!=f.contentDOM)y.push({node:x,deco:new Jr({inclusive:!0,attributes:R0(x),tagName:x.tagName.toLowerCase()})});else return null}}}function J0(f,t){return f.nodeType!=1?0:(t&&f.childNodes[t-1].contentEditable=="false"?1:0)|(t<f.childNodes.length&&f.childNodes[t].contentEditable=="false"?2:0)}let Z0=class{constructor(){this.changes=[]}compareRange(t,i){eo(t,i,this.changes)}comparePoint(t,i){eo(t,i,this.changes)}boundChange(t){eo(t,t,this.changes)}};function Q0(f,t,i){let r=new Z0;return At.compare(f,t,i,r),r.changes}function $0(f,t){for(let i=f;i&&i!=t;i=i.assignedSlot||i.parentNode)if(i.nodeType==1&&i.contentEditable=="false")return!0;return!1}function tm(f,t){let i=!1;return t&&f.iterChangedRanges((r,s)=>{r<t.to&&s>t.from&&(i=!0)}),i}function em(f,t,i=1){let r=f.charCategorizer(t),s=f.doc.lineAt(t),h=t-s.from;if(s.length==0)return j.cursor(t);h==0?i=1:h==s.length&&(i=-1);let u=h,d=h;i<0?u=ii(s.text,h,!1):d=ii(s.text,h);let p=r(s.text.slice(u,d));for(;u>0;){let v=ii(s.text,u,!1);if(r(s.text.slice(v,u))!=p)break;u=v}for(;d<s.length;){let v=ii(s.text,d);if(r(s.text.slice(d,v))!=p)break;d=v}return j.range(u+s.from,d+s.from)}function im(f,t){return t.left>f?t.left-f:Math.max(0,f-t.right)}function nm(f,t){return t.top>f?t.top-f:Math.max(0,f-t.bottom)}function Fl(f,t){return f.top<t.bottom-1&&f.bottom>t.top+1}function Cu(f,t){return t<f.top?{top:t,left:f.left,right:f.right,bottom:f.bottom}:f}function ku(f,t){return t>f.bottom?{top:f.top,left:f.left,right:f.right,bottom:t}:f}function ba(f,t,i){let r,s,h,u,d=!1,p,v,y,x;for(let M=f.firstChild;M;M=M.nextSibling){let D=Vn(M);for(let N=0;N<D.length;N++){let P=D[N];s&&Fl(s,P)&&(P=Cu(ku(P,s.bottom),s.top));let H=im(t,P),Y=nm(i,P);if(H==0&&Y==0)return M.nodeType==3?Au(M,t,i):ba(M,t,i);(!r||u>Y||u==Y&&h>H)&&(r=M,s=P,h=H,u=Y,d=H?t<P.left?N>0:N<D.length-1:!0),H==0?i>P.bottom&&(!y||y.bottom<P.bottom)?(p=M,y=P):i<P.top&&(!x||x.top>P.top)&&(v=M,x=P):y&&Fl(y,P)?y=ku(y,P.bottom):x&&Fl(x,P)&&(x=Cu(x,P.top))}}if(y&&y.bottom>=i?(r=p,s=y):x&&x.top<=i&&(r=v,s=x),!r)return{node:f,offset:0};let S=Math.max(s.left,Math.min(s.right,t));if(r.nodeType==3)return Au(r,S,i);if(d&&r.contentEditable!="false")return ba(r,S,i);let A=Array.prototype.indexOf.call(f.childNodes,r)+(t>=(s.left+s.right)/2?1:0);return{node:f,offset:A}}function Au(f,t,i){let r=f.nodeValue.length,s=-1,h=1e9,u=0;for(let d=0;d<r;d++){let p=an(f,d,d+1).getClientRects();for(let v=0;v<p.length;v++){let y=p[v];if(y.top==y.bottom)continue;u||(u=t-y.left);let x=(y.top>i?y.top-i:i-y.bottom)-1;if(y.left-1<=t&&y.right+1>=t&&x<h){let S=t>=(y.left+y.right)/2,A=S;if((V.chrome||V.gecko)&&an(f,d).getBoundingClientRect().left==y.right&&(A=!S),x<=0)return{node:f,offset:d+(A?1:0)};s=d+(A?1:0),h=x}}}return{node:f,offset:s>-1?s:u>0?f.nodeValue.length:0}}function ld(f,t,i,r=-1){var s,h;let u=f.contentDOM.getBoundingClientRect(),d=u.top+f.viewState.paddingTop,p,{docHeight:v}=f.viewState,{x:y,y:x}=t,S=x-d;if(S<0)return 0;if(S>v)return f.state.doc.length;for(let J=f.viewState.heightOracle.textHeight/2,q=!1;p=f.elementAtHeight(S),p.type!=ri.Text;)for(;S=r>0?p.bottom+J:p.top-J,!(S>=0&&S<=v);){if(q)return i?null:0;q=!0,r=-r}x=d+S;let A=p.from;if(A<f.viewport.from)return f.viewport.from==0?0:i?null:Mu(f,u,p,y,x);if(A>f.viewport.to)return f.viewport.to==f.state.doc.length?f.state.doc.length:i?null:Mu(f,u,p,y,x);let M=f.dom.ownerDocument,D=f.root.elementFromPoint?f.root:M,N=D.elementFromPoint(y,x);N&&!f.contentDOM.contains(N)&&(N=null),N||(y=Math.max(u.left+1,Math.min(u.right-1,y)),N=D.elementFromPoint(y,x),N&&!f.contentDOM.contains(N)&&(N=null));let P,H=-1;if(N&&((s=f.docView.nearest(N))===null||s===void 0?void 0:s.isEditable)!=!1){if(M.caretPositionFromPoint){let J=M.caretPositionFromPoint(y,x);J&&({offsetNode:P,offset:H}=J)}else if(M.caretRangeFromPoint){let J=M.caretRangeFromPoint(y,x);J&&({startContainer:P,startOffset:H}=J,(!f.contentDOM.contains(P)||V.safari&&rm(P,H,y)||V.chrome&&sm(P,H,y))&&(P=void 0))}P&&(H=Math.min(si(P),H))}if(!P||!f.docView.dom.contains(P)){let J=It.find(f.docView,A);if(!J)return S>p.top+p.height/2?p.to:p.from;({node:P,offset:H}=ba(J.dom,y,x))}let Y=f.docView.nearest(P);if(!Y)return null;if(Y.isWidget&&((h=Y.dom)===null||h===void 0?void 0:h.nodeType)==1){let J=Y.dom.getBoundingClientRect();return t.y<J.top||t.y<=J.bottom&&t.x<=(J.left+J.right)/2?Y.posAtStart:Y.posAtEnd}else return Y.localPosFromDOM(P,H)+Y.posAtStart}function Mu(f,t,i,r,s){let h=Math.round((r-t.left)*f.defaultCharacterWidth);if(f.lineWrapping&&i.height>f.defaultLineHeight*1.5){let d=f.viewState.heightOracle.textHeight,p=Math.floor((s-i.top-(f.defaultLineHeight-d)*.5)/d);h+=p*f.viewState.heightOracle.lineLength}let u=f.state.sliceDoc(i.from,i.to);return i.from+w0(u,h,f.state.tabSize)}function rm(f,t,i){let r,s=f;if(f.nodeType!=3||t!=(r=f.nodeValue.length))return!1;for(;;){let h=s.nextSibling;if(h){if(h.nodeName=="BR")break;return!1}else{let u=s.parentNode;if(!u||u.nodeName=="DIV")break;s=u}}return an(f,r-1,r).getBoundingClientRect().right>i}function sm(f,t,i){if(t!=0)return!1;for(let s=f;;){let h=s.parentNode;if(!h||h.nodeType!=1||h.firstChild!=s)return!1;if(h.classList.contains("cm-line"))break;s=h}let r=f.nodeType==1?f.getBoundingClientRect():an(f,0,Math.max(f.nodeValue.length,1)).getBoundingClientRect();return i-r.left>5}function om(f,t,i){let r=f.lineBlockAt(t);if(Array.isArray(r.type)){let s;for(let h of r.type){if(h.from>t)break;if(!(h.to<t)){if(h.from<t&&h.to>t)return h;(!s||h.type==ri.Text&&(s.type!=h.type||(i<0?h.from<t:h.to>t)))&&(s=h)}}return s||r}return r}function lm(f,t,i,r){let s=om(f,t.head,t.assoc||-1),h=!r||s.type!=ri.Text||!(f.lineWrapping||s.widgetLineBreaks)?null:f.coordsAtPos(t.assoc<0&&t.head>s.from?t.head-1:t.head);if(h){let u=f.dom.getBoundingClientRect(),d=f.textDirectionAt(s.from),p=f.posAtCoords({x:i==(d==te.LTR)?u.right-1:u.left+1,y:(h.top+h.bottom)/2});if(p!=null)return j.cursor(p,i?-1:1)}return j.cursor(i?s.to:s.from,i?-1:1)}function Tu(f,t,i,r){let s=f.state.doc.lineAt(t.head),h=f.bidiSpans(s),u=f.textDirectionAt(s.from);for(let d=t,p=null;;){let v=V0(s,h,u,d,i),y=qc;if(!v){if(s.number==(i?f.state.doc.lines:1))return d;y=`
`,s=f.state.doc.line(s.number+(i?1:-1)),h=f.bidiSpans(s),v=f.visualLineSide(s,!i)}if(p){if(!p(y))return d}else{if(!r)return v;p=r(y)}d=v}}function am(f,t,i){let r=f.state.charCategorizer(t),s=r(i);return h=>{let u=r(h);return s==gi.Space&&(s=u),s==u}}function hm(f,t,i,r){let s=t.head,h=i?1:-1;if(s==(i?f.state.doc.length:0))return j.cursor(s,t.assoc);let u=t.goalColumn,d,p=f.contentDOM.getBoundingClientRect(),v=f.coordsAtPos(s,t.assoc||-1),y=f.documentTop;if(v)u==null&&(u=v.left-p.left),d=h<0?v.top:v.bottom;else{let A=f.viewState.lineBlockAt(s);u==null&&(u=Math.min(p.right-p.left,f.defaultCharacterWidth*(s-A.from))),d=(h<0?A.top:A.bottom)+y}let x=p.left+u,S=r??f.viewState.heightOracle.textHeight>>1;for(let A=0;;A+=10){let M=d+(S+A)*h,D=ld(f,{x,y:M},!1,h);if(M<p.top||M>p.bottom||(h<0?D<s:D>s)){let N=f.docView.coordsForChar(D),P=!N||M<N.top?-1:1;return j.cursor(D,P,void 0,u)}}}function io(f,t,i){for(;;){let r=0;for(let s of f)s.between(t-1,t+1,(h,u,d)=>{if(t>h&&t<u){let p=r||i||(t-h<u-t?-1:1);t=p<0?h:u,r=p}});if(!r)return t}}function zl(f,t,i){let r=io(f.state.facet(Fa).map(s=>s(f)),i.from,t.head>i.from?-1:1);return r==i.from?i:j.cursor(r,r<i.from?1:-1)}const Ir="￿";class fm{constructor(t,i){this.points=t,this.text="",this.lineSeparator=i.facet(ut.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Ir}readRange(t,i){if(!t)return this;let r=t.parentNode;for(let s=t;;){this.findPointBefore(r,s);let h=this.text.length;this.readNode(s);let u=s.nextSibling;if(u==i)break;let d=wt.get(s),p=wt.get(u);(d&&p?d.breakAfter:(d?d.breakAfter:ao(s))||ao(u)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>h)&&this.lineBreak(),s=u}return this.findPointBefore(r,i),this}readTextNode(t){let i=t.nodeValue;for(let r of this.points)r.node==t&&(r.pos=this.text.length+Math.min(r.offset,i.length));for(let r=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let h=-1,u=1,d;if(this.lineSeparator?(h=i.indexOf(this.lineSeparator,r),u=this.lineSeparator.length):(d=s.exec(i))&&(h=d.index,u=d[0].length),this.append(i.slice(r,h<0?i.length:h)),h<0)break;if(this.lineBreak(),u>1)for(let p of this.points)p.node==t&&p.pos>this.text.length&&(p.pos-=u-1);r=h+u}}readNode(t){if(t.cmIgnore)return;let i=wt.get(t),r=i&&i.overrideDOMText;if(r!=null){this.findPointInside(t,r.length);for(let s=r.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,i){for(let r of this.points)r.node==t&&t.childNodes[r.offset]==i&&(r.pos=this.text.length)}findPointInside(t,i){for(let r of this.points)(t.nodeType==3?r.node==t:t.contains(r.node))&&(r.pos=this.text.length+(um(t,r.node,r.offset)?i:0))}}function um(f,t,i){for(;;){if(!t||i<si(t))return!1;if(t==f)return!0;i=ln(t)+1,t=t.parentNode}}class Lu{constructor(t,i){this.node=t,this.offset=i,this.pos=-1}}class cm{constructor(t,i,r,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=i>-1;let{impreciseHead:h,impreciseAnchor:u}=t.docView;if(t.state.readOnly&&i>-1)this.newSel=null;else if(i>-1&&(this.bounds=t.docView.domBoundsAround(i,r,0))){let d=h||u?[]:gm(t),p=new fm(d,t.state);p.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=p.text,this.newSel=mm(d,this.bounds.from)}else{let d=t.observer.selectionRange,p=h&&h.node==d.focusNode&&h.offset==d.focusOffset||!aa(t.contentDOM,d.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(d.focusNode,d.focusOffset),v=u&&u.node==d.anchorNode&&u.offset==d.anchorOffset||!aa(t.contentDOM,d.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(d.anchorNode,d.anchorOffset),y=t.viewport;if((V.ios||V.chrome)&&t.state.selection.main.empty&&p!=v&&(y.from>0||y.to<t.state.doc.length)){let x=Math.min(p,v),S=Math.max(p,v),A=y.from-x,M=y.to-S;(A==0||A==1||x==0)&&(M==0||M==-1||S==t.state.doc.length)&&(p=0,v=t.state.doc.length)}this.newSel=j.single(v,p)}}}function ad(f,t){let i,{newSel:r}=t,s=f.state.selection.main,h=f.inputState.lastKeyTime>Date.now()-100?f.inputState.lastKeyCode:-1;if(t.bounds){let{from:u,to:d}=t.bounds,p=s.from,v=null;(h===8||V.android&&t.text.length<d-u)&&(p=s.to,v="end");let y=pm(f.state.doc.sliceString(u,d,Ir),t.text,p-u,v);y&&(V.chrome&&h==13&&y.toB==y.from+2&&t.text.slice(y.from,y.toB)==Ir+Ir&&y.toB--,i={from:u+y.from,to:u+y.toA,insert:dt.of(t.text.slice(y.from,y.toB).split(Ir))})}else r&&(!f.hasFocus&&f.state.facet(pi)||r.main.eq(s))&&(r=null);if(!i&&!r)return!1;if(!i&&t.typeOver&&!s.empty&&r&&r.main.empty?i={from:s.from,to:s.to,insert:f.state.doc.slice(s.from,s.to)}:(V.mac||V.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&f.contentDOM.getAttribute("autocorrect")=="off"?(r&&i.insert.length==2&&(r=j.single(r.main.anchor-1,r.main.head-1)),i={from:i.from,to:i.to,insert:dt.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:f.state.doc.slice(s.from,i.from).append(i.insert).append(f.state.doc.slice(i.to,s.to))}:V.chrome&&i&&i.from==i.to&&i.from==s.head&&i.insert.toString()==`
 `&&f.lineWrapping&&(r&&(r=j.single(r.main.anchor-1,r.main.head-1)),i={from:s.from,to:s.to,insert:dt.of([" "])}),i)return za(f,i,r,h);if(r&&!r.main.eq(s)){let u=!1,d="select";return f.inputState.lastSelectionTime>Date.now()-50&&(f.inputState.lastSelectionOrigin=="select"&&(u=!0),d=f.inputState.lastSelectionOrigin),f.dispatch({selection:r,scrollIntoView:u,userEvent:d}),!0}else return!1}function za(f,t,i,r=-1){if(V.ios&&f.inputState.flushIOSKey(t))return!0;let s=f.state.selection.main;if(V.android&&(t.to==s.to&&(t.from==s.from||t.from==s.from-1&&f.state.sliceDoc(t.from,s.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&zn(f.contentDOM,"Enter",13)||(t.from==s.from-1&&t.to==s.to&&t.insert.length==0||r==8&&t.insert.length<t.to-t.from&&t.to>s.head)&&zn(f.contentDOM,"Backspace",8)||t.from==s.from&&t.to==s.to+1&&t.insert.length==0&&zn(f.contentDOM,"Delete",46)))return!0;let h=t.insert.toString();f.inputState.composing>=0&&f.inputState.composing++;let u,d=()=>u||(u=dm(f,t,i));return f.state.facet(Jc).some(p=>p(f,t.from,t.to,h,d))||f.dispatch(d()),!0}function dm(f,t,i){let r,s=f.state,h=s.selection.main;if(t.from>=h.from&&t.to<=h.to&&t.to-t.from>=(h.to-h.from)/3&&(!i||i.main.empty&&i.main.from==t.from+t.insert.length)&&f.inputState.composing<0){let d=h.from<t.from?s.sliceDoc(h.from,t.from):"",p=h.to>t.to?s.sliceDoc(t.to,h.to):"";r=s.replaceSelection(f.state.toText(d+t.insert.sliceString(0,void 0,f.state.lineBreak)+p))}else{let d=s.changes(t),p=i&&i.main.to<=d.newLength?i.main:void 0;if(s.selection.ranges.length>1&&f.inputState.composing>=0&&t.to<=h.to&&t.to>=h.to-10){let v=f.state.sliceDoc(t.from,t.to),y,x=i&&od(f,i.main.head);if(x){let M=t.insert.length-(t.to-t.from);y={from:x.from,to:x.to-M}}else y=f.state.doc.lineAt(h.head);let S=h.to-t.to,A=h.to-h.from;r=s.changeByRange(M=>{if(M.from==h.from&&M.to==h.to)return{changes:d,range:p||M.map(d)};let D=M.to-S,N=D-v.length;if(M.to-M.from!=A||f.state.sliceDoc(N,D)!=v||M.to>=y.from&&M.from<=y.to)return{range:M};let P=s.changes({from:N,to:D,insert:t.insert}),H=M.to-h.to;return{changes:P,range:p?j.range(Math.max(0,p.anchor+H),Math.max(0,p.head+H)):M.map(P)}})}else r={changes:d,selection:p&&s.selection.replaceRange(p)}}let u="input.type";return(f.composing||f.inputState.compositionPendingChange&&f.inputState.compositionEndedAt>Date.now()-50)&&(f.inputState.compositionPendingChange=!1,u+=".compose",f.inputState.compositionFirstChange&&(u+=".start",f.inputState.compositionFirstChange=!1)),s.update(r,{userEvent:u,scrollIntoView:!0})}function pm(f,t,i,r){let s=Math.min(f.length,t.length),h=0;for(;h<s&&f.charCodeAt(h)==t.charCodeAt(h);)h++;if(h==s&&f.length==t.length)return null;let u=f.length,d=t.length;for(;u>0&&d>0&&f.charCodeAt(u-1)==t.charCodeAt(d-1);)u--,d--;if(r=="end"){let p=Math.max(0,h-Math.min(u,d));i-=u+p-h}if(u<h&&f.length<t.length){let p=i<=h&&i>=u?h-i:0;h-=p,d=h+(d-u),u=h}else if(d<h){let p=i<=h&&i>=d?h-i:0;h-=p,u=h+(u-d),d=h}return{from:h,toA:u,toB:d}}function gm(f){let t=[];if(f.root.activeElement!=f.contentDOM)return t;let{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:h}=f.observer.selectionRange;return i&&(t.push(new Lu(i,r)),(s!=i||h!=r)&&t.push(new Lu(s,h))),t}function mm(f,t){if(f.length==0)return null;let i=f[0].pos,r=f.length==2?f[1].pos:i;return i>-1&&r>-1?j.single(i+t,r+t):null}class vm{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,V.safari&&t.contentDOM.addEventListener("input",()=>null),V.gecko&&Em(t.contentDOM.ownerDocument)}handleEvent(t){!Am(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(t.type,t)):this.runHandlers(t.type,t))}runHandlers(t,i){let r=this.handlers[t];if(r){for(let s of r.observers)s(this.view,i);for(let s of r.handlers){if(i.defaultPrevented)break;if(s(this.view,i)){i.preventDefault();break}}}}ensureHandlers(t){let i=ym(t),r=this.handlers,s=this.view.contentDOM;for(let h in i)if(h!="scroll"){let u=!i[h].handlers.length,d=r[h];d&&u!=!d.handlers.length&&(s.removeEventListener(h,this.handleEvent),d=null),d||s.addEventListener(h,this.handleEvent,{passive:u})}for(let h in r)h!="scroll"&&!i[h]&&s.removeEventListener(h,this.handleEvent);this.handlers=i}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&fd.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),V.android&&V.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return V.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((i=hd.find(r=>r.keyCode==t.keyCode))&&!t.ctrlKey||bm.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=i||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let i=this.pendingIOSKey;return!i||i.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,zn(this.view.contentDOM,i.key,i.keyCode,i instanceof KeyboardEvent?i:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:V.safari&&!V.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Ou(f,t){return(i,r)=>{try{return t.call(f,r,i)}catch(s){ni(i.state,s)}}}function ym(f){let t=Object.create(null);function i(r){return t[r]||(t[r]={observers:[],handlers:[]})}for(let r of f){let s=r.spec,h=s&&s.plugin.domEventHandlers,u=s&&s.plugin.domEventObservers;if(h)for(let d in h){let p=h[d];p&&i(d).handlers.push(Ou(r.value,p))}if(u)for(let d in u){let p=u[d];p&&i(d).observers.push(Ou(r.value,p))}}for(let r in Ue)i(r).handlers.push(Ue[r]);for(let r in Re)i(r).observers.push(Re[r]);return t}const hd=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],bm="dthko",fd=[16,17,18,20,91,92,224,225],zs=6;function Ks(f){return Math.max(0,f)*.7+8}function wm(f,t){return Math.max(Math.abs(f.clientX-t.clientX),Math.abs(f.clientY-t.clientY))}class xm{constructor(t,i,r,s){this.view=t,this.startEvent=i,this.style=r,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=i,this.scrollParents=T0(t.contentDOM),this.atoms=t.state.facet(Fa).map(u=>u(t));let h=t.contentDOM.ownerDocument;h.addEventListener("mousemove",this.move=this.move.bind(this)),h.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=t.state.facet(ut.allowMultipleSelections)&&Sm(t,i),this.dragging=km(t,i)&&dd(i)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&wm(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let i=0,r=0,s=0,h=0,u=this.view.win.innerWidth,d=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:u}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:h,bottom:d}=this.scrollParents.y.getBoundingClientRect());let p=sd(this.view);t.clientX-p.left<=s+zs?i=-Ks(s-t.clientX):t.clientX+p.right>=u-zs&&(i=Ks(t.clientX-u)),t.clientY-p.top<=h+zs?r=-Ks(h-t.clientY):t.clientY+p.bottom>=d-zs&&(r=Ks(t.clientY-d)),this.setScrollSpeed(i,r)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,i){this.scrollSpeed={x:t,y:i},t||i?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:i}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),i&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=i,i=0),(t||i)&&this.view.win.scrollBy(t,i),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let i=null;for(let r=0;r<t.ranges.length;r++){let s=t.ranges[r],h=null;if(s.empty){let u=io(this.atoms,s.from,0);u!=s.from&&(h=j.cursor(u,-1))}else{let u=io(this.atoms,s.from,-1),d=io(this.atoms,s.to,1);(u!=s.from||d!=s.to)&&(h=j.range(s.from==s.anchor?u:d,s.from==s.head?u:d))}h&&(i||(i=t.ranges.slice()),i[r]=h)}return i?j.create(i,t.mainIndex):t}select(t){let{view:i}=this,r=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!r.eq(i.state.selection,this.dragging===!1))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(i=>i.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Sm(f,t){let i=f.state.facet(Yc);return i.length?i[0](t):V.mac?t.metaKey:t.ctrlKey}function Cm(f,t){let i=f.state.facet(Xc);return i.length?i[0](t):V.mac?!t.altKey:!t.ctrlKey}function km(f,t){let{main:i}=f.state.selection;if(i.empty)return!1;let r=qr(f.root);if(!r||r.rangeCount==0)return!0;let s=r.getRangeAt(0).getClientRects();for(let h=0;h<s.length;h++){let u=s[h];if(u.left<=t.clientX&&u.right>=t.clientX&&u.top<=t.clientY&&u.bottom>=t.clientY)return!0}return!1}function Am(f,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i=t.target,r;i!=f.contentDOM;i=i.parentNode)if(!i||i.nodeType==11||(r=wt.get(i))&&r.ignoreEvent(t))return!1;return!0}const Ue=Object.create(null),Re=Object.create(null),ud=V.ie&&V.ie_version<15||V.ios&&V.webkit_version<604;function Mm(f){let t=f.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{f.focus(),i.remove(),cd(f,i.value)},50)}function bo(f,t,i){for(let r of f.facet(t))i=r(i,f);return i}function cd(f,t){t=bo(f.state,Ia,t);let{state:i}=f,r,s=1,h=i.toText(t),u=h.lines==i.selection.ranges.length;if(wa!=null&&i.selection.ranges.every(p=>p.empty)&&wa==h.toString()){let p=-1;r=i.changeByRange(v=>{let y=i.doc.lineAt(v.from);if(y.from==p)return{range:v};p=y.from;let x=i.toText((u?h.line(s++).text:t)+i.lineBreak);return{changes:{from:y.from,insert:x},range:j.cursor(v.from+x.length)}})}else u?r=i.changeByRange(p=>{let v=h.line(s++);return{changes:{from:p.from,to:p.to,insert:v.text},range:j.cursor(p.from+v.length)}}):r=i.replaceSelection(h);f.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}Re.scroll=f=>{f.inputState.lastScrollTop=f.scrollDOM.scrollTop,f.inputState.lastScrollLeft=f.scrollDOM.scrollLeft};Ue.keydown=(f,t)=>(f.inputState.setSelectionOrigin("select"),t.keyCode==27&&f.inputState.tabFocusMode!=0&&(f.inputState.tabFocusMode=Date.now()+2e3),!1);Re.touchstart=(f,t)=>{f.inputState.lastTouchTime=Date.now(),f.inputState.setSelectionOrigin("select.pointer")};Re.touchmove=f=>{f.inputState.setSelectionOrigin("select.pointer")};Ue.mousedown=(f,t)=>{if(f.observer.flush(),f.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let r of f.state.facet(_c))if(i=r(f,t),i)break;if(!i&&t.button==0&&(i=Om(f,t)),i){let r=!f.hasFocus;f.inputState.startMouseSelection(new xm(f,t,i,r)),r&&f.observer.ignore(()=>{Tc(f.contentDOM);let h=f.root.activeElement;h&&!h.contains(f.contentDOM)&&h.blur()});let s=f.inputState.mouseSelection;if(s)return s.start(t),s.dragging===!1}return!1};function Du(f,t,i,r){if(r==1)return j.cursor(t,i);if(r==2)return em(f.state,t,i);{let s=It.find(f.docView,t),h=f.state.doc.lineAt(s?s.posAtEnd:t),u=s?s.posAtStart:h.from,d=s?s.posAtEnd:h.to;return d<f.state.doc.length&&d==h.to&&d++,j.range(u,d)}}let Nu=(f,t,i)=>t>=i.top&&t<=i.bottom&&f>=i.left&&f<=i.right;function Tm(f,t,i,r){let s=It.find(f.docView,t);if(!s)return 1;let h=t-s.posAtStart;if(h==0)return 1;if(h==s.length)return-1;let u=s.coordsAt(h,-1);if(u&&Nu(i,r,u))return-1;let d=s.coordsAt(h,1);return d&&Nu(i,r,d)?1:u&&u.bottom>=r?-1:1}function Pu(f,t){let i=f.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:i,bias:Tm(f,i,t.clientX,t.clientY)}}const Lm=V.ie&&V.ie_version<=11;let Eu=null,Bu=0,Ru=0;function dd(f){if(!Lm)return f.detail;let t=Eu,i=Ru;return Eu=f,Ru=Date.now(),Bu=!t||i>Date.now()-400&&Math.abs(t.clientX-f.clientX)<2&&Math.abs(t.clientY-f.clientY)<2?(Bu+1)%3:1}function Om(f,t){let i=Pu(f,t),r=dd(t),s=f.state.selection;return{update(h){h.docChanged&&(i.pos=h.changes.mapPos(i.pos),s=s.map(h.changes))},get(h,u,d){let p=Pu(f,h),v,y=Du(f,p.pos,p.bias,r);if(i.pos!=p.pos&&!u){let x=Du(f,i.pos,i.bias,r),S=Math.min(x.from,y.from),A=Math.max(x.to,y.to);y=S<y.from?j.range(S,A):j.range(A,S)}return u?s.replaceRange(s.main.extend(y.from,y.to)):d&&r==1&&s.ranges.length>1&&(v=Dm(s,p.pos))?v:d?s.addRange(y):j.create([y])}}}function Dm(f,t){for(let i=0;i<f.ranges.length;i++){let{from:r,to:s}=f.ranges[i];if(r<=t&&s>=t)return j.create(f.ranges.slice(0,i).concat(f.ranges.slice(i+1)),f.mainIndex==i?0:f.mainIndex-(f.mainIndex>i?1:0))}return null}Ue.dragstart=(f,t)=>{let{selection:{main:i}}=f.state;if(t.target.draggable){let s=f.docView.nearest(t.target);if(s&&s.isWidget){let h=s.posAtStart,u=h+s.length;(h>=i.to||u<=i.from)&&(i=j.range(h,u))}}let{inputState:r}=f;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=i,t.dataTransfer&&(t.dataTransfer.setData("Text",bo(f.state,Wa,f.state.sliceDoc(i.from,i.to))),t.dataTransfer.effectAllowed="copyMove"),!1};Ue.dragend=f=>(f.inputState.draggedContent=null,!1);function Iu(f,t,i,r){if(i=bo(f.state,Ia,i),!i)return;let s=f.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:h}=f.inputState,u=r&&h&&Cm(f,t)?{from:h.from,to:h.to}:null,d={from:s,insert:i},p=f.state.changes(u?[u,d]:d);f.focus(),f.dispatch({changes:p,selection:{anchor:p.mapPos(s,-1),head:p.mapPos(s,1)},userEvent:u?"move.drop":"input.drop"}),f.inputState.draggedContent=null}Ue.drop=(f,t)=>{if(!t.dataTransfer)return!1;if(f.state.readOnly)return!0;let i=t.dataTransfer.files;if(i&&i.length){let r=Array(i.length),s=0,h=()=>{++s==i.length&&Iu(f,t,r.filter(u=>u!=null).join(f.state.lineBreak),!1)};for(let u=0;u<i.length;u++){let d=new FileReader;d.onerror=h,d.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(d.result)||(r[u]=d.result),h()},d.readAsText(i[u])}return!0}else{let r=t.dataTransfer.getData("Text");if(r)return Iu(f,t,r,!0),!0}return!1};Ue.paste=(f,t)=>{if(f.state.readOnly)return!0;f.observer.flush();let i=ud?null:t.clipboardData;return i?(cd(f,i.getData("text/plain")||i.getData("text/uri-list")),!0):(Mm(f),!1)};function Nm(f,t){let i=f.dom.parentNode;if(!i)return;let r=i.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=t,r.focus(),r.selectionEnd=t.length,r.selectionStart=0,setTimeout(()=>{r.remove(),f.focus()},50)}function Pm(f){let t=[],i=[],r=!1;for(let s of f.selection.ranges)s.empty||(t.push(f.sliceDoc(s.from,s.to)),i.push(s));if(!t.length){let s=-1;for(let{from:h}of f.selection.ranges){let u=f.doc.lineAt(h);u.number>s&&(t.push(u.text),i.push({from:u.from,to:Math.min(f.doc.length,u.to+1)})),s=u.number}r=!0}return{text:bo(f,Wa,t.join(f.lineBreak)),ranges:i,linewise:r}}let wa=null;Ue.copy=Ue.cut=(f,t)=>{let{text:i,ranges:r,linewise:s}=Pm(f.state);if(!i&&!s)return!1;wa=s?i:null,t.type=="cut"&&!f.state.readOnly&&f.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let h=ud?null:t.clipboardData;return h?(h.clearData(),h.setData("text/plain",i),!0):(Nm(f,i),!1)};const pd=Zn.define();function gd(f,t){let i=[];for(let r of f.facet(Zc)){let s=r(f,t);s&&i.push(s)}return i.length?f.update({effects:i,annotations:pd.of(!0)}):null}function md(f){setTimeout(()=>{let t=f.hasFocus;if(t!=f.inputState.notifiedFocused){let i=gd(f.state,t);i?f.dispatch(i):f.update([])}},10)}Re.focus=f=>{f.inputState.lastFocusTime=Date.now(),!f.scrollDOM.scrollTop&&(f.inputState.lastScrollTop||f.inputState.lastScrollLeft)&&(f.scrollDOM.scrollTop=f.inputState.lastScrollTop,f.scrollDOM.scrollLeft=f.inputState.lastScrollLeft),md(f)};Re.blur=f=>{f.observer.clearSelectionRange(),md(f)};Re.compositionstart=Re.compositionupdate=f=>{f.observer.editContext||(f.inputState.compositionFirstChange==null&&(f.inputState.compositionFirstChange=!0),f.inputState.composing<0&&(f.inputState.composing=0))};Re.compositionend=f=>{f.observer.editContext||(f.inputState.composing=-1,f.inputState.compositionEndedAt=Date.now(),f.inputState.compositionPendingKey=!0,f.inputState.compositionPendingChange=f.observer.pendingRecords().length>0,f.inputState.compositionFirstChange=null,V.chrome&&V.android?f.observer.flushSoon():f.inputState.compositionPendingChange?Promise.resolve().then(()=>f.observer.flush()):setTimeout(()=>{f.inputState.composing<0&&f.docView.hasComposition&&f.update([])},50))};Re.contextmenu=f=>{f.inputState.lastContextMenu=Date.now()};Ue.beforeinput=(f,t)=>{var i,r;if(t.inputType=="insertReplacementText"&&f.observer.editContext){let h=(i=t.dataTransfer)===null||i===void 0?void 0:i.getData("text/plain"),u=t.getTargetRanges();if(h&&u.length){let d=u[0],p=f.posAtDOM(d.startContainer,d.startOffset),v=f.posAtDOM(d.endContainer,d.endOffset);return za(f,{from:p,to:v,insert:f.state.toText(h)},null),!0}}let s;if(V.chrome&&V.android&&(s=hd.find(h=>h.inputType==t.inputType))&&(f.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let h=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var u;(((u=window.visualViewport)===null||u===void 0?void 0:u.height)||0)>h+10&&f.hasFocus&&(f.contentDOM.blur(),f.focus())},100)}return V.ios&&t.inputType=="deleteContentForward"&&f.observer.flushSoon(),V.safari&&t.inputType=="insertText"&&f.inputState.composing>=0&&setTimeout(()=>Re.compositionend(f,t),20),!1};const Wu=new Set;function Em(f){Wu.has(f)||(Wu.add(f),f.addEventListener("copy",()=>{}),f.addEventListener("cut",()=>{}))}const Hu=["pre-wrap","normal","pre-line","break-spaces"];let Xn=!1;function Fu(){Xn=!1}class Bm{constructor(t){this.lineWrapping=t,this.doc=dt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,i){let r=this.doc.lineAt(i).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((i-t-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return Hu.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let i=!1;for(let r=0;r<t.length;r++){let s=t[r];s<0?r++:this.heightSamples[Math.floor(s*10)]||(i=!0,this.heightSamples[Math.floor(s*10)]=!0)}return i}refresh(t,i,r,s,h,u){let d=Hu.indexOf(t)>-1,p=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=d;if(this.lineWrapping=d,this.lineHeight=i,this.charWidth=r,this.textHeight=s,this.lineLength=h,p){this.heightSamples={};for(let v=0;v<u.length;v++){let y=u[v];y<0?v++:this.heightSamples[Math.floor(y*10)]=!0}}return p}}class Rm{constructor(t,i){this.from=t,this.heights=i,this.index=0}get more(){return this.index<this.heights.length}}class ei{constructor(t,i,r,s,h){this.from=t,this.length=i,this.top=r,this.height=s,this._content=h}get type(){return typeof this._content=="number"?ri.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Hi?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let i=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new ei(this.from,this.length+t.length,this.top,this.height+t.height,i)}}var kt=function(f){return f[f.ByPos=0]="ByPos",f[f.ByHeight=1]="ByHeight",f[f.ByPosNoHeight=2]="ByPosNoHeight",f}(kt||(kt={}));const no=.001;class me{constructor(t,i,r=2){this.length=t,this.height=i,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>no&&(Xn=!0),this.height=t)}replace(t,i,r){return me.of(r)}decomposeLeft(t,i){i.push(this)}decomposeRight(t,i){i.push(this)}applyChanges(t,i,r,s){let h=this,u=r.doc;for(let d=s.length-1;d>=0;d--){let{fromA:p,toA:v,fromB:y,toB:x}=s[d],S=h.lineAt(p,kt.ByPosNoHeight,r.setDoc(i),0,0),A=S.to>=v?S:h.lineAt(v,kt.ByPosNoHeight,r,0,0);for(x+=A.to-v,v=A.to;d>0&&S.from<=s[d-1].toA;)p=s[d-1].fromA,y=s[d-1].fromB,d--,p<S.from&&(S=h.lineAt(p,kt.ByPosNoHeight,r,0,0));y+=S.from-p,p=S.from;let M=Ka.build(r.setDoc(u),t,y,x);h=uo(h,h.replace(p,v,M))}return h.updateHeight(r,0)}static empty(){return new Te(0,0)}static of(t){if(t.length==1)return t[0];let i=0,r=t.length,s=0,h=0;for(;;)if(i==r)if(s>h*2){let d=t[i-1];d.break?t.splice(--i,1,d.left,null,d.right):t.splice(--i,1,d.left,d.right),r+=1+d.break,s-=d.size}else if(h>s*2){let d=t[r];d.break?t.splice(r,1,d.left,null,d.right):t.splice(r,1,d.left,d.right),r+=2+d.break,h-=d.size}else break;else if(s<h){let d=t[i++];d&&(s+=d.size)}else{let d=t[--r];d&&(h+=d.size)}let u=0;return t[i-1]==null?(u=1,i--):t[i]==null&&(u=1,r++),new Im(me.of(t.slice(0,i)),u,me.of(t.slice(r)))}}function uo(f,t){return f==t?f:(f.constructor!=t.constructor&&(Xn=!0),t)}me.prototype.size=1;class vd extends me{constructor(t,i,r){super(t,i),this.deco=r}blockAt(t,i,r,s){return new ei(s,this.length,r,this.height,this.deco||0)}lineAt(t,i,r,s,h){return this.blockAt(0,r,s,h)}forEachLine(t,i,r,s,h,u){t<=h+this.length&&i>=h&&u(this.blockAt(0,r,s,h))}updateHeight(t,i=0,r=!1,s){return s&&s.from<=i&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Te extends vd{constructor(t,i){super(t,i,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,i,r,s){return new ei(s,this.length,r,this.height,this.breaks)}replace(t,i,r){let s=r[0];return r.length==1&&(s instanceof Te||s instanceof Zt&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Zt?s=new Te(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):me.of(r)}updateHeight(t,i=0,r=!1,s){return s&&s.from<=i&&s.more?this.setHeight(s.heights[s.index++]):(r||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Zt extends me{constructor(t){super(t,0)}heightMetrics(t,i){let r=t.doc.lineAt(i).number,s=t.doc.lineAt(i+this.length).number,h=s-r+1,u,d=0;if(t.lineWrapping){let p=Math.min(this.height,t.lineHeight*h);u=p/h,this.length>h+1&&(d=(this.height-p)/(this.length-h-1))}else u=this.height/h;return{firstLine:r,lastLine:s,perLine:u,perChar:d}}blockAt(t,i,r,s){let{firstLine:h,lastLine:u,perLine:d,perChar:p}=this.heightMetrics(i,s);if(i.lineWrapping){let v=s+(t<i.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-r)/this.height))*this.length)),y=i.doc.lineAt(v),x=d+y.length*p,S=Math.max(r,t-x/2);return new ei(y.from,y.length,S,x,0)}else{let v=Math.max(0,Math.min(u-h,Math.floor((t-r)/d))),{from:y,length:x}=i.doc.line(h+v);return new ei(y,x,r+d*v,d,0)}}lineAt(t,i,r,s,h){if(i==kt.ByHeight)return this.blockAt(t,r,s,h);if(i==kt.ByPosNoHeight){let{from:A,to:M}=r.doc.lineAt(t);return new ei(A,M-A,0,0,0)}let{firstLine:u,perLine:d,perChar:p}=this.heightMetrics(r,h),v=r.doc.lineAt(t),y=d+v.length*p,x=v.number-u,S=s+d*x+p*(v.from-h-x);return new ei(v.from,v.length,Math.max(s,Math.min(S,s+this.height-y)),y,0)}forEachLine(t,i,r,s,h,u){t=Math.max(t,h),i=Math.min(i,h+this.length);let{firstLine:d,perLine:p,perChar:v}=this.heightMetrics(r,h);for(let y=t,x=s;y<=i;){let S=r.doc.lineAt(y);if(y==t){let M=S.number-d;x+=p*M+v*(t-h-M)}let A=p+v*S.length;u(new ei(S.from,S.length,x,A,0)),x+=A,y=S.to+1}}replace(t,i,r){let s=this.length-i;if(s>0){let h=r[r.length-1];h instanceof Zt?r[r.length-1]=new Zt(h.length+s):r.push(null,new Zt(s-1))}if(t>0){let h=r[0];h instanceof Zt?r[0]=new Zt(t+h.length):r.unshift(new Zt(t-1),null)}return me.of(r)}decomposeLeft(t,i){i.push(new Zt(t-1),null)}decomposeRight(t,i){i.push(null,new Zt(this.length-t-1))}updateHeight(t,i=0,r=!1,s){let h=i+this.length;if(s&&s.from<=i+this.length&&s.more){let u=[],d=Math.max(i,s.from),p=-1;for(s.from>i&&u.push(new Zt(s.from-i-1).updateHeight(t,i));d<=h&&s.more;){let y=t.doc.lineAt(d).length;u.length&&u.push(null);let x=s.heights[s.index++];p==-1?p=x:Math.abs(x-p)>=no&&(p=-2);let S=new Te(y,x);S.outdated=!1,u.push(S),d+=y+1}d<=h&&u.push(null,new Zt(h-d).updateHeight(t,d));let v=me.of(u);return(p<0||Math.abs(v.height-this.height)>=no||Math.abs(p-this.heightMetrics(t,i).perLine)>=no)&&(Xn=!0),uo(this,v)}else(r||this.outdated)&&(this.setHeight(t.heightForGap(i,i+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Im extends me{constructor(t,i,r){super(t.length+i+r.length,t.height+r.height,i|(t.outdated||r.outdated?2:0)),this.left=t,this.right=r,this.size=t.size+r.size}get break(){return this.flags&1}blockAt(t,i,r,s){let h=r+this.left.height;return t<h?this.left.blockAt(t,i,r,s):this.right.blockAt(t,i,h,s+this.left.length+this.break)}lineAt(t,i,r,s,h){let u=s+this.left.height,d=h+this.left.length+this.break,p=i==kt.ByHeight?t<u:t<d,v=p?this.left.lineAt(t,i,r,s,h):this.right.lineAt(t,i,r,u,d);if(this.break||(p?v.to<d:v.from>d))return v;let y=i==kt.ByPosNoHeight?kt.ByPosNoHeight:kt.ByPos;return p?v.join(this.right.lineAt(d,y,r,u,d)):this.left.lineAt(d,y,r,s,h).join(v)}forEachLine(t,i,r,s,h,u){let d=s+this.left.height,p=h+this.left.length+this.break;if(this.break)t<p&&this.left.forEachLine(t,i,r,s,h,u),i>=p&&this.right.forEachLine(t,i,r,d,p,u);else{let v=this.lineAt(p,kt.ByPos,r,s,h);t<v.from&&this.left.forEachLine(t,v.from-1,r,s,h,u),v.to>=t&&v.from<=i&&u(v),i>v.to&&this.right.forEachLine(v.to+1,i,r,d,p,u)}}replace(t,i,r){let s=this.left.length+this.break;if(i<s)return this.balanced(this.left.replace(t,i,r),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-s,i-s,r));let h=[];t>0&&this.decomposeLeft(t,h);let u=h.length;for(let d of r)h.push(d);if(t>0&&zu(h,u-1),i<this.length){let d=h.length;this.decomposeRight(i,h),zu(h,d)}return me.of(h)}decomposeLeft(t,i){let r=this.left.length;if(t<=r)return this.left.decomposeLeft(t,i);i.push(this.left),this.break&&(r++,t>=r&&i.push(null)),t>r&&this.right.decomposeLeft(t-r,i)}decomposeRight(t,i){let r=this.left.length,s=r+this.break;if(t>=s)return this.right.decomposeRight(t-s,i);t<r&&this.left.decomposeRight(t,i),this.break&&t<s&&i.push(null),i.push(this.right)}balanced(t,i){return t.size>2*i.size||i.size>2*t.size?me.of(this.break?[t,null,i]:[t,i]):(this.left=uo(this.left,t),this.right=uo(this.right,i),this.setHeight(t.height+i.height),this.outdated=t.outdated||i.outdated,this.size=t.size+i.size,this.length=t.length+this.break+i.length,this)}updateHeight(t,i=0,r=!1,s){let{left:h,right:u}=this,d=i+h.length+this.break,p=null;return s&&s.from<=i+h.length&&s.more?p=h=h.updateHeight(t,i,r,s):h.updateHeight(t,i,r),s&&s.from<=d+u.length&&s.more?p=u=u.updateHeight(t,d,r,s):u.updateHeight(t,d,r),p?this.balanced(h,u):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function zu(f,t){let i,r;f[t]==null&&(i=f[t-1])instanceof Zt&&(r=f[t+1])instanceof Zt&&f.splice(t-1,3,new Zt(i.length+1+r.length))}const Wm=5;class Ka{constructor(t,i){this.pos=t,this.oracle=i,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,i){if(this.lineStart>-1){let r=Math.min(i,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Te?s.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new Te(r-this.pos,-1)),this.writtenTo=r,i>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=i}point(t,i,r){if(t<i||r.heightRelevant){let s=r.widget?r.widget.estimatedHeight:0,h=r.widget?r.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let u=i-t;r.block?this.addBlock(new vd(u,s,r)):(u||h||s>=Wm)&&this.addLineDeco(s,h,u)}else i>t&&this.span(t,i);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:i}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=i,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Te(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,i){let r=new Zt(i-t);return this.oracle.doc.lineAt(t).to==i&&(r.flags|=4),r}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Te)return t;let i=new Te(0,-1);return this.nodes.push(i),i}addBlock(t){this.enterLine();let i=t.deco;i&&i.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,i&&i.endSide>0&&(this.covering=t)}addLineDeco(t,i,r){let s=this.ensureLine();s.length+=r,s.collapsed+=r,s.widgetHeight=Math.max(s.widgetHeight,t),s.breaks+=i,this.writtenTo=this.pos=this.pos+r}finish(t){let i=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(i instanceof Te)&&!this.isCovered?this.nodes.push(new Te(0,-1)):(this.writtenTo<this.pos||i==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=t;for(let s of this.nodes)s instanceof Te&&s.updateHeight(this.oracle,r),r+=s?s.length:1;return this.nodes}static build(t,i,r,s){let h=new Ka(r,t);return At.spans(i,r,s,h,0),h.finish(r)}}function Hm(f,t,i){let r=new Fm;return At.compare(f,t,i,r,0),r.changes}class Fm{constructor(){this.changes=[]}compareRange(){}comparePoint(t,i,r,s){(t<i||r&&r.heightRelevant||s&&s.heightRelevant)&&eo(t,i,this.changes,5)}}function zm(f,t){let i=f.getBoundingClientRect(),r=f.ownerDocument,s=r.defaultView||window,h=Math.max(0,i.left),u=Math.min(s.innerWidth,i.right),d=Math.max(0,i.top),p=Math.min(s.innerHeight,i.bottom);for(let v=f.parentNode;v&&v!=r.body;)if(v.nodeType==1){let y=v,x=window.getComputedStyle(y);if((y.scrollHeight>y.clientHeight||y.scrollWidth>y.clientWidth)&&x.overflow!="visible"){let S=y.getBoundingClientRect();h=Math.max(h,S.left),u=Math.min(u,S.right),d=Math.max(d,S.top),p=Math.min(v==f.parentNode?s.innerHeight:p,S.bottom)}v=x.position=="absolute"||x.position=="fixed"?y.offsetParent:y.parentNode}else if(v.nodeType==11)v=v.host;else break;return{left:h-i.left,right:Math.max(h,u)-i.left,top:d-(i.top+t),bottom:Math.max(d,p)-(i.top+t)}}function Km(f){let t=f.getBoundingClientRect(),i=f.ownerDocument.defaultView||window;return t.left<i.innerWidth&&t.right>0&&t.top<i.innerHeight&&t.bottom>0}function Um(f,t){let i=f.getBoundingClientRect();return{left:0,right:i.right-i.left,top:t,bottom:i.bottom-(i.top+t)}}class Kl{constructor(t,i,r,s){this.from=t,this.to=i,this.size=r,this.displaySize=s}static same(t,i){if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){let s=t[r],h=i[r];if(s.from!=h.from||s.to!=h.to||s.size!=h.size)return!1}return!0}draw(t,i){return Ht.replace({widget:new Gm(this.displaySize*(i?t.scaleY:t.scaleX),i)}).range(this.from,this.to)}}class Gm extends yo{constructor(t,i){super(),this.size=t,this.vertical=i}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Ku{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Uu,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=te.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let i=t.facet(Ha).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new Bm(i),this.stateDeco=t.facet(Yr).filter(r=>typeof r!="function"),this.heightMap=me.empty().applyChanges(this.stateDeco,dt.empty,this.heightOracle.setDoc(t.doc),[new Ee(0,0,0,t.doc.length)]);for(let r=0;r<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());r++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ht.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:i}=this.state.selection;for(let r=0;r<=1;r++){let s=r?i.head:i.anchor;if(!t.some(({from:h,to:u})=>s>=h&&s<=u)){let{from:h,to:u}=this.lineBlockAt(s);t.push(new Us(h,u))}}return this.viewports=t.sort((r,s)=>r.from-s.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?Uu:new Ua(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(Wr(t,this.scaler))})}update(t,i=null){this.state=t.state;let r=this.stateDeco;this.stateDeco=this.state.facet(Yr).filter(y=>typeof y!="function");let s=t.changedRanges,h=Ee.extendWithRanges(s,Hm(r,this.stateDeco,t?t.changes:Xt.empty(this.state.doc.length))),u=this.heightMap.height,d=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Fu(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),h),(this.heightMap.height!=u||Xn)&&(t.flags|=2),d?(this.scrollAnchorPos=t.changes.mapPos(d.from,-1),this.scrollAnchorHeight=d.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=u);let p=h.length?this.mapViewport(this.viewport,t.changes):this.viewport;(i&&(i.range.head<p.from||i.range.head>p.to)||!this.viewportIsAppropriate(p))&&(p=this.getViewport(0,i));let v=p.from!=this.viewport.from||p.to!=this.viewport.to;this.viewport=p,t.flags|=this.updateForViewport(),(v||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),i&&(this.scrollTarget=i),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(Y0)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let i=t.contentDOM,r=window.getComputedStyle(i),s=this.heightOracle,h=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?te.RTL:te.LTR;let u=this.heightOracle.mustRefreshForWrapping(h),d=i.getBoundingClientRect(),p=u||this.mustMeasureContent||this.contentDOMHeight!=d.height;this.contentDOMHeight=d.height,this.mustMeasureContent=!1;let v=0,y=0;if(d.width&&d.height){let{scaleX:J,scaleY:q}=Mc(i,d);(J>.005&&Math.abs(this.scaleX-J)>.005||q>.005&&Math.abs(this.scaleY-q)>.005)&&(this.scaleX=J,this.scaleY=q,v|=16,u=p=!0)}let x=(parseInt(r.paddingTop)||0)*this.scaleY,S=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=x||this.paddingBottom!=S)&&(this.paddingTop=x,this.paddingBottom=S,v|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(s.lineWrapping&&(p=!0),this.editorWidth=t.scrollDOM.clientWidth,v|=16);let A=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=A&&(this.scrollAnchorHeight=-1,this.scrollTop=A),this.scrolledToBottom=Oc(t.scrollDOM);let M=(this.printing?Um:zm)(i,this.paddingTop),D=M.top-this.pixelViewport.top,N=M.bottom-this.pixelViewport.bottom;this.pixelViewport=M;let P=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(P!=this.inView&&(this.inView=P,P&&(p=!0)),!this.inView&&!this.scrollTarget&&!Km(t.dom))return 0;let H=d.width;if((this.contentDOMWidth!=H||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=d.width,this.editorHeight=t.scrollDOM.clientHeight,v|=16),p){let J=t.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(J)&&(u=!0),u||s.lineWrapping&&Math.abs(H-this.contentDOMWidth)>s.charWidth){let{lineHeight:q,charWidth:et,textHeight:Q}=t.docView.measureTextSize();u=q>0&&s.refresh(h,q,et,Q,Math.max(5,H/et),J),u&&(t.docView.minWidth=0,v|=16)}D>0&&N>0?y=Math.max(D,N):D<0&&N<0&&(y=Math.min(D,N)),Fu();for(let q of this.viewports){let et=q.from==this.viewport.from?J:t.docView.measureVisibleLineHeights(q);this.heightMap=(u?me.empty().applyChanges(this.stateDeco,dt.empty,this.heightOracle,[new Ee(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(s,0,u,new Rm(q.from,et))}Xn&&(v|=2)}let Y=!this.viewportIsAppropriate(this.viewport,y)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return Y&&(v&2&&(v|=this.updateScaler()),this.viewport=this.getViewport(y,this.scrollTarget),v|=this.updateForViewport()),(v&2||Y)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(u?[]:this.lineGaps,t)),v|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),v}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,i){let r=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),s=this.heightMap,h=this.heightOracle,{visibleTop:u,visibleBottom:d}=this,p=new Us(s.lineAt(u-r*1e3,kt.ByHeight,h,0,0).from,s.lineAt(d+(1-r)*1e3,kt.ByHeight,h,0,0).to);if(i){let{head:v}=i.range;if(v<p.from||v>p.to){let y=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),x=s.lineAt(v,kt.ByPos,h,0,0),S;i.y=="center"?S=(x.top+x.bottom)/2-y/2:i.y=="start"||i.y=="nearest"&&v<p.from?S=x.top:S=x.bottom-y,p=new Us(s.lineAt(S-1e3/2,kt.ByHeight,h,0,0).from,s.lineAt(S+y+1e3/2,kt.ByHeight,h,0,0).to)}}return p}mapViewport(t,i){let r=i.mapPos(t.from,-1),s=i.mapPos(t.to,1);return new Us(this.heightMap.lineAt(r,kt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,kt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:i},r=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(t,kt.ByPos,this.heightOracle,0,0),{bottom:h}=this.heightMap.lineAt(i,kt.ByPos,this.heightOracle,0,0),{visibleTop:u,visibleBottom:d}=this;return(t==0||s<=u-Math.max(10,Math.min(-r,250)))&&(i==this.state.doc.length||h>=d+Math.max(10,Math.min(r,250)))&&s>u-2*1e3&&h<d+2*1e3}mapLineGaps(t,i){if(!t.length||i.empty)return t;let r=[];for(let s of t)i.touchesRange(s.from,s.to)||r.push(new Kl(i.mapPos(s.from),i.mapPos(s.to),s.size,s.displaySize));return r}ensureLineGaps(t,i){let r=this.heightOracle.lineWrapping,s=r?1e4:2e3,h=s>>1,u=s<<1;if(this.defaultTextDirection!=te.LTR&&!r)return[];let d=[],p=(y,x,S,A)=>{if(x-y<h)return;let M=this.state.selection.main,D=[M.from];M.empty||D.push(M.to);for(let P of D)if(P>y&&P<x){p(y,P-10,S,A),p(P+10,x,S,A);return}let N=qm(t,P=>P.from>=S.from&&P.to<=S.to&&Math.abs(P.from-y)<h&&Math.abs(P.to-x)<h&&!D.some(H=>P.from<H&&P.to>H));if(!N){if(x<S.to&&i&&r&&i.visibleRanges.some(Y=>Y.from<=x&&Y.to>=x)){let Y=i.moveToLineBoundary(j.cursor(x),!1,!0).head;Y>y&&(x=Y)}let P=this.gapSize(S,y,x,A),H=r||P<2e6?P:2e6;N=new Kl(y,x,P,H)}d.push(N)},v=y=>{if(y.length<u||y.type!=ri.Text)return;let x=Vm(y.from,y.to,this.stateDeco);if(x.total<u)return;let S=this.scrollTarget?this.scrollTarget.range.head:null,A,M;if(r){let D=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,N,P;if(S!=null){let H=Vs(x,S),Y=((this.visibleBottom-this.visibleTop)/2+D)/y.height;N=H-Y,P=H+Y}else N=(this.visibleTop-y.top-D)/y.height,P=(this.visibleBottom-y.top+D)/y.height;A=Gs(x,N),M=Gs(x,P)}else{let D=x.total*this.heightOracle.charWidth,N=s*this.heightOracle.charWidth,P=0;if(D>2e6)for(let et of t)et.from>=y.from&&et.from<y.to&&et.size!=et.displaySize&&et.from*this.heightOracle.charWidth+P<this.pixelViewport.left&&(P=et.size-et.displaySize);let H=this.pixelViewport.left+P,Y=this.pixelViewport.right+P,J,q;if(S!=null){let et=Vs(x,S),Q=((Y-H)/2+N)/D;J=et-Q,q=et+Q}else J=(H-N)/D,q=(Y+N)/D;A=Gs(x,J),M=Gs(x,q)}A>y.from&&p(y.from,A,y,x),M<y.to&&p(M,y.to,y,x)};for(let y of this.viewportLines)Array.isArray(y.type)?y.type.forEach(v):v(y);return d}gapSize(t,i,r,s){let h=Vs(s,r)-Vs(s,i);return this.heightOracle.lineWrapping?t.height*h:s.total*this.heightOracle.charWidth*h}updateLineGaps(t){Kl.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=Ht.set(t.map(i=>i.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(t){let i=this.stateDeco;this.lineGaps.length&&(i=i.concat(this.lineGapDeco));let r=[];At.spans(i,this.viewport.from,this.viewport.to,{span(h,u){r.push({from:h,to:u})},point(){}},20);let s=0;if(r.length!=this.visibleRanges.length)s=12;else for(let h=0;h<r.length&&!(s&8);h++){let u=this.visibleRanges[h],d=r[h];(u.from!=d.from||u.to!=d.to)&&(s|=4,t&&t.mapPos(u.from,-1)==d.from&&t.mapPos(u.to,1)==d.to||(s|=8))}return this.visibleRanges=r,s}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(i=>i.from<=t&&i.to>=t)||Wr(this.heightMap.lineAt(t,kt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(i=>i.top<=t&&i.bottom>=t)||Wr(this.heightMap.lineAt(this.scaler.fromDOM(t),kt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let i=this.lineBlockAtHeight(t+8);return i.from>=this.viewport.from||this.viewportLines[0].top-t>200?i:this.viewportLines[0]}elementAtHeight(t){return Wr(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Us{constructor(t,i){this.from=t,this.to=i}}function Vm(f,t,i){let r=[],s=f,h=0;return At.spans(i,f,t,{span(){},point(u,d){u>s&&(r.push({from:s,to:u}),h+=u-s),s=d}},20),s<t&&(r.push({from:s,to:t}),h+=t-s),{total:h,ranges:r}}function Gs({total:f,ranges:t},i){if(i<=0)return t[0].from;if(i>=1)return t[t.length-1].to;let r=Math.floor(f*i);for(let s=0;;s++){let{from:h,to:u}=t[s],d=u-h;if(r<=d)return h+r;r-=d}}function Vs(f,t){let i=0;for(let{from:r,to:s}of f.ranges){if(t<=s){i+=t-r;break}i+=s-r}return i/f.total}function qm(f,t){for(let i of f)if(t(i))return i}const Uu={toDOM(f){return f},fromDOM(f){return f},scale:1,eq(f){return f==this}};class Ua{constructor(t,i,r){let s=0,h=0,u=0;this.viewports=r.map(({from:d,to:p})=>{let v=i.lineAt(d,kt.ByPos,t,0,0).top,y=i.lineAt(p,kt.ByPos,t,0,0).bottom;return s+=y-v,{from:d,to:p,top:v,bottom:y,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(i.height-s);for(let d of this.viewports)d.domTop=u+(d.top-h)*this.scale,u=d.domBottom=d.domTop+(d.bottom-d.top),h=d.bottom}toDOM(t){for(let i=0,r=0,s=0;;i++){let h=i<this.viewports.length?this.viewports[i]:null;if(!h||t<h.top)return s+(t-r)*this.scale;if(t<=h.bottom)return h.domTop+(t-h.top);r=h.bottom,s=h.domBottom}}fromDOM(t){for(let i=0,r=0,s=0;;i++){let h=i<this.viewports.length?this.viewports[i]:null;if(!h||t<h.domTop)return r+(t-s)/this.scale;if(t<=h.domBottom)return h.top+(t-h.domTop);r=h.bottom,s=h.domBottom}}eq(t){return t instanceof Ua?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((i,r)=>i.from==t.viewports[r].from&&i.to==t.viewports[r].to):!1}}function Wr(f,t){if(t.scale==1)return f;let i=t.toDOM(f.top),r=t.toDOM(f.bottom);return new ei(f.from,f.length,i,r-i,Array.isArray(f._content)?f._content.map(s=>Wr(s,t)):f._content)}const qs=st.define({combine:f=>f.join(" ")}),xa=st.define({combine:f=>f.indexOf(!0)>-1}),Sa=Ii.newName(),yd=Ii.newName(),bd=Ii.newName(),wd={"&light":"."+yd,"&dark":"."+bd};function Ca(f,t,i){return new Ii(t,{finish(r){return/&/.test(r)?r.replace(/&\w*/,s=>{if(s=="&")return f;if(!i||!i[s])throw new RangeError(`Unsupported selector: ${s}`);return i[s]}):f+" "+r}})}const Ym=Ca("."+Sa,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},wd),Xm={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Ul=V.ie&&V.ie_version<=11;class _m{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new L0,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(i=>{for(let r of i)this.queue.push(r);(V.ie&&V.ie_version<=11||V.ios&&t.composing)&&i.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&V.android&&t.constructor.EDIT_CONTEXT!==!1&&!(V.chrome&&V.chrome_version<126)&&(this.editContext=new Jm(t),t.state.facet(pi)&&(t.contentDOM.editContext=this.editContext.editContext)),Ul&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var i;((i=this.view.docView)===null||i===void 0?void 0:i.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(i=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),i.length>0&&i[i.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(i=>{i.length>0&&i[i.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((i,r)=>i!=t[r]))){this.gapIntersection.disconnect();for(let i of t)this.gapIntersection.observe(i);this.gaps=t}}onSelectionChange(t){let i=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,s=this.selectionRange;if(r.state.facet(pi)?r.root.activeElement!=this.dom:!to(this.dom,s))return;let h=s.anchorNode&&r.docView.nearest(s.anchorNode);if(h&&h.ignoreEvent(t)){i||(this.selectionChanged=!1);return}(V.ie&&V.ie_version<=11||V.android&&V.chrome)&&!r.state.selection.main.empty&&s.focusNode&&zr(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,i=qr(t.root);if(!i)return!1;let r=V.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&jm(this.view,i)||i;if(!r||this.selectionRange.eq(r))return!1;let s=to(this.dom,r);return s&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&D0(this.dom,r)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(r),s&&(this.selectionChanged=!0),!0)}setSelectionRange(t,i){this.selectionRange.set(t.node,t.offset,i.node,i.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,i=null;for(let r=this.dom;r;)if(r.nodeType==1)!i&&t<this.scrollTargets.length&&this.scrollTargets[t]==r?t++:i||(i=this.scrollTargets.slice(0,t)),i&&i.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(t<this.scrollTargets.length&&!i&&(i=this.scrollTargets.slice(0,t)),i){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=i)r.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Xm),Ul&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Ul&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,i){var r;if(!this.delayedAndroidKey){let s=()=>{let h=this.delayedAndroidKey;h&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=h.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&h.force&&zn(this.dom,h.key,h.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:i,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let i=-1,r=-1,s=!1;for(let h of t){let u=this.readMutation(h);u&&(u.typeOver&&(s=!0),i==-1?{from:i,to:r}=u:(i=Math.min(u.from,i),r=Math.max(u.to,r)))}return{from:i,to:r,typeOver:s}}readChange(){let{from:t,to:i,typeOver:r}=this.processRecords(),s=this.selectionChanged&&to(this.dom,this.selectionRange);if(t<0&&!s)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let h=new cm(this.view,t,i,r);return this.view.docView.domChanged={newSel:h.newSel?h.newSel.main:null},h}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let i=this.readChange();if(!i)return this.view.requestMeasure(),!1;let r=this.view.state,s=ad(this.view,i);return this.view.state==r&&(i.domChanged||i.newSel&&!i.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(t){let i=this.view.docView.nearest(t.target);if(!i||i.ignoreMutation(t))return null;if(i.markDirty(t.type=="attributes"),t.type=="attributes"&&(i.flags|=4),t.type=="childList"){let r=Gu(i,t.previousSibling||t.target.previousSibling,-1),s=Gu(i,t.nextSibling||t.target.nextSibling,1);return{from:r?i.posAfter(r):i.posAtStart,to:s?i.posBefore(s):i.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:i.posAtStart,to:i.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(pi)!=t.state.facet(pi)&&(t.view.contentDOM.editContext=t.state.facet(pi)?this.editContext.editContext:null))}destroy(){var t,i,r;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(i=this.gapIntersection)===null||i===void 0||i.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Gu(f,t,i){for(;t;){let r=wt.get(t);if(r&&r.parent==f)return r;let s=t.parentNode;t=s!=f.dom?s:i>0?t.nextSibling:t.previousSibling}return null}function Vu(f,t){let i=t.startContainer,r=t.startOffset,s=t.endContainer,h=t.endOffset,u=f.docView.domAtPos(f.state.selection.main.anchor);return zr(u.node,u.offset,s,h)&&([i,r,s,h]=[s,h,i,r]),{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:h}}function jm(f,t){if(t.getComposedRanges){let s=t.getComposedRanges(f.root)[0];if(s)return Vu(f,s)}let i=null;function r(s){s.preventDefault(),s.stopImmediatePropagation(),i=s.getTargetRanges()[0]}return f.contentDOM.addEventListener("beforeinput",r,!0),f.dom.ownerDocument.execCommand("indent"),f.contentDOM.removeEventListener("beforeinput",r,!0),i?Vu(f,i):null}class Jm{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let i=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=r=>{let s=t.state.selection.main,{anchor:h,head:u}=s,d=this.toEditorPos(r.updateRangeStart),p=this.toEditorPos(r.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:d,drifted:!1});let v={from:d,to:p,insert:dt.of(r.text.split(`
`))};if(v.from==this.from&&h<this.from?v.from=h:v.to==this.to&&h>this.to&&(v.to=h),v.from==v.to&&!v.insert.length){let y=j.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));y.main.eq(s)||t.dispatch({selection:y,userEvent:"select"});return}if((V.mac||V.android)&&v.from==u-1&&/^\. ?$/.test(r.text)&&t.contentDOM.getAttribute("autocorrect")=="off"&&(v={from:d,to:p,insert:dt.of([r.text.replace("."," ")])}),this.pendingContextChange=v,!t.state.readOnly){let y=this.to-this.from+(v.to-v.from+v.insert.length);za(t,v,j.single(this.toEditorPos(r.selectionStart,y),this.toEditorPos(r.selectionEnd,y)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))},this.handlers.characterboundsupdate=r=>{let s=[],h=null;for(let u=this.toEditorPos(r.rangeStart),d=this.toEditorPos(r.rangeEnd);u<d;u++){let p=t.coordsForChar(u);h=p&&new DOMRect(p.left,p.top,p.right-p.left,p.bottom-p.top)||h||new DOMRect,s.push(h)}i.updateCharacterBounds(r.rangeStart,s)},this.handlers.textformatupdate=r=>{let s=[];for(let h of r.getTextFormats()){let u=h.underlineStyle,d=h.underlineThickness;if(u!="None"&&d!="None"){let p=this.toEditorPos(h.rangeStart),v=this.toEditorPos(h.rangeEnd);if(p<v){let y=`text-decoration: underline ${u=="Dashed"?"dashed ":u=="Squiggle"?"wavy ":""}${d=="Thin"?1:2}px`;s.push(Ht.mark({attributes:{style:y}}).range(p,v))}}}t.dispatch({effects:td.of(Ht.set(s))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:r}=this.composing;this.composing=null,r&&this.reset(t.state)}};for(let r in this.handlers)i.addEventListener(r,this.handlers[r]);this.measureReq={read:r=>{this.editContext.updateControlBounds(r.contentDOM.getBoundingClientRect());let s=qr(r.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let i=0,r=!1,s=this.pendingContextChange;return t.changes.iterChanges((h,u,d,p,v)=>{if(r)return;let y=v.length-(u-h);if(s&&u>=s.to)if(s.from==h&&s.to==u&&s.insert.eq(v)){s=this.pendingContextChange=null,i+=y,this.to+=y;return}else s=null,this.revertPending(t.state);if(h+=i,u+=i,u<=this.from)this.from+=y,this.to+=y;else if(h<this.to){if(h<this.from||u>this.to||this.to-this.from+v.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(h),this.toContextPos(u),v.toString()),this.to+=y}i+=y}),s&&!r&&this.revertPending(t.state),!r}update(t){let i=this.pendingContextChange,r=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(r.from,r.to)&&t.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.reset(t.state)):(t.docChanged||t.selectionSet||i)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:i}=t.selection.main;this.from=Math.max(0,i-1e4),this.to=Math.min(t.doc.length,i+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let i=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(i.from),this.toContextPos(i.from+i.insert.length),t.doc.sliceString(i.from,i.to))}setSelection(t){let{main:i}=t.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,i.anchor))),s=this.toContextPos(i.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(r,s)}rangeIsValid(t){let{head:i}=t.selection.main;return!(this.from>0&&i-this.from<500||this.to<t.doc.length&&this.to-i<500||this.to-this.from>1e4*3)}toEditorPos(t,i=this.to-this.from){t=Math.min(t,i);let r=this.composing;return r&&r.drifted?r.editorBase+(t-r.contextBase):t+this.from}toContextPos(t){let i=this.composing;return i&&i.drifted?i.contextBase+(t-i.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class at{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var i;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:r}=t;this.dispatchTransactions=t.dispatchTransactions||r&&(s=>s.forEach(h=>r(h,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=t.root||O0(t.parent)||document,this.viewState=new Ku(t.state||ut.create(t)),t.scrollTo&&t.scrollTo.is(Fs)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Wn).map(s=>new Hl(s));for(let s of this.plugins)s.update(this);this.observer=new _m(this),this.inputState=new vm(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Su(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((i=document.fonts)===null||i===void 0)&&i.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let i=t.length==1&&t[0]instanceof oe?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(i,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let i=!1,r=!1,s,h=this.state;for(let S of t){if(S.startState!=h)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");h=S.state}if(this.destroyed){this.viewState.state=h;return}let u=this.hasFocus,d=0,p=null;t.some(S=>S.annotation(pd))?(this.inputState.notifiedFocused=u,d=1):u!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=u,p=gd(h,u),p||(d=1));let v=this.observer.delayedAndroidKey,y=null;if(v?(this.observer.clearDelayedAndroidKey(),y=this.observer.readChange(),(y&&!this.state.doc.eq(h.doc)||!this.state.selection.eq(h.selection))&&(y=null)):this.observer.clear(),h.facet(ut.phrases)!=this.state.facet(ut.phrases))return this.setState(h);s=fo.create(this,h,t),s.flags|=d;let x=this.viewState.scrollTarget;try{this.updateState=2;for(let S of t){if(x&&(x=x.map(S.changes)),S.scrollIntoView){let{main:A}=S.state.selection;x=new Kn(A.empty?A:j.cursor(A.head,A.head>A.anchor?-1:1))}for(let A of S.effects)A.is(Fs)&&(x=A.value.clip(this.state))}this.viewState.update(s,x),this.bidiCache=co.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),i=this.docView.update(s),this.state.facet(Rr)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some(S=>S.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(qs)!=s.state.facet(qs)&&(this.viewState.mustMeasureContent=!0),(i||r||x||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!s.empty)for(let S of this.state.facet(ya))try{S(s)}catch(A){ni(this.state,A,"update listener")}(p||y)&&Promise.resolve().then(()=>{p&&this.state==p.startState&&this.dispatch(p),y&&!ad(this,y)&&v.force&&zn(this.contentDOM,v.key,v.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let i=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new Ku(t),this.plugins=t.facet(Wn).map(r=>new Hl(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView.destroy(),this.docView=new Su(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}updatePlugins(t){let i=t.startState.facet(Wn),r=t.state.facet(Wn);if(i!=r){let s=[];for(let h of r){let u=i.indexOf(h);if(u<0)s.push(new Hl(h));else{let d=this.plugins[u];d.mustUpdate=t,s.push(d)}}for(let h of this.plugins)h.mustUpdate!=t&&h.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=t;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);i!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let i=t.value;if(i&&i.docViewUpdate)try{i.docViewUpdate(this)}catch(r){ni(this.state,r,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let i=null,r=this.scrollDOM,s=r.scrollTop*this.scaleY,{scrollAnchorPos:h,scrollAnchorHeight:u}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(u=-1),this.viewState.scrollAnchorHeight=-1;try{for(let d=0;;d++){if(u<0)if(Oc(r))h=-1,u=this.viewState.heightMap.height;else{let A=this.viewState.scrollAnchorAt(s);h=A.from,u=A.top}this.updateState=1;let p=this.viewState.measure(this);if(!p&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(d>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let v=[];p&4||([this.measureRequests,v]=[v,this.measureRequests]);let y=v.map(A=>{try{return A.read(this)}catch(M){return ni(this.state,M),qu}}),x=fo.create(this,this.state,[]),S=!1;x.flags|=p,i?i.flags|=p:i=x,this.updateState=2,x.empty||(this.updatePlugins(x),this.inputState.update(x),this.updateAttrs(),S=this.docView.update(x),S&&this.docViewUpdate());for(let A=0;A<v.length;A++)if(y[A]!=qu)try{let M=v[A];M.write&&M.write(y[A],this)}catch(M){ni(this.state,M)}if(S&&this.docView.updateSelection(!0),!x.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,u=-1;continue}else{let M=(h<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(h).top)-u;if(M>1||M<-1){s=s+M,r.scrollTop=s/this.scaleY,u=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(i&&!i.empty)for(let d of this.state.facet(ya))d(i)}get themeClasses(){return Sa+" "+(this.state.facet(xa)?bd:yd)+" "+this.state.facet(qs)}updateAttrs(){let t=Yu(this,ed,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),i={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(pi)?"true":"false",class:"cm-content",style:`${V.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(i["aria-readonly"]="true"),Yu(this,Ha,i);let r=this.observer.ignore(()=>{let s=da(this.contentDOM,this.contentAttrs,i),h=da(this.dom,this.editorAttrs,t);return s||h});return this.editorAttrs=t,this.contentAttrs=i,r}showAnnouncements(t){let i=!0;for(let r of t)for(let s of r.effects)if(s.is(at.announce)){i&&(this.announceDOM.textContent=""),i=!1;let h=this.announceDOM.appendChild(document.createElement("div"));h.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Rr);let t=this.state.facet(at.cspNonce);Ii.mount(this.root,this.styleModules.concat(Ym).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===t.key){this.measureRequests[i]=t;return}}this.measureRequests.push(t)}}plugin(t){let i=this.pluginMap.get(t);return(i===void 0||i&&i.plugin!=t)&&this.pluginMap.set(t,i=this.plugins.find(r=>r.plugin==t)||null),i&&i.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,i,r){return zl(this,t,Tu(this,t,i,r))}moveByGroup(t,i){return zl(this,t,Tu(this,t,i,r=>am(this,t.head,r)))}visualLineSide(t,i){let r=this.bidiSpans(t),s=this.textDirectionAt(t.from),h=r[i?r.length-1:0];return j.cursor(h.side(i,s)+t.from,h.forward(!i,s)?1:-1)}moveToLineBoundary(t,i,r=!0){return lm(this,t,i,r)}moveVertically(t,i,r){return zl(this,t,hm(this,t,i,r))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,i=0){return this.docView.posFromDOM(t,i)}posAtCoords(t,i=!0){return this.readMeasured(),ld(this,t,i)}coordsAtPos(t,i=1){this.readMeasured();let r=this.docView.coordsAt(t,i);if(!r||r.left==r.right)return r;let s=this.state.doc.lineAt(t),h=this.bidiSpans(s),u=h[Bi.find(h,t-s.from,-1,i)];return jr(r,u.dir==te.LTR==i>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(Qc)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>Zm)return Vc(t.length);let i=this.textDirectionAt(t.from),r;for(let h of this.bidiCache)if(h.from==t.from&&h.dir==i&&(h.fresh||Gc(h.isolates,r=xu(this,t))))return h.order;r||(r=xu(this,t));let s=G0(t.text,i,r);return this.bidiCache.push(new co(t.from,t.to,i,r,!0,s)),s}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||V.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Tc(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,i={}){return Fs.of(new Kn(typeof t=="number"?j.cursor(t):t,i.y,i.x,i.yMargin,i.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:i}=this.scrollDOM,r=this.viewState.scrollAnchorAt(t);return Fs.of(new Kn(j.cursor(r.from),"start","start",r.top-t,i,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return fn.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return fn.define(()=>({}),{eventObservers:t})}static theme(t,i){let r=Ii.newName(),s=[qs.of(r),Rr.of(Ca(`.${r}`,t))];return i&&i.dark&&s.push(xa.of(!0)),s}static baseTheme(t){return pc.lowest(Rr.of(Ca("."+Sa,t,wd)))}static findFromDOM(t){var i;let r=t.querySelector(".cm-content"),s=r&&wt.get(r)||wt.get(t);return((i=s==null?void 0:s.rootView)===null||i===void 0?void 0:i.view)||null}}at.styleModule=Rr;at.inputHandler=Jc;at.clipboardInputFilter=Ia;at.clipboardOutputFilter=Wa;at.scrollHandler=$c;at.focusChangeEffect=Zc;at.perLineTextDirection=Qc;at.exceptionSink=jc;at.updateListener=ya;at.editable=pi;at.mouseSelectionStyle=_c;at.dragMovesSelection=Xc;at.clickAddsSelectionRange=Yc;at.decorations=Yr;at.outerDecorations=id;at.atomicRanges=Fa;at.bidiIsolatedRanges=nd;at.scrollMargins=rd;at.darkTheme=xa;at.cspNonce=st.define({combine:f=>f.length?f[0]:""});at.contentAttributes=Ha;at.editorAttributes=ed;at.lineWrapping=at.contentAttributes.of({class:"cm-lineWrapping"});at.announce=Wt.define();const Zm=4096,qu={};class co{constructor(t,i,r,s,h,u){this.from=t,this.to=i,this.dir=r,this.isolates=s,this.fresh=h,this.order=u}static update(t,i){if(i.empty&&!t.some(h=>h.fresh))return t;let r=[],s=t.length?t[t.length-1].dir:te.LTR;for(let h=Math.max(0,t.length-10);h<t.length;h++){let u=t[h];u.dir==s&&!i.touchesRange(u.from,u.to)&&r.push(new co(i.mapPos(u.from,1),i.mapPos(u.to,-1),u.dir,u.isolates,!1,u.order))}return r}}function Yu(f,t,i){for(let r=f.state.facet(t),s=r.length-1;s>=0;s--){let h=r[s],u=typeof h=="function"?h(f):h;u&&ca(u,i)}return i}const Qm=V.mac?"mac":V.windows?"win":V.linux?"linux":"key";function $m(f,t){const i=f.split(/-(?!$)/);let r=i[i.length-1];r=="Space"&&(r=" ");let s,h,u,d;for(let p=0;p<i.length-1;++p){const v=i[p];if(/^(cmd|meta|m)$/i.test(v))d=!0;else if(/^a(lt)?$/i.test(v))s=!0;else if(/^(c|ctrl|control)$/i.test(v))h=!0;else if(/^s(hift)?$/i.test(v))u=!0;else if(/^mod$/i.test(v))t=="mac"?d=!0:h=!0;else throw new Error("Unrecognized modifier name: "+v)}return s&&(r="Alt-"+r),h&&(r="Ctrl-"+r),d&&(r="Meta-"+r),u&&(r="Shift-"+r),r}function Ys(f,t,i){return t.altKey&&(f="Alt-"+f),t.ctrlKey&&(f="Ctrl-"+f),t.metaKey&&(f="Meta-"+f),i!==!1&&t.shiftKey&&(f="Shift-"+f),f}const tv=pc.default(at.domEventHandlers({keydown(f,t){return rv(ev(t.state),f,t,"editor")}})),xd=st.define({enables:tv}),Xu=new WeakMap;function ev(f){let t=f.facet(xd),i=Xu.get(t);return i||Xu.set(t,i=nv(t.reduce((r,s)=>r.concat(s),[]))),i}let Pi=null;const iv=4e3;function nv(f,t=Qm){let i=Object.create(null),r=Object.create(null),s=(u,d)=>{let p=r[u];if(p==null)r[u]=d;else if(p!=d)throw new Error("Key binding "+u+" is used both as a regular binding and as a multi-stroke prefix")},h=(u,d,p,v,y)=>{var x,S;let A=i[u]||(i[u]=Object.create(null)),M=d.split(/ (?!$)/).map(P=>$m(P,t));for(let P=1;P<M.length;P++){let H=M.slice(0,P).join(" ");s(H,!0),A[H]||(A[H]={preventDefault:!0,stopPropagation:!1,run:[Y=>{let J=Pi={view:Y,prefix:H,scope:u};return setTimeout(()=>{Pi==J&&(Pi=null)},iv),!0}]})}let D=M.join(" ");s(D,!1);let N=A[D]||(A[D]={preventDefault:!1,stopPropagation:!1,run:((S=(x=A._any)===null||x===void 0?void 0:x.run)===null||S===void 0?void 0:S.slice())||[]});p&&N.run.push(p),v&&(N.preventDefault=!0),y&&(N.stopPropagation=!0)};for(let u of f){let d=u.scope?u.scope.split(" "):["editor"];if(u.any)for(let v of d){let y=i[v]||(i[v]=Object.create(null));y._any||(y._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:x}=u;for(let S in y)y[S].run.push(A=>x(A,ka))}let p=u[t]||u.key;if(p)for(let v of d)h(v,p,u.run,u.preventDefault,u.stopPropagation),u.shift&&h(v,"Shift-"+p,u.shift,u.preventDefault,u.stopPropagation)}return i}let ka=null;function rv(f,t,i,r){ka=t;let s=k0(t),h=s0(s,0),u=o0(h)==s.length&&s!=" ",d="",p=!1,v=!1,y=!1;Pi&&Pi.view==i&&Pi.scope==r&&(d=Pi.prefix+" ",fd.indexOf(t.keyCode)<0&&(v=!0,Pi=null));let x=new Set,S=N=>{if(N){for(let P of N.run)if(!x.has(P)&&(x.add(P),P(i)))return N.stopPropagation&&(y=!0),!0;N.preventDefault&&(N.stopPropagation&&(y=!0),v=!0)}return!1},A=f[r],M,D;return A&&(S(A[d+Ys(s,t,!u)])?p=!0:u&&(t.altKey||t.metaKey||t.ctrlKey)&&!(V.windows&&t.ctrlKey&&t.altKey)&&!(V.mac&&t.altKey&&!t.ctrlKey)&&(M=Wi[t.keyCode])&&M!=s?(S(A[d+Ys(M,t,!0)])||t.shiftKey&&(D=Vr[t.keyCode])!=s&&D!=M&&S(A[d+Ys(D,t,!1)]))&&(p=!0):u&&t.shiftKey&&S(A[d+Ys(s,t,!0)])&&(p=!0),!p&&S(A._any)&&(p=!0)),v&&(p=!0),p&&y&&t.stopPropagation(),ka=null,p}class sv extends yo{constructor(t){super(),this.content=t}toDOM(t){let i=document.createElement("span");return i.className="cm-placeholder",i.style.pointerEvents="none",i.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(t):this.content.cloneNode(!0)),i.setAttribute("aria-hidden","true"),i}coordsAt(t){let i=t.firstChild?Vn(t.firstChild):[];if(!i.length)return null;let r=window.getComputedStyle(t.parentNode),s=jr(i[0],r.direction!="rtl"),h=parseInt(r.lineHeight);return s.bottom-s.top>h*1.5?{left:s.left,right:s.right,top:s.top,bottom:s.top+h}:s}ignoreEvent(){return!1}}function ov(f){let t=fn.fromClass(class{constructor(i){this.view=i,this.placeholder=f?Ht.set([Ht.widget({widget:new sv(f),side:1}).range(0)]):Ht.none}get decorations(){return this.view.state.doc.length?Ht.none:this.placeholder}},{decorations:i=>i.decorations});return typeof f=="string"?[t,at.contentAttributes.of({"aria-placeholder":f})]:t}class _n extends Gn{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}_n.prototype.elementClass="";_n.prototype.toDOM=void 0;_n.prototype.mapMode=Le.TrackBefore;_n.prototype.startSide=_n.prototype.endSide=-1;_n.prototype.point=!0;const lv=1024;let av=0;class Gl{constructor(t,i){this.from=t,this.to=i}}class xt{constructor(t={}){this.id=av++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Oe.match(t)),i=>{let r=t(i);return r===void 0?null:[this,r]}}}xt.closedBy=new xt({deserialize:f=>f.split(" ")});xt.openedBy=new xt({deserialize:f=>f.split(" ")});xt.group=new xt({deserialize:f=>f.split(" ")});xt.isolate=new xt({deserialize:f=>{if(f&&f!="rtl"&&f!="ltr"&&f!="auto")throw new RangeError("Invalid value for isolate: "+f);return f||"auto"}});xt.contextHash=new xt({perNode:!0});xt.lookAhead=new xt({perNode:!0});xt.mounted=new xt({perNode:!0});class po{constructor(t,i,r){this.tree=t,this.overlay=i,this.parser=r}static get(t){return t&&t.props&&t.props[xt.mounted.id]}}const hv=Object.create(null);class Oe{constructor(t,i,r,s=0){this.name=t,this.props=i,this.id=r,this.flags=s}static define(t){let i=t.props&&t.props.length?Object.create(null):hv,r=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),s=new Oe(t.name||"",i,t.id,r);if(t.props){for(let h of t.props)if(Array.isArray(h)||(h=h(s)),h){if(h[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");i[h[0].id]=h[1]}}return s}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let i=this.prop(xt.group);return i?i.indexOf(t)>-1:!1}return this.id==t}static match(t){let i=Object.create(null);for(let r in t)for(let s of r.split(" "))i[s]=t[r];return r=>{for(let s=r.prop(xt.group),h=-1;h<(s?s.length:0);h++){let u=i[h<0?r.name:s[h]];if(u)return u}}}}Oe.none=new Oe("",Object.create(null),0,8);class Sd{constructor(t){this.types=t;for(let i=0;i<t.length;i++)if(t[i].id!=i)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let i=[];for(let r of this.types){let s=null;for(let h of t){let u=h(r);u&&(s||(s=Object.assign({},r.props)),s[u[0].id]=u[1])}i.push(s?new Oe(r.name,s,r.id,r.flags):r)}return new Sd(i)}}const Xs=new WeakMap,_u=new WeakMap;var $t;(function(f){f[f.ExcludeBuffers=1]="ExcludeBuffers",f[f.IncludeAnonymous=2]="IncludeAnonymous",f[f.IgnoreMounts=4]="IgnoreMounts",f[f.IgnoreOverlays=8]="IgnoreOverlays"})($t||($t={}));class le{constructor(t,i,r,s,h){if(this.type=t,this.children=i,this.positions=r,this.length=s,this.props=null,h&&h.length){this.props=Object.create(null);for(let[u,d]of h)this.props[typeof u=="number"?u:u.id]=d}}toString(){let t=po.get(this);if(t&&!t.overlay)return t.tree.toString();let i="";for(let r of this.children){let s=r.toString();s&&(i&&(i+=","),i+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(i.length?"("+i+")":""):i}cursor(t=0){return new Ma(this.topNode,t)}cursorAt(t,i=0,r=0){let s=Xs.get(this)||this.topNode,h=new Ma(s);return h.moveTo(t,i),Xs.set(this,h._tree),h}get topNode(){return new Be(this,0,0,null)}resolve(t,i=0){let r=Xr(Xs.get(this)||this.topNode,t,i,!1);return Xs.set(this,r),r}resolveInner(t,i=0){let r=Xr(_u.get(this)||this.topNode,t,i,!0);return _u.set(this,r),r}resolveStack(t,i=0){return cv(this,t,i)}iterate(t){let{enter:i,leave:r,from:s=0,to:h=this.length}=t,u=t.mode||0,d=(u&$t.IncludeAnonymous)>0;for(let p=this.cursor(u|$t.IncludeAnonymous);;){let v=!1;if(p.from<=h&&p.to>=s&&(!d&&p.type.isAnonymous||i(p)!==!1)){if(p.firstChild())continue;v=!0}for(;v&&r&&(d||!p.type.isAnonymous)&&r(p),!p.nextSibling();){if(!p.parent())return;v=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let i in this.props)t.push([+i,this.props[i]]);return t}balance(t={}){return this.children.length<=8?this:qa(Oe.none,this.children,this.positions,0,this.children.length,0,this.length,(i,r,s)=>new le(this.type,i,r,s,this.propValues),t.makeTree||((i,r,s)=>new le(Oe.none,i,r,s)))}static build(t){return dv(t)}}le.empty=new le(Oe.none,[],[],0);class Ga{constructor(t,i){this.buffer=t,this.index=i}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ga(this.buffer,this.index)}}class Fi{constructor(t,i,r){this.buffer=t,this.length=i,this.set=r}get type(){return Oe.none}toString(){let t=[];for(let i=0;i<this.buffer.length;)t.push(this.childString(i)),i=this.buffer[i+3];return t.join(",")}childString(t){let i=this.buffer[t],r=this.buffer[t+3],s=this.set.types[i],h=s.name;if(/\W/.test(h)&&!s.isError&&(h=JSON.stringify(h)),t+=4,r==t)return h;let u=[];for(;t<r;)u.push(this.childString(t)),t=this.buffer[t+3];return h+"("+u.join(",")+")"}findChild(t,i,r,s,h){let{buffer:u}=this,d=-1;for(let p=t;p!=i&&!(Cd(h,s,u[p+1],u[p+2])&&(d=p,r>0));p=u[p+3]);return d}slice(t,i,r){let s=this.buffer,h=new Uint16Array(i-t),u=0;for(let d=t,p=0;d<i;){h[p++]=s[d++],h[p++]=s[d++]-r;let v=h[p++]=s[d++]-r;h[p++]=s[d++]-t,u=Math.max(u,v)}return new Fi(h,u,this.set)}}function Cd(f,t,i,r){switch(f){case-2:return i<t;case-1:return r>=t&&i<t;case 0:return i<t&&r>t;case 1:return i<=t&&r>t;case 2:return r>t;case 4:return!0}}function Xr(f,t,i,r){for(var s;f.from==f.to||(i<1?f.from>=t:f.from>t)||(i>-1?f.to<=t:f.to<t);){let u=!r&&f instanceof Be&&f.index<0?null:f.parent;if(!u)return f;f=u}let h=r?0:$t.IgnoreOverlays;if(r)for(let u=f,d=u.parent;d;u=d,d=u.parent)u instanceof Be&&u.index<0&&((s=d.enter(t,i,h))===null||s===void 0?void 0:s.from)!=u.from&&(f=d);for(;;){let u=f.enter(t,i,h);if(!u)return f;f=u}}class kd{cursor(t=0){return new Ma(this,t)}getChild(t,i=null,r=null){let s=ju(this,t,i,r);return s.length?s[0]:null}getChildren(t,i=null,r=null){return ju(this,t,i,r)}resolve(t,i=0){return Xr(this,t,i,!1)}resolveInner(t,i=0){return Xr(this,t,i,!0)}matchContext(t){return Aa(this.parent,t)}enterUnfinishedNodesBefore(t){let i=this.childBefore(t),r=this;for(;i;){let s=i.lastChild;if(!s||s.to!=i.to)break;s.type.isError&&s.from==s.to?(r=i,i=s.prevSibling):i=s}return r}get node(){return this}get next(){return this.parent}}class Be extends kd{constructor(t,i,r,s){super(),this._tree=t,this.from=i,this.index=r,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,i,r,s,h=0){for(let u=this;;){for(let{children:d,positions:p}=u._tree,v=i>0?d.length:-1;t!=v;t+=i){let y=d[t],x=p[t]+u.from;if(Cd(s,r,x,x+y.length)){if(y instanceof Fi){if(h&$t.ExcludeBuffers)continue;let S=y.findChild(0,y.buffer.length,i,r-x,s);if(S>-1)return new Ri(new fv(u,y,t,x),null,S)}else if(h&$t.IncludeAnonymous||!y.type.isAnonymous||Va(y)){let S;if(!(h&$t.IgnoreMounts)&&(S=po.get(y))&&!S.overlay)return new Be(S.tree,x,t,u);let A=new Be(y,x,t,u);return h&$t.IncludeAnonymous||!A.type.isAnonymous?A:A.nextChild(i<0?y.children.length-1:0,i,r,s)}}}if(h&$t.IncludeAnonymous||!u.type.isAnonymous||(u.index>=0?t=u.index+i:t=i<0?-1:u._parent._tree.children.length,u=u._parent,!u))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,i,r=0){let s;if(!(r&$t.IgnoreOverlays)&&(s=po.get(this._tree))&&s.overlay){let h=t-this.from;for(let{from:u,to:d}of s.overlay)if((i>0?u<=h:u<h)&&(i<0?d>=h:d>h))return new Be(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,i,r)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function ju(f,t,i,r){let s=f.cursor(),h=[];if(!s.firstChild())return h;if(i!=null){for(let u=!1;!u;)if(u=s.type.is(i),!s.nextSibling())return h}for(;;){if(r!=null&&s.type.is(r))return h;if(s.type.is(t)&&h.push(s.node),!s.nextSibling())return r==null?h:[]}}function Aa(f,t,i=t.length-1){for(let r=f;i>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(t[i]&&t[i]!=r.name)return!1;i--}}return!0}class fv{constructor(t,i,r,s){this.parent=t,this.buffer=i,this.index=r,this.start=s}}class Ri extends kd{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,i,r){super(),this.context=t,this._parent=i,this.index=r,this.type=t.buffer.set.types[t.buffer.buffer[r]]}child(t,i,r){let{buffer:s}=this.context,h=s.findChild(this.index+4,s.buffer[this.index+3],t,i-this.context.start,r);return h<0?null:new Ri(this.context,this,h)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,i,r=0){if(r&$t.ExcludeBuffers)return null;let{buffer:s}=this.context,h=s.findChild(this.index+4,s.buffer[this.index+3],i>0?1:-1,t-this.context.start,i);return h<0?null:new Ri(this.context,this,h)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,i=t.buffer[this.index+3];return i<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new Ri(this.context,this._parent,i):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,i=this._parent?this._parent.index+4:0;return this.index==i?this.externalSibling(-1):new Ri(this.context,this._parent,t.findChild(i,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],i=[],{buffer:r}=this.context,s=this.index+4,h=r.buffer[this.index+3];if(h>s){let u=r.buffer[this.index+1];t.push(r.slice(s,h,u)),i.push(0)}return new le(this.type,t,i,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Ad(f){if(!f.length)return null;let t=0,i=f[0];for(let h=1;h<f.length;h++){let u=f[h];(u.from>i.from||u.to<i.to)&&(i=u,t=h)}let r=i instanceof Be&&i.index<0?null:i.parent,s=f.slice();return r?s[t]=r:s.splice(t,1),new uv(s,i)}class uv{constructor(t,i){this.heads=t,this.node=i}get next(){return Ad(this.heads)}}function cv(f,t,i){let r=f.resolveInner(t,i),s=null;for(let h=r instanceof Be?r:r.context.parent;h;h=h.parent)if(h.index<0){let u=h.parent;(s||(s=[r])).push(u.resolve(t,i)),h=u}else{let u=po.get(h.tree);if(u&&u.overlay&&u.overlay[0].from<=t&&u.overlay[u.overlay.length-1].to>=t){let d=new Be(u.tree,u.overlay[0].from+h.from,-1,h);(s||(s=[r])).push(Xr(d,t,i,!1))}}return s?Ad(s):r}class Ma{get name(){return this.type.name}constructor(t,i=0){if(this.mode=i,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Be)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let r=t._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,i){this.index=t;let{start:r,buffer:s}=this.buffer;return this.type=i||s.set.types[s.buffer[t]],this.from=r+s.buffer[t+1],this.to=r+s.buffer[t+2],!0}yield(t){return t?t instanceof Be?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,i,r){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,i,r,this.mode));let{buffer:s}=this.buffer,h=s.findChild(this.index+4,s.buffer[this.index+3],t,i-this.buffer.start,r);return h<0?!1:(this.stack.push(this.index),this.yieldBuf(h))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,i,r=this.mode){return this.buffer?r&$t.ExcludeBuffers?!1:this.enterChild(1,t,i):this.yield(this._tree.enter(t,i,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&$t.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&$t.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:i}=this.buffer,r=this.stack.length-1;if(t<0){let s=r<0?0:this.stack[r]+4;if(this.index!=s)return this.yieldBuf(i.findChild(s,this.index,-1,0,4))}else{let s=i.buffer[this.index+3];if(s<(r<0?i.buffer.length:i.buffer[this.stack[r]+3]))return this.yieldBuf(s)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let i,r,{buffer:s}=this;if(s){if(t>0){if(this.index<s.buffer.buffer.length)return!1}else for(let h=0;h<this.index;h++)if(s.buffer.buffer[h+3]<this.index)return!1;({index:i,parent:r}=s)}else({index:i,_parent:r}=this._tree);for(;r;{index:i,_parent:r}=r)if(i>-1)for(let h=i+t,u=t<0?-1:r._tree.children.length;h!=u;h+=t){let d=r._tree.children[h];if(this.mode&$t.IncludeAnonymous||d instanceof Fi||!d.type.isAnonymous||Va(d))return!1}return!0}move(t,i){if(i&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,i=0){for(;(this.from==this.to||(i<1?this.from>=t:this.from>t)||(i>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,i););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,i=null,r=0;if(t&&t.context==this.buffer)t:for(let s=this.index,h=this.stack.length;h>=0;){for(let u=t;u;u=u._parent)if(u.index==s){if(s==this.index)return u;i=u,r=h+1;break t}s=this.stack[--h]}for(let s=r;s<this.stack.length;s++)i=new Ri(this.buffer,i,this.stack[s]);return this.bufferNode=new Ri(this.buffer,i,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,i){for(let r=0;;){let s=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&i&&i(this),s=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,s=!0}}}matchContext(t){if(!this.buffer)return Aa(this.node.parent,t);let{buffer:i}=this.buffer,{types:r}=i.set;for(let s=t.length-1,h=this.stack.length-1;s>=0;h--){if(h<0)return Aa(this._tree,t,s);let u=r[i.buffer[this.stack[h]]];if(!u.isAnonymous){if(t[s]&&t[s]!=u.name)return!1;s--}}return!0}}function Va(f){return f.children.some(t=>t instanceof Fi||!t.type.isAnonymous||Va(t))}function dv(f){var t;let{buffer:i,nodeSet:r,maxBufferLength:s=lv,reused:h=[],minRepeatType:u=r.types.length}=f,d=Array.isArray(i)?new Ga(i,i.length):i,p=r.types,v=0,y=0;function x(q,et,Q,pt,vt,St){let{id:ot,start:tt,end:ht,size:lt}=d,G=y,ae=v;for(;lt<0;)if(d.next(),lt==-1){let ke=h[ot];Q.push(ke),pt.push(tt-q);return}else if(lt==-3){v=ot;return}else if(lt==-4){y=ot;return}else throw new RangeError(`Unrecognized record size: ${lt}`);let Se=p[ot],Ce,Bt,Ge=tt-q;if(ht-tt<=s&&(Bt=N(d.pos-et,vt))){let ke=new Uint16Array(Bt.size-Bt.skip),qt=d.pos-Bt.size,ee=ke.length;for(;d.pos>qt;)ee=P(Bt.start,ke,ee);Ce=new Fi(ke,ht-Bt.start,r),Ge=Bt.start-q}else{let ke=d.pos-lt;d.next();let qt=[],ee=[],ve=ot>=u?ot:-1,ye=0,oi=ht;for(;d.pos>ke;)ve>=0&&d.id==ve&&d.size>=0?(d.end<=oi-s&&(M(qt,ee,tt,ye,d.end,oi,ve,G,ae),ye=qt.length,oi=d.end),d.next()):St>2500?S(tt,ke,qt,ee):x(tt,ke,qt,ee,ve,St+1);if(ve>=0&&ye>0&&ye<qt.length&&M(qt,ee,tt,ye,tt,oi,ve,G,ae),qt.reverse(),ee.reverse(),ve>-1&&ye>0){let cn=A(Se,ae);Ce=qa(Se,qt,ee,0,qt.length,0,ht-tt,cn,cn)}else Ce=D(Se,qt,ee,ht-tt,G-ht,ae)}Q.push(Ce),pt.push(Ge)}function S(q,et,Q,pt){let vt=[],St=0,ot=-1;for(;d.pos>et;){let{id:tt,start:ht,end:lt,size:G}=d;if(G>4)d.next();else{if(ot>-1&&ht<ot)break;ot<0&&(ot=lt-s),vt.push(tt,ht,lt),St++,d.next()}}if(St){let tt=new Uint16Array(St*4),ht=vt[vt.length-2];for(let lt=vt.length-3,G=0;lt>=0;lt-=3)tt[G++]=vt[lt],tt[G++]=vt[lt+1]-ht,tt[G++]=vt[lt+2]-ht,tt[G++]=G;Q.push(new Fi(tt,vt[2]-ht,r)),pt.push(ht-q)}}function A(q,et){return(Q,pt,vt)=>{let St=0,ot=Q.length-1,tt,ht;if(ot>=0&&(tt=Q[ot])instanceof le){if(!ot&&tt.type==q&&tt.length==vt)return tt;(ht=tt.prop(xt.lookAhead))&&(St=pt[ot]+tt.length+ht)}return D(q,Q,pt,vt,St,et)}}function M(q,et,Q,pt,vt,St,ot,tt,ht){let lt=[],G=[];for(;q.length>pt;)lt.push(q.pop()),G.push(et.pop()+Q-vt);q.push(D(r.types[ot],lt,G,St-vt,tt-St,ht)),et.push(vt-Q)}function D(q,et,Q,pt,vt,St,ot){if(St){let tt=[xt.contextHash,St];ot=ot?[tt].concat(ot):[tt]}if(vt>25){let tt=[xt.lookAhead,vt];ot=ot?[tt].concat(ot):[tt]}return new le(q,et,Q,pt,ot)}function N(q,et){let Q=d.fork(),pt=0,vt=0,St=0,ot=Q.end-s,tt={size:0,start:0,skip:0};t:for(let ht=Q.pos-q;Q.pos>ht;){let lt=Q.size;if(Q.id==et&&lt>=0){tt.size=pt,tt.start=vt,tt.skip=St,St+=4,pt+=4,Q.next();continue}let G=Q.pos-lt;if(lt<0||G<ht||Q.start<ot)break;let ae=Q.id>=u?4:0,Se=Q.start;for(Q.next();Q.pos>G;){if(Q.size<0)if(Q.size==-3)ae+=4;else break t;else Q.id>=u&&(ae+=4);Q.next()}vt=Se,pt+=lt,St+=ae}return(et<0||pt==q)&&(tt.size=pt,tt.start=vt,tt.skip=St),tt.size>4?tt:void 0}function P(q,et,Q){let{id:pt,start:vt,end:St,size:ot}=d;if(d.next(),ot>=0&&pt<u){let tt=Q;if(ot>4){let ht=d.pos-(ot-4);for(;d.pos>ht;)Q=P(q,et,Q)}et[--Q]=tt,et[--Q]=St-q,et[--Q]=vt-q,et[--Q]=pt}else ot==-3?v=pt:ot==-4&&(y=pt);return Q}let H=[],Y=[];for(;d.pos>0;)x(f.start||0,f.bufferStart||0,H,Y,-1,0);let J=(t=f.length)!==null&&t!==void 0?t:H.length?Y[0]+H[0].length:0;return new le(p[f.topID],H.reverse(),Y.reverse(),J)}const Ju=new WeakMap;function ro(f,t){if(!f.isAnonymous||t instanceof Fi||t.type!=f)return 1;let i=Ju.get(t);if(i==null){i=1;for(let r of t.children){if(r.type!=f||!(r instanceof le)){i=1;break}i+=ro(f,r)}Ju.set(t,i)}return i}function qa(f,t,i,r,s,h,u,d,p){let v=0;for(let M=r;M<s;M++)v+=ro(f,t[M]);let y=Math.ceil(v*1.5/8),x=[],S=[];function A(M,D,N,P,H){for(let Y=N;Y<P;){let J=Y,q=D[Y],et=ro(f,M[Y]);for(Y++;Y<P;Y++){let Q=ro(f,M[Y]);if(et+Q>=y)break;et+=Q}if(Y==J+1){if(et>y){let Q=M[J];A(Q.children,Q.positions,0,Q.children.length,D[J]+H);continue}x.push(M[J])}else{let Q=D[Y-1]+M[Y-1].length-q;x.push(qa(f,M,D,J,Y,q,Q,null,p))}S.push(q+H-h)}}return A(t,i,r,s,0),(d||p)(x,S,u)}class on{constructor(t,i,r,s,h=!1,u=!1){this.from=t,this.to=i,this.tree=r,this.offset=s,this.open=(h?1:0)|(u?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,i=[],r=!1){let s=[new on(0,t.length,t,0,!1,r)];for(let h of i)h.to>t.length&&s.push(h);return s}static applyChanges(t,i,r=128){if(!i.length)return t;let s=[],h=1,u=t.length?t[0]:null;for(let d=0,p=0,v=0;;d++){let y=d<i.length?i[d]:null,x=y?y.fromA:1e9;if(x-p>=r)for(;u&&u.from<x;){let S=u;if(p>=S.from||x<=S.to||v){let A=Math.max(S.from,p)-v,M=Math.min(S.to,x)-v;S=A>=M?null:new on(A,M,S.tree,S.offset+v,d>0,!!y)}if(S&&s.push(S),u.to>x)break;u=h<t.length?t[h++]:null}if(!y)break;p=y.toA,v=y.toA-y.toB}return s}}class pv{startParse(t,i,r){return typeof t=="string"&&(t=new gv(t)),r=r?r.length?r.map(s=>new Gl(s.from,s.to)):[new Gl(0,0)]:[new Gl(0,t.length)],this.createParse(t,i||[],r)}parse(t,i,r){let s=this.startParse(t,i,r);for(;;){let h=s.advance();if(h)return h}}}class gv{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,i){return this.string.slice(t,i)}}new xt({perNode:!0});let mv=0;class Pe{constructor(t,i,r,s){this.name=t,this.set=i,this.base=r,this.modified=s,this.id=mv++}toString(){let{name:t}=this;for(let i of this.modified)i.name&&(t=`${i.name}(${t})`);return t}static define(t,i){let r=typeof t=="string"?t:"?";if(t instanceof Pe&&(i=t),i!=null&&i.base)throw new Error("Can not derive from a modified tag");let s=new Pe(r,[],null,[]);if(s.set.push(s),i)for(let h of i.set)s.set.push(h);return s}static defineModifier(t){let i=new go(t);return r=>r.modified.indexOf(i)>-1?r:go.get(r.base||r,r.modified.concat(i).sort((s,h)=>s.id-h.id))}}let vv=0;class go{constructor(t){this.name=t,this.instances=[],this.id=vv++}static get(t,i){if(!i.length)return t;let r=i[0].instances.find(d=>d.base==t&&yv(i,d.modified));if(r)return r;let s=[],h=new Pe(t.name,s,t,i);for(let d of i)d.instances.push(h);let u=bv(i);for(let d of t.set)if(!d.modified.length)for(let p of u)s.push(go.get(d,p));return h}}function yv(f,t){return f.length==t.length&&f.every((i,r)=>i==t[r])}function bv(f){let t=[[]];for(let i=0;i<f.length;i++)for(let r=0,s=t.length;r<s;r++)t.push(t[r].concat(f[i]));return t.sort((i,r)=>r.length-i.length)}function wv(f){let t=Object.create(null);for(let i in f){let r=f[i];Array.isArray(r)||(r=[r]);for(let s of i.split(" "))if(s){let h=[],u=2,d=s;for(let x=0;;){if(d=="..."&&x>0&&x+3==s.length){u=1;break}let S=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(d);if(!S)throw new RangeError("Invalid path: "+s);if(h.push(S[0]=="*"?"":S[0][0]=='"'?JSON.parse(S[0]):S[0]),x+=S[0].length,x==s.length)break;let A=s[x++];if(x==s.length&&A=="!"){u=0;break}if(A!="/")throw new RangeError("Invalid path: "+s);d=s.slice(x)}let p=h.length-1,v=h[p];if(!v)throw new RangeError("Invalid path: "+s);let y=new Ta(r,u,p>0?h.slice(0,p):null);t[v]=y.sort(t[v])}}return xv.add(t)}const xv=new xt;class Ta{constructor(t,i,r,s){this.tags=t,this.mode=i,this.context=r,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}Ta.empty=new Ta([],2,null);function Md(f,t){let i=Object.create(null);for(let h of f)if(!Array.isArray(h.tag))i[h.tag.id]=h.class;else for(let u of h.tag)i[u.id]=h.class;let{scope:r,all:s=null}=t||{};return{style:h=>{let u=s;for(let d of h)for(let p of d.set){let v=i[p.id];if(v){u=u?u+" "+v:v;break}}return u},scope:r}}const z=Pe.define,_s=z(),Di=z(),Zu=z(Di),Qu=z(Di),Ni=z(),js=z(Ni),Vl=z(Ni),$e=z(),tn=z($e),Ze=z(),Qe=z(),La=z(),Er=z(La),Js=z(),K={comment:_s,lineComment:z(_s),blockComment:z(_s),docComment:z(_s),name:Di,variableName:z(Di),typeName:Zu,tagName:z(Zu),propertyName:Qu,attributeName:z(Qu),className:z(Di),labelName:z(Di),namespace:z(Di),macroName:z(Di),literal:Ni,string:js,docString:z(js),character:z(js),attributeValue:z(js),number:Vl,integer:z(Vl),float:z(Vl),bool:z(Ni),regexp:z(Ni),escape:z(Ni),color:z(Ni),url:z(Ni),keyword:Ze,self:z(Ze),null:z(Ze),atom:z(Ze),unit:z(Ze),modifier:z(Ze),operatorKeyword:z(Ze),controlKeyword:z(Ze),definitionKeyword:z(Ze),moduleKeyword:z(Ze),operator:Qe,derefOperator:z(Qe),arithmeticOperator:z(Qe),logicOperator:z(Qe),bitwiseOperator:z(Qe),compareOperator:z(Qe),updateOperator:z(Qe),definitionOperator:z(Qe),typeOperator:z(Qe),controlOperator:z(Qe),punctuation:La,separator:z(La),bracket:Er,angleBracket:z(Er),squareBracket:z(Er),paren:z(Er),brace:z(Er),content:$e,heading:tn,heading1:z(tn),heading2:z(tn),heading3:z(tn),heading4:z(tn),heading5:z(tn),heading6:z(tn),contentSeparator:z($e),list:z($e),quote:z($e),emphasis:z($e),strong:z($e),link:z($e),monospace:z($e),strikethrough:z($e),inserted:z(),deleted:z(),changed:z(),invalid:z(),meta:Js,documentMeta:z(Js),annotation:z(Js),processingInstruction:z(Js),definition:Pe.defineModifier("definition"),constant:Pe.defineModifier("constant"),function:Pe.defineModifier("function"),standard:Pe.defineModifier("standard"),local:Pe.defineModifier("local"),special:Pe.defineModifier("special")};for(let f in K){let t=K[f];t instanceof Pe&&(t.name=f)}Md([{tag:K.link,class:"tok-link"},{tag:K.heading,class:"tok-heading"},{tag:K.emphasis,class:"tok-emphasis"},{tag:K.strong,class:"tok-strong"},{tag:K.keyword,class:"tok-keyword"},{tag:K.atom,class:"tok-atom"},{tag:K.bool,class:"tok-bool"},{tag:K.url,class:"tok-url"},{tag:K.labelName,class:"tok-labelName"},{tag:K.inserted,class:"tok-inserted"},{tag:K.deleted,class:"tok-deleted"},{tag:K.literal,class:"tok-literal"},{tag:K.string,class:"tok-string"},{tag:K.number,class:"tok-number"},{tag:[K.regexp,K.escape,K.special(K.string)],class:"tok-string2"},{tag:K.variableName,class:"tok-variableName"},{tag:K.local(K.variableName),class:"tok-variableName tok-local"},{tag:K.definition(K.variableName),class:"tok-variableName tok-definition"},{tag:K.special(K.variableName),class:"tok-variableName2"},{tag:K.definition(K.propertyName),class:"tok-propertyName tok-definition"},{tag:K.typeName,class:"tok-typeName"},{tag:K.namespace,class:"tok-namespace"},{tag:K.className,class:"tok-className"},{tag:K.macroName,class:"tok-macroName"},{tag:K.propertyName,class:"tok-propertyName"},{tag:K.operator,class:"tok-operator"},{tag:K.comment,class:"tok-comment"},{tag:K.meta,class:"tok-meta"},{tag:K.invalid,class:"tok-invalid"},{tag:K.punctuation,class:"tok-punctuation"}]);var ql;const Hn=new xt;function Sv(f){return st.define({combine:f?t=>t.concat(f):void 0})}const Cv=new xt;class ze{constructor(t,i,r=[],s=""){this.data=t,this.name=s,ut.prototype.hasOwnProperty("tree")||Object.defineProperty(ut.prototype,"tree",{get(){return Da(this)}}),this.parser=i,this.extension=[Jn.of(this),ut.languageData.of((h,u,d)=>{let p=$u(h,u,d),v=p.type.prop(Hn);if(!v)return[];let y=h.facet(v),x=p.type.prop(Cv);if(x){let S=p.resolve(u-p.from,d);for(let A of x)if(A.test(S,h)){let M=h.facet(A.facet);return A.type=="replace"?M:M.concat(y)}}return y})].concat(r)}isActiveAt(t,i,r=-1){return $u(t,i,r).type.prop(Hn)==this.data}findRegions(t){let i=t.facet(Jn);if((i==null?void 0:i.data)==this.data)return[{from:0,to:t.doc.length}];if(!i||!i.allowsNesting)return[];let r=[],s=(h,u)=>{if(h.prop(Hn)==this.data){r.push({from:u,to:u+h.length});return}let d=h.prop(xt.mounted);if(d){if(d.tree.prop(Hn)==this.data){if(d.overlay)for(let p of d.overlay)r.push({from:p.from+u,to:p.to+u});else r.push({from:u,to:u+h.length});return}else if(d.overlay){let p=r.length;if(s(d.tree,d.overlay[0].from+u),r.length>p)return}}for(let p=0;p<h.children.length;p++){let v=h.children[p];v instanceof le&&s(v,h.positions[p]+u)}};return s(Da(t),0),r}get allowsNesting(){return!0}}ze.setState=Wt.define();function $u(f,t,i){let r=f.facet(Jn),s=Da(f).topNode;if(!r||r.allowsNesting)for(let h=s;h;h=h.enter(t,i,$t.ExcludeBuffers))h.type.isTop&&(s=h);return s}class Oa extends ze{constructor(t,i,r){super(t,i,[],r),this.parser=i}static define(t){let i=Sv(t.languageData);return new Oa(i,t.parser.configure({props:[Hn.add(r=>r.isTop?i:void 0)]}),t.name)}configure(t,i){return new Oa(this.data,this.parser.configure(t),i||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Da(f){let t=f.field(ze.state,!1);return t?t.tree:le.empty}class kv{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,i){let r=this.cursorPos-this.string.length;return t<r||i>=this.cursorPos?this.doc.sliceString(t,i):this.string.slice(t-r,i-r)}}let Br=null;class mo{constructor(t,i,r=[],s,h,u,d,p){this.parser=t,this.state=i,this.fragments=r,this.tree=s,this.treeLen=h,this.viewport=u,this.skipped=d,this.scheduleOn=p,this.parse=null,this.tempSkipped=[]}static create(t,i,r){return new mo(t,i,[],le.empty,0,r,[],null)}startParse(){return this.parser.startParse(new kv(this.state.doc),this.fragments)}work(t,i){return i!=null&&i>=this.state.doc.length&&(i=void 0),this.tree!=le.empty&&this.isDone(i??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof t=="number"){let s=Date.now()+t;t=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),i!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>i)&&i<this.state.doc.length&&this.parse.stopAt(i);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(on.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(i??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,i;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(i=this.parse.advance()););}),this.treeLen=t,this.tree=i,this.fragments=this.withoutTempSkipped(on.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let i=Br;Br=this;try{return t()}finally{Br=i}}withoutTempSkipped(t){for(let i;i=this.tempSkipped.pop();)t=tc(t,i.from,i.to);return t}changes(t,i){let{fragments:r,tree:s,treeLen:h,viewport:u,skipped:d}=this;if(this.takeTree(),!t.empty){let p=[];if(t.iterChangedRanges((v,y,x,S)=>p.push({fromA:v,toA:y,fromB:x,toB:S})),r=on.applyChanges(r,p),s=le.empty,h=0,u={from:t.mapPos(u.from,-1),to:t.mapPos(u.to,1)},this.skipped.length){d=[];for(let v of this.skipped){let y=t.mapPos(v.from,1),x=t.mapPos(v.to,-1);y<x&&d.push({from:y,to:x})}}}return new mo(this.parser,i,r,s,h,u,d,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let i=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:s,to:h}=this.skipped[r];s<t.to&&h>t.from&&(this.fragments=tc(this.fragments,s,h),this.skipped.splice(r--,1))}return this.skipped.length>=i?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,i){this.skipped.push({from:t,to:i})}static getSkippingParser(t){return new class extends pv{createParse(i,r,s){let h=s[0].from,u=s[s.length-1].to;return{parsedPos:h,advance(){let p=Br;if(p){for(let v of s)p.tempSkipped.push(v);t&&(p.scheduleOn=p.scheduleOn?Promise.all([p.scheduleOn,t]):t)}return this.parsedPos=u,new le(Oe.none,[],[],u-h)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let i=this.fragments;return this.treeLen>=t&&i.length&&i[0].from==0&&i[0].to>=t}static get(){return Br}}function tc(f,t,i){return on.applyChanges(f,[{fromA:t,toA:i,fromB:t,toB:i}])}class jn{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let i=this.context.changes(t.changes,t.state),r=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),i.viewport.to);return i.work(20,r)||i.takeTree(),new jn(i)}static init(t){let i=Math.min(3e3,t.doc.length),r=mo.create(t.facet(Jn).parser,t,{from:0,to:i});return r.work(20,i)||r.takeTree(),new jn(r)}}ze.state=un.define({create:jn.init,update(f,t){for(let i of t.effects)if(i.is(ze.setState))return i.value;return t.startState.facet(Jn)!=t.state.facet(Jn)?jn.init(t.state):f.apply(t)}});let Td=f=>{let t=setTimeout(()=>f(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(Td=f=>{let t=-1,i=setTimeout(()=>{t=requestIdleCallback(f,{timeout:500-100})},100);return()=>t<0?clearTimeout(i):cancelIdleCallback(t)});const Yl=typeof navigator<"u"&&(!((ql=navigator.scheduling)===null||ql===void 0)&&ql.isInputPending)?()=>navigator.scheduling.isInputPending():null,Av=fn.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let i=this.view.state.field(ze.state).context;(i.updateViewport(t.view.viewport)||this.view.viewport.to>i.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(i)}scheduleWork(){if(this.working)return;let{state:t}=this.view,i=t.field(ze.state);(i.tree!=i.context.tree||!i.context.isDone(t.doc.length))&&(this.working=Td(this.work))}work(t){this.working=null;let i=Date.now();if(this.chunkEnd<i&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=i+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:s}}=this.view,h=r.field(ze.state);if(h.tree==h.context.tree&&h.context.isDone(s+1e5))return;let u=Date.now()+Math.min(this.chunkBudget,100,t&&!Yl?Math.max(25,t.timeRemaining()-5):1e9),d=h.context.treeLen<s&&r.doc.length>s+1e3,p=h.context.work(()=>Yl&&Yl()||Date.now()>u,s+(d?0:1e5));this.chunkBudget-=Date.now()-i,(p||this.chunkBudget<=0)&&(h.context.takeTree(),this.view.dispatch({effects:ze.setState.of(new jn(h.context))})),this.chunkBudget>0&&!(p&&!d)&&this.scheduleWork(),this.checkAsyncSchedule(h.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(i=>ni(this.view.state,i)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Jn=st.define({combine(f){return f.length?f[0]:null},enables:f=>[ze.state,Av,at.contentAttributes.compute([f],t=>{let i=t.facet(f);return i&&i.name?{"data-language":i.name}:{}})]});class qv{constructor(t,i=[]){this.language=t,this.support=i,this.extension=[t,i]}}const wo=st.define({combine:f=>{if(!f.length)return"  ";let t=f[0];if(!t||/\S/.test(t)||Array.from(t).some(i=>i!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(f[0]));return t}});function Mv(f){let t=f.facet(wo);return t.charCodeAt(0)==9?f.tabSize*t.length:t.length}function Tv(f,t){let i="",r=f.tabSize,s=f.facet(wo)[0];if(s=="	"){for(;t>=r;)i+="	",t-=r;s=" "}for(let h=0;h<t;h++)i+=s;return i}const Yv=new xt;function Xv({except:f,units:t=1}={}){return i=>{let r=f&&f.test(i.textAfter);return i.baseIndent+(r?0:t*i.unit)}}const _v=new xt;function jv(f){let t=f.firstChild,i=f.lastChild;return t&&t.to<i.from?{from:t.to,to:i.type.isError?f.to:i.from}:null}class Ya{constructor(t,i){this.specs=t;let r;function s(d){let p=Ii.newName();return(r||(r=Object.create(null)))["."+p]=d,p}const h=typeof i.all=="string"?i.all:i.all?s(i.all):void 0,u=i.scope;this.scope=u instanceof ze?d=>d.prop(Hn)==u.data:u?d=>d==u:void 0,this.style=Md(t.map(d=>({tag:d.tag,class:d.class||s(Object.assign({},d,{tag:null}))})),{all:h}).style,this.module=r?new Ii(r):null,this.themeType=i.themeType}static define(t,i){return new Ya(t,i||{})}}K.meta,K.link,K.heading,K.emphasis,K.strong,K.strikethrough,K.keyword,K.atom,K.bool,K.url,K.contentSeparator,K.labelName,K.literal,K.inserted,K.string,K.deleted,K.regexp,K.escape,K.string,K.variableName,K.variableName,K.typeName,K.namespace,K.className,K.variableName,K.macroName,K.propertyName,K.comment,K.invalid;const Lv=Object.create(null),ec=[Oe.none],ic=[],nc=Object.create(null),Ov=Object.create(null);for(let[f,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Ov[f]=Dv(Lv,t);function Xl(f,t){ic.indexOf(f)>-1||(ic.push(f),console.warn(t))}function Dv(f,t){let i=[];for(let d of t.split(" ")){let p=[];for(let v of d.split(".")){let y=f[v]||K[v];y?typeof y=="function"?p.length?p=p.map(y):Xl(v,`Modifier ${v} used at start of tag`):p.length?Xl(v,`Tag ${v} used as modifier`):p=Array.isArray(y)?y:[y]:Xl(v,`Unknown highlighting tag ${v}`)}for(let v of p)i.push(v)}if(!i.length)return 0;let r=t.replace(/ /g,"_"),s=r+" "+i.map(d=>d.id),h=nc[s];if(h)return h.id;let u=nc[s]=Oe.define({id:ec.length,name:r,props:[wv({[r]:i})]});return ec.push(u),u.id}te.RTL,te.LTR;function Ld(f,t){let i=-1;return f.changeByRange(r=>{let s=[];for(let u=r.from;u<=r.to;){let d=f.doc.lineAt(u);d.number>i&&(r.empty||r.to>d.from)&&(t(d,s,r),i=d.number),u=d.to+1}let h=f.changes(s);return{changes:s,range:j.range(h.mapPos(r.anchor,1),h.mapPos(r.head,1))}})}const Nv=({state:f,dispatch:t})=>f.readOnly?!1:(t(f.update(Ld(f,(i,r)=>{r.push({from:i.from,insert:f.facet(wo)})}),{userEvent:"input.indent"})),!0),Pv=({state:f,dispatch:t})=>f.readOnly?!1:(t(f.update(Ld(f,(i,r)=>{let s=/^\s*/.exec(i.text)[0];if(!s)return;let h=b0(s,f.tabSize),u=0,d=Tv(f,Math.max(0,h-Mv(f)));for(;u<s.length&&u<d.length&&s.charCodeAt(u)==d.charCodeAt(u);)u++;r.push({from:i.from+u,to:i.from+s.length,insert:d.slice(u)})}),{userEvent:"delete.dedent"})),!0),Ev={key:"Tab",run:Nv,shift:Pv};/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var Bv=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[Zg.basicSetup]}),Rv=Symbol("vue-codemirror-global-config"),ge,Iv=function(f){var t=f.onUpdate,i=f.onChange,r=f.onFocus,s=f.onBlur,h=function(u,d){var p={};for(var v in u)Object.prototype.hasOwnProperty.call(u,v)&&d.indexOf(v)<0&&(p[v]=u[v]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var y=0;for(v=Object.getOwnPropertySymbols(u);y<v.length;y++)d.indexOf(v[y])<0&&Object.prototype.propertyIsEnumerable.call(u,v[y])&&(p[v[y]]=u[v[y]])}return p}(f,["onUpdate","onChange","onFocus","onBlur"]);return ut.create({doc:h.doc,selection:h.selection,extensions:(Array.isArray(h.extensions)?h.extensions:[h.extensions]).concat([at.updateListener.of(function(u){t(u),u.docChanged&&i(u.state.doc.toString(),u),u.focusChanged&&(u.view.hasFocus?r(u):s(u))})])})},In=function(f){var t=new _r;return{compartment:t,run:function(i){t.get(f.state)?f.dispatch({effects:t.reconfigure(i)}):f.dispatch({effects:Wt.appendConfig.of(t.of(i))})}}},rc=function(f,t){var i=In(f),r=i.compartment,s=i.run;return function(h){var u=r.get(f.state);s(h??u!==t?t:[])}},Zs={type:Boolean,default:void 0},Wv={autofocus:Zs,disabled:Zs,indentWithTab:Zs,tabSize:Number,placeholder:String,style:Object,autoDestroy:Zs,phrases:Object,root:Object,extensions:Array,selection:Object},Hv={modelValue:{type:String,default:""}},Fv=Object.assign(Object.assign({},Wv),Hv);(function(f){f.Change="change",f.Update="update",f.Focus="focus",f.Blur="blur",f.Ready="ready",f.ModelUpdate="update:modelValue"})(ge||(ge={}));var nn={};nn[ge.Change]=function(f,t){return!0},nn[ge.Update]=function(f){return!0},nn[ge.Focus]=function(f){return!0},nn[ge.Blur]=function(f){return!0},nn[ge.Ready]=function(f){return!0};var Od={};Od[ge.ModelUpdate]=nn[ge.Change];var zv=Object.assign(Object.assign({},nn),Od),Kv=Vg({name:"VueCodemirror",props:Object.assign({},Fv),emits:Object.assign({},zv),setup:function(f,t){var i=El(),r=El(),s=El(),h=Object.assign(Object.assign({},Bv),qg(Rv,{})),u=Yg(function(){var d={};return Object.keys(Jg(f)).forEach(function(p){var v;p!=="modelValue"&&(d[p]=(v=f[p])!==null&&v!==void 0?v:h[p])}),d});return Xg(function(){var d;r.value=Iv({doc:f.modelValue,selection:u.value.selection,extensions:(d=h.extensions)!==null&&d!==void 0?d:[],onFocus:function(v){return t.emit(ge.Focus,v)},onBlur:function(v){return t.emit(ge.Blur,v)},onUpdate:function(v){return t.emit(ge.Update,v)},onChange:function(v,y){v!==f.modelValue&&(t.emit(ge.Change,v,y),t.emit(ge.ModelUpdate,v,y))}}),s.value=function(v){return new at(Object.assign({},v))}({state:r.value,parent:i.value,root:u.value.root});var p=function(v){var y=function(){return v.state.doc.toString()},x=In(v).run,S=rc(v,[at.editable.of(!1),ut.readOnly.of(!0)]),A=rc(v,xd.of([Ev])),M=In(v).run,D=In(v).run,N=In(v).run,P=In(v).run;return{focus:function(){return v.focus()},getDoc:y,setDoc:function(H){H!==y()&&v.dispatch({changes:{from:0,to:v.state.doc.length,insert:H}})},reExtensions:x,toggleDisabled:S,toggleIndentWithTab:A,setTabSize:function(H){M([ut.tabSize.of(H),wo.of(" ".repeat(H))])},setPhrases:function(H){D([ut.phrases.of(H)])},setPlaceholder:function(H){N(ov(H))},setStyle:function(H){H===void 0&&(H={}),P(at.theme({"&":Object.assign({},H)}))}}}(s.value);Oi(function(){return f.modelValue},function(v){v!==p.getDoc()&&p.setDoc(v)}),Oi(function(){return f.extensions},function(v){return p.reExtensions(v||[])},{immediate:!0}),Oi(function(){return u.value.disabled},function(v){return p.toggleDisabled(v)},{immediate:!0}),Oi(function(){return u.value.indentWithTab},function(v){return p.toggleIndentWithTab(v)},{immediate:!0}),Oi(function(){return u.value.tabSize},function(v){return p.setTabSize(v)},{immediate:!0}),Oi(function(){return u.value.phrases},function(v){return p.setPhrases(v||{})},{immediate:!0}),Oi(function(){return u.value.placeholder},function(v){return p.setPlaceholder(v)},{immediate:!0}),Oi(function(){return u.value.style},function(v){return p.setStyle(v)},{immediate:!0}),u.value.autofocus&&p.focus(),t.emit(ge.Ready,{state:r.value,view:s.value,container:i.value})}),_g(function(){u.value.autoDestroy&&s.value&&function(d){d.destroy()}(s.value)}),function(){return jg("div",{class:"v-codemirror",style:{display:"contents"},ref:i})}}}),Jv=Kv;export{lv as D,$t as I,qv as L,Sd as N,pv as P,le as T,Oe as a,xt as b,Oa as c,Xv as d,jv as e,_v as f,Jv as g,Yv as i,wv as s,K as t};
