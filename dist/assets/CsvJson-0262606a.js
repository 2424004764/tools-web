import{_ as M}from"./DetailHeader.vue_vue_type_script_setup_true_lang-43bd1469.js";import{_ as I}from"./ToolDetail.vue_vue_type_script_setup_true_lang-b167f798.js";import{d as Q,l as h,A as C,B as R,r as y,b as x,c as A,i as n,f as d,h as c,j as p,g as k,C as w,D as z,s as q,E as j}from"./index-ad8866de.js";const F={class:"flex flex-col mt-3 flex-1"},G={class:"p-4 rounded-2xl bg-white"},L={class:"flex flex-wrap items-center gap-3"},P={class:"flex items-center gap-2"},W={class:"mt-3 text-sm text-gray-500"},X={class:"mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4"},Y={key:0,class:"lg:col-span-1"},Z={key:1,class:"lg:col-span-1"},se=Q({__name:"CsvJson",setup(ee){const N=h({title:"CSV/TSV ↔ JSON 互转"}),_=C("csv2json"),V=C(""),S=C(""),g=C(""),r=h({delimKey:"comma",customDelim:"",hasHeader:!0,includeHeader:!0}),b=R(()=>{switch(r.delimKey){case"comma":return",";case"tab":return"	";case"semicolon":return";";case"pipe":return"|";case"custom":return r.customDelim||","}});function J(a,e){const s=[];let i="",o=[],l=!1;const t=a.replace(/\r\n/g,`
`),m=t.length;for(let f=0;f<m;f++){const v=t[f];v==='"'?l&&t[f+1]==='"'?(i+='"',f++):l=!l:v===e&&!l?(o.push(i),i=""):v===`
`&&!l?(o.push(i),s.push(o),o=[],i=""):i+=v}for(o.push(i),s.push(o);s.length&&s[s.length-1].length===1&&s[s.length-1][0]==="";)s.pop();return s}function O(){try{const a=J(V.value||"",b.value);if(!a.length){g.value="[]";return}let e=[],s=[];if(r.hasHeader)e=a[0].map((o,l)=>(o??"").toString().trim()||`col_${l+1}`),s=a.slice(1);else{const o=Math.max(...a.map(l=>l.length));e=Array.from({length:o},(l,t)=>`col_${t+1}`),s=a}const i=s.map(o=>{const l={};return e.forEach((t,m)=>{l[t]=o[m]??""}),l});g.value=JSON.stringify(i,null,2),j.success("转换成功")}catch(a){j.error((a==null?void 0:a.message)||"转换失败")}}function B(){try{const a=JSON.parse(S.value||"[]"),e=Array.isArray(a)?a:[a];if(!e.length){g.value="";return}let s=[];if(r.includeHeader){if(typeof e[0]=="object"&&!Array.isArray(e[0])){const l=new Set;for(const t of e)t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).forEach(m=>l.add(m));s=Array.from(l)}else if(Array.isArray(e[0])){const l=Math.max(...e.map(t=>Array.isArray(t)?t.length:0));s=Array.from({length:l},(t,m)=>`col_${m+1}`)}}const i=l=>{const t=l==null?"":String(l),m=b.value,f=t.includes('"')||t.includes(`
`)||t.includes("\r")||t.includes(m),v=t.replace(/"/g,'""');return f?`"${v}"`:v},o=[];r.includeHeader&&s.length&&o.push(s.map(i).join(b.value));for(const l of e)if(Array.isArray(l))o.push(l.map(i).join(b.value));else if(l&&typeof l=="object"){const t=(s.length?s:Object.keys(l)).map(m=>i(l[m]));o.push(t.join(b.value))}else o.push(i(l));g.value=o.join(`\r
`),j.success("转换成功")}catch(a){j.error((a==null?void 0:a.message)||"转换失败，请检查 JSON 是否有效")}}function H(){_.value==="csv2json"?O():B()}function T(){V.value="",S.value="",g.value=""}function E(){q(g.value)}function U(){V.value=`name,age,city
Alice,30,Beijing
Bob,25,Shanghai`}function D(){r.delimKey="tab",V.value=`name	age	city
Alice	30	Beijing
Bob	25	Shanghai`}function K(){S.value=JSON.stringify([{name:"Alice",age:30,city:"Beijing"},{name:"Bob",age:25,city:"Shanghai"}],null,2)}return(a,e)=>{const s=y("el-radio-button"),i=y("el-radio-group"),o=y("el-option"),l=y("el-select"),t=y("el-input"),m=y("el-switch"),f=y("el-button"),v=y("el-link"),$=y("el-text");return x(),A("div",F,[n(M,{title:N.title},null,8,["title"]),d("div",G,[d("div",L,[n(i,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=u=>_.value=u)},{default:c(()=>[n(s,{label:"csv2json"},{default:c(()=>e[8]||(e[8]=[p("CSV/TSV → JSON",-1)])),_:1,__:[8]}),n(s,{label:"json2csv"},{default:c(()=>e[9]||(e[9]=[p("JSON → CSV/TSV",-1)])),_:1,__:[9]})]),_:1},8,["modelValue"]),d("div",P,[e[10]||(e[10]=d("span",{class:"text-sm text-gray-600"},"分隔符：",-1)),n(l,{modelValue:r.delimKey,"onUpdate:modelValue":e[1]||(e[1]=u=>r.delimKey=u),style:{width:"160px"}},{default:c(()=>[n(o,{label:"逗号 (,)",value:"comma"}),n(o,{label:"制表符 (Tab)",value:"tab"}),n(o,{label:"分号 (;)",value:"semicolon"}),n(o,{label:"竖线 (|)",value:"pipe"}),n(o,{label:"自定义",value:"custom"})]),_:1},8,["modelValue"]),r.delimKey==="custom"?(x(),k(t,{key:0,modelValue:r.customDelim,"onUpdate:modelValue":e[2]||(e[2]=u=>r.customDelim=u),placeholder:"自定义分隔符",style:{width:"140px"},maxlength:"3"},null,8,["modelValue"])):w("",!0)]),_.value==="csv2json"?(x(),k(m,{key:0,modelValue:r.hasHeader,"onUpdate:modelValue":e[3]||(e[3]=u=>r.hasHeader=u),"active-text":"首行是列头","inactive-text":"自动生成列头"},null,8,["modelValue"])):(x(),k(m,{key:1,modelValue:r.includeHeader,"onUpdate:modelValue":e[4]||(e[4]=u=>r.includeHeader=u),"active-text":"输出包含列头","inactive-text":"不包含列头"},null,8,["modelValue"])),n(f,{type:"primary",onClick:H},{default:c(()=>e[11]||(e[11]=[p("转换",-1)])),_:1,__:[11]}),n(f,{onClick:E},{default:c(()=>e[12]||(e[12]=[p("复制结果",-1)])),_:1,__:[12]}),n(f,{type:"danger",onClick:T},{default:c(()=>e[13]||(e[13]=[p("清空",-1)])),_:1,__:[13]})]),d("div",W,[e[17]||(e[17]=p(" 示例： ",-1)),n(v,{type:"primary",onClick:U},{default:c(()=>e[14]||(e[14]=[p("CSV",-1)])),_:1,__:[14]}),e[18]||(e[18]=d("span",{class:"mx-1"},"/",-1)),n(v,{type:"primary",onClick:D},{default:c(()=>e[15]||(e[15]=[p("TSV",-1)])),_:1,__:[15]}),e[19]||(e[19]=d("span",{class:"mx-1"},"/",-1)),n(v,{type:"primary",onClick:K},{default:c(()=>e[16]||(e[16]=[p("JSON",-1)])),_:1,__:[16]})]),d("div",X,[_.value==="csv2json"?(x(),A("div",Y,[e[20]||(e[20]=d("div",{class:"mb-2 text-sm text-gray-600"},"CSV/TSV 输入",-1)),n(t,{type:"textarea",rows:16,modelValue:V.value,"onUpdate:modelValue":e[5]||(e[5]=u=>V.value=u),placeholder:"粘贴 CSV/TSV 内容"},null,8,["modelValue"])])):w("",!0),_.value==="json2csv"?(x(),A("div",Z,[e[21]||(e[21]=d("div",{class:"mb-2 text-sm text-gray-600"},"JSON 输入（数组）",-1)),n(t,{type:"textarea",rows:16,modelValue:S.value,"onUpdate:modelValue":e[6]||(e[6]=u=>S.value=u),placeholder:'如：[{"a":1},{"a":2}]'},null,8,["modelValue"])])):w("",!0),d("div",{class:z((_.value==="csv2json","lg:col-span-2"))},[e[22]||(e[22]=d("div",{class:"mb-2 text-sm text-gray-600"},"结果",-1)),n(t,{type:"textarea",rows:16,modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=u=>g.value=u),placeholder:"转换结果"},null,8,["modelValue"])],2)])]),n(I,{title:"描述"},{default:c(()=>[n($,null,{default:c(()=>e[23]||(e[23]=[p(" - 支持分隔符选择（逗号/制表符/分号/竖线/自定义）与列头推断。",-1),d("br",null,null,-1),p(" - CSV→JSON：可指定首行是否列头；若否，将自动生成 col_1...。",-1),d("br",null,null,-1),p(" - JSON→CSV：自动合并对象键为列头；支持选择是否输出列头。",-1),d("br",null,null,-1),p(" - 支持复制、清空与示例填充。 ",-1)])),_:1,__:[23]})]),_:1})])}}});export{se as default};
