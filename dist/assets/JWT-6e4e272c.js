import{_ as h}from"./DetailHeader.vue_vue_type_script_setup_true_lang-ebd64336.js";import{_ as C}from"./ToolDetail.vue_vue_type_script_setup_true_lang-abb97f39.js";import{d as N,l as V,A as v,o as T,r as k,b as c,c as y,i as u,f as e,g as I,h as p,j as n,C as f}from"./index-c0f229a0.js";class m extends Error{}m.prototype.name="InvalidTokenError";function O(a){return decodeURIComponent(atob(a).replace(/(.)/g,(l,r)=>{let o=r.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function W(a){let l=a.replace(/-/g,"+").replace(/_/g,"/");switch(l.length%4){case 0:break;case 2:l+="==";break;case 3:l+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return O(l)}catch{return atob(l)}}function J(a,l){if(typeof a!="string")throw new m("Invalid token specified: must be a string");l||(l={});const r=l.header===!0?0:1,o=a.split(".")[r];if(typeof o!="string")throw new m(`Invalid token specified: missing part #${r+1}`);let i;try{i=W(o)}catch(s){throw new m(`Invalid token specified: invalid base64 for part #${r+1} (${s.message})`)}try{return JSON.parse(i)}catch(s){throw new m(`Invalid token specified: invalid json for part #${r+1} (${s.message})`)}}const j={class:"flex flex-col mt-3 flex-1"},z={class:"p-4 rounded-2xl bg-white"},E={class:"mb-6"},M={class:"mt-3"},S={key:0},U={key:1},B=N({__name:"JWT",setup(a){const l=V({title:"JWT解析",token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ0b29scy5yYW5ibG9ncy5jb20iLCJzdWIiOiJhcnlhIiwiYXVkIjoidGFvcmFuIiwiaWF0IjoxNzE3MDM2MzMzLCJleHAiOjE3MTcwMzY5MzN9.9v_eDdsPnvcY7qZatNnKvN9VEf7t7o72OgwhLS6gy6w"}),r=v(),o=v(),i=v(!1),s=()=>{try{o.value=JSON.stringify(J(l.token),null,"	"),r.value=JSON.stringify(J(l.token,{header:!0}),null,"	")}catch(_){console.log("Invalid token",_),i.value=!0}},x=()=>{l.token="",r.value="",o.value=""};return T(()=>{s()}),(_,t)=>{const b=k("el-input"),g=k("el-text"),w=k("el-button");return c(),y("div",j,[u(h,{title:l.title},null,8,["title"]),e("div",z,[e("div",E,[u(b,{modelValue:l.token,"onUpdate:modelValue":t[0]||(t[0]=d=>l.token=d),rows:5,type:"textarea",placeholder:"请输入Token",onChange:s},null,8,["modelValue"]),i.value?(c(),I(g,{key:0,type:"danger"},{default:p(()=>t[3]||(t[3]=[n("Invalid token",-1)])),_:1,__:[3]})):f("",!0),e("div",M,[u(w,{type:"primary",onClick:s},{default:p(()=>t[4]||(t[4]=[n("解析",-1)])),_:1,__:[4]}),u(w,{type:"primary",onClick:x},{default:p(()=>t[5]||(t[5]=[n("清除",-1)])),_:1,__:[5]})])]),r.value?(c(),y("div",S,[t[6]||(t[6]=e("div",{class:"mb-3"},"Header(头部)",-1)),u(b,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=d=>r.value=d),type:"textarea",autosize:!0,class:"w-full"},null,8,["modelValue"])])):f("",!0),o.value?(c(),y("div",U,[t[7]||(t[7]=e("div",{class:"mb-3 mt-3"},"Payload(载荷)",-1)),o.value?(c(),I(b,{key:0,modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=d=>o.value=d),type:"textarea",autosize:!0,class:"w-full"},null,8,["modelValue"])):f("",!0)])):f("",!0)]),u(C,{title:"描述"},{default:p(()=>[u(g,null,{default:p(()=>t[8]||(t[8]=[n(" 解析和解码JSON Web Token（jwt）并显示其内容。",-1),e("br",null,null,-1),e("br",null,null,-1),n(" 1. JWT 是 JSON Web Tokens 的缩写，是目前最流行的跨域认证解决方案，是一个开放式标准(RFC 7519)，用于在各方之间以JSON对象安全传输信息。",-1),e("br",null,null,-1),n(" 2. Header(头部)",-1),e("br",null,null,-1),n("   - typ(type): 用来标识整个token字符串是一个JWT字符串",-1),e("br",null,null,-1),n("   - alg(algorithm): 用来说明这个JWT签发的时候所使用的签名和摘要算法",-1),e("br",null,null,-1),n(" 3. Payload(载荷)",-1),e("br",null,null,-1),n("   - iss (Issuer)：签发者",-1),e("br",null,null,-1),n("   - sub (Subject)：主题",-1),e("br",null,null,-1),n("   - aud (Audience)：接收者",-1),e("br",null,null,-1),n("   - exp (Expiration time)：过期时间",-1),e("br",null,null,-1),n("   - nbf (Not Before)：生效时间",-1),e("br",null,null,-1),n("   - iat (Issued At)：签发时间",-1),e("br",null,null,-1),n("   - jti (JWT ID)：编号",-1),e("br",null,null,-1)])),_:1,__:[8]})]),_:1})])}}});export{B as default};
