import{_ as Jg}from"./DetailHeader.vue_vue_type_script_setup_true_lang-c8743df2.js";import{_ as Zg}from"./ToolDetail.vue_vue_type_script_setup_true_lang-781b2750.js";import{p as Qg,d as cc,s as Hl,q as $g,x as t0,o as e0,y as Di,z as i0,A as n0,B as r0,k as s0,r as Fs,b as Fl,c as zl,h as Ne,f as Ni,j as o0,w as Wn,i as Er,F as l0,e as a0,t as hu}from"./index-ee02e3fd.js";var dc={exports:{}};(function(f,t){(function(i,r){f.exports=r()})(Qg,function(){var i=navigator.userAgent,r=navigator.platform,s=/gecko\/\d/i.test(i),h=/MSIE \d/.test(i),u=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(i),d=/Edge\/(\d+)/.exec(i),p=h||u||d,v=p&&(h?document.documentMode||6:+(d||u)[1]),y=!d&&/WebKit\//.test(i),w=y&&/Qt\/\d+\.\d+/.test(i),S=!d&&/Chrome\/(\d+)/.exec(i),A=S&&+S[1],M=/Opera\//.test(i),D=/Apple Computer/.test(navigator.vendor),N=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(i),P=/PhantomJS/.test(i),H=D&&(/Mobile\/\w+/.test(i)||navigator.maxTouchPoints>2),q=/Android/.test(i),J=H||q||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(i),_=H||/Mac/.test(r),et=/\bCrOS\b/.test(i),Q=/win/i.test(r),pt=M&&i.match(/Version\/(\d*\.\d*)/);pt&&(pt=Number(pt[1])),pt&&pt>=15&&(M=!1,y=!0);var vt=_&&(w||M&&(pt==null||pt<12.11)),wt=s||p&&v>=9;function st(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var tt=function(e,n){var l=e.className,o=st(n).exec(l);if(o){var a=l.slice(o.index+o[0].length);e.className=l.slice(0,o.index)+(a?o[1]+a:"")}};function ht(e){for(var n=e.childNodes.length;n>0;--n)e.removeChild(e.firstChild);return e}function lt(e,n){return ht(e).appendChild(n)}function V(e,n,l,o){var a=document.createElement(e);if(l&&(a.className=l),o&&(a.style.cssText=o),typeof n=="string")a.appendChild(document.createTextNode(n));else if(n)for(var c=0;c<n.length;++c)a.appendChild(n[c]);return a}function ae(e,n,l,o){var a=V(e,n,l,o);return a.setAttribute("role","presentation"),a}var Se;document.createRange?Se=function(e,n,l,o){var a=document.createRange();return a.setEnd(o||e,l),a.setStart(e,n),a}:Se=function(e,n,l){var o=document.body.createTextRange();try{o.moveToElementText(e.parentNode)}catch{return o}return o.collapse(!0),o.moveEnd("character",l),o.moveStart("character",n),o};function ke(e,n){if(n.nodeType==3&&(n=n.parentNode),e.contains)return e.contains(n);do if(n.nodeType==11&&(n=n.host),n==e)return!0;while(n=n.parentNode)}function Bt(e){var n=e.ownerDocument||e,l;try{l=e.activeElement}catch{l=n.body||null}for(;l&&l.shadowRoot&&l.shadowRoot.activeElement;)l=l.shadowRoot.activeElement;return l}function Ve(e,n){var l=e.className;st(n).test(l)||(e.className+=(l?" ":"")+n)}function Ce(e,n){for(var l=e.split(" "),o=0;o<l.length;o++)l[o]&&!st(l[o]).test(n)&&(n+=" "+l[o]);return n}var _t=function(e){e.select()};H?_t=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:p&&(_t=function(e){try{e.select()}catch{}});function ee(e){return e.display.wrapper.ownerDocument}function ve(e){return ye(e.display.wrapper)}function ye(e){return e.getRootNode?e.getRootNode():e.ownerDocument}function li(e){return ee(e).defaultView}function pn(e){var n=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,n)}}function Ui(e,n,l){n||(n={});for(var o in e)e.hasOwnProperty(o)&&(l!==!1||!n.hasOwnProperty(o))&&(n[o]=e[o]);return n}function Oe(e,n,l,o,a){n==null&&(n=e.search(/[^\s\u00a0]/),n==-1&&(n=e.length));for(var c=o||0,g=a||0;;){var m=e.indexOf("	",c);if(m<0||m>=n)return g+(n-c);g+=m-c,g+=l-g%l,c=m+1}}var xi=function(){this.id=null,this.f=null,this.time=0,this.handler=pn(this.onTimeout,this)};xi.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},xi.prototype.set=function(e,n){this.f=n;var l=+new Date+e;(!this.id||l<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=l)};function Xt(e,n){for(var l=0;l<e.length;++l)if(e[l]==n)return l;return-1}var $a=50,is={toString:function(){return"CodeMirror.Pass"}},Ge={scroll:!1},Mo={origin:"*mouse"},tr={origin:"+move"};function To(e,n,l){for(var o=0,a=0;;){var c=e.indexOf("	",o);c==-1&&(c=e.length);var g=c-o;if(c==e.length||a+g>=n)return o+Math.min(g,n-a);if(a+=c-o,a+=l-a%l,o=c+1,a>=n)return o}}var ns=[""];function Lo(e){for(;ns.length<=e;)ns.push(ct(ns)+" ");return ns[e]}function ct(e){return e[e.length-1]}function rs(e,n){for(var l=[],o=0;o<e.length;o++)l[o]=n(e[o],o);return l}function Wd(e,n,l){for(var o=0,a=l(n);o<e.length&&l(e[o])<=a;)o++;e.splice(o,0,n)}function th(){}function eh(e,n){var l;return Object.create?l=Object.create(e):(th.prototype=e,l=new th),n&&Ui(n,l),l}var Hd=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Oo(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Hd.test(e))}function ss(e,n){return n?n.source.indexOf("\\w")>-1&&Oo(e)?!0:n.test(e):Oo(e)}function ih(e){for(var n in e)if(e.hasOwnProperty(n)&&e[n])return!1;return!0}var Fd=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Do(e){return e.charCodeAt(0)>=768&&Fd.test(e)}function nh(e,n,l){for(;(l<0?n>0:n<e.length)&&Do(e.charAt(n));)n+=l;return n}function er(e,n,l){for(var o=n>l?-1:1;;){if(n==l)return n;var a=(n+l)/2,c=o<0?Math.ceil(a):Math.floor(a);if(c==n)return e(c)?n:l;e(c)?l=c:n=c+o}}function zd(e,n,l,o){if(!e)return o(n,l,"ltr",0);for(var a=!1,c=0;c<e.length;++c){var g=e[c];(g.from<l&&g.to>n||n==l&&g.to==n)&&(o(Math.max(g.from,n),Math.min(g.to,l),g.level==1?"rtl":"ltr",c),a=!0)}a||o(n,l,"ltr")}var ir=null;function nr(e,n,l){var o;ir=null;for(var a=0;a<e.length;++a){var c=e[a];if(c.from<n&&c.to>n)return a;c.to==n&&(c.from!=c.to&&l=="before"?o=a:ir=a),c.from==n&&(c.from!=c.to&&l!="before"?o=a:ir=a)}return o??ir}var Kd=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function l(x){return x<=247?e.charAt(x):1424<=x&&x<=1524?"R":1536<=x&&x<=1785?n.charAt(x-1536):1774<=x&&x<=2220?"r":8192<=x&&x<=8203?"w":x==8204?"b":"L"}var o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,a=/[stwN]/,c=/[LRr]/,g=/[Lb1n]/,m=/[1n]/;function b(x,k,C){this.level=x,this.from=k,this.to=C}return function(x,k){var C=k=="ltr"?"L":"R";if(x.length==0||k=="ltr"&&!o.test(x))return!1;for(var L=x.length,T=[],O=0;O<L;++O)T.push(l(x.charCodeAt(O)));for(var E=0,R=C;E<L;++E){var I=T[E];I=="m"?T[E]=R:R=I}for(var F=0,W=C;F<L;++F){var U=T[F];U=="1"&&W=="r"?T[F]="n":c.test(U)&&(W=U,U=="r"&&(T[F]="R"))}for(var Z=1,X=T[0];Z<L-1;++Z){var rt=T[Z];rt=="+"&&X=="1"&&T[Z+1]=="1"?T[Z]="1":rt==","&&X==T[Z+1]&&(X=="1"||X=="n")&&(T[Z]=X),X=rt}for(var yt=0;yt<L;++yt){var Vt=T[yt];if(Vt==",")T[yt]="N";else if(Vt=="%"){var Mt=void 0;for(Mt=yt+1;Mt<L&&T[Mt]=="%";++Mt);for(var xe=yt&&T[yt-1]=="!"||Mt<L&&T[Mt]=="1"?"1":"N",ce=yt;ce<Mt;++ce)T[ce]=xe;yt=Mt-1}}for(var Nt=0,de=C;Nt<L;++Nt){var qt=T[Nt];de=="L"&&qt=="1"?T[Nt]="L":c.test(qt)&&(de=qt)}for(var Rt=0;Rt<L;++Rt)if(a.test(T[Rt])){var Pt=void 0;for(Pt=Rt+1;Pt<L&&a.test(T[Pt]);++Pt);for(var Tt=(Rt?T[Rt-1]:C)=="L",pe=(Pt<L?T[Pt]:C)=="L",Rn=Tt==pe?Tt?"L":"R":C,Oi=Rt;Oi<Pt;++Oi)T[Oi]=Rn;Rt=Pt-1}for(var Jt=[],je,Gt=0;Gt<L;)if(g.test(T[Gt])){var Il=Gt;for(++Gt;Gt<L&&g.test(T[Gt]);++Gt);Jt.push(new b(0,Il,Gt))}else{var pi=Gt,tn=Jt.length,en=k=="rtl"?1:0;for(++Gt;Gt<L&&T[Gt]!="L";++Gt);for(var ne=pi;ne<Gt;)if(m.test(T[ne])){pi<ne&&(Jt.splice(tn,0,new b(1,pi,ne)),tn+=en);var In=ne;for(++ne;ne<Gt&&m.test(T[ne]);++ne);Jt.splice(tn,0,new b(2,In,ne)),tn+=en,pi=ne}else++ne;pi<Gt&&Jt.splice(tn,0,new b(1,pi,Gt))}return k=="ltr"&&(Jt[0].level==1&&(je=x.match(/^\s+/))&&(Jt[0].from=je[0].length,Jt.unshift(new b(0,0,je[0].length))),ct(Jt).level==1&&(je=x.match(/\s+$/))&&(ct(Jt).to-=je[0].length,Jt.push(new b(0,L-je[0].length,L)))),k=="rtl"?Jt.reverse():Jt}}();function ai(e,n){var l=e.order;return l==null&&(l=e.order=Kd(e.text,n)),l}var rh=[],$=function(e,n,l){if(e.addEventListener)e.addEventListener(n,l,!1);else if(e.attachEvent)e.attachEvent("on"+n,l);else{var o=e._handlers||(e._handlers={});o[n]=(o[n]||rh).concat(l)}};function No(e,n){return e._handlers&&e._handlers[n]||rh}function Ae(e,n,l){if(e.removeEventListener)e.removeEventListener(n,l,!1);else if(e.detachEvent)e.detachEvent("on"+n,l);else{var o=e._handlers,a=o&&o[n];if(a){var c=Xt(a,l);c>-1&&(o[n]=a.slice(0,c).concat(a.slice(c+1)))}}}function Ot(e,n){var l=No(e,n);if(l.length)for(var o=Array.prototype.slice.call(arguments,2),a=0;a<l.length;++a)l[a].apply(null,o)}function Ft(e,n,l){return typeof n=="string"&&(n={type:n,preventDefault:function(){this.defaultPrevented=!0}}),Ot(e,l||n.type,e,n),Po(n)||n.codemirrorIgnore}function sh(e){var n=e._handlers&&e._handlers.cursorActivity;if(n)for(var l=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),o=0;o<n.length;++o)Xt(l,n[o])==-1&&l.push(n[o])}function De(e,n){return No(e,n).length>0}function gn(e){e.prototype.on=function(n,l){$(this,n,l)},e.prototype.off=function(n,l){Ae(this,n,l)}}function he(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function oh(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Po(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==!1}function rr(e){he(e),oh(e)}function Eo(e){return e.target||e.srcElement}function lh(e){var n=e.which;return n==null&&(e.button&1?n=1:e.button&2?n=3:e.button&4&&(n=2)),_&&e.ctrlKey&&n==1&&(n=3),n}var Ud=function(){if(p&&v<9)return!1;var e=V("div");return"draggable"in e||"dragDrop"in e}(),Bo;function Vd(e){if(Bo==null){var n=V("span","​");lt(e,V("span",[n,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(Bo=n.offsetWidth<=1&&n.offsetHeight>2&&!(p&&v<8))}var l=Bo?V("span","​"):V("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return l.setAttribute("cm-text",""),l}var Ro;function Gd(e){if(Ro!=null)return Ro;var n=lt(e,document.createTextNode("AخA")),l=Se(n,0,1).getBoundingClientRect(),o=Se(n,1,2).getBoundingClientRect();return ht(e),!l||l.left==l.right?!1:Ro=o.right-l.right<3}var Io=`

b`.split(/\n/).length!=3?function(e){for(var n=0,l=[],o=e.length;n<=o;){var a=e.indexOf(`
`,n);a==-1&&(a=e.length);var c=e.slice(n,e.charAt(a-1)=="\r"?a-1:a),g=c.indexOf("\r");g!=-1?(l.push(c.slice(0,g)),n+=g+1):(l.push(c),n=a+1)}return l}:function(e){return e.split(/\r\n?|\n/)},_d=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch{return!1}}:function(e){var n;try{n=e.ownerDocument.selection.createRange()}catch{}return!n||n.parentElement()!=e?!1:n.compareEndPoints("StartToEnd",n)!=0},qd=function(){var e=V("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),Wo=null;function Yd(e){if(Wo!=null)return Wo;var n=lt(e,V("span","x")),l=n.getBoundingClientRect(),o=Se(n,0,1).getBoundingClientRect();return Wo=Math.abs(l.left-o.left)>1}var Ho={},mn={};function Xd(e,n){arguments.length>2&&(n.dependencies=Array.prototype.slice.call(arguments,2)),Ho[e]=n}function jd(e,n){mn[e]=n}function os(e){if(typeof e=="string"&&mn.hasOwnProperty(e))e=mn[e];else if(e&&typeof e.name=="string"&&mn.hasOwnProperty(e.name)){var n=mn[e.name];typeof n=="string"&&(n={name:n}),e=eh(n,e),e.name=n.name}else{if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return os("application/xml");if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return os("application/json")}return typeof e=="string"?{name:e}:e||{name:"null"}}function Fo(e,n){n=os(n);var l=Ho[n.name];if(!l)return Fo(e,"text/plain");var o=l(e,n);if(vn.hasOwnProperty(n.name)){var a=vn[n.name];for(var c in a)a.hasOwnProperty(c)&&(o.hasOwnProperty(c)&&(o["_"+c]=o[c]),o[c]=a[c])}if(o.name=n.name,n.helperType&&(o.helperType=n.helperType),n.modeProps)for(var g in n.modeProps)o[g]=n.modeProps[g];return o}var vn={};function Jd(e,n){var l=vn.hasOwnProperty(e)?vn[e]:vn[e]={};Ui(n,l)}function Vi(e,n){if(n===!0)return n;if(e.copyState)return e.copyState(n);var l={};for(var o in n){var a=n[o];a instanceof Array&&(a=a.concat([])),l[o]=a}return l}function zo(e,n){for(var l;e.innerMode&&(l=e.innerMode(n),!(!l||l.mode==e));)n=l.state,e=l.mode;return l||{mode:e,state:n}}function ah(e,n,l){return e.startState?e.startState(n,l):!0}var Dt=function(e,n,l){this.pos=this.start=0,this.string=e,this.tabSize=n||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=l};Dt.prototype.eol=function(){return this.pos>=this.string.length},Dt.prototype.sol=function(){return this.pos==this.lineStart},Dt.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Dt.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Dt.prototype.eat=function(e){var n=this.string.charAt(this.pos),l;if(typeof e=="string"?l=n==e:l=n&&(e.test?e.test(n):e(n)),l)return++this.pos,n},Dt.prototype.eatWhile=function(e){for(var n=this.pos;this.eat(e););return this.pos>n},Dt.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},Dt.prototype.skipToEnd=function(){this.pos=this.string.length},Dt.prototype.skipTo=function(e){var n=this.string.indexOf(e,this.pos);if(n>-1)return this.pos=n,!0},Dt.prototype.backUp=function(e){this.pos-=e},Dt.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Oe(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Oe(this.string,this.lineStart,this.tabSize):0)},Dt.prototype.indentation=function(){return Oe(this.string,null,this.tabSize)-(this.lineStart?Oe(this.string,this.lineStart,this.tabSize):0)},Dt.prototype.match=function(e,n,l){if(typeof e=="string"){var o=function(g){return l?g.toLowerCase():g},a=this.string.substr(this.pos,e.length);if(o(a)==o(e))return n!==!1&&(this.pos+=e.length),!0}else{var c=this.string.slice(this.pos).match(e);return c&&c.index>0?null:(c&&n!==!1&&(this.pos+=c[0].length),c)}},Dt.prototype.current=function(){return this.string.slice(this.start,this.pos)},Dt.prototype.hideFirstChars=function(e,n){this.lineStart+=e;try{return n()}finally{this.lineStart-=e}},Dt.prototype.lookAhead=function(e){var n=this.lineOracle;return n&&n.lookAhead(e)},Dt.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function Y(e,n){if(n-=e.first,n<0||n>=e.size)throw new Error("There is no line "+(n+e.first)+" in the document.");for(var l=e;!l.lines;)for(var o=0;;++o){var a=l.children[o],c=a.chunkSize();if(n<c){l=a;break}n-=c}return l.lines[n]}function Gi(e,n,l){var o=[],a=n.line;return e.iter(n.line,l.line+1,function(c){var g=c.text;a==l.line&&(g=g.slice(0,l.ch)),a==n.line&&(g=g.slice(n.ch)),o.push(g),++a}),o}function Ko(e,n,l){var o=[];return e.iter(n,l,function(a){o.push(a.text)}),o}function _e(e,n){var l=n-e.height;if(l)for(var o=e;o;o=o.parent)o.height+=l}function gt(e){if(e.parent==null)return null;for(var n=e.parent,l=Xt(n.lines,e),o=n.parent;o;n=o,o=o.parent)for(var a=0;o.children[a]!=n;++a)l+=o.children[a].chunkSize();return l+n.first}function _i(e,n){var l=e.first;t:do{for(var o=0;o<e.children.length;++o){var a=e.children[o],c=a.height;if(n<c){e=a;continue t}n-=c,l+=a.chunkSize()}return l}while(!e.lines);for(var g=0;g<e.lines.length;++g){var m=e.lines[g],b=m.height;if(n<b)break;n-=b}return l+g}function sr(e,n){return n>=e.first&&n<e.first+e.size}function Uo(e,n){return String(e.lineNumberFormatter(n+e.firstLineNumber))}function B(e,n,l){if(l===void 0&&(l=null),!(this instanceof B))return new B(e,n,l);this.line=e,this.ch=n,this.sticky=l}function it(e,n){return e.line-n.line||e.ch-n.ch}function Vo(e,n){return e.sticky==n.sticky&&it(e,n)==0}function Go(e){return B(e.line,e.ch)}function ls(e,n){return it(e,n)<0?n:e}function as(e,n){return it(e,n)<0?e:n}function hh(e,n){return Math.max(e.first,Math.min(n,e.first+e.size-1))}function nt(e,n){if(n.line<e.first)return B(e.first,0);var l=e.first+e.size-1;return n.line>l?B(l,Y(e,l).text.length):Zd(n,Y(e,n.line).text.length)}function Zd(e,n){var l=e.ch;return l==null||l>n?B(e.line,n):l<0?B(e.line,0):e}function fh(e,n){for(var l=[],o=0;o<n.length;o++)l[o]=nt(e,n[o]);return l}var hs=function(e,n){this.state=e,this.lookAhead=n},qe=function(e,n,l,o){this.state=n,this.doc=e,this.line=l,this.maxLookAhead=o||0,this.baseTokens=null,this.baseTokenPos=1};qe.prototype.lookAhead=function(e){var n=this.doc.getLine(this.line+e);return n!=null&&e>this.maxLookAhead&&(this.maxLookAhead=e),n},qe.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var n=this.baseTokens[this.baseTokenPos+1];return{type:n&&n.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},qe.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},qe.fromSaved=function(e,n,l){return n instanceof hs?new qe(e,Vi(e.mode,n.state),l,n.lookAhead):new qe(e,Vi(e.mode,n),l)},qe.prototype.save=function(e){var n=e!==!1?Vi(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new hs(n,this.maxLookAhead):n};function uh(e,n,l,o){var a=[e.state.modeGen],c={};vh(e,n.text,e.doc.mode,l,function(x,k){return a.push(x,k)},c,o);for(var g=l.state,m=function(x){l.baseTokens=a;var k=e.state.overlays[x],C=1,L=0;l.state=!0,vh(e,n.text,k.mode,l,function(T,O){for(var E=C;L<T;){var R=a[C];R>T&&a.splice(C,1,T,a[C+1],R),C+=2,L=Math.min(T,R)}if(O)if(k.opaque)a.splice(E,C-E,T,"overlay "+O),C=E+2;else for(;E<C;E+=2){var I=a[E+1];a[E+1]=(I?I+" ":"")+"overlay "+O}},c),l.state=g,l.baseTokens=null,l.baseTokenPos=1},b=0;b<e.state.overlays.length;++b)m(b);return{styles:a,classes:c.bgClass||c.textClass?c:null}}function ch(e,n,l){if(!n.styles||n.styles[0]!=e.state.modeGen){var o=or(e,gt(n)),a=n.text.length>e.options.maxHighlightLength&&Vi(e.doc.mode,o.state),c=uh(e,n,o);a&&(o.state=a),n.stateAfter=o.save(!a),n.styles=c.styles,c.classes?n.styleClasses=c.classes:n.styleClasses&&(n.styleClasses=null),l===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return n.styles}function or(e,n,l){var o=e.doc,a=e.display;if(!o.mode.startState)return new qe(o,!0,n);var c=Qd(e,n,l),g=c>o.first&&Y(o,c-1).stateAfter,m=g?qe.fromSaved(o,g,c):new qe(o,ah(o.mode),c);return o.iter(c,n,function(b){_o(e,b.text,m);var x=m.line;b.stateAfter=x==n-1||x%5==0||x>=a.viewFrom&&x<a.viewTo?m.save():null,m.nextLine()}),l&&(o.modeFrontier=m.line),m}function _o(e,n,l,o){var a=e.doc.mode,c=new Dt(n,e.options.tabSize,l);for(c.start=c.pos=o||0,n==""&&dh(a,l.state);!c.eol();)qo(a,c,l.state),c.start=c.pos}function dh(e,n){if(e.blankLine)return e.blankLine(n);if(e.innerMode){var l=zo(e,n);if(l.mode.blankLine)return l.mode.blankLine(l.state)}}function qo(e,n,l,o){for(var a=0;a<10;a++){o&&(o[0]=zo(e,l).mode);var c=e.token(n,l);if(n.pos>n.start)return c}throw new Error("Mode "+e.name+" failed to advance stream.")}var ph=function(e,n,l){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=n||null,this.state=l};function gh(e,n,l,o){var a=e.doc,c=a.mode,g;n=nt(a,n);var m=Y(a,n.line),b=or(e,n.line,l),x=new Dt(m.text,e.options.tabSize,b),k;for(o&&(k=[]);(o||x.pos<n.ch)&&!x.eol();)x.start=x.pos,g=qo(c,x,b.state),o&&k.push(new ph(x,g,Vi(a.mode,b.state)));return o?k:new ph(x,g,b.state)}function mh(e,n){if(e)for(;;){var l=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!l)break;e=e.slice(0,l.index)+e.slice(l.index+l[0].length);var o=l[1]?"bgClass":"textClass";n[o]==null?n[o]=l[2]:new RegExp("(?:^|\\s)"+l[2]+"(?:$|\\s)").test(n[o])||(n[o]+=" "+l[2])}return e}function vh(e,n,l,o,a,c,g){var m=l.flattenSpans;m==null&&(m=e.options.flattenSpans);var b=0,x=null,k=new Dt(n,e.options.tabSize,o),C,L=e.options.addModeClass&&[null];for(n==""&&mh(dh(l,o.state),c);!k.eol();){if(k.pos>e.options.maxHighlightLength?(m=!1,g&&_o(e,n,o,k.pos),k.pos=n.length,C=null):C=mh(qo(l,k,o.state,L),c),L){var T=L[0].name;T&&(C="m-"+(C?T+" "+C:T))}if(!m||x!=C){for(;b<k.start;)b=Math.min(k.start,b+5e3),a(b,x);x=C}k.start=k.pos}for(;b<k.pos;){var O=Math.min(k.pos,b+5e3);a(O,x),b=O}}function Qd(e,n,l){for(var o,a,c=e.doc,g=l?-1:n-(e.doc.mode.innerMode?1e3:100),m=n;m>g;--m){if(m<=c.first)return c.first;var b=Y(c,m-1),x=b.stateAfter;if(x&&(!l||m+(x instanceof hs?x.lookAhead:0)<=c.modeFrontier))return m;var k=Oe(b.text,null,e.options.tabSize);(a==null||o>k)&&(a=m-1,o=k)}return a}function $d(e,n){if(e.modeFrontier=Math.min(e.modeFrontier,n),!(e.highlightFrontier<n-10)){for(var l=e.first,o=n-1;o>l;o--){var a=Y(e,o).stateAfter;if(a&&(!(a instanceof hs)||o+a.lookAhead<n)){l=o+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,l)}}var yh=!1,hi=!1;function tp(){yh=!0}function ep(){hi=!0}function fs(e,n,l){this.marker=e,this.from=n,this.to=l}function lr(e,n){if(e)for(var l=0;l<e.length;++l){var o=e[l];if(o.marker==n)return o}}function ip(e,n){for(var l,o=0;o<e.length;++o)e[o]!=n&&(l||(l=[])).push(e[o]);return l}function np(e,n,l){var o=l&&window.WeakSet&&(l.markedSpans||(l.markedSpans=new WeakSet));o&&e.markedSpans&&o.has(e.markedSpans)?e.markedSpans.push(n):(e.markedSpans=e.markedSpans?e.markedSpans.concat([n]):[n],o&&o.add(e.markedSpans)),n.marker.attachLine(e)}function rp(e,n,l){var o;if(e)for(var a=0;a<e.length;++a){var c=e[a],g=c.marker,m=c.from==null||(g.inclusiveLeft?c.from<=n:c.from<n);if(m||c.from==n&&g.type=="bookmark"&&(!l||!c.marker.insertLeft)){var b=c.to==null||(g.inclusiveRight?c.to>=n:c.to>n);(o||(o=[])).push(new fs(g,c.from,b?null:c.to))}}return o}function sp(e,n,l){var o;if(e)for(var a=0;a<e.length;++a){var c=e[a],g=c.marker,m=c.to==null||(g.inclusiveRight?c.to>=n:c.to>n);if(m||c.from==n&&g.type=="bookmark"&&(!l||c.marker.insertLeft)){var b=c.from==null||(g.inclusiveLeft?c.from<=n:c.from<n);(o||(o=[])).push(new fs(g,b?null:c.from-n,c.to==null?null:c.to-n))}}return o}function Yo(e,n){if(n.full)return null;var l=sr(e,n.from.line)&&Y(e,n.from.line).markedSpans,o=sr(e,n.to.line)&&Y(e,n.to.line).markedSpans;if(!l&&!o)return null;var a=n.from.ch,c=n.to.ch,g=it(n.from,n.to)==0,m=rp(l,a,g),b=sp(o,c,g),x=n.text.length==1,k=ct(n.text).length+(x?a:0);if(m)for(var C=0;C<m.length;++C){var L=m[C];if(L.to==null){var T=lr(b,L.marker);T?x&&(L.to=T.to==null?null:T.to+k):L.to=a}}if(b)for(var O=0;O<b.length;++O){var E=b[O];if(E.to!=null&&(E.to+=k),E.from==null){var R=lr(m,E.marker);R||(E.from=k,x&&(m||(m=[])).push(E))}else E.from+=k,x&&(m||(m=[])).push(E)}m&&(m=bh(m)),b&&b!=m&&(b=bh(b));var I=[m];if(!x){var F=n.text.length-2,W;if(F>0&&m)for(var U=0;U<m.length;++U)m[U].to==null&&(W||(W=[])).push(new fs(m[U].marker,null,null));for(var Z=0;Z<F;++Z)I.push(W);I.push(b)}return I}function bh(e){for(var n=0;n<e.length;++n){var l=e[n];l.from!=null&&l.from==l.to&&l.marker.clearWhenEmpty!==!1&&e.splice(n--,1)}return e.length?e:null}function op(e,n,l){var o=null;if(e.iter(n.line,l.line+1,function(T){if(T.markedSpans)for(var O=0;O<T.markedSpans.length;++O){var E=T.markedSpans[O].marker;E.readOnly&&(!o||Xt(o,E)==-1)&&(o||(o=[])).push(E)}}),!o)return null;for(var a=[{from:n,to:l}],c=0;c<o.length;++c)for(var g=o[c],m=g.find(0),b=0;b<a.length;++b){var x=a[b];if(!(it(x.to,m.from)<0||it(x.from,m.to)>0)){var k=[b,1],C=it(x.from,m.from),L=it(x.to,m.to);(C<0||!g.inclusiveLeft&&!C)&&k.push({from:x.from,to:m.from}),(L>0||!g.inclusiveRight&&!L)&&k.push({from:m.to,to:x.to}),a.splice.apply(a,k),b+=k.length-3}}return a}function xh(e){var n=e.markedSpans;if(n){for(var l=0;l<n.length;++l)n[l].marker.detachLine(e);e.markedSpans=null}}function wh(e,n){if(n){for(var l=0;l<n.length;++l)n[l].marker.attachLine(e);e.markedSpans=n}}function us(e){return e.inclusiveLeft?-1:0}function cs(e){return e.inclusiveRight?1:0}function Xo(e,n){var l=e.lines.length-n.lines.length;if(l!=0)return l;var o=e.find(),a=n.find(),c=it(o.from,a.from)||us(e)-us(n);if(c)return-c;var g=it(o.to,a.to)||cs(e)-cs(n);return g||n.id-e.id}function Sh(e,n){var l=hi&&e.markedSpans,o;if(l)for(var a=void 0,c=0;c<l.length;++c)a=l[c],a.marker.collapsed&&(n?a.from:a.to)==null&&(!o||Xo(o,a.marker)<0)&&(o=a.marker);return o}function kh(e){return Sh(e,!0)}function ds(e){return Sh(e,!1)}function lp(e,n){var l=hi&&e.markedSpans,o;if(l)for(var a=0;a<l.length;++a){var c=l[a];c.marker.collapsed&&(c.from==null||c.from<n)&&(c.to==null||c.to>n)&&(!o||Xo(o,c.marker)<0)&&(o=c.marker)}return o}function Ch(e,n,l,o,a){var c=Y(e,n),g=hi&&c.markedSpans;if(g)for(var m=0;m<g.length;++m){var b=g[m];if(b.marker.collapsed){var x=b.marker.find(0),k=it(x.from,l)||us(b.marker)-us(a),C=it(x.to,o)||cs(b.marker)-cs(a);if(!(k>=0&&C<=0||k<=0&&C>=0)&&(k<=0&&(b.marker.inclusiveRight&&a.inclusiveLeft?it(x.to,l)>=0:it(x.to,l)>0)||k>=0&&(b.marker.inclusiveRight&&a.inclusiveLeft?it(x.from,o)<=0:it(x.from,o)<0)))return!0}}}function We(e){for(var n;n=kh(e);)e=n.find(-1,!0).line;return e}function ap(e){for(var n;n=ds(e);)e=n.find(1,!0).line;return e}function hp(e){for(var n,l;n=ds(e);)e=n.find(1,!0).line,(l||(l=[])).push(e);return l}function jo(e,n){var l=Y(e,n),o=We(l);return l==o?n:gt(o)}function Ah(e,n){if(n>e.lastLine())return n;var l=Y(e,n),o;if(!wi(e,l))return n;for(;o=ds(l);)l=o.find(1,!0).line;return gt(l)+1}function wi(e,n){var l=hi&&n.markedSpans;if(l){for(var o=void 0,a=0;a<l.length;++a)if(o=l[a],!!o.marker.collapsed){if(o.from==null)return!0;if(!o.marker.widgetNode&&o.from==0&&o.marker.inclusiveLeft&&Jo(e,n,o))return!0}}}function Jo(e,n,l){if(l.to==null){var o=l.marker.find(1,!0);return Jo(e,o.line,lr(o.line.markedSpans,l.marker))}if(l.marker.inclusiveRight&&l.to==n.text.length)return!0;for(var a=void 0,c=0;c<n.markedSpans.length;++c)if(a=n.markedSpans[c],a.marker.collapsed&&!a.marker.widgetNode&&a.from==l.to&&(a.to==null||a.to!=l.from)&&(a.marker.inclusiveLeft||l.marker.inclusiveRight)&&Jo(e,n,a))return!0}function fi(e){e=We(e);for(var n=0,l=e.parent,o=0;o<l.lines.length;++o){var a=l.lines[o];if(a==e)break;n+=a.height}for(var c=l.parent;c;l=c,c=l.parent)for(var g=0;g<c.children.length;++g){var m=c.children[g];if(m==l)break;n+=m.height}return n}function ps(e){if(e.height==0)return 0;for(var n=e.text.length,l,o=e;l=kh(o);){var a=l.find(0,!0);o=a.from.line,n+=a.from.ch-a.to.ch}for(o=e;l=ds(o);){var c=l.find(0,!0);n-=o.text.length-c.from.ch,o=c.to.line,n+=o.text.length-c.to.ch}return n}function Zo(e){var n=e.display,l=e.doc;n.maxLine=Y(l,l.first),n.maxLineLength=ps(n.maxLine),n.maxLineChanged=!0,l.iter(function(o){var a=ps(o);a>n.maxLineLength&&(n.maxLineLength=a,n.maxLine=o)})}var yn=function(e,n,l){this.text=e,wh(this,n),this.height=l?l(this):1};yn.prototype.lineNo=function(){return gt(this)},gn(yn);function fp(e,n,l,o){e.text=n,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),xh(e),wh(e,l);var a=o?o(e):1;a!=e.height&&_e(e,a)}function up(e){e.parent=null,xh(e)}var cp={},dp={};function Mh(e,n){if(!e||/^\s*$/.test(e))return null;var l=n.addModeClass?dp:cp;return l[e]||(l[e]=e.replace(/\S+/g,"cm-$&"))}function Th(e,n){var l=ae("span",null,null,y?"padding-right: .1px":null),o={pre:ae("pre",[l],"CodeMirror-line"),content:l,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};n.measure={};for(var a=0;a<=(n.rest?n.rest.length:0);a++){var c=a?n.rest[a-1]:n.line,g=void 0;o.pos=0,o.addToken=gp,Gd(e.display.measure)&&(g=ai(c,e.doc.direction))&&(o.addToken=vp(o.addToken,g)),o.map=[];var m=n!=e.display.externalMeasured&&gt(c);yp(c,o,ch(e,c,m)),c.styleClasses&&(c.styleClasses.bgClass&&(o.bgClass=Ce(c.styleClasses.bgClass,o.bgClass||"")),c.styleClasses.textClass&&(o.textClass=Ce(c.styleClasses.textClass,o.textClass||""))),o.map.length==0&&o.map.push(0,0,o.content.appendChild(Vd(e.display.measure))),a==0?(n.measure.map=o.map,n.measure.cache={}):((n.measure.maps||(n.measure.maps=[])).push(o.map),(n.measure.caches||(n.measure.caches=[])).push({}))}if(y){var b=o.content.lastChild;(/\bcm-tab\b/.test(b.className)||b.querySelector&&b.querySelector(".cm-tab"))&&(o.content.className="cm-tab-wrap-hack")}return Ot(e,"renderLine",e,n.line,o.pre),o.pre.className&&(o.textClass=Ce(o.pre.className,o.textClass||"")),o}function pp(e){var n=V("span","•","cm-invalidchar");return n.title="\\u"+e.charCodeAt(0).toString(16),n.setAttribute("aria-label",n.title),n}function gp(e,n,l,o,a,c,g){if(n){var m=e.splitSpaces?mp(n,e.trailingSpace):n,b=e.cm.state.specialChars,x=!1,k;if(!b.test(n))e.col+=n.length,k=document.createTextNode(m),e.map.push(e.pos,e.pos+n.length,k),p&&v<9&&(x=!0),e.pos+=n.length;else{k=document.createDocumentFragment();for(var C=0;;){b.lastIndex=C;var L=b.exec(n),T=L?L.index-C:n.length-C;if(T){var O=document.createTextNode(m.slice(C,C+T));p&&v<9?k.appendChild(V("span",[O])):k.appendChild(O),e.map.push(e.pos,e.pos+T,O),e.col+=T,e.pos+=T}if(!L)break;C+=T+1;var E=void 0;if(L[0]=="	"){var R=e.cm.options.tabSize,I=R-e.col%R;E=k.appendChild(V("span",Lo(I),"cm-tab")),E.setAttribute("role","presentation"),E.setAttribute("cm-text","	"),e.col+=I}else L[0]=="\r"||L[0]==`
`?(E=k.appendChild(V("span",L[0]=="\r"?"␍":"␤","cm-invalidchar")),E.setAttribute("cm-text",L[0]),e.col+=1):(E=e.cm.options.specialCharPlaceholder(L[0]),E.setAttribute("cm-text",L[0]),p&&v<9?k.appendChild(V("span",[E])):k.appendChild(E),e.col+=1);e.map.push(e.pos,e.pos+1,E),e.pos++}}if(e.trailingSpace=m.charCodeAt(n.length-1)==32,l||o||a||x||c||g){var F=l||"";o&&(F+=o),a&&(F+=a);var W=V("span",[k],F,c);if(g)for(var U in g)g.hasOwnProperty(U)&&U!="style"&&U!="class"&&W.setAttribute(U,g[U]);return e.content.appendChild(W)}e.content.appendChild(k)}}function mp(e,n){if(e.length>1&&!/  /.test(e))return e;for(var l=n,o="",a=0;a<e.length;a++){var c=e.charAt(a);c==" "&&l&&(a==e.length-1||e.charCodeAt(a+1)==32)&&(c=" "),o+=c,l=c==" "}return o}function vp(e,n){return function(l,o,a,c,g,m,b){a=a?a+" cm-force-border":"cm-force-border";for(var x=l.pos,k=x+o.length;;){for(var C=void 0,L=0;L<n.length&&(C=n[L],!(C.to>x&&C.from<=x));L++);if(C.to>=k)return e(l,o,a,c,g,m,b);e(l,o.slice(0,C.to-x),a,c,null,m,b),c=null,o=o.slice(C.to-x),x=C.to}}}function Lh(e,n,l,o){var a=!o&&l.widgetNode;a&&e.map.push(e.pos,e.pos+n,a),!o&&e.cm.display.input.needsContentAttribute&&(a||(a=e.content.appendChild(document.createElement("span"))),a.setAttribute("cm-marker",l.id)),a&&(e.cm.display.input.setUneditable(a),e.content.appendChild(a)),e.pos+=n,e.trailingSpace=!1}function yp(e,n,l){var o=e.markedSpans,a=e.text,c=0;if(!o){for(var g=1;g<l.length;g+=2)n.addToken(n,a.slice(c,c=l[g]),Mh(l[g+1],n.cm.options));return}for(var m=a.length,b=0,x=1,k="",C,L,T=0,O,E,R,I,F;;){if(T==b){O=E=R=L="",F=null,I=null,T=1/0;for(var W=[],U=void 0,Z=0;Z<o.length;++Z){var X=o[Z],rt=X.marker;if(rt.type=="bookmark"&&X.from==b&&rt.widgetNode)W.push(rt);else if(X.from<=b&&(X.to==null||X.to>b||rt.collapsed&&X.to==b&&X.from==b)){if(X.to!=null&&X.to!=b&&T>X.to&&(T=X.to,E=""),rt.className&&(O+=" "+rt.className),rt.css&&(L=(L?L+";":"")+rt.css),rt.startStyle&&X.from==b&&(R+=" "+rt.startStyle),rt.endStyle&&X.to==T&&(U||(U=[])).push(rt.endStyle,X.to),rt.title&&((F||(F={})).title=rt.title),rt.attributes)for(var yt in rt.attributes)(F||(F={}))[yt]=rt.attributes[yt];rt.collapsed&&(!I||Xo(I.marker,rt)<0)&&(I=X)}else X.from>b&&T>X.from&&(T=X.from)}if(U)for(var Vt=0;Vt<U.length;Vt+=2)U[Vt+1]==T&&(E+=" "+U[Vt]);if(!I||I.from==b)for(var Mt=0;Mt<W.length;++Mt)Lh(n,0,W[Mt]);if(I&&(I.from||0)==b){if(Lh(n,(I.to==null?m+1:I.to)-b,I.marker,I.from==null),I.to==null)return;I.to==b&&(I=!1)}}if(b>=m)break;for(var xe=Math.min(m,T);;){if(k){var ce=b+k.length;if(!I){var Nt=ce>xe?k.slice(0,xe-b):k;n.addToken(n,Nt,C?C+O:O,R,b+Nt.length==T?E:"",L,F)}if(ce>=xe){k=k.slice(xe-b),b=xe;break}b=ce,R=""}k=a.slice(c,c=l[x++]),C=Mh(l[x++],n.cm.options)}}}function Oh(e,n,l){this.line=n,this.rest=hp(n),this.size=this.rest?gt(ct(this.rest))-l+1:1,this.node=this.text=null,this.hidden=wi(e,n)}function gs(e,n,l){for(var o=[],a,c=n;c<l;c=a){var g=new Oh(e.doc,Y(e.doc,c),c);a=c+g.size,o.push(g)}return o}var bn=null;function bp(e){bn?bn.ops.push(e):e.ownsGroup=bn={ops:[e],delayedCallbacks:[]}}function xp(e){var n=e.delayedCallbacks,l=0;do{for(;l<n.length;l++)n[l].call(null);for(var o=0;o<e.ops.length;o++){var a=e.ops[o];if(a.cursorActivityHandlers)for(;a.cursorActivityCalled<a.cursorActivityHandlers.length;)a.cursorActivityHandlers[a.cursorActivityCalled++].call(null,a.cm)}}while(l<n.length)}function wp(e,n){var l=e.ownsGroup;if(l)try{xp(l)}finally{bn=null,n(l)}}var ar=null;function zt(e,n){var l=No(e,n);if(l.length){var o=Array.prototype.slice.call(arguments,2),a;bn?a=bn.delayedCallbacks:ar?a=ar:(a=ar=[],setTimeout(Sp,0));for(var c=function(m){a.push(function(){return l[m].apply(null,o)})},g=0;g<l.length;++g)c(g)}}function Sp(){var e=ar;ar=null;for(var n=0;n<e.length;++n)e[n]()}function Dh(e,n,l,o){for(var a=0;a<n.changes.length;a++){var c=n.changes[a];c=="text"?Cp(e,n):c=="gutter"?Ph(e,n,l,o):c=="class"?Qo(e,n):c=="widget"&&Ap(e,n,o)}n.changes=null}function hr(e){return e.node==e.text&&(e.node=V("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),p&&v<8&&(e.node.style.zIndex=2)),e.node}function kp(e,n){var l=n.bgClass?n.bgClass+" "+(n.line.bgClass||""):n.line.bgClass;if(l&&(l+=" CodeMirror-linebackground"),n.background)l?n.background.className=l:(n.background.parentNode.removeChild(n.background),n.background=null);else if(l){var o=hr(n);n.background=o.insertBefore(V("div",null,l),o.firstChild),e.display.input.setUneditable(n.background)}}function Nh(e,n){var l=e.display.externalMeasured;return l&&l.line==n.line?(e.display.externalMeasured=null,n.measure=l.measure,l.built):Th(e,n)}function Cp(e,n){var l=n.text.className,o=Nh(e,n);n.text==n.node&&(n.node=o.pre),n.text.parentNode.replaceChild(o.pre,n.text),n.text=o.pre,o.bgClass!=n.bgClass||o.textClass!=n.textClass?(n.bgClass=o.bgClass,n.textClass=o.textClass,Qo(e,n)):l&&(n.text.className=l)}function Qo(e,n){kp(e,n),n.line.wrapClass?hr(n).className=n.line.wrapClass:n.node!=n.text&&(n.node.className="");var l=n.textClass?n.textClass+" "+(n.line.textClass||""):n.line.textClass;n.text.className=l||""}function Ph(e,n,l,o){if(n.gutter&&(n.node.removeChild(n.gutter),n.gutter=null),n.gutterBackground&&(n.node.removeChild(n.gutterBackground),n.gutterBackground=null),n.line.gutterClass){var a=hr(n);n.gutterBackground=V("div",null,"CodeMirror-gutter-background "+n.line.gutterClass,"left: "+(e.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px; width: "+o.gutterTotalWidth+"px"),e.display.input.setUneditable(n.gutterBackground),a.insertBefore(n.gutterBackground,n.text)}var c=n.line.gutterMarkers;if(e.options.lineNumbers||c){var g=hr(n),m=n.gutter=V("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px");if(m.setAttribute("aria-hidden","true"),e.display.input.setUneditable(m),g.insertBefore(m,n.text),n.line.gutterClass&&(m.className+=" "+n.line.gutterClass),e.options.lineNumbers&&(!c||!c["CodeMirror-linenumbers"])&&(n.lineNumber=m.appendChild(V("div",Uo(e.options,l),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+o.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),c)for(var b=0;b<e.display.gutterSpecs.length;++b){var x=e.display.gutterSpecs[b].className,k=c.hasOwnProperty(x)&&c[x];k&&m.appendChild(V("div",[k],"CodeMirror-gutter-elt","left: "+o.gutterLeft[x]+"px; width: "+o.gutterWidth[x]+"px"))}}}function Ap(e,n,l){n.alignable&&(n.alignable=null);for(var o=st("CodeMirror-linewidget"),a=n.node.firstChild,c=void 0;a;a=c)c=a.nextSibling,o.test(a.className)&&n.node.removeChild(a);Eh(e,n,l)}function Mp(e,n,l,o){var a=Nh(e,n);return n.text=n.node=a.pre,a.bgClass&&(n.bgClass=a.bgClass),a.textClass&&(n.textClass=a.textClass),Qo(e,n),Ph(e,n,l,o),Eh(e,n,o),n.node}function Eh(e,n,l){if(Bh(e,n.line,n,l,!0),n.rest)for(var o=0;o<n.rest.length;o++)Bh(e,n.rest[o],n,l,!1)}function Bh(e,n,l,o,a){if(n.widgets)for(var c=hr(l),g=0,m=n.widgets;g<m.length;++g){var b=m[g],x=V("div",[b.node],"CodeMirror-linewidget"+(b.className?" "+b.className:""));b.handleMouseEvents||x.setAttribute("cm-ignore-events","true"),Tp(b,x,l,o),e.display.input.setUneditable(x),a&&b.above?c.insertBefore(x,l.gutter||l.text):c.appendChild(x),zt(b,"redraw")}}function Tp(e,n,l,o){if(e.noHScroll){(l.alignable||(l.alignable=[])).push(n);var a=o.wrapperWidth;n.style.left=o.fixedPos+"px",e.coverGutter||(a-=o.gutterTotalWidth,n.style.paddingLeft=o.gutterTotalWidth+"px"),n.style.width=a+"px"}e.coverGutter&&(n.style.zIndex=5,n.style.position="relative",e.noHScroll||(n.style.marginLeft=-o.gutterTotalWidth+"px"))}function fr(e){if(e.height!=null)return e.height;var n=e.doc.cm;if(!n)return 0;if(!ke(document.body,e.node)){var l="position: relative;";e.coverGutter&&(l+="margin-left: -"+n.display.gutters.offsetWidth+"px;"),e.noHScroll&&(l+="width: "+n.display.wrapper.clientWidth+"px;"),lt(n.display.measure,V("div",[e.node],null,l))}return e.height=e.node.parentNode.offsetHeight}function ui(e,n){for(var l=Eo(n);l!=e.wrapper;l=l.parentNode)if(!l||l.nodeType==1&&l.getAttribute("cm-ignore-events")=="true"||l.parentNode==e.sizer&&l!=e.mover)return!0}function ms(e){return e.lineSpace.offsetTop}function $o(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Rh(e){if(e.cachedPaddingH)return e.cachedPaddingH;var n=lt(e.measure,V("pre","x","CodeMirror-line-like")),l=window.getComputedStyle?window.getComputedStyle(n):n.currentStyle,o={left:parseInt(l.paddingLeft),right:parseInt(l.paddingRight)};return!isNaN(o.left)&&!isNaN(o.right)&&(e.cachedPaddingH=o),o}function Ye(e){return $a-e.display.nativeBarWidth}function qi(e){return e.display.scroller.clientWidth-Ye(e)-e.display.barWidth}function tl(e){return e.display.scroller.clientHeight-Ye(e)-e.display.barHeight}function Lp(e,n,l){var o=e.options.lineWrapping,a=o&&qi(e);if(!n.measure.heights||o&&n.measure.width!=a){var c=n.measure.heights=[];if(o){n.measure.width=a;for(var g=n.text.firstChild.getClientRects(),m=0;m<g.length-1;m++){var b=g[m],x=g[m+1];Math.abs(b.bottom-x.bottom)>2&&c.push((b.bottom+x.top)/2-l.top)}}c.push(l.bottom-l.top)}}function Ih(e,n,l){if(e.line==n)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var o=0;o<e.rest.length;o++)if(e.rest[o]==n)return{map:e.measure.maps[o],cache:e.measure.caches[o]};for(var a=0;a<e.rest.length;a++)if(gt(e.rest[a])>l)return{map:e.measure.maps[a],cache:e.measure.caches[a],before:!0}}}function Op(e,n){n=We(n);var l=gt(n),o=e.display.externalMeasured=new Oh(e.doc,n,l);o.lineN=l;var a=o.built=Th(e,o);return o.text=a.pre,lt(e.display.lineMeasure,a.pre),o}function Wh(e,n,l,o){return Xe(e,xn(e,n),l,o)}function el(e,n){if(n>=e.display.viewFrom&&n<e.display.viewTo)return e.display.view[ji(e,n)];var l=e.display.externalMeasured;if(l&&n>=l.lineN&&n<l.lineN+l.size)return l}function xn(e,n){var l=gt(n),o=el(e,l);o&&!o.text?o=null:o&&o.changes&&(Dh(e,o,l,ol(e)),e.curOp.forceUpdate=!0),o||(o=Op(e,n));var a=Ih(o,n,l);return{line:n,view:o,rect:null,map:a.map,cache:a.cache,before:a.before,hasHeights:!1}}function Xe(e,n,l,o,a){n.before&&(l=-1);var c=l+(o||""),g;return n.cache.hasOwnProperty(c)?g=n.cache[c]:(n.rect||(n.rect=n.view.text.getBoundingClientRect()),n.hasHeights||(Lp(e,n.view,n.rect),n.hasHeights=!0),g=Np(e,n,l,o),g.bogus||(n.cache[c]=g)),{left:g.left,right:g.right,top:a?g.rtop:g.top,bottom:a?g.rbottom:g.bottom}}var Hh={left:0,right:0,top:0,bottom:0};function Fh(e,n,l){for(var o,a,c,g,m,b,x=0;x<e.length;x+=3)if(m=e[x],b=e[x+1],n<m?(a=0,c=1,g="left"):n<b?(a=n-m,c=a+1):(x==e.length-3||n==b&&e[x+3]>n)&&(c=b-m,a=c-1,n>=b&&(g="right")),a!=null){if(o=e[x+2],m==b&&l==(o.insertLeft?"left":"right")&&(g=l),l=="left"&&a==0)for(;x&&e[x-2]==e[x-3]&&e[x-1].insertLeft;)o=e[(x-=3)+2],g="left";if(l=="right"&&a==b-m)for(;x<e.length-3&&e[x+3]==e[x+4]&&!e[x+5].insertLeft;)o=e[(x+=3)+2],g="right";break}return{node:o,start:a,end:c,collapse:g,coverStart:m,coverEnd:b}}function Dp(e,n){var l=Hh;if(n=="left")for(var o=0;o<e.length&&(l=e[o]).left==l.right;o++);else for(var a=e.length-1;a>=0&&(l=e[a]).left==l.right;a--);return l}function Np(e,n,l,o){var a=Fh(n.map,l,o),c=a.node,g=a.start,m=a.end,b=a.collapse,x;if(c.nodeType==3){for(var k=0;k<4;k++){for(;g&&Do(n.line.text.charAt(a.coverStart+g));)--g;for(;a.coverStart+m<a.coverEnd&&Do(n.line.text.charAt(a.coverStart+m));)++m;if(p&&v<9&&g==0&&m==a.coverEnd-a.coverStart?x=c.parentNode.getBoundingClientRect():x=Dp(Se(c,g,m).getClientRects(),o),x.left||x.right||g==0)break;m=g,g=g-1,b="right"}p&&v<11&&(x=Pp(e.display.measure,x))}else{g>0&&(b=o="right");var C;e.options.lineWrapping&&(C=c.getClientRects()).length>1?x=C[o=="right"?C.length-1:0]:x=c.getBoundingClientRect()}if(p&&v<9&&!g&&(!x||!x.left&&!x.right)){var L=c.parentNode.getClientRects()[0];L?x={left:L.left,right:L.left+Sn(e.display),top:L.top,bottom:L.bottom}:x=Hh}for(var T=x.top-n.rect.top,O=x.bottom-n.rect.top,E=(T+O)/2,R=n.view.measure.heights,I=0;I<R.length-1&&!(E<R[I]);I++);var F=I?R[I-1]:0,W=R[I],U={left:(b=="right"?x.right:x.left)-n.rect.left,right:(b=="left"?x.left:x.right)-n.rect.left,top:F,bottom:W};return!x.left&&!x.right&&(U.bogus=!0),e.options.singleCursorHeightPerLine||(U.rtop=T,U.rbottom=O),U}function Pp(e,n){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Yd(e))return n;var l=screen.logicalXDPI/screen.deviceXDPI,o=screen.logicalYDPI/screen.deviceYDPI;return{left:n.left*l,right:n.right*l,top:n.top*o,bottom:n.bottom*o}}function zh(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var n=0;n<e.rest.length;n++)e.measure.caches[n]={}}function Kh(e){e.display.externalMeasure=null,ht(e.display.lineMeasure);for(var n=0;n<e.display.view.length;n++)zh(e.display.view[n])}function ur(e){Kh(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Uh(e){return S&&q?-(e.body.getBoundingClientRect().left-parseInt(getComputedStyle(e.body).marginLeft)):e.defaultView.pageXOffset||(e.documentElement||e.body).scrollLeft}function Vh(e){return S&&q?-(e.body.getBoundingClientRect().top-parseInt(getComputedStyle(e.body).marginTop)):e.defaultView.pageYOffset||(e.documentElement||e.body).scrollTop}function il(e){var n=We(e),l=n.widgets,o=0;if(l)for(var a=0;a<l.length;++a)l[a].above&&(o+=fr(l[a]));return o}function vs(e,n,l,o,a){if(!a){var c=il(n);l.top+=c,l.bottom+=c}if(o=="line")return l;o||(o="local");var g=fi(n);if(o=="local"?g+=ms(e.display):g-=e.display.viewOffset,o=="page"||o=="window"){var m=e.display.lineSpace.getBoundingClientRect();g+=m.top+(o=="window"?0:Vh(ee(e)));var b=m.left+(o=="window"?0:Uh(ee(e)));l.left+=b,l.right+=b}return l.top+=g,l.bottom+=g,l}function Gh(e,n,l){if(l=="div")return n;var o=n.left,a=n.top;if(l=="page")o-=Uh(ee(e)),a-=Vh(ee(e));else if(l=="local"||!l){var c=e.display.sizer.getBoundingClientRect();o+=c.left,a+=c.top}var g=e.display.lineSpace.getBoundingClientRect();return{left:o-g.left,top:a-g.top}}function ys(e,n,l,o,a){return o||(o=Y(e.doc,n.line)),vs(e,o,Wh(e,o,n.ch,a),l)}function He(e,n,l,o,a,c){o=o||Y(e.doc,n.line),a||(a=xn(e,o));function g(O,E){var R=Xe(e,a,O,E?"right":"left",c);return E?R.left=R.right:R.right=R.left,vs(e,o,R,l)}var m=ai(o,e.doc.direction),b=n.ch,x=n.sticky;if(b>=o.text.length?(b=o.text.length,x="before"):b<=0&&(b=0,x="after"),!m)return g(x=="before"?b-1:b,x=="before");function k(O,E,R){var I=m[E],F=I.level==1;return g(R?O-1:O,F!=R)}var C=nr(m,b,x),L=ir,T=k(b,C,x=="before");return L!=null&&(T.other=k(b,L,x!="before")),T}function _h(e,n){var l=0;n=nt(e.doc,n),e.options.lineWrapping||(l=Sn(e.display)*n.ch);var o=Y(e.doc,n.line),a=fi(o)+ms(e.display);return{left:l,right:l,top:a,bottom:a+o.height}}function nl(e,n,l,o,a){var c=B(e,n,l);return c.xRel=a,o&&(c.outside=o),c}function rl(e,n,l){var o=e.doc;if(l+=e.display.viewOffset,l<0)return nl(o.first,0,null,-1,-1);var a=_i(o,l),c=o.first+o.size-1;if(a>c)return nl(o.first+o.size-1,Y(o,c).text.length,null,1,1);n<0&&(n=0);for(var g=Y(o,a);;){var m=Ep(e,g,a,n,l),b=lp(g,m.ch+(m.xRel>0||m.outside>0?1:0));if(!b)return m;var x=b.find(1);if(x.line==a)return x;g=Y(o,a=x.line)}}function qh(e,n,l,o){o-=il(n);var a=n.text.length,c=er(function(g){return Xe(e,l,g-1).bottom<=o},a,0);return a=er(function(g){return Xe(e,l,g).top>o},c,a),{begin:c,end:a}}function Yh(e,n,l,o){l||(l=xn(e,n));var a=vs(e,n,Xe(e,l,o),"line").top;return qh(e,n,l,a)}function sl(e,n,l,o){return e.bottom<=l?!1:e.top>l?!0:(o?e.left:e.right)>n}function Ep(e,n,l,o,a){a-=fi(n);var c=xn(e,n),g=il(n),m=0,b=n.text.length,x=!0,k=ai(n,e.doc.direction);if(k){var C=(e.options.lineWrapping?Rp:Bp)(e,n,l,c,k,o,a);x=C.level!=1,m=x?C.from:C.to-1,b=x?C.to:C.from-1}var L=null,T=null,O=er(function(Z){var X=Xe(e,c,Z);return X.top+=g,X.bottom+=g,sl(X,o,a,!1)?(X.top<=a&&X.left<=o&&(L=Z,T=X),!0):!1},m,b),E,R,I=!1;if(T){var F=o-T.left<T.right-o,W=F==x;O=L+(W?0:1),R=W?"after":"before",E=F?T.left:T.right}else{!x&&(O==b||O==m)&&O++,R=O==0?"after":O==n.text.length?"before":Xe(e,c,O-(x?1:0)).bottom+g<=a==x?"after":"before";var U=He(e,B(l,O,R),"line",n,c);E=U.left,I=a<U.top?-1:a>=U.bottom?1:0}return O=nh(n.text,O,1),nl(l,O,R,I,o-E)}function Bp(e,n,l,o,a,c,g){var m=er(function(C){var L=a[C],T=L.level!=1;return sl(He(e,B(l,T?L.to:L.from,T?"before":"after"),"line",n,o),c,g,!0)},0,a.length-1),b=a[m];if(m>0){var x=b.level!=1,k=He(e,B(l,x?b.from:b.to,x?"after":"before"),"line",n,o);sl(k,c,g,!0)&&k.top>g&&(b=a[m-1])}return b}function Rp(e,n,l,o,a,c,g){var m=qh(e,n,o,g),b=m.begin,x=m.end;/\s/.test(n.text.charAt(x-1))&&x--;for(var k=null,C=null,L=0;L<a.length;L++){var T=a[L];if(!(T.from>=x||T.to<=b)){var O=T.level!=1,E=Xe(e,o,O?Math.min(x,T.to)-1:Math.max(b,T.from)).right,R=E<c?c-E+1e9:E-c;(!k||C>R)&&(k=T,C=R)}}return k||(k=a[a.length-1]),k.from<b&&(k={from:b,to:k.to,level:k.level}),k.to>x&&(k={from:k.from,to:x,level:k.level}),k}var Yi;function wn(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(Yi==null){Yi=V("pre",null,"CodeMirror-line-like");for(var n=0;n<49;++n)Yi.appendChild(document.createTextNode("x")),Yi.appendChild(V("br"));Yi.appendChild(document.createTextNode("x"))}lt(e.measure,Yi);var l=Yi.offsetHeight/50;return l>3&&(e.cachedTextHeight=l),ht(e.measure),l||1}function Sn(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var n=V("span","xxxxxxxxxx"),l=V("pre",[n],"CodeMirror-line-like");lt(e.measure,l);var o=n.getBoundingClientRect(),a=(o.right-o.left)/10;return a>2&&(e.cachedCharWidth=a),a||10}function ol(e){for(var n=e.display,l={},o={},a=n.gutters.clientLeft,c=n.gutters.firstChild,g=0;c;c=c.nextSibling,++g){var m=e.display.gutterSpecs[g].className;l[m]=c.offsetLeft+c.clientLeft+a,o[m]=c.clientWidth}return{fixedPos:ll(n),gutterTotalWidth:n.gutters.offsetWidth,gutterLeft:l,gutterWidth:o,wrapperWidth:n.wrapper.clientWidth}}function ll(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Xh(e){var n=wn(e.display),l=e.options.lineWrapping,o=l&&Math.max(5,e.display.scroller.clientWidth/Sn(e.display)-3);return function(a){if(wi(e.doc,a))return 0;var c=0;if(a.widgets)for(var g=0;g<a.widgets.length;g++)a.widgets[g].height&&(c+=a.widgets[g].height);return l?c+(Math.ceil(a.text.length/o)||1)*n:c+n}}function al(e){var n=e.doc,l=Xh(e);n.iter(function(o){var a=l(o);a!=o.height&&_e(o,a)})}function Xi(e,n,l,o){var a=e.display;if(!l&&Eo(n).getAttribute("cm-not-content")=="true")return null;var c,g,m=a.lineSpace.getBoundingClientRect();try{c=n.clientX-m.left,g=n.clientY-m.top}catch{return null}var b=rl(e,c,g),x;if(o&&b.xRel>0&&(x=Y(e.doc,b.line).text).length==b.ch){var k=Oe(x,x.length,e.options.tabSize)-x.length;b=B(b.line,Math.max(0,Math.round((c-Rh(e.display).left)/Sn(e.display))-k))}return b}function ji(e,n){if(n>=e.display.viewTo||(n-=e.display.viewFrom,n<0))return null;for(var l=e.display.view,o=0;o<l.length;o++)if(n-=l[o].size,n<0)return o}function fe(e,n,l,o){n==null&&(n=e.doc.first),l==null&&(l=e.doc.first+e.doc.size),o||(o=0);var a=e.display;if(o&&l<a.viewTo&&(a.updateLineNumbers==null||a.updateLineNumbers>n)&&(a.updateLineNumbers=n),e.curOp.viewChanged=!0,n>=a.viewTo)hi&&jo(e.doc,n)<a.viewTo&&ki(e);else if(l<=a.viewFrom)hi&&Ah(e.doc,l+o)>a.viewFrom?ki(e):(a.viewFrom+=o,a.viewTo+=o);else if(n<=a.viewFrom&&l>=a.viewTo)ki(e);else if(n<=a.viewFrom){var c=bs(e,l,l+o,1);c?(a.view=a.view.slice(c.index),a.viewFrom=c.lineN,a.viewTo+=o):ki(e)}else if(l>=a.viewTo){var g=bs(e,n,n,-1);g?(a.view=a.view.slice(0,g.index),a.viewTo=g.lineN):ki(e)}else{var m=bs(e,n,n,-1),b=bs(e,l,l+o,1);m&&b?(a.view=a.view.slice(0,m.index).concat(gs(e,m.lineN,b.lineN)).concat(a.view.slice(b.index)),a.viewTo+=o):ki(e)}var x=a.externalMeasured;x&&(l<x.lineN?x.lineN+=o:n<x.lineN+x.size&&(a.externalMeasured=null))}function Si(e,n,l){e.curOp.viewChanged=!0;var o=e.display,a=e.display.externalMeasured;if(a&&n>=a.lineN&&n<a.lineN+a.size&&(o.externalMeasured=null),!(n<o.viewFrom||n>=o.viewTo)){var c=o.view[ji(e,n)];if(c.node!=null){var g=c.changes||(c.changes=[]);Xt(g,l)==-1&&g.push(l)}}}function ki(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function bs(e,n,l,o){var a=ji(e,n),c,g=e.display.view;if(!hi||l==e.doc.first+e.doc.size)return{index:a,lineN:l};for(var m=e.display.viewFrom,b=0;b<a;b++)m+=g[b].size;if(m!=n){if(o>0){if(a==g.length-1)return null;c=m+g[a].size-n,a++}else c=m-n;n+=c,l+=c}for(;jo(e.doc,l)!=l;){if(a==(o<0?0:g.length-1))return null;l+=o*g[a-(o<0?1:0)].size,a+=o}return{index:a,lineN:l}}function Ip(e,n,l){var o=e.display,a=o.view;a.length==0||n>=o.viewTo||l<=o.viewFrom?(o.view=gs(e,n,l),o.viewFrom=n):(o.viewFrom>n?o.view=gs(e,n,o.viewFrom).concat(o.view):o.viewFrom<n&&(o.view=o.view.slice(ji(e,n))),o.viewFrom=n,o.viewTo<l?o.view=o.view.concat(gs(e,o.viewTo,l)):o.viewTo>l&&(o.view=o.view.slice(0,ji(e,l)))),o.viewTo=l}function jh(e){for(var n=e.display.view,l=0,o=0;o<n.length;o++){var a=n[o];!a.hidden&&(!a.node||a.changes)&&++l}return l}function cr(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Jh(e,n){n===void 0&&(n=!0);var l=e.doc,o={},a=o.cursors=document.createDocumentFragment(),c=o.selection=document.createDocumentFragment(),g=e.options.$customCursor;g&&(n=!0);for(var m=0;m<l.sel.ranges.length;m++)if(!(!n&&m==l.sel.primIndex)){var b=l.sel.ranges[m];if(!(b.from().line>=e.display.viewTo||b.to().line<e.display.viewFrom)){var x=b.empty();if(g){var k=g(e,b);k&&hl(e,k,a)}else(x||e.options.showCursorWhenSelecting)&&hl(e,b.head,a);x||Wp(e,b,c)}}return o}function hl(e,n,l){var o=He(e,n,"div",null,null,!e.options.singleCursorHeightPerLine),a=l.appendChild(V("div"," ","CodeMirror-cursor"));if(a.style.left=o.left+"px",a.style.top=o.top+"px",a.style.height=Math.max(0,o.bottom-o.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var c=ys(e,n,"div",null,null),g=c.right-c.left;a.style.width=(g>0?g:e.defaultCharWidth())+"px"}if(o.other){var m=l.appendChild(V("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));m.style.display="",m.style.left=o.other.left+"px",m.style.top=o.other.top+"px",m.style.height=(o.other.bottom-o.other.top)*.85+"px"}}function xs(e,n){return e.top-n.top||e.left-n.left}function Wp(e,n,l){var o=e.display,a=e.doc,c=document.createDocumentFragment(),g=Rh(e.display),m=g.left,b=Math.max(o.sizerWidth,qi(e)-o.sizer.offsetLeft)-g.right,x=a.direction=="ltr";function k(W,U,Z,X){U<0&&(U=0),U=Math.round(U),X=Math.round(X),c.appendChild(V("div",null,"CodeMirror-selected","position: absolute; left: "+W+`px;
                             top: `+U+"px; width: "+(Z??b-W)+`px;
                             height: `+(X-U)+"px"))}function C(W,U,Z){var X=Y(a,W),rt=X.text.length,yt,Vt;function Mt(Nt,de){return ys(e,B(W,Nt),"div",X,de)}function xe(Nt,de,qt){var Rt=Yh(e,X,null,Nt),Pt=de=="ltr"==(qt=="after")?"left":"right",Tt=qt=="after"?Rt.begin:Rt.end-(/\s/.test(X.text.charAt(Rt.end-1))?2:1);return Mt(Tt,Pt)[Pt]}var ce=ai(X,a.direction);return zd(ce,U||0,Z??rt,function(Nt,de,qt,Rt){var Pt=qt=="ltr",Tt=Mt(Nt,Pt?"left":"right"),pe=Mt(de-1,Pt?"right":"left"),Rn=U==null&&Nt==0,Oi=Z==null&&de==rt,Jt=Rt==0,je=!ce||Rt==ce.length-1;if(pe.top-Tt.top<=3){var Gt=(x?Rn:Oi)&&Jt,Il=(x?Oi:Rn)&&je,pi=Gt?m:(Pt?Tt:pe).left,tn=Il?b:(Pt?pe:Tt).right;k(pi,Tt.top,tn-pi,Tt.bottom)}else{var en,ne,In,Wl;Pt?(en=x&&Rn&&Jt?m:Tt.left,ne=x?b:xe(Nt,qt,"before"),In=x?m:xe(de,qt,"after"),Wl=x&&Oi&&je?b:pe.right):(en=x?xe(Nt,qt,"before"):m,ne=!x&&Rn&&Jt?b:Tt.right,In=!x&&Oi&&je?m:pe.left,Wl=x?xe(de,qt,"after"):b),k(en,Tt.top,ne-en,Tt.bottom),Tt.bottom<pe.top&&k(m,Tt.bottom,null,pe.top),k(In,pe.top,Wl-In,pe.bottom)}(!yt||xs(Tt,yt)<0)&&(yt=Tt),xs(pe,yt)<0&&(yt=pe),(!Vt||xs(Tt,Vt)<0)&&(Vt=Tt),xs(pe,Vt)<0&&(Vt=pe)}),{start:yt,end:Vt}}var L=n.from(),T=n.to();if(L.line==T.line)C(L.line,L.ch,T.ch);else{var O=Y(a,L.line),E=Y(a,T.line),R=We(O)==We(E),I=C(L.line,L.ch,R?O.text.length+1:null).end,F=C(T.line,R?0:null,T.ch).start;R&&(I.top<F.top-2?(k(I.right,I.top,null,I.bottom),k(m,F.top,F.left,F.bottom)):k(I.right,I.top,F.left-I.right,I.bottom)),I.bottom<F.top&&k(m,I.bottom,null,F.top)}l.appendChild(c)}function fl(e){if(e.state.focused){var n=e.display;clearInterval(n.blinker);var l=!0;n.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?n.blinker=setInterval(function(){e.hasFocus()||kn(e),n.cursorDiv.style.visibility=(l=!l)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(n.cursorDiv.style.visibility="hidden")}}function Zh(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||cl(e))}function ul(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&kn(e))},100)}function cl(e,n){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),e.options.readOnly!="nocursor"&&(e.state.focused||(Ot(e,"focus",e,n),e.state.focused=!0,Ve(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(e.display.input.reset(),y&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),fl(e))}function kn(e,n){e.state.delayingBlurEvent||(e.state.focused&&(Ot(e,"blur",e,n),e.state.focused=!1,tt(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function ws(e){for(var n=e.display,l=n.lineDiv.offsetTop,o=Math.max(0,n.scroller.getBoundingClientRect().top),a=n.lineDiv.getBoundingClientRect().top,c=0,g=0;g<n.view.length;g++){var m=n.view[g],b=e.options.lineWrapping,x=void 0,k=0;if(!m.hidden){if(a+=m.line.height,p&&v<8){var C=m.node.offsetTop+m.node.offsetHeight;x=C-l,l=C}else{var L=m.node.getBoundingClientRect();x=L.bottom-L.top,!b&&m.text.firstChild&&(k=m.text.firstChild.getBoundingClientRect().right-L.left-1)}var T=m.line.height-x;if((T>.005||T<-.005)&&(a<o&&(c-=T),_e(m.line,x),Qh(m.line),m.rest))for(var O=0;O<m.rest.length;O++)Qh(m.rest[O]);if(k>e.display.sizerWidth){var E=Math.ceil(k/Sn(e.display));E>e.display.maxLineLength&&(e.display.maxLineLength=E,e.display.maxLine=m.line,e.display.maxLineChanged=!0)}}}Math.abs(c)>2&&(n.scroller.scrollTop+=c)}function Qh(e){if(e.widgets)for(var n=0;n<e.widgets.length;++n){var l=e.widgets[n],o=l.node.parentNode;o&&(l.height=o.offsetHeight)}}function Ss(e,n,l){var o=l&&l.top!=null?Math.max(0,l.top):e.scroller.scrollTop;o=Math.floor(o-ms(e));var a=l&&l.bottom!=null?l.bottom:o+e.wrapper.clientHeight,c=_i(n,o),g=_i(n,a);if(l&&l.ensure){var m=l.ensure.from.line,b=l.ensure.to.line;m<c?(c=m,g=_i(n,fi(Y(n,m))+e.wrapper.clientHeight)):Math.min(b,n.lastLine())>=g&&(c=_i(n,fi(Y(n,b))-e.wrapper.clientHeight),g=b)}return{from:c,to:Math.max(g,c+1)}}function Hp(e,n){if(!Ft(e,"scrollCursorIntoView")){var l=e.display,o=l.sizer.getBoundingClientRect(),a=null,c=l.wrapper.ownerDocument;if(n.top+o.top<0?a=!0:n.bottom+o.top>(c.defaultView.innerHeight||c.documentElement.clientHeight)&&(a=!1),a!=null&&!P){var g=V("div","​",null,`position: absolute;
                         top: `+(n.top-l.viewOffset-ms(e.display))+`px;
                         height: `+(n.bottom-n.top+Ye(e)+l.barHeight)+`px;
                         left: `+n.left+"px; width: "+Math.max(2,n.right-n.left)+"px;");e.display.lineSpace.appendChild(g),g.scrollIntoView(a),e.display.lineSpace.removeChild(g)}}}function Fp(e,n,l,o){o==null&&(o=0);var a;!e.options.lineWrapping&&n==l&&(l=n.sticky=="before"?B(n.line,n.ch+1,"before"):n,n=n.ch?B(n.line,n.sticky=="before"?n.ch-1:n.ch,"after"):n);for(var c=0;c<5;c++){var g=!1,m=He(e,n),b=!l||l==n?m:He(e,l);a={left:Math.min(m.left,b.left),top:Math.min(m.top,b.top)-o,right:Math.max(m.left,b.left),bottom:Math.max(m.bottom,b.bottom)+o};var x=dl(e,a),k=e.doc.scrollTop,C=e.doc.scrollLeft;if(x.scrollTop!=null&&(pr(e,x.scrollTop),Math.abs(e.doc.scrollTop-k)>1&&(g=!0)),x.scrollLeft!=null&&(Ji(e,x.scrollLeft),Math.abs(e.doc.scrollLeft-C)>1&&(g=!0)),!g)break}return a}function zp(e,n){var l=dl(e,n);l.scrollTop!=null&&pr(e,l.scrollTop),l.scrollLeft!=null&&Ji(e,l.scrollLeft)}function dl(e,n){var l=e.display,o=wn(e.display);n.top<0&&(n.top=0);var a=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:l.scroller.scrollTop,c=tl(e),g={};n.bottom-n.top>c&&(n.bottom=n.top+c);var m=e.doc.height+$o(l),b=n.top<o,x=n.bottom>m-o;if(n.top<a)g.scrollTop=b?0:n.top;else if(n.bottom>a+c){var k=Math.min(n.top,(x?m:n.bottom)-c);k!=a&&(g.scrollTop=k)}var C=e.options.fixedGutter?0:l.gutters.offsetWidth,L=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:l.scroller.scrollLeft-C,T=qi(e)-l.gutters.offsetWidth,O=n.right-n.left>T;return O&&(n.right=n.left+T),n.left<10?g.scrollLeft=0:n.left<L?g.scrollLeft=Math.max(0,n.left+C-(O?0:10)):n.right>T+L-3&&(g.scrollLeft=n.right+(O?0:10)-T),g}function pl(e,n){n!=null&&(ks(e),e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+n)}function Cn(e){ks(e);var n=e.getCursor();e.curOp.scrollToPos={from:n,to:n,margin:e.options.cursorScrollMargin}}function dr(e,n,l){(n!=null||l!=null)&&ks(e),n!=null&&(e.curOp.scrollLeft=n),l!=null&&(e.curOp.scrollTop=l)}function Kp(e,n){ks(e),e.curOp.scrollToPos=n}function ks(e){var n=e.curOp.scrollToPos;if(n){e.curOp.scrollToPos=null;var l=_h(e,n.from),o=_h(e,n.to);$h(e,l,o,n.margin)}}function $h(e,n,l,o){var a=dl(e,{left:Math.min(n.left,l.left),top:Math.min(n.top,l.top)-o,right:Math.max(n.right,l.right),bottom:Math.max(n.bottom,l.bottom)+o});dr(e,a.scrollLeft,a.scrollTop)}function pr(e,n){Math.abs(e.doc.scrollTop-n)<2||(s||ml(e,{top:n}),tf(e,n,!0),s&&ml(e),vr(e,100))}function tf(e,n,l){n=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,n)),!(e.display.scroller.scrollTop==n&&!l)&&(e.doc.scrollTop=n,e.display.scrollbars.setScrollTop(n),e.display.scroller.scrollTop!=n&&(e.display.scroller.scrollTop=n))}function Ji(e,n,l,o){n=Math.max(0,Math.min(n,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),!((l?n==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-n)<2)&&!o)&&(e.doc.scrollLeft=n,of(e),e.display.scroller.scrollLeft!=n&&(e.display.scroller.scrollLeft=n),e.display.scrollbars.setScrollLeft(n))}function gr(e){var n=e.display,l=n.gutters.offsetWidth,o=Math.round(e.doc.height+$o(e.display));return{clientHeight:n.scroller.clientHeight,viewHeight:n.wrapper.clientHeight,scrollWidth:n.scroller.scrollWidth,clientWidth:n.scroller.clientWidth,viewWidth:n.wrapper.clientWidth,barLeft:e.options.fixedGutter?l:0,docHeight:o,scrollHeight:o+Ye(e)+n.barHeight,nativeBarWidth:n.nativeBarWidth,gutterWidth:l}}var Zi=function(e,n,l){this.cm=l;var o=this.vert=V("div",[V("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),a=this.horiz=V("div",[V("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");o.tabIndex=a.tabIndex=-1,e(o),e(a),$(o,"scroll",function(){o.clientHeight&&n(o.scrollTop,"vertical")}),$(a,"scroll",function(){a.clientWidth&&n(a.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,p&&v<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Zi.prototype.update=function(e){var n=e.scrollWidth>e.clientWidth+1,l=e.scrollHeight>e.clientHeight+1,o=e.nativeBarWidth;if(l){this.vert.style.display="block",this.vert.style.bottom=n?o+"px":"0";var a=e.viewHeight-(n?o:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+a)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(n){this.horiz.style.display="block",this.horiz.style.right=l?o+"px":"0",this.horiz.style.left=e.barLeft+"px";var c=e.viewWidth-e.barLeft-(l?o:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+c)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(o==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:l?o:0,bottom:n?o:0}},Zi.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Zi.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Zi.prototype.zeroWidthHack=function(){var e=_&&!N?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new xi,this.disableVert=new xi},Zi.prototype.enableZeroWidthBar=function(e,n,l){e.style.visibility="";function o(){var a=e.getBoundingClientRect(),c=l=="vert"?document.elementFromPoint(a.right-1,(a.top+a.bottom)/2):document.elementFromPoint((a.right+a.left)/2,a.bottom-1);c!=e?e.style.visibility="hidden":n.set(1e3,o)}n.set(1e3,o)},Zi.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var mr=function(){};mr.prototype.update=function(){return{bottom:0,right:0}},mr.prototype.setScrollLeft=function(){},mr.prototype.setScrollTop=function(){},mr.prototype.clear=function(){};function An(e,n){n||(n=gr(e));var l=e.display.barWidth,o=e.display.barHeight;ef(e,n);for(var a=0;a<4&&l!=e.display.barWidth||o!=e.display.barHeight;a++)l!=e.display.barWidth&&e.options.lineWrapping&&ws(e),ef(e,gr(e)),l=e.display.barWidth,o=e.display.barHeight}function ef(e,n){var l=e.display,o=l.scrollbars.update(n);l.sizer.style.paddingRight=(l.barWidth=o.right)+"px",l.sizer.style.paddingBottom=(l.barHeight=o.bottom)+"px",l.heightForcer.style.borderBottom=o.bottom+"px solid transparent",o.right&&o.bottom?(l.scrollbarFiller.style.display="block",l.scrollbarFiller.style.height=o.bottom+"px",l.scrollbarFiller.style.width=o.right+"px"):l.scrollbarFiller.style.display="",o.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(l.gutterFiller.style.display="block",l.gutterFiller.style.height=o.bottom+"px",l.gutterFiller.style.width=n.gutterWidth+"px"):l.gutterFiller.style.display=""}var nf={native:Zi,null:mr};function rf(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&tt(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new nf[e.options.scrollbarStyle](function(n){e.display.wrapper.insertBefore(n,e.display.scrollbarFiller),$(n,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),n.setAttribute("cm-not-content","true")},function(n,l){l=="horizontal"?Ji(e,n):pr(e,n)},e),e.display.scrollbars.addClass&&Ve(e.display.wrapper,e.display.scrollbars.addClass)}var Up=0;function Qi(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Up,markArrays:null},bp(e.curOp)}function $i(e){var n=e.curOp;n&&wp(n,function(l){for(var o=0;o<l.ops.length;o++)l.ops[o].cm.curOp=null;Vp(l)})}function Vp(e){for(var n=e.ops,l=0;l<n.length;l++)Gp(n[l]);for(var o=0;o<n.length;o++)_p(n[o]);for(var a=0;a<n.length;a++)qp(n[a]);for(var c=0;c<n.length;c++)Yp(n[c]);for(var g=0;g<n.length;g++)Xp(n[g])}function Gp(e){var n=e.cm,l=n.display;Jp(n),e.updateMaxLine&&Zo(n),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<l.viewFrom||e.scrollToPos.to.line>=l.viewTo)||l.maxLineChanged&&n.options.lineWrapping,e.update=e.mustUpdate&&new Cs(n,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function _p(e){e.updatedDisplay=e.mustUpdate&&gl(e.cm,e.update)}function qp(e){var n=e.cm,l=n.display;e.updatedDisplay&&ws(n),e.barMeasure=gr(n),l.maxLineChanged&&!n.options.lineWrapping&&(e.adjustWidthTo=Wh(n,l.maxLine,l.maxLine.text.length).left+3,n.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(l.scroller.clientWidth,l.sizer.offsetLeft+e.adjustWidthTo+Ye(n)+n.display.barWidth),e.maxScrollLeft=Math.max(0,l.sizer.offsetLeft+e.adjustWidthTo-qi(n))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=l.input.prepareSelection())}function Yp(e){var n=e.cm;e.adjustWidthTo!=null&&(n.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<n.doc.scrollLeft&&Ji(n,Math.min(n.display.scroller.scrollLeft,e.maxScrollLeft),!0),n.display.maxLineChanged=!1);var l=e.focus&&e.focus==Bt(ve(n));e.preparedSelection&&n.display.input.showSelection(e.preparedSelection,l),(e.updatedDisplay||e.startHeight!=n.doc.height)&&An(n,e.barMeasure),e.updatedDisplay&&yl(n,e.barMeasure),e.selectionChanged&&fl(n),n.state.focused&&e.updateInput&&n.display.input.reset(e.typing),l&&Zh(e.cm)}function Xp(e){var n=e.cm,l=n.display,o=n.doc;if(e.updatedDisplay&&sf(n,e.update),l.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(l.wheelStartX=l.wheelStartY=null),e.scrollTop!=null&&tf(n,e.scrollTop,e.forceScroll),e.scrollLeft!=null&&Ji(n,e.scrollLeft,!0,!0),e.scrollToPos){var a=Fp(n,nt(o,e.scrollToPos.from),nt(o,e.scrollToPos.to),e.scrollToPos.margin);Hp(n,a)}var c=e.maybeHiddenMarkers,g=e.maybeUnhiddenMarkers;if(c)for(var m=0;m<c.length;++m)c[m].lines.length||Ot(c[m],"hide");if(g)for(var b=0;b<g.length;++b)g[b].lines.length&&Ot(g[b],"unhide");l.wrapper.offsetHeight&&(o.scrollTop=n.display.scroller.scrollTop),e.changeObjs&&Ot(n,"changes",n,e.changeObjs),e.update&&e.update.finish()}function be(e,n){if(e.curOp)return n();Qi(e);try{return n()}finally{$i(e)}}function Kt(e,n){return function(){if(e.curOp)return n.apply(e,arguments);Qi(e);try{return n.apply(e,arguments)}finally{$i(e)}}}function ie(e){return function(){if(this.curOp)return e.apply(this,arguments);Qi(this);try{return e.apply(this,arguments)}finally{$i(this)}}}function Ut(e){return function(){var n=this.cm;if(!n||n.curOp)return e.apply(this,arguments);Qi(n);try{return e.apply(this,arguments)}finally{$i(n)}}}function vr(e,n){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(n,pn(jp,e))}function jp(e){var n=e.doc;if(!(n.highlightFrontier>=e.display.viewTo)){var l=+new Date+e.options.workTime,o=or(e,n.highlightFrontier),a=[];n.iter(o.line,Math.min(n.first+n.size,e.display.viewTo+500),function(c){if(o.line>=e.display.viewFrom){var g=c.styles,m=c.text.length>e.options.maxHighlightLength?Vi(n.mode,o.state):null,b=uh(e,c,o,!0);m&&(o.state=m),c.styles=b.styles;var x=c.styleClasses,k=b.classes;k?c.styleClasses=k:x&&(c.styleClasses=null);for(var C=!g||g.length!=c.styles.length||x!=k&&(!x||!k||x.bgClass!=k.bgClass||x.textClass!=k.textClass),L=0;!C&&L<g.length;++L)C=g[L]!=c.styles[L];C&&a.push(o.line),c.stateAfter=o.save(),o.nextLine()}else c.text.length<=e.options.maxHighlightLength&&_o(e,c.text,o),c.stateAfter=o.line%5==0?o.save():null,o.nextLine();if(+new Date>l)return vr(e,e.options.workDelay),!0}),n.highlightFrontier=o.line,n.modeFrontier=Math.max(n.modeFrontier,o.line),a.length&&be(e,function(){for(var c=0;c<a.length;c++)Si(e,a[c],"text")})}}var Cs=function(e,n,l){var o=e.display;this.viewport=n,this.visible=Ss(o,e.doc,n),this.editorIsHidden=!o.wrapper.offsetWidth,this.wrapperHeight=o.wrapper.clientHeight,this.wrapperWidth=o.wrapper.clientWidth,this.oldDisplayWidth=qi(e),this.force=l,this.dims=ol(e),this.events=[]};Cs.prototype.signal=function(e,n){De(e,n)&&this.events.push(arguments)},Cs.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ot.apply(null,this.events[e])};function Jp(e){var n=e.display;!n.scrollbarsClipped&&n.scroller.offsetWidth&&(n.nativeBarWidth=n.scroller.offsetWidth-n.scroller.clientWidth,n.heightForcer.style.height=Ye(e)+"px",n.sizer.style.marginBottom=-n.nativeBarWidth+"px",n.sizer.style.borderRightWidth=Ye(e)+"px",n.scrollbarsClipped=!0)}function Zp(e){if(e.hasFocus())return null;var n=Bt(ve(e));if(!n||!ke(e.display.lineDiv,n))return null;var l={activeElt:n};if(window.getSelection){var o=li(e).getSelection();o.anchorNode&&o.extend&&ke(e.display.lineDiv,o.anchorNode)&&(l.anchorNode=o.anchorNode,l.anchorOffset=o.anchorOffset,l.focusNode=o.focusNode,l.focusOffset=o.focusOffset)}return l}function Qp(e){if(!(!e||!e.activeElt||e.activeElt==Bt(ye(e.activeElt)))&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&ke(document.body,e.anchorNode)&&ke(document.body,e.focusNode))){var n=e.activeElt.ownerDocument,l=n.defaultView.getSelection(),o=n.createRange();o.setEnd(e.anchorNode,e.anchorOffset),o.collapse(!1),l.removeAllRanges(),l.addRange(o),l.extend(e.focusNode,e.focusOffset)}}function gl(e,n){var l=e.display,o=e.doc;if(n.editorIsHidden)return ki(e),!1;if(!n.force&&n.visible.from>=l.viewFrom&&n.visible.to<=l.viewTo&&(l.updateLineNumbers==null||l.updateLineNumbers>=l.viewTo)&&l.renderedView==l.view&&jh(e)==0)return!1;lf(e)&&(ki(e),n.dims=ol(e));var a=o.first+o.size,c=Math.max(n.visible.from-e.options.viewportMargin,o.first),g=Math.min(a,n.visible.to+e.options.viewportMargin);l.viewFrom<c&&c-l.viewFrom<20&&(c=Math.max(o.first,l.viewFrom)),l.viewTo>g&&l.viewTo-g<20&&(g=Math.min(a,l.viewTo)),hi&&(c=jo(e.doc,c),g=Ah(e.doc,g));var m=c!=l.viewFrom||g!=l.viewTo||l.lastWrapHeight!=n.wrapperHeight||l.lastWrapWidth!=n.wrapperWidth;Ip(e,c,g),l.viewOffset=fi(Y(e.doc,l.viewFrom)),e.display.mover.style.top=l.viewOffset+"px";var b=jh(e);if(!m&&b==0&&!n.force&&l.renderedView==l.view&&(l.updateLineNumbers==null||l.updateLineNumbers>=l.viewTo))return!1;var x=Zp(e);return b>4&&(l.lineDiv.style.display="none"),$p(e,l.updateLineNumbers,n.dims),b>4&&(l.lineDiv.style.display=""),l.renderedView=l.view,Qp(x),ht(l.cursorDiv),ht(l.selectionDiv),l.gutters.style.height=l.sizer.style.minHeight=0,m&&(l.lastWrapHeight=n.wrapperHeight,l.lastWrapWidth=n.wrapperWidth,vr(e,400)),l.updateLineNumbers=null,!0}function sf(e,n){for(var l=n.viewport,o=!0;;o=!1){if(!o||!e.options.lineWrapping||n.oldDisplayWidth==qi(e)){if(l&&l.top!=null&&(l={top:Math.min(e.doc.height+$o(e.display)-tl(e),l.top)}),n.visible=Ss(e.display,e.doc,l),n.visible.from>=e.display.viewFrom&&n.visible.to<=e.display.viewTo)break}else o&&(n.visible=Ss(e.display,e.doc,l));if(!gl(e,n))break;ws(e);var a=gr(e);cr(e),An(e,a),yl(e,a),n.force=!1}n.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(n.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function ml(e,n){var l=new Cs(e,n);if(gl(e,l)){ws(e),sf(e,l);var o=gr(e);cr(e),An(e,o),yl(e,o),l.finish()}}function $p(e,n,l){var o=e.display,a=e.options.lineNumbers,c=o.lineDiv,g=c.firstChild;function m(O){var E=O.nextSibling;return y&&_&&e.display.currentWheelTarget==O?O.style.display="none":O.parentNode.removeChild(O),E}for(var b=o.view,x=o.viewFrom,k=0;k<b.length;k++){var C=b[k];if(!C.hidden)if(!C.node||C.node.parentNode!=c){var L=Mp(e,C,x,l);c.insertBefore(L,g)}else{for(;g!=C.node;)g=m(g);var T=a&&n!=null&&n<=x&&C.lineNumber;C.changes&&(Xt(C.changes,"gutter")>-1&&(T=!1),Dh(e,C,x,l)),T&&(ht(C.lineNumber),C.lineNumber.appendChild(document.createTextNode(Uo(e.options,x)))),g=C.node.nextSibling}x+=C.size}for(;g;)g=m(g)}function vl(e){var n=e.gutters.offsetWidth;e.sizer.style.marginLeft=n+"px",zt(e,"gutterChanged",e)}function yl(e,n){e.display.sizer.style.minHeight=n.docHeight+"px",e.display.heightForcer.style.top=n.docHeight+"px",e.display.gutters.style.height=n.docHeight+e.display.barHeight+Ye(e)+"px"}function of(e){var n=e.display,l=n.view;if(!(!n.alignWidgets&&(!n.gutters.firstChild||!e.options.fixedGutter))){for(var o=ll(n)-n.scroller.scrollLeft+e.doc.scrollLeft,a=n.gutters.offsetWidth,c=o+"px",g=0;g<l.length;g++)if(!l[g].hidden){e.options.fixedGutter&&(l[g].gutter&&(l[g].gutter.style.left=c),l[g].gutterBackground&&(l[g].gutterBackground.style.left=c));var m=l[g].alignable;if(m)for(var b=0;b<m.length;b++)m[b].style.left=c}e.options.fixedGutter&&(n.gutters.style.left=o+a+"px")}}function lf(e){if(!e.options.lineNumbers)return!1;var n=e.doc,l=Uo(e.options,n.first+n.size-1),o=e.display;if(l.length!=o.lineNumChars){var a=o.measure.appendChild(V("div",[V("div",l)],"CodeMirror-linenumber CodeMirror-gutter-elt")),c=a.firstChild.offsetWidth,g=a.offsetWidth-c;return o.lineGutter.style.width="",o.lineNumInnerWidth=Math.max(c,o.lineGutter.offsetWidth-g)+1,o.lineNumWidth=o.lineNumInnerWidth+g,o.lineNumChars=o.lineNumInnerWidth?l.length:-1,o.lineGutter.style.width=o.lineNumWidth+"px",vl(e.display),!0}return!1}function bl(e,n){for(var l=[],o=!1,a=0;a<e.length;a++){var c=e[a],g=null;if(typeof c!="string"&&(g=c.style,c=c.className),c=="CodeMirror-linenumbers")if(n)o=!0;else continue;l.push({className:c,style:g})}return n&&!o&&l.push({className:"CodeMirror-linenumbers",style:null}),l}function af(e){var n=e.gutters,l=e.gutterSpecs;ht(n),e.lineGutter=null;for(var o=0;o<l.length;++o){var a=l[o],c=a.className,g=a.style,m=n.appendChild(V("div",null,"CodeMirror-gutter "+c));g&&(m.style.cssText=g),c=="CodeMirror-linenumbers"&&(e.lineGutter=m,m.style.width=(e.lineNumWidth||1)+"px")}n.style.display=l.length?"":"none",vl(e)}function yr(e){af(e.display),fe(e),of(e)}function tg(e,n,l,o){var a=this;this.input=l,a.scrollbarFiller=V("div",null,"CodeMirror-scrollbar-filler"),a.scrollbarFiller.setAttribute("cm-not-content","true"),a.gutterFiller=V("div",null,"CodeMirror-gutter-filler"),a.gutterFiller.setAttribute("cm-not-content","true"),a.lineDiv=ae("div",null,"CodeMirror-code"),a.selectionDiv=V("div",null,null,"position: relative; z-index: 1"),a.cursorDiv=V("div",null,"CodeMirror-cursors"),a.measure=V("div",null,"CodeMirror-measure"),a.lineMeasure=V("div",null,"CodeMirror-measure"),a.lineSpace=ae("div",[a.measure,a.lineMeasure,a.selectionDiv,a.cursorDiv,a.lineDiv],null,"position: relative; outline: none");var c=ae("div",[a.lineSpace],"CodeMirror-lines");a.mover=V("div",[c],null,"position: relative"),a.sizer=V("div",[a.mover],"CodeMirror-sizer"),a.sizerWidth=null,a.heightForcer=V("div",null,null,"position: absolute; height: "+$a+"px; width: 1px;"),a.gutters=V("div",null,"CodeMirror-gutters"),a.lineGutter=null,a.scroller=V("div",[a.sizer,a.heightForcer,a.gutters],"CodeMirror-scroll"),a.scroller.setAttribute("tabIndex","-1"),a.wrapper=V("div",[a.scrollbarFiller,a.gutterFiller,a.scroller],"CodeMirror"),S&&A>=105&&(a.wrapper.style.clipPath="inset(0px)"),a.wrapper.setAttribute("translate","no"),p&&v<8&&(a.gutters.style.zIndex=-1,a.scroller.style.paddingRight=0),!y&&!(s&&J)&&(a.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(a.wrapper):e(a.wrapper)),a.viewFrom=a.viewTo=n.first,a.reportedViewFrom=a.reportedViewTo=n.first,a.view=[],a.renderedView=null,a.externalMeasured=null,a.viewOffset=0,a.lastWrapHeight=a.lastWrapWidth=0,a.updateLineNumbers=null,a.nativeBarWidth=a.barHeight=a.barWidth=0,a.scrollbarsClipped=!1,a.lineNumWidth=a.lineNumInnerWidth=a.lineNumChars=null,a.alignWidgets=!1,a.cachedCharWidth=a.cachedTextHeight=a.cachedPaddingH=null,a.maxLine=null,a.maxLineLength=0,a.maxLineChanged=!1,a.wheelDX=a.wheelDY=a.wheelStartX=a.wheelStartY=null,a.shift=!1,a.selForContextMenu=null,a.activeTouch=null,a.gutterSpecs=bl(o.gutters,o.lineNumbers),af(a),l.init(a)}var As=0,ci=null;p?ci=-.53:s?ci=15:S?ci=-.7:D&&(ci=-1/3);function hf(e){var n=e.wheelDeltaX,l=e.wheelDeltaY;return n==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(n=e.detail),l==null&&e.detail&&e.axis==e.VERTICAL_AXIS?l=e.detail:l==null&&(l=e.wheelDelta),{x:n,y:l}}function eg(e){var n=hf(e);return n.x*=ci,n.y*=ci,n}function ff(e,n){S&&A==102&&(e.display.chromeScrollHack==null?e.display.sizer.style.pointerEvents="none":clearTimeout(e.display.chromeScrollHack),e.display.chromeScrollHack=setTimeout(function(){e.display.chromeScrollHack=null,e.display.sizer.style.pointerEvents=""},100));var l=hf(n),o=l.x,a=l.y,c=ci;n.deltaMode===0&&(o=n.deltaX,a=n.deltaY,c=1);var g=e.display,m=g.scroller,b=m.scrollWidth>m.clientWidth,x=m.scrollHeight>m.clientHeight;if(o&&b||a&&x){if(a&&_&&y){t:for(var k=n.target,C=g.view;k!=m;k=k.parentNode)for(var L=0;L<C.length;L++)if(C[L].node==k){e.display.currentWheelTarget=k;break t}}if(o&&!s&&!M&&c!=null){a&&x&&pr(e,Math.max(0,m.scrollTop+a*c)),Ji(e,Math.max(0,m.scrollLeft+o*c)),(!a||a&&x)&&he(n),g.wheelStartX=null;return}if(a&&c!=null){var T=a*c,O=e.doc.scrollTop,E=O+g.wrapper.clientHeight;T<0?O=Math.max(0,O+T-50):E=Math.min(e.doc.height,E+T+50),ml(e,{top:O,bottom:E})}As<20&&n.deltaMode!==0&&(g.wheelStartX==null?(g.wheelStartX=m.scrollLeft,g.wheelStartY=m.scrollTop,g.wheelDX=o,g.wheelDY=a,setTimeout(function(){if(g.wheelStartX!=null){var R=m.scrollLeft-g.wheelStartX,I=m.scrollTop-g.wheelStartY,F=I&&g.wheelDY&&I/g.wheelDY||R&&g.wheelDX&&R/g.wheelDX;g.wheelStartX=g.wheelStartY=null,F&&(ci=(ci*As+F)/(As+1),++As)}},200)):(g.wheelDX+=o,g.wheelDY+=a))}}var Me=function(e,n){this.ranges=e,this.primIndex=n};Me.prototype.primary=function(){return this.ranges[this.primIndex]},Me.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var n=0;n<this.ranges.length;n++){var l=this.ranges[n],o=e.ranges[n];if(!Vo(l.anchor,o.anchor)||!Vo(l.head,o.head))return!1}return!0},Me.prototype.deepCopy=function(){for(var e=[],n=0;n<this.ranges.length;n++)e[n]=new ft(Go(this.ranges[n].anchor),Go(this.ranges[n].head));return new Me(e,this.primIndex)},Me.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},Me.prototype.contains=function(e,n){n||(n=e);for(var l=0;l<this.ranges.length;l++){var o=this.ranges[l];if(it(n,o.from())>=0&&it(e,o.to())<=0)return l}return-1};var ft=function(e,n){this.anchor=e,this.head=n};ft.prototype.from=function(){return as(this.anchor,this.head)},ft.prototype.to=function(){return ls(this.anchor,this.head)},ft.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function Fe(e,n,l){var o=e&&e.options.selectionsMayTouch,a=n[l];n.sort(function(L,T){return it(L.from(),T.from())}),l=Xt(n,a);for(var c=1;c<n.length;c++){var g=n[c],m=n[c-1],b=it(m.to(),g.from());if(o&&!g.empty()?b>0:b>=0){var x=as(m.from(),g.from()),k=ls(m.to(),g.to()),C=m.empty()?g.from()==g.head:m.from()==m.head;c<=l&&--l,n.splice(--c,2,new ft(C?k:x,C?x:k))}}return new Me(n,l)}function Ci(e,n){return new Me([new ft(e,n||e)],0)}function Ai(e){return e.text?B(e.from.line+e.text.length-1,ct(e.text).length+(e.text.length==1?e.from.ch:0)):e.to}function uf(e,n){if(it(e,n.from)<0)return e;if(it(e,n.to)<=0)return Ai(n);var l=e.line+n.text.length-(n.to.line-n.from.line)-1,o=e.ch;return e.line==n.to.line&&(o+=Ai(n).ch-n.to.ch),B(l,o)}function xl(e,n){for(var l=[],o=0;o<e.sel.ranges.length;o++){var a=e.sel.ranges[o];l.push(new ft(uf(a.anchor,n),uf(a.head,n)))}return Fe(e.cm,l,e.sel.primIndex)}function cf(e,n,l){return e.line==n.line?B(l.line,e.ch-n.ch+l.ch):B(l.line+(e.line-n.line),e.ch)}function ig(e,n,l){for(var o=[],a=B(e.first,0),c=a,g=0;g<n.length;g++){var m=n[g],b=cf(m.from,a,c),x=cf(Ai(m),a,c);if(a=m.to,c=x,l=="around"){var k=e.sel.ranges[g],C=it(k.head,k.anchor)<0;o[g]=new ft(C?x:b,C?b:x)}else o[g]=new ft(b,b)}return new Me(o,e.sel.primIndex)}function wl(e){e.doc.mode=Fo(e.options,e.doc.modeOption),br(e)}function br(e){e.doc.iter(function(n){n.stateAfter&&(n.stateAfter=null),n.styles&&(n.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,vr(e,100),e.state.modeGen++,e.curOp&&fe(e)}function df(e,n){return n.from.ch==0&&n.to.ch==0&&ct(n.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Sl(e,n,l,o){function a(F){return l?l[F]:null}function c(F,W,U){fp(F,W,U,o),zt(F,"change",F,n)}function g(F,W){for(var U=[],Z=F;Z<W;++Z)U.push(new yn(x[Z],a(Z),o));return U}var m=n.from,b=n.to,x=n.text,k=Y(e,m.line),C=Y(e,b.line),L=ct(x),T=a(x.length-1),O=b.line-m.line;if(n.full)e.insert(0,g(0,x.length)),e.remove(x.length,e.size-x.length);else if(df(e,n)){var E=g(0,x.length-1);c(C,C.text,T),O&&e.remove(m.line,O),E.length&&e.insert(m.line,E)}else if(k==C)if(x.length==1)c(k,k.text.slice(0,m.ch)+L+k.text.slice(b.ch),T);else{var R=g(1,x.length-1);R.push(new yn(L+k.text.slice(b.ch),T,o)),c(k,k.text.slice(0,m.ch)+x[0],a(0)),e.insert(m.line+1,R)}else if(x.length==1)c(k,k.text.slice(0,m.ch)+x[0]+C.text.slice(b.ch),a(0)),e.remove(m.line+1,O);else{c(k,k.text.slice(0,m.ch)+x[0],a(0)),c(C,L+C.text.slice(b.ch),T);var I=g(1,x.length-1);O>1&&e.remove(m.line+1,O-1),e.insert(m.line+1,I)}zt(e,"change",e,n)}function Mi(e,n,l){function o(a,c,g){if(a.linked)for(var m=0;m<a.linked.length;++m){var b=a.linked[m];if(b.doc!=c){var x=g&&b.sharedHist;l&&!x||(n(b.doc,x),o(b.doc,a,x))}}}o(e,null,!0)}function pf(e,n){if(n.cm)throw new Error("This document is already in use.");e.doc=n,n.cm=e,al(e),wl(e),gf(e),e.options.direction=n.direction,e.options.lineWrapping||Zo(e),e.options.mode=n.modeOption,fe(e)}function gf(e){(e.doc.direction=="rtl"?Ve:tt)(e.display.lineDiv,"CodeMirror-rtl")}function ng(e){be(e,function(){gf(e),fe(e)})}function Ms(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function kl(e,n){var l={from:Go(n.from),to:Ai(n),text:Gi(e,n.from,n.to)};return yf(e,l,n.from.line,n.to.line+1),Mi(e,function(o){return yf(o,l,n.from.line,n.to.line+1)},!0),l}function mf(e){for(;e.length;){var n=ct(e);if(n.ranges)e.pop();else break}}function rg(e,n){if(n)return mf(e.done),ct(e.done);if(e.done.length&&!ct(e.done).ranges)return ct(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),ct(e.done)}function vf(e,n,l,o){var a=e.history;a.undone.length=0;var c=+new Date,g,m;if((a.lastOp==o||a.lastOrigin==n.origin&&n.origin&&(n.origin.charAt(0)=="+"&&a.lastModTime>c-(e.cm?e.cm.options.historyEventDelay:500)||n.origin.charAt(0)=="*"))&&(g=rg(a,a.lastOp==o)))m=ct(g.changes),it(n.from,n.to)==0&&it(n.from,m.to)==0?m.to=Ai(n):g.changes.push(kl(e,n));else{var b=ct(a.done);for((!b||!b.ranges)&&Ts(e.sel,a.done),g={changes:[kl(e,n)],generation:a.generation},a.done.push(g);a.done.length>a.undoDepth;)a.done.shift(),a.done[0].ranges||a.done.shift()}a.done.push(l),a.generation=++a.maxGeneration,a.lastModTime=a.lastSelTime=c,a.lastOp=a.lastSelOp=o,a.lastOrigin=a.lastSelOrigin=n.origin,m||Ot(e,"historyAdded")}function sg(e,n,l,o){var a=n.charAt(0);return a=="*"||a=="+"&&l.ranges.length==o.ranges.length&&l.somethingSelected()==o.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function og(e,n,l,o){var a=e.history,c=o&&o.origin;l==a.lastSelOp||c&&a.lastSelOrigin==c&&(a.lastModTime==a.lastSelTime&&a.lastOrigin==c||sg(e,c,ct(a.done),n))?a.done[a.done.length-1]=n:Ts(n,a.done),a.lastSelTime=+new Date,a.lastSelOrigin=c,a.lastSelOp=l,o&&o.clearRedo!==!1&&mf(a.undone)}function Ts(e,n){var l=ct(n);l&&l.ranges&&l.equals(e)||n.push(e)}function yf(e,n,l,o){var a=n["spans_"+e.id],c=0;e.iter(Math.max(e.first,l),Math.min(e.first+e.size,o),function(g){g.markedSpans&&((a||(a=n["spans_"+e.id]={}))[c]=g.markedSpans),++c})}function lg(e){if(!e)return null;for(var n,l=0;l<e.length;++l)e[l].marker.explicitlyCleared?n||(n=e.slice(0,l)):n&&n.push(e[l]);return n?n.length?n:null:e}function ag(e,n){var l=n["spans_"+e.id];if(!l)return null;for(var o=[],a=0;a<n.text.length;++a)o.push(lg(l[a]));return o}function bf(e,n){var l=ag(e,n),o=Yo(e,n);if(!l)return o;if(!o)return l;for(var a=0;a<l.length;++a){var c=l[a],g=o[a];if(c&&g)t:for(var m=0;m<g.length;++m){for(var b=g[m],x=0;x<c.length;++x)if(c[x].marker==b.marker)continue t;c.push(b)}else g&&(l[a]=g)}return l}function Mn(e,n,l){for(var o=[],a=0;a<e.length;++a){var c=e[a];if(c.ranges){o.push(l?Me.prototype.deepCopy.call(c):c);continue}var g=c.changes,m=[];o.push({changes:m});for(var b=0;b<g.length;++b){var x=g[b],k=void 0;if(m.push({from:x.from,to:x.to,text:x.text}),n)for(var C in x)(k=C.match(/^spans_(\d+)$/))&&Xt(n,Number(k[1]))>-1&&(ct(m)[C]=x[C],delete x[C])}}return o}function Cl(e,n,l,o){if(o){var a=e.anchor;if(l){var c=it(n,a)<0;c!=it(l,a)<0?(a=n,n=l):c!=it(n,l)<0&&(n=l)}return new ft(a,n)}else return new ft(l||n,n)}function Ls(e,n,l,o,a){a==null&&(a=e.cm&&(e.cm.display.shift||e.extend)),jt(e,new Me([Cl(e.sel.primary(),n,l,a)],0),o)}function xf(e,n,l){for(var o=[],a=e.cm&&(e.cm.display.shift||e.extend),c=0;c<e.sel.ranges.length;c++)o[c]=Cl(e.sel.ranges[c],n[c],null,a);var g=Fe(e.cm,o,e.sel.primIndex);jt(e,g,l)}function Al(e,n,l,o){var a=e.sel.ranges.slice(0);a[n]=l,jt(e,Fe(e.cm,a,e.sel.primIndex),o)}function wf(e,n,l,o){jt(e,Ci(n,l),o)}function hg(e,n,l){var o={ranges:n.ranges,update:function(a){this.ranges=[];for(var c=0;c<a.length;c++)this.ranges[c]=new ft(nt(e,a[c].anchor),nt(e,a[c].head))},origin:l&&l.origin};return Ot(e,"beforeSelectionChange",e,o),e.cm&&Ot(e.cm,"beforeSelectionChange",e.cm,o),o.ranges!=n.ranges?Fe(e.cm,o.ranges,o.ranges.length-1):n}function Sf(e,n,l){var o=e.history.done,a=ct(o);a&&a.ranges?(o[o.length-1]=n,Os(e,n,l)):jt(e,n,l)}function jt(e,n,l){Os(e,n,l),og(e,e.sel,e.cm?e.cm.curOp.id:NaN,l)}function Os(e,n,l){(De(e,"beforeSelectionChange")||e.cm&&De(e.cm,"beforeSelectionChange"))&&(n=hg(e,n,l));var o=l&&l.bias||(it(n.primary().head,e.sel.primary().head)<0?-1:1);kf(e,Af(e,n,o,!0)),!(l&&l.scroll===!1)&&e.cm&&e.cm.getOption("readOnly")!="nocursor"&&Cn(e.cm)}function kf(e,n){n.equals(e.sel)||(e.sel=n,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,sh(e.cm)),zt(e,"cursorActivity",e))}function Cf(e){kf(e,Af(e,e.sel,null,!1))}function Af(e,n,l,o){for(var a,c=0;c<n.ranges.length;c++){var g=n.ranges[c],m=n.ranges.length==e.sel.ranges.length&&e.sel.ranges[c],b=Ds(e,g.anchor,m&&m.anchor,l,o),x=g.head==g.anchor?b:Ds(e,g.head,m&&m.head,l,o);(a||b!=g.anchor||x!=g.head)&&(a||(a=n.ranges.slice(0,c)),a[c]=new ft(b,x))}return a?Fe(e.cm,a,n.primIndex):n}function Tn(e,n,l,o,a){var c=Y(e,n.line);if(c.markedSpans)for(var g=0;g<c.markedSpans.length;++g){var m=c.markedSpans[g],b=m.marker,x="selectLeft"in b?!b.selectLeft:b.inclusiveLeft,k="selectRight"in b?!b.selectRight:b.inclusiveRight;if((m.from==null||(x?m.from<=n.ch:m.from<n.ch))&&(m.to==null||(k?m.to>=n.ch:m.to>n.ch))){if(a&&(Ot(b,"beforeCursorEnter"),b.explicitlyCleared))if(c.markedSpans){--g;continue}else break;if(!b.atomic)continue;if(l){var C=b.find(o<0?1:-1),L=void 0;if((o<0?k:x)&&(C=Mf(e,C,-o,C&&C.line==n.line?c:null)),C&&C.line==n.line&&(L=it(C,l))&&(o<0?L<0:L>0))return Tn(e,C,n,o,a)}var T=b.find(o<0?-1:1);return(o<0?x:k)&&(T=Mf(e,T,o,T.line==n.line?c:null)),T?Tn(e,T,n,o,a):null}}return n}function Ds(e,n,l,o,a){var c=o||1,g=Tn(e,n,l,c,a)||!a&&Tn(e,n,l,c,!0)||Tn(e,n,l,-c,a)||!a&&Tn(e,n,l,-c,!0);return g||(e.cantEdit=!0,B(e.first,0))}function Mf(e,n,l,o){return l<0&&n.ch==0?n.line>e.first?nt(e,B(n.line-1)):null:l>0&&n.ch==(o||Y(e,n.line)).text.length?n.line<e.first+e.size-1?B(n.line+1,0):null:new B(n.line,n.ch+l)}function Tf(e){e.setSelection(B(e.firstLine(),0),B(e.lastLine()),Ge)}function Lf(e,n,l){var o={canceled:!1,from:n.from,to:n.to,text:n.text,origin:n.origin,cancel:function(){return o.canceled=!0}};return l&&(o.update=function(a,c,g,m){a&&(o.from=nt(e,a)),c&&(o.to=nt(e,c)),g&&(o.text=g),m!==void 0&&(o.origin=m)}),Ot(e,"beforeChange",e,o),e.cm&&Ot(e.cm,"beforeChange",e.cm,o),o.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:o.from,to:o.to,text:o.text,origin:o.origin}}function Ln(e,n,l){if(e.cm){if(!e.cm.curOp)return Kt(e.cm,Ln)(e,n,l);if(e.cm.state.suppressEdits)return}if(!((De(e,"beforeChange")||e.cm&&De(e.cm,"beforeChange"))&&(n=Lf(e,n,!0),!n))){var o=yh&&!l&&op(e,n.from,n.to);if(o)for(var a=o.length-1;a>=0;--a)Of(e,{from:o[a].from,to:o[a].to,text:a?[""]:n.text,origin:n.origin});else Of(e,n)}}function Of(e,n){if(!(n.text.length==1&&n.text[0]==""&&it(n.from,n.to)==0)){var l=xl(e,n);vf(e,n,l,e.cm?e.cm.curOp.id:NaN),xr(e,n,l,Yo(e,n));var o=[];Mi(e,function(a,c){!c&&Xt(o,a.history)==-1&&(Ef(a.history,n),o.push(a.history)),xr(a,n,null,Yo(a,n))})}}function Ns(e,n,l){var o=e.cm&&e.cm.state.suppressEdits;if(!(o&&!l)){for(var a=e.history,c,g=e.sel,m=n=="undo"?a.done:a.undone,b=n=="undo"?a.undone:a.done,x=0;x<m.length&&(c=m[x],!(l?c.ranges&&!c.equals(e.sel):!c.ranges));x++);if(x!=m.length){for(a.lastOrigin=a.lastSelOrigin=null;;)if(c=m.pop(),c.ranges){if(Ts(c,b),l&&!c.equals(e.sel)){jt(e,c,{clearRedo:!1});return}g=c}else if(o){m.push(c);return}else break;var k=[];Ts(g,b),b.push({changes:k,generation:a.generation}),a.generation=c.generation||++a.maxGeneration;for(var C=De(e,"beforeChange")||e.cm&&De(e.cm,"beforeChange"),L=function(E){var R=c.changes[E];if(R.origin=n,C&&!Lf(e,R,!1))return m.length=0,{};k.push(kl(e,R));var I=E?xl(e,R):ct(m);xr(e,R,I,bf(e,R)),!E&&e.cm&&e.cm.scrollIntoView({from:R.from,to:Ai(R)});var F=[];Mi(e,function(W,U){!U&&Xt(F,W.history)==-1&&(Ef(W.history,R),F.push(W.history)),xr(W,R,null,bf(W,R))})},T=c.changes.length-1;T>=0;--T){var O=L(T);if(O)return O.v}}}}function Df(e,n){if(n!=0&&(e.first+=n,e.sel=new Me(rs(e.sel.ranges,function(a){return new ft(B(a.anchor.line+n,a.anchor.ch),B(a.head.line+n,a.head.ch))}),e.sel.primIndex),e.cm)){fe(e.cm,e.first,e.first-n,n);for(var l=e.cm.display,o=l.viewFrom;o<l.viewTo;o++)Si(e.cm,o,"gutter")}}function xr(e,n,l,o){if(e.cm&&!e.cm.curOp)return Kt(e.cm,xr)(e,n,l,o);if(n.to.line<e.first){Df(e,n.text.length-1-(n.to.line-n.from.line));return}if(!(n.from.line>e.lastLine())){if(n.from.line<e.first){var a=n.text.length-1-(e.first-n.from.line);Df(e,a),n={from:B(e.first,0),to:B(n.to.line+a,n.to.ch),text:[ct(n.text)],origin:n.origin}}var c=e.lastLine();n.to.line>c&&(n={from:n.from,to:B(c,Y(e,c).text.length),text:[n.text[0]],origin:n.origin}),n.removed=Gi(e,n.from,n.to),l||(l=xl(e,n)),e.cm?fg(e.cm,n,o):Sl(e,n,o),Os(e,l,Ge),e.cantEdit&&Ds(e,B(e.firstLine(),0))&&(e.cantEdit=!1)}}function fg(e,n,l){var o=e.doc,a=e.display,c=n.from,g=n.to,m=!1,b=c.line;e.options.lineWrapping||(b=gt(We(Y(o,c.line))),o.iter(b,g.line+1,function(T){if(T==a.maxLine)return m=!0,!0})),o.sel.contains(n.from,n.to)>-1&&sh(e),Sl(o,n,l,Xh(e)),e.options.lineWrapping||(o.iter(b,c.line+n.text.length,function(T){var O=ps(T);O>a.maxLineLength&&(a.maxLine=T,a.maxLineLength=O,a.maxLineChanged=!0,m=!1)}),m&&(e.curOp.updateMaxLine=!0)),$d(o,c.line),vr(e,400);var x=n.text.length-(g.line-c.line)-1;n.full?fe(e):c.line==g.line&&n.text.length==1&&!df(e.doc,n)?Si(e,c.line,"text"):fe(e,c.line,g.line+1,x);var k=De(e,"changes"),C=De(e,"change");if(C||k){var L={from:c,to:g,text:n.text,removed:n.removed,origin:n.origin};C&&zt(e,"change",e,L),k&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(L)}e.display.selForContextMenu=null}function On(e,n,l,o,a){var c;o||(o=l),it(o,l)<0&&(c=[o,l],l=c[0],o=c[1]),typeof n=="string"&&(n=e.splitLines(n)),Ln(e,{from:l,to:o,text:n,origin:a})}function Nf(e,n,l,o){l<e.line?e.line+=o:n<e.line&&(e.line=n,e.ch=0)}function Pf(e,n,l,o){for(var a=0;a<e.length;++a){var c=e[a],g=!0;if(c.ranges){c.copied||(c=e[a]=c.deepCopy(),c.copied=!0);for(var m=0;m<c.ranges.length;m++)Nf(c.ranges[m].anchor,n,l,o),Nf(c.ranges[m].head,n,l,o);continue}for(var b=0;b<c.changes.length;++b){var x=c.changes[b];if(l<x.from.line)x.from=B(x.from.line+o,x.from.ch),x.to=B(x.to.line+o,x.to.ch);else if(n<=x.to.line){g=!1;break}}g||(e.splice(0,a+1),a=0)}}function Ef(e,n){var l=n.from.line,o=n.to.line,a=n.text.length-(o-l)-1;Pf(e.done,l,o,a),Pf(e.undone,l,o,a)}function wr(e,n,l,o){var a=n,c=n;return typeof n=="number"?c=Y(e,hh(e,n)):a=gt(n),a==null?null:(o(c,a)&&e.cm&&Si(e.cm,a,l),c)}function Sr(e){this.lines=e,this.parent=null;for(var n=0,l=0;l<e.length;++l)e[l].parent=this,n+=e[l].height;this.height=n}Sr.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,n){for(var l=e,o=e+n;l<o;++l){var a=this.lines[l];this.height-=a.height,up(a),zt(a,"delete")}this.lines.splice(e,n)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,n,l){this.height+=l,this.lines=this.lines.slice(0,e).concat(n).concat(this.lines.slice(e));for(var o=0;o<n.length;++o)n[o].parent=this},iterN:function(e,n,l){for(var o=e+n;e<o;++e)if(l(this.lines[e]))return!0}};function kr(e){this.children=e;for(var n=0,l=0,o=0;o<e.length;++o){var a=e[o];n+=a.chunkSize(),l+=a.height,a.parent=this}this.size=n,this.height=l,this.parent=null}kr.prototype={chunkSize:function(){return this.size},removeInner:function(e,n){this.size-=n;for(var l=0;l<this.children.length;++l){var o=this.children[l],a=o.chunkSize();if(e<a){var c=Math.min(n,a-e),g=o.height;if(o.removeInner(e,c),this.height-=g-o.height,a==c&&(this.children.splice(l--,1),o.parent=null),(n-=c)==0)break;e=0}else e-=a}if(this.size-n<25&&(this.children.length>1||!(this.children[0]instanceof Sr))){var m=[];this.collapse(m),this.children=[new Sr(m)],this.children[0].parent=this}},collapse:function(e){for(var n=0;n<this.children.length;++n)this.children[n].collapse(e)},insertInner:function(e,n,l){this.size+=n.length,this.height+=l;for(var o=0;o<this.children.length;++o){var a=this.children[o],c=a.chunkSize();if(e<=c){if(a.insertInner(e,n,l),a.lines&&a.lines.length>50){for(var g=a.lines.length%25+25,m=g;m<a.lines.length;){var b=new Sr(a.lines.slice(m,m+=25));a.height-=b.height,this.children.splice(++o,0,b),b.parent=this}a.lines=a.lines.slice(0,g),this.maybeSpill()}break}e-=c}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var n=e.children.splice(e.children.length-5,5),l=new kr(n);if(e.parent){e.size-=l.size,e.height-=l.height;var a=Xt(e.parent.children,e);e.parent.children.splice(a+1,0,l)}else{var o=new kr(e.children);o.parent=e,e.children=[o,l],e=o}l.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,n,l){for(var o=0;o<this.children.length;++o){var a=this.children[o],c=a.chunkSize();if(e<c){var g=Math.min(n,c-e);if(a.iterN(e,g,l))return!0;if((n-=g)==0)break;e=0}else e-=c}}};var Cr=function(e,n,l){if(l)for(var o in l)l.hasOwnProperty(o)&&(this[o]=l[o]);this.doc=e,this.node=n};Cr.prototype.clear=function(){var e=this.doc.cm,n=this.line.widgets,l=this.line,o=gt(l);if(!(o==null||!n)){for(var a=0;a<n.length;++a)n[a]==this&&n.splice(a--,1);n.length||(l.widgets=null);var c=fr(this);_e(l,Math.max(0,l.height-c)),e&&(be(e,function(){Bf(e,l,-c),Si(e,o,"widget")}),zt(e,"lineWidgetCleared",e,this,o))}},Cr.prototype.changed=function(){var e=this,n=this.height,l=this.doc.cm,o=this.line;this.height=null;var a=fr(this)-n;a&&(wi(this.doc,o)||_e(o,o.height+a),l&&be(l,function(){l.curOp.forceUpdate=!0,Bf(l,o,a),zt(l,"lineWidgetChanged",l,e,gt(o))}))},gn(Cr);function Bf(e,n,l){fi(n)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&pl(e,l)}function ug(e,n,l,o){var a=new Cr(e,l,o),c=e.cm;return c&&a.noHScroll&&(c.display.alignWidgets=!0),wr(e,n,"widget",function(g){var m=g.widgets||(g.widgets=[]);if(a.insertAt==null?m.push(a):m.splice(Math.min(m.length,Math.max(0,a.insertAt)),0,a),a.line=g,c&&!wi(e,g)){var b=fi(g)<e.scrollTop;_e(g,g.height+fr(a)),b&&pl(c,a.height),c.curOp.forceUpdate=!0}return!0}),c&&zt(c,"lineWidgetAdded",c,a,typeof n=="number"?n:gt(n)),a}var Rf=0,Ti=function(e,n){this.lines=[],this.type=n,this.doc=e,this.id=++Rf};Ti.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,n=e&&!e.curOp;if(n&&Qi(e),De(this,"clear")){var l=this.find();l&&zt(this,"clear",l.from,l.to)}for(var o=null,a=null,c=0;c<this.lines.length;++c){var g=this.lines[c],m=lr(g.markedSpans,this);e&&!this.collapsed?Si(e,gt(g),"text"):e&&(m.to!=null&&(a=gt(g)),m.from!=null&&(o=gt(g))),g.markedSpans=ip(g.markedSpans,m),m.from==null&&this.collapsed&&!wi(this.doc,g)&&e&&_e(g,wn(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var b=0;b<this.lines.length;++b){var x=We(this.lines[b]),k=ps(x);k>e.display.maxLineLength&&(e.display.maxLine=x,e.display.maxLineLength=k,e.display.maxLineChanged=!0)}o!=null&&e&&this.collapsed&&fe(e,o,a+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Cf(e.doc)),e&&zt(e,"markerCleared",e,this,o,a),n&&$i(e),this.parent&&this.parent.clear()}},Ti.prototype.find=function(e,n){e==null&&this.type=="bookmark"&&(e=1);for(var l,o,a=0;a<this.lines.length;++a){var c=this.lines[a],g=lr(c.markedSpans,this);if(g.from!=null&&(l=B(n?c:gt(c),g.from),e==-1))return l;if(g.to!=null&&(o=B(n?c:gt(c),g.to),e==1))return o}return l&&{from:l,to:o}},Ti.prototype.changed=function(){var e=this,n=this.find(-1,!0),l=this,o=this.doc.cm;!n||!o||be(o,function(){var a=n.line,c=gt(n.line),g=el(o,c);if(g&&(zh(g),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,!wi(l.doc,a)&&l.height!=null){var m=l.height;l.height=null;var b=fr(l)-m;b&&_e(a,a.height+b)}zt(o,"markerChanged",o,e)})},Ti.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var n=this.doc.cm.curOp;(!n.maybeHiddenMarkers||Xt(n.maybeHiddenMarkers,this)==-1)&&(n.maybeUnhiddenMarkers||(n.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Ti.prototype.detachLine=function(e){if(this.lines.splice(Xt(this.lines,e),1),!this.lines.length&&this.doc.cm){var n=this.doc.cm.curOp;(n.maybeHiddenMarkers||(n.maybeHiddenMarkers=[])).push(this)}},gn(Ti);function Dn(e,n,l,o,a){if(o&&o.shared)return cg(e,n,l,o,a);if(e.cm&&!e.cm.curOp)return Kt(e.cm,Dn)(e,n,l,o,a);var c=new Ti(e,a),g=it(n,l);if(o&&Ui(o,c,!1),g>0||g==0&&c.clearWhenEmpty!==!1)return c;if(c.replacedWith&&(c.collapsed=!0,c.widgetNode=ae("span",[c.replacedWith],"CodeMirror-widget"),o.handleMouseEvents||c.widgetNode.setAttribute("cm-ignore-events","true"),o.insertLeft&&(c.widgetNode.insertLeft=!0)),c.collapsed){if(Ch(e,n.line,n,l,c)||n.line!=l.line&&Ch(e,l.line,n,l,c))throw new Error("Inserting collapsed marker partially overlapping an existing one");ep()}c.addToHistory&&vf(e,{from:n,to:l,origin:"markText"},e.sel,NaN);var m=n.line,b=e.cm,x;if(e.iter(m,l.line+1,function(C){b&&c.collapsed&&!b.options.lineWrapping&&We(C)==b.display.maxLine&&(x=!0),c.collapsed&&m!=n.line&&_e(C,0),np(C,new fs(c,m==n.line?n.ch:null,m==l.line?l.ch:null),e.cm&&e.cm.curOp),++m}),c.collapsed&&e.iter(n.line,l.line+1,function(C){wi(e,C)&&_e(C,0)}),c.clearOnEnter&&$(c,"beforeCursorEnter",function(){return c.clear()}),c.readOnly&&(tp(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),c.collapsed&&(c.id=++Rf,c.atomic=!0),b){if(x&&(b.curOp.updateMaxLine=!0),c.collapsed)fe(b,n.line,l.line+1);else if(c.className||c.startStyle||c.endStyle||c.css||c.attributes||c.title)for(var k=n.line;k<=l.line;k++)Si(b,k,"text");c.atomic&&Cf(b.doc),zt(b,"markerAdded",b,c)}return c}var Ar=function(e,n){this.markers=e,this.primary=n;for(var l=0;l<e.length;++l)e[l].parent=this};Ar.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();zt(this,"clear")}},Ar.prototype.find=function(e,n){return this.primary.find(e,n)},gn(Ar);function cg(e,n,l,o,a){o=Ui(o),o.shared=!1;var c=[Dn(e,n,l,o,a)],g=c[0],m=o.widgetNode;return Mi(e,function(b){m&&(o.widgetNode=m.cloneNode(!0)),c.push(Dn(b,nt(b,n),nt(b,l),o,a));for(var x=0;x<b.linked.length;++x)if(b.linked[x].isParent)return;g=ct(c)}),new Ar(c,g)}function If(e){return e.findMarks(B(e.first,0),e.clipPos(B(e.lastLine())),function(n){return n.parent})}function dg(e,n){for(var l=0;l<n.length;l++){var o=n[l],a=o.find(),c=e.clipPos(a.from),g=e.clipPos(a.to);if(it(c,g)){var m=Dn(e,c,g,o.primary,o.primary.type);o.markers.push(m),m.parent=o}}}function pg(e){for(var n=function(o){var a=e[o],c=[a.primary.doc];Mi(a.primary.doc,function(b){return c.push(b)});for(var g=0;g<a.markers.length;g++){var m=a.markers[g];Xt(c,m.doc)==-1&&(m.parent=null,a.markers.splice(g--,1))}},l=0;l<e.length;l++)n(l)}var gg=0,ue=function(e,n,l,o,a){if(!(this instanceof ue))return new ue(e,n,l,o,a);l==null&&(l=0),kr.call(this,[new Sr([new yn("",null)])]),this.first=l,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=l;var c=B(l,0);this.sel=Ci(c),this.history=new Ms(null),this.id=++gg,this.modeOption=n,this.lineSep=o,this.direction=a=="rtl"?"rtl":"ltr",this.extend=!1,typeof e=="string"&&(e=this.splitLines(e)),Sl(this,{from:c,to:c,text:e}),jt(this,Ci(c),Ge)};ue.prototype=eh(kr.prototype,{constructor:ue,iter:function(e,n,l){l?this.iterN(e-this.first,n-e,l):this.iterN(this.first,this.first+this.size,e)},insert:function(e,n){for(var l=0,o=0;o<n.length;++o)l+=n[o].height;this.insertInner(e-this.first,n,l)},remove:function(e,n){this.removeInner(e-this.first,n)},getValue:function(e){var n=Ko(this,this.first,this.first+this.size);return e===!1?n:n.join(e||this.lineSeparator())},setValue:Ut(function(e){var n=B(this.first,0),l=this.first+this.size-1;Ln(this,{from:n,to:B(l,Y(this,l).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&dr(this.cm,0,0),jt(this,Ci(n),Ge)}),replaceRange:function(e,n,l,o){n=nt(this,n),l=l?nt(this,l):n,On(this,e,n,l,o)},getRange:function(e,n,l){var o=Gi(this,nt(this,e),nt(this,n));return l===!1?o:l===""?o.join(""):o.join(l||this.lineSeparator())},getLine:function(e){var n=this.getLineHandle(e);return n&&n.text},getLineHandle:function(e){if(sr(this,e))return Y(this,e)},getLineNumber:function(e){return gt(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=Y(this,e)),We(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return nt(this,e)},getCursor:function(e){var n=this.sel.primary(),l;return e==null||e=="head"?l=n.head:e=="anchor"?l=n.anchor:e=="end"||e=="to"||e===!1?l=n.to():l=n.from(),l},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Ut(function(e,n,l){wf(this,nt(this,typeof e=="number"?B(e,n||0):e),null,l)}),setSelection:Ut(function(e,n,l){wf(this,nt(this,e),nt(this,n||e),l)}),extendSelection:Ut(function(e,n,l){Ls(this,nt(this,e),n&&nt(this,n),l)}),extendSelections:Ut(function(e,n){xf(this,fh(this,e),n)}),extendSelectionsBy:Ut(function(e,n){var l=rs(this.sel.ranges,e);xf(this,fh(this,l),n)}),setSelections:Ut(function(e,n,l){if(e.length){for(var o=[],a=0;a<e.length;a++)o[a]=new ft(nt(this,e[a].anchor),nt(this,e[a].head||e[a].anchor));n==null&&(n=Math.min(e.length-1,this.sel.primIndex)),jt(this,Fe(this.cm,o,n),l)}}),addSelection:Ut(function(e,n,l){var o=this.sel.ranges.slice(0);o.push(new ft(nt(this,e),nt(this,n||e))),jt(this,Fe(this.cm,o,o.length-1),l)}),getSelection:function(e){for(var n=this.sel.ranges,l,o=0;o<n.length;o++){var a=Gi(this,n[o].from(),n[o].to());l=l?l.concat(a):a}return e===!1?l:l.join(e||this.lineSeparator())},getSelections:function(e){for(var n=[],l=this.sel.ranges,o=0;o<l.length;o++){var a=Gi(this,l[o].from(),l[o].to());e!==!1&&(a=a.join(e||this.lineSeparator())),n[o]=a}return n},replaceSelection:function(e,n,l){for(var o=[],a=0;a<this.sel.ranges.length;a++)o[a]=e;this.replaceSelections(o,n,l||"+input")},replaceSelections:Ut(function(e,n,l){for(var o=[],a=this.sel,c=0;c<a.ranges.length;c++){var g=a.ranges[c];o[c]={from:g.from(),to:g.to(),text:this.splitLines(e[c]),origin:l}}for(var m=n&&n!="end"&&ig(this,o,n),b=o.length-1;b>=0;b--)Ln(this,o[b]);m?Sf(this,m):this.cm&&Cn(this.cm)}),undo:Ut(function(){Ns(this,"undo")}),redo:Ut(function(){Ns(this,"redo")}),undoSelection:Ut(function(){Ns(this,"undo",!0)}),redoSelection:Ut(function(){Ns(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,n=0,l=0,o=0;o<e.done.length;o++)e.done[o].ranges||++n;for(var a=0;a<e.undone.length;a++)e.undone[a].ranges||++l;return{undo:n,redo:l}},clearHistory:function(){var e=this;this.history=new Ms(this.history),Mi(this,function(n){return n.history=e.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Mn(this.history.done),undone:Mn(this.history.undone)}},setHistory:function(e){var n=this.history=new Ms(this.history);n.done=Mn(e.done.slice(0),null,!0),n.undone=Mn(e.undone.slice(0),null,!0)},setGutterMarker:Ut(function(e,n,l){return wr(this,e,"gutter",function(o){var a=o.gutterMarkers||(o.gutterMarkers={});return a[n]=l,!l&&ih(a)&&(o.gutterMarkers=null),!0})}),clearGutter:Ut(function(e){var n=this;this.iter(function(l){l.gutterMarkers&&l.gutterMarkers[e]&&wr(n,l,"gutter",function(){return l.gutterMarkers[e]=null,ih(l.gutterMarkers)&&(l.gutterMarkers=null),!0})})}),lineInfo:function(e){var n;if(typeof e=="number"){if(!sr(this,e)||(n=e,e=Y(this,e),!e))return null}else if(n=gt(e),n==null)return null;return{line:n,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Ut(function(e,n,l){return wr(this,e,n=="gutter"?"gutter":"class",function(o){var a=n=="text"?"textClass":n=="background"?"bgClass":n=="gutter"?"gutterClass":"wrapClass";if(!o[a])o[a]=l;else{if(st(l).test(o[a]))return!1;o[a]+=" "+l}return!0})}),removeLineClass:Ut(function(e,n,l){return wr(this,e,n=="gutter"?"gutter":"class",function(o){var a=n=="text"?"textClass":n=="background"?"bgClass":n=="gutter"?"gutterClass":"wrapClass",c=o[a];if(c)if(l==null)o[a]=null;else{var g=c.match(st(l));if(!g)return!1;var m=g.index+g[0].length;o[a]=c.slice(0,g.index)+(!g.index||m==c.length?"":" ")+c.slice(m)||null}else return!1;return!0})}),addLineWidget:Ut(function(e,n,l){return ug(this,e,n,l)}),removeLineWidget:function(e){e.clear()},markText:function(e,n,l){return Dn(this,nt(this,e),nt(this,n),l,l&&l.type||"range")},setBookmark:function(e,n){var l={replacedWith:n&&(n.nodeType==null?n.widget:n),insertLeft:n&&n.insertLeft,clearWhenEmpty:!1,shared:n&&n.shared,handleMouseEvents:n&&n.handleMouseEvents};return e=nt(this,e),Dn(this,e,e,l,"bookmark")},findMarksAt:function(e){e=nt(this,e);var n=[],l=Y(this,e.line).markedSpans;if(l)for(var o=0;o<l.length;++o){var a=l[o];(a.from==null||a.from<=e.ch)&&(a.to==null||a.to>=e.ch)&&n.push(a.marker.parent||a.marker)}return n},findMarks:function(e,n,l){e=nt(this,e),n=nt(this,n);var o=[],a=e.line;return this.iter(e.line,n.line+1,function(c){var g=c.markedSpans;if(g)for(var m=0;m<g.length;m++){var b=g[m];!(b.to!=null&&a==e.line&&e.ch>=b.to||b.from==null&&a!=e.line||b.from!=null&&a==n.line&&b.from>=n.ch)&&(!l||l(b.marker))&&o.push(b.marker.parent||b.marker)}++a}),o},getAllMarks:function(){var e=[];return this.iter(function(n){var l=n.markedSpans;if(l)for(var o=0;o<l.length;++o)l[o].from!=null&&e.push(l[o].marker)}),e},posFromIndex:function(e){var n,l=this.first,o=this.lineSeparator().length;return this.iter(function(a){var c=a.text.length+o;if(c>e)return n=e,!0;e-=c,++l}),nt(this,B(l,n))},indexFromPos:function(e){e=nt(this,e);var n=e.ch;if(e.line<this.first||e.ch<0)return 0;var l=this.lineSeparator().length;return this.iter(this.first,e.line,function(o){n+=o.text.length+l}),n},copy:function(e){var n=new ue(Ko(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return n.scrollTop=this.scrollTop,n.scrollLeft=this.scrollLeft,n.sel=this.sel,n.extend=!1,e&&(n.history.undoDepth=this.history.undoDepth,n.setHistory(this.getHistory())),n},linkedDoc:function(e){e||(e={});var n=this.first,l=this.first+this.size;e.from!=null&&e.from>n&&(n=e.from),e.to!=null&&e.to<l&&(l=e.to);var o=new ue(Ko(this,n,l),e.mode||this.modeOption,n,this.lineSep,this.direction);return e.sharedHist&&(o.history=this.history),(this.linked||(this.linked=[])).push({doc:o,sharedHist:e.sharedHist}),o.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],dg(o,If(this)),o},unlinkDoc:function(e){if(e instanceof St&&(e=e.doc),this.linked)for(var n=0;n<this.linked.length;++n){var l=this.linked[n];if(l.doc==e){this.linked.splice(n,1),e.unlinkDoc(this),pg(If(this));break}}if(e.history==this.history){var o=[e.id];Mi(e,function(a){return o.push(a.id)},!0),e.history=new Ms(null),e.history.done=Mn(this.history.done,o),e.history.undone=Mn(this.history.undone,o)}},iterLinkedDocs:function(e){Mi(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Io(e)},lineSeparator:function(){return this.lineSep||`
`},setDirection:Ut(function(e){e!="rtl"&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(n){return n.order=null}),this.cm&&ng(this.cm))})}),ue.prototype.eachLine=ue.prototype.iter;var Wf=0;function mg(e){var n=this;if(Hf(n),!(Ft(n,e)||ui(n.display,e))){he(e),p&&(Wf=+new Date);var l=Xi(n,e,!0),o=e.dataTransfer.files;if(!(!l||n.isReadOnly()))if(o&&o.length&&window.FileReader&&window.File)for(var a=o.length,c=Array(a),g=0,m=function(){++g==a&&Kt(n,function(){l=nt(n.doc,l);var T={from:l,to:l,text:n.doc.splitLines(c.filter(function(O){return O!=null}).join(n.doc.lineSeparator())),origin:"paste"};Ln(n.doc,T),Sf(n.doc,Ci(nt(n.doc,l),nt(n.doc,Ai(T))))})()},b=function(T,O){if(n.options.allowDropFileTypes&&Xt(n.options.allowDropFileTypes,T.type)==-1){m();return}var E=new FileReader;E.onerror=function(){return m()},E.onload=function(){var R=E.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(R)){m();return}c[O]=R,m()},E.readAsText(T)},x=0;x<o.length;x++)b(o[x],x);else{if(n.state.draggingText&&n.doc.sel.contains(l)>-1){n.state.draggingText(e),setTimeout(function(){return n.display.input.focus()},20);return}try{var k=e.dataTransfer.getData("Text");if(k){var C;if(n.state.draggingText&&!n.state.draggingText.copy&&(C=n.listSelections()),Os(n.doc,Ci(l,l)),C)for(var L=0;L<C.length;++L)On(n.doc,"",C[L].anchor,C[L].head,"drag");n.replaceSelection(k,"around","paste"),n.display.input.focus()}}catch{}}}}function vg(e,n){if(p&&(!e.state.draggingText||+new Date-Wf<100)){rr(n);return}if(!(Ft(e,n)||ui(e.display,n))&&(n.dataTransfer.setData("Text",e.getSelection()),n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setDragImage&&!D)){var l=V("img",null,null,"position: fixed; left: 0; top: 0;");l.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",M&&(l.width=l.height=1,e.display.wrapper.appendChild(l),l._top=l.offsetTop),n.dataTransfer.setDragImage(l,0,0),M&&l.parentNode.removeChild(l)}}function yg(e,n){var l=Xi(e,n);if(l){var o=document.createDocumentFragment();hl(e,l,o),e.display.dragCursor||(e.display.dragCursor=V("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),lt(e.display.dragCursor,o)}}function Hf(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Ff(e){if(document.getElementsByClassName){for(var n=document.getElementsByClassName("CodeMirror"),l=[],o=0;o<n.length;o++){var a=n[o].CodeMirror;a&&l.push(a)}l.length&&l[0].operation(function(){for(var c=0;c<l.length;c++)e(l[c])})}}var zf=!1;function bg(){zf||(xg(),zf=!0)}function xg(){var e;$(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,Ff(wg)},100))}),$(window,"blur",function(){return Ff(kn)})}function wg(e){var n=e.display;n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.scrollbarsClipped=!1,e.setSize()}for(var Li={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Mr=0;Mr<10;Mr++)Li[Mr+48]=Li[Mr+96]=String(Mr);for(var Ps=65;Ps<=90;Ps++)Li[Ps]=String.fromCharCode(Ps);for(var Tr=1;Tr<=12;Tr++)Li[Tr+111]=Li[Tr+63235]="F"+Tr;var di={};di.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},di.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},di.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},di.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},di.default=_?di.macDefault:di.pcDefault;function Sg(e){var n=e.split(/-(?!$)/);e=n[n.length-1];for(var l,o,a,c,g=0;g<n.length-1;g++){var m=n[g];if(/^(cmd|meta|m)$/i.test(m))c=!0;else if(/^a(lt)?$/i.test(m))l=!0;else if(/^(c|ctrl|control)$/i.test(m))o=!0;else if(/^s(hift)?$/i.test(m))a=!0;else throw new Error("Unrecognized modifier name: "+m)}return l&&(e="Alt-"+e),o&&(e="Ctrl-"+e),c&&(e="Cmd-"+e),a&&(e="Shift-"+e),e}function kg(e){var n={};for(var l in e)if(e.hasOwnProperty(l)){var o=e[l];if(/^(name|fallthrough|(de|at)tach)$/.test(l))continue;if(o=="..."){delete e[l];continue}for(var a=rs(l.split(" "),Sg),c=0;c<a.length;c++){var g=void 0,m=void 0;c==a.length-1?(m=a.join(" "),g=o):(m=a.slice(0,c+1).join(" "),g="...");var b=n[m];if(!b)n[m]=g;else if(b!=g)throw new Error("Inconsistent bindings for "+m)}delete e[l]}for(var x in n)e[x]=n[x];return e}function Nn(e,n,l,o){n=Es(n);var a=n.call?n.call(e,o):n[e];if(a===!1)return"nothing";if(a==="...")return"multi";if(a!=null&&l(a))return"handled";if(n.fallthrough){if(Object.prototype.toString.call(n.fallthrough)!="[object Array]")return Nn(e,n.fallthrough,l,o);for(var c=0;c<n.fallthrough.length;c++){var g=Nn(e,n.fallthrough[c],l,o);if(g)return g}}}function Kf(e){var n=typeof e=="string"?e:Li[e.keyCode];return n=="Ctrl"||n=="Alt"||n=="Shift"||n=="Mod"}function Uf(e,n,l){var o=e;return n.altKey&&o!="Alt"&&(e="Alt-"+e),(vt?n.metaKey:n.ctrlKey)&&o!="Ctrl"&&(e="Ctrl-"+e),(vt?n.ctrlKey:n.metaKey)&&o!="Mod"&&(e="Cmd-"+e),!l&&n.shiftKey&&o!="Shift"&&(e="Shift-"+e),e}function Vf(e,n){if(M&&e.keyCode==34&&e.char)return!1;var l=Li[e.keyCode];return l==null||e.altGraphKey?!1:(e.keyCode==3&&e.code&&(l=e.code),Uf(l,e,n))}function Es(e){return typeof e=="string"?di[e]:e}function Pn(e,n){for(var l=e.doc.sel.ranges,o=[],a=0;a<l.length;a++){for(var c=n(l[a]);o.length&&it(c.from,ct(o).to)<=0;){var g=o.pop();if(it(g.from,c.from)<0){c.from=g.from;break}}o.push(c)}be(e,function(){for(var m=o.length-1;m>=0;m--)On(e.doc,"",o[m].from,o[m].to,"+delete");Cn(e)})}function Ml(e,n,l){var o=nh(e.text,n+l,l);return o<0||o>e.text.length?null:o}function Tl(e,n,l){var o=Ml(e,n.ch,l);return o==null?null:new B(n.line,o,l<0?"after":"before")}function Ll(e,n,l,o,a){if(e){n.doc.direction=="rtl"&&(a=-a);var c=ai(l,n.doc.direction);if(c){var g=a<0?ct(c):c[0],m=a<0==(g.level==1),b=m?"after":"before",x;if(g.level>0||n.doc.direction=="rtl"){var k=xn(n,l);x=a<0?l.text.length-1:0;var C=Xe(n,k,x).top;x=er(function(L){return Xe(n,k,L).top==C},a<0==(g.level==1)?g.from:g.to-1,x),b=="before"&&(x=Ml(l,x,1))}else x=a<0?g.to:g.from;return new B(o,x,b)}}return new B(o,a<0?l.text.length:0,a<0?"before":"after")}function Cg(e,n,l,o){var a=ai(n,e.doc.direction);if(!a)return Tl(n,l,o);l.ch>=n.text.length?(l.ch=n.text.length,l.sticky="before"):l.ch<=0&&(l.ch=0,l.sticky="after");var c=nr(a,l.ch,l.sticky),g=a[c];if(e.doc.direction=="ltr"&&g.level%2==0&&(o>0?g.to>l.ch:g.from<l.ch))return Tl(n,l,o);var m=function(I,F){return Ml(n,I instanceof B?I.ch:I,F)},b,x=function(I){return e.options.lineWrapping?(b=b||xn(e,n),Yh(e,n,b,I)):{begin:0,end:n.text.length}},k=x(l.sticky=="before"?m(l,-1):l.ch);if(e.doc.direction=="rtl"||g.level==1){var C=g.level==1==o<0,L=m(l,C?1:-1);if(L!=null&&(C?L<=g.to&&L<=k.end:L>=g.from&&L>=k.begin)){var T=C?"before":"after";return new B(l.line,L,T)}}var O=function(I,F,W){for(var U=function(yt,Vt){return Vt?new B(l.line,m(yt,1),"before"):new B(l.line,yt,"after")};I>=0&&I<a.length;I+=F){var Z=a[I],X=F>0==(Z.level!=1),rt=X?W.begin:m(W.end,-1);if(Z.from<=rt&&rt<Z.to||(rt=X?Z.from:m(Z.to,-1),W.begin<=rt&&rt<W.end))return U(rt,X)}},E=O(c+o,o,k);if(E)return E;var R=o>0?k.end:m(k.begin,-1);return R!=null&&!(o>0&&R==n.text.length)&&(E=O(o>0?0:a.length-1,o,x(R)),E)?E:null}var Lr={selectAll:Tf,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Ge)},killLine:function(e){return Pn(e,function(n){if(n.empty()){var l=Y(e.doc,n.head.line).text.length;return n.head.ch==l&&n.head.line<e.lastLine()?{from:n.head,to:B(n.head.line+1,0)}:{from:n.head,to:B(n.head.line,l)}}else return{from:n.from(),to:n.to()}})},deleteLine:function(e){return Pn(e,function(n){return{from:B(n.from().line,0),to:nt(e.doc,B(n.to().line+1,0))}})},delLineLeft:function(e){return Pn(e,function(n){return{from:B(n.from().line,0),to:n.from()}})},delWrappedLineLeft:function(e){return Pn(e,function(n){var l=e.charCoords(n.head,"div").top+5,o=e.coordsChar({left:0,top:l},"div");return{from:o,to:n.from()}})},delWrappedLineRight:function(e){return Pn(e,function(n){var l=e.charCoords(n.head,"div").top+5,o=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:l},"div");return{from:n.from(),to:o}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(B(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(B(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(n){return Gf(e,n.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(n){return _f(e,n.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(n){return Ag(e,n.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(n){var l=e.cursorCoords(n.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:l},"div")},tr)},goLineLeft:function(e){return e.extendSelectionsBy(function(n){var l=e.cursorCoords(n.head,"div").top+5;return e.coordsChar({left:0,top:l},"div")},tr)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(n){var l=e.cursorCoords(n.head,"div").top+5,o=e.coordsChar({left:0,top:l},"div");return o.ch<e.getLine(o.line).search(/\S/)?_f(e,n.head):o},tr)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("	")},insertSoftTab:function(e){for(var n=[],l=e.listSelections(),o=e.options.tabSize,a=0;a<l.length;a++){var c=l[a].from(),g=Oe(e.getLine(c.line),c.ch,o);n.push(Lo(o-g%o))}e.replaceSelections(n)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return be(e,function(){for(var n=e.listSelections(),l=[],o=0;o<n.length;o++)if(n[o].empty()){var a=n[o].head,c=Y(e.doc,a.line).text;if(c){if(a.ch==c.length&&(a=new B(a.line,a.ch-1)),a.ch>0)a=new B(a.line,a.ch+1),e.replaceRange(c.charAt(a.ch-1)+c.charAt(a.ch-2),B(a.line,a.ch-2),a,"+transpose");else if(a.line>e.doc.first){var g=Y(e.doc,a.line-1).text;g&&(a=new B(a.line,1),e.replaceRange(c.charAt(0)+e.doc.lineSeparator()+g.charAt(g.length-1),B(a.line-1,g.length-1),a,"+transpose"))}}l.push(new ft(a,a))}e.setSelections(l)})},newlineAndIndent:function(e){return be(e,function(){for(var n=e.listSelections(),l=n.length-1;l>=0;l--)e.replaceRange(e.doc.lineSeparator(),n[l].anchor,n[l].head,"+input");n=e.listSelections();for(var o=0;o<n.length;o++)e.indentLine(n[o].from().line,null,!0);Cn(e)})},openLine:function(e){return e.replaceSelection(`
`,"start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Gf(e,n){var l=Y(e.doc,n),o=We(l);return o!=l&&(n=gt(o)),Ll(!0,e,o,n,1)}function Ag(e,n){var l=Y(e.doc,n),o=ap(l);return o!=l&&(n=gt(o)),Ll(!0,e,l,n,-1)}function _f(e,n){var l=Gf(e,n.line),o=Y(e.doc,l.line),a=ai(o,e.doc.direction);if(!a||a[0].level==0){var c=Math.max(l.ch,o.text.search(/\S/)),g=n.line==l.line&&n.ch<=c&&n.ch;return B(l.line,g?0:c,l.sticky)}return l}function Bs(e,n,l){if(typeof n=="string"&&(n=Lr[n],!n))return!1;e.display.input.ensurePolled();var o=e.display.shift,a=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),l&&(e.display.shift=!1),a=n(e)!=is}finally{e.display.shift=o,e.state.suppressEdits=!1}return a}function Mg(e,n,l){for(var o=0;o<e.state.keyMaps.length;o++){var a=Nn(n,e.state.keyMaps[o],l,e);if(a)return a}return e.options.extraKeys&&Nn(n,e.options.extraKeys,l,e)||Nn(n,e.options.keyMap,l,e)}var Tg=new xi;function Or(e,n,l,o){var a=e.state.keySeq;if(a){if(Kf(n))return"handled";if(/\'$/.test(n)?e.state.keySeq=null:Tg.set(50,function(){e.state.keySeq==a&&(e.state.keySeq=null,e.display.input.reset())}),qf(e,a+" "+n,l,o))return!0}return qf(e,n,l,o)}function qf(e,n,l,o){var a=Mg(e,n,o);return a=="multi"&&(e.state.keySeq=n),a=="handled"&&zt(e,"keyHandled",e,n,l),(a=="handled"||a=="multi")&&(he(l),fl(e)),!!a}function Yf(e,n){var l=Vf(n,!0);return l?n.shiftKey&&!e.state.keySeq?Or(e,"Shift-"+l,n,function(o){return Bs(e,o,!0)})||Or(e,l,n,function(o){if(typeof o=="string"?/^go[A-Z]/.test(o):o.motion)return Bs(e,o)}):Or(e,l,n,function(o){return Bs(e,o)}):!1}function Lg(e,n,l){return Or(e,"'"+l+"'",n,function(o){return Bs(e,o,!0)})}var Ol=null;function Xf(e){var n=this;if(!(e.target&&e.target!=n.display.input.getField())&&(n.curOp.focus=Bt(ve(n)),!Ft(n,e))){p&&v<11&&e.keyCode==27&&(e.returnValue=!1);var l=e.keyCode;n.display.shift=l==16||e.shiftKey;var o=Yf(n,e);M&&(Ol=o?l:null,!o&&l==88&&!qd&&(_?e.metaKey:e.ctrlKey)&&n.replaceSelection("",null,"cut")),s&&!_&&!o&&l==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),l==18&&!/\bCodeMirror-crosshair\b/.test(n.display.lineDiv.className)&&Og(n)}}function Og(e){var n=e.display.lineDiv;Ve(n,"CodeMirror-crosshair");function l(o){(o.keyCode==18||!o.altKey)&&(tt(n,"CodeMirror-crosshair"),Ae(document,"keyup",l),Ae(document,"mouseover",l))}$(document,"keyup",l),$(document,"mouseover",l)}function jf(e){e.keyCode==16&&(this.doc.sel.shift=!1),Ft(this,e)}function Jf(e){var n=this;if(!(e.target&&e.target!=n.display.input.getField())&&!(ui(n.display,e)||Ft(n,e)||e.ctrlKey&&!e.altKey||_&&e.metaKey)){var l=e.keyCode,o=e.charCode;if(M&&l==Ol){Ol=null,he(e);return}if(!(M&&(!e.which||e.which<10)&&Yf(n,e))){var a=String.fromCharCode(o??l);a!="\b"&&(Lg(n,e,a)||n.display.input.onKeyPress(e))}}}var Dg=400,Dl=function(e,n,l){this.time=e,this.pos=n,this.button=l};Dl.prototype.compare=function(e,n,l){return this.time+Dg>e&&it(n,this.pos)==0&&l==this.button};var Dr,Nr;function Ng(e,n){var l=+new Date;return Nr&&Nr.compare(l,e,n)?(Dr=Nr=null,"triple"):Dr&&Dr.compare(l,e,n)?(Nr=new Dl(l,e,n),Dr=null,"double"):(Dr=new Dl(l,e,n),Nr=null,"single")}function Zf(e){var n=this,l=n.display;if(!(Ft(n,e)||l.activeTouch&&l.input.supportsTouch())){if(l.input.ensurePolled(),l.shift=e.shiftKey,ui(l,e)){y||(l.scroller.draggable=!1,setTimeout(function(){return l.scroller.draggable=!0},100));return}if(!Nl(n,e)){var o=Xi(n,e),a=lh(e),c=o?Ng(o,a):"single";li(n).focus(),a==1&&n.state.selectingText&&n.state.selectingText(e),!(o&&Pg(n,a,o,c,e))&&(a==1?o?Bg(n,o,c,e):Eo(e)==l.scroller&&he(e):a==2?(o&&Ls(n.doc,o),setTimeout(function(){return l.input.focus()},20)):a==3&&(wt?n.display.input.onContextMenu(e):ul(n)))}}}function Pg(e,n,l,o,a){var c="Click";return o=="double"?c="Double"+c:o=="triple"&&(c="Triple"+c),c=(n==1?"Left":n==2?"Middle":"Right")+c,Or(e,Uf(c,a),a,function(g){if(typeof g=="string"&&(g=Lr[g]),!g)return!1;var m=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),m=g(e,l)!=is}finally{e.state.suppressEdits=!1}return m})}function Eg(e,n,l){var o=e.getOption("configureMouse"),a=o?o(e,n,l):{};if(a.unit==null){var c=et?l.shiftKey&&l.metaKey:l.altKey;a.unit=c?"rectangle":n=="single"?"char":n=="double"?"word":"line"}return(a.extend==null||e.doc.extend)&&(a.extend=e.doc.extend||l.shiftKey),a.addNew==null&&(a.addNew=_?l.metaKey:l.ctrlKey),a.moveOnDrag==null&&(a.moveOnDrag=!(_?l.altKey:l.ctrlKey)),a}function Bg(e,n,l,o){p?setTimeout(pn(Zh,e),0):e.curOp.focus=Bt(ve(e));var a=Eg(e,l,o),c=e.doc.sel,g;e.options.dragDrop&&Ud&&!e.isReadOnly()&&l=="single"&&(g=c.contains(n))>-1&&(it((g=c.ranges[g]).from(),n)<0||n.xRel>0)&&(it(g.to(),n)>0||n.xRel<0)?Rg(e,o,n,a):Ig(e,o,n,a)}function Rg(e,n,l,o){var a=e.display,c=!1,g=Kt(e,function(x){y&&(a.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:ul(e)),Ae(a.wrapper.ownerDocument,"mouseup",g),Ae(a.wrapper.ownerDocument,"mousemove",m),Ae(a.scroller,"dragstart",b),Ae(a.scroller,"drop",g),c||(he(x),o.addNew||Ls(e.doc,l,null,null,o.extend),y&&!D||p&&v==9?setTimeout(function(){a.wrapper.ownerDocument.body.focus({preventScroll:!0}),a.input.focus()},20):a.input.focus())}),m=function(x){c=c||Math.abs(n.clientX-x.clientX)+Math.abs(n.clientY-x.clientY)>=10},b=function(){return c=!0};y&&(a.scroller.draggable=!0),e.state.draggingText=g,g.copy=!o.moveOnDrag,$(a.wrapper.ownerDocument,"mouseup",g),$(a.wrapper.ownerDocument,"mousemove",m),$(a.scroller,"dragstart",b),$(a.scroller,"drop",g),e.state.delayingBlurEvent=!0,setTimeout(function(){return a.input.focus()},20),a.scroller.dragDrop&&a.scroller.dragDrop()}function Qf(e,n,l){if(l=="char")return new ft(n,n);if(l=="word")return e.findWordAt(n);if(l=="line")return new ft(B(n.line,0),nt(e.doc,B(n.line+1,0)));var o=l(e,n);return new ft(o.from,o.to)}function Ig(e,n,l,o){p&&ul(e);var a=e.display,c=e.doc;he(n);var g,m,b=c.sel,x=b.ranges;if(o.addNew&&!o.extend?(m=c.sel.contains(l),m>-1?g=x[m]:g=new ft(l,l)):(g=c.sel.primary(),m=c.sel.primIndex),o.unit=="rectangle")o.addNew||(g=new ft(l,l)),l=Xi(e,n,!0,!0),m=-1;else{var k=Qf(e,l,o.unit);o.extend?g=Cl(g,k.anchor,k.head,o.extend):g=k}o.addNew?m==-1?(m=x.length,jt(c,Fe(e,x.concat([g]),m),{scroll:!1,origin:"*mouse"})):x.length>1&&x[m].empty()&&o.unit=="char"&&!o.extend?(jt(c,Fe(e,x.slice(0,m).concat(x.slice(m+1)),0),{scroll:!1,origin:"*mouse"}),b=c.sel):Al(c,m,g,Mo):(m=0,jt(c,new Me([g],0),Mo),b=c.sel);var C=l;function L(W){if(it(C,W)!=0)if(C=W,o.unit=="rectangle"){for(var U=[],Z=e.options.tabSize,X=Oe(Y(c,l.line).text,l.ch,Z),rt=Oe(Y(c,W.line).text,W.ch,Z),yt=Math.min(X,rt),Vt=Math.max(X,rt),Mt=Math.min(l.line,W.line),xe=Math.min(e.lastLine(),Math.max(l.line,W.line));Mt<=xe;Mt++){var ce=Y(c,Mt).text,Nt=To(ce,yt,Z);yt==Vt?U.push(new ft(B(Mt,Nt),B(Mt,Nt))):ce.length>Nt&&U.push(new ft(B(Mt,Nt),B(Mt,To(ce,Vt,Z))))}U.length||U.push(new ft(l,l)),jt(c,Fe(e,b.ranges.slice(0,m).concat(U),m),{origin:"*mouse",scroll:!1}),e.scrollIntoView(W)}else{var de=g,qt=Qf(e,W,o.unit),Rt=de.anchor,Pt;it(qt.anchor,Rt)>0?(Pt=qt.head,Rt=as(de.from(),qt.anchor)):(Pt=qt.anchor,Rt=ls(de.to(),qt.head));var Tt=b.ranges.slice(0);Tt[m]=Wg(e,new ft(nt(c,Rt),Pt)),jt(c,Fe(e,Tt,m),Mo)}}var T=a.wrapper.getBoundingClientRect(),O=0;function E(W){var U=++O,Z=Xi(e,W,!0,o.unit=="rectangle");if(Z)if(it(Z,C)!=0){e.curOp.focus=Bt(ve(e)),L(Z);var X=Ss(a,c);(Z.line>=X.to||Z.line<X.from)&&setTimeout(Kt(e,function(){O==U&&E(W)}),150)}else{var rt=W.clientY<T.top?-20:W.clientY>T.bottom?20:0;rt&&setTimeout(Kt(e,function(){O==U&&(a.scroller.scrollTop+=rt,E(W))}),50)}}function R(W){e.state.selectingText=!1,O=1/0,W&&(he(W),a.input.focus()),Ae(a.wrapper.ownerDocument,"mousemove",I),Ae(a.wrapper.ownerDocument,"mouseup",F),c.history.lastSelOrigin=null}var I=Kt(e,function(W){W.buttons===0||!lh(W)?R(W):E(W)}),F=Kt(e,R);e.state.selectingText=F,$(a.wrapper.ownerDocument,"mousemove",I),$(a.wrapper.ownerDocument,"mouseup",F)}function Wg(e,n){var l=n.anchor,o=n.head,a=Y(e.doc,l.line);if(it(l,o)==0&&l.sticky==o.sticky)return n;var c=ai(a);if(!c)return n;var g=nr(c,l.ch,l.sticky),m=c[g];if(m.from!=l.ch&&m.to!=l.ch)return n;var b=g+(m.from==l.ch==(m.level!=1)?0:1);if(b==0||b==c.length)return n;var x;if(o.line!=l.line)x=(o.line-l.line)*(e.doc.direction=="ltr"?1:-1)>0;else{var k=nr(c,o.ch,o.sticky),C=k-g||(o.ch-l.ch)*(m.level==1?-1:1);k==b-1||k==b?x=C<0:x=C>0}var L=c[b+(x?-1:0)],T=x==(L.level==1),O=T?L.from:L.to,E=T?"after":"before";return l.ch==O&&l.sticky==E?n:new ft(new B(l.line,O,E),o)}function $f(e,n,l,o){var a,c;if(n.touches)a=n.touches[0].clientX,c=n.touches[0].clientY;else try{a=n.clientX,c=n.clientY}catch{return!1}if(a>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;o&&he(n);var g=e.display,m=g.lineDiv.getBoundingClientRect();if(c>m.bottom||!De(e,l))return Po(n);c-=m.top-g.viewOffset;for(var b=0;b<e.display.gutterSpecs.length;++b){var x=g.gutters.childNodes[b];if(x&&x.getBoundingClientRect().right>=a){var k=_i(e.doc,c),C=e.display.gutterSpecs[b];return Ot(e,l,e,k,C.className,n),Po(n)}}}function Nl(e,n){return $f(e,n,"gutterClick",!0)}function tu(e,n){ui(e.display,n)||Hg(e,n)||Ft(e,n,"contextmenu")||wt||e.display.input.onContextMenu(n)}function Hg(e,n){return De(e,"gutterContextMenu")?$f(e,n,"gutterContextMenu",!1):!1}function eu(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),ur(e)}var En={toString:function(){return"CodeMirror.Init"}},iu={},Rs={};function Fg(e){var n=e.optionHandlers;function l(o,a,c,g){e.defaults[o]=a,c&&(n[o]=g?function(m,b,x){x!=En&&c(m,b,x)}:c)}e.defineOption=l,e.Init=En,l("value","",function(o,a){return o.setValue(a)},!0),l("mode",null,function(o,a){o.doc.modeOption=a,wl(o)},!0),l("indentUnit",2,wl,!0),l("indentWithTabs",!1),l("smartIndent",!0),l("tabSize",4,function(o){br(o),ur(o),fe(o)},!0),l("lineSeparator",null,function(o,a){if(o.doc.lineSep=a,!!a){var c=[],g=o.doc.first;o.doc.iter(function(b){for(var x=0;;){var k=b.text.indexOf(a,x);if(k==-1)break;x=k+a.length,c.push(B(g,k))}g++});for(var m=c.length-1;m>=0;m--)On(o.doc,a,c[m],B(c[m].line,c[m].ch+a.length))}}),l("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,function(o,a,c){o.state.specialChars=new RegExp(a.source+(a.test("	")?"":"|	"),"g"),c!=En&&o.refresh()}),l("specialCharPlaceholder",pp,function(o){return o.refresh()},!0),l("electricChars",!0),l("inputStyle",J?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),l("spellcheck",!1,function(o,a){return o.getInputField().spellcheck=a},!0),l("autocorrect",!1,function(o,a){return o.getInputField().autocorrect=a},!0),l("autocapitalize",!1,function(o,a){return o.getInputField().autocapitalize=a},!0),l("rtlMoveVisually",!Q),l("wholeLineUpdateBefore",!0),l("theme","default",function(o){eu(o),yr(o)},!0),l("keyMap","default",function(o,a,c){var g=Es(a),m=c!=En&&Es(c);m&&m.detach&&m.detach(o,g),g.attach&&g.attach(o,m||null)}),l("extraKeys",null),l("configureMouse",null),l("lineWrapping",!1,Kg,!0),l("gutters",[],function(o,a){o.display.gutterSpecs=bl(a,o.options.lineNumbers),yr(o)},!0),l("fixedGutter",!0,function(o,a){o.display.gutters.style.left=a?ll(o.display)+"px":"0",o.refresh()},!0),l("coverGutterNextToScrollbar",!1,function(o){return An(o)},!0),l("scrollbarStyle","native",function(o){rf(o),An(o),o.display.scrollbars.setScrollTop(o.doc.scrollTop),o.display.scrollbars.setScrollLeft(o.doc.scrollLeft)},!0),l("lineNumbers",!1,function(o,a){o.display.gutterSpecs=bl(o.options.gutters,a),yr(o)},!0),l("firstLineNumber",1,yr,!0),l("lineNumberFormatter",function(o){return o},yr,!0),l("showCursorWhenSelecting",!1,cr,!0),l("resetSelectionOnContextMenu",!0),l("lineWiseCopyCut",!0),l("pasteLinesPerSelection",!0),l("selectionsMayTouch",!1),l("readOnly",!1,function(o,a){a=="nocursor"&&(kn(o),o.display.input.blur()),o.display.input.readOnlyChanged(a)}),l("screenReaderLabel",null,function(o,a){a=a===""?null:a,o.display.input.screenReaderLabelChanged(a)}),l("disableInput",!1,function(o,a){a||o.display.input.reset()},!0),l("dragDrop",!0,zg),l("allowDropFileTypes",null),l("cursorBlinkRate",530),l("cursorScrollMargin",0),l("cursorHeight",1,cr,!0),l("singleCursorHeightPerLine",!0,cr,!0),l("workTime",100),l("workDelay",100),l("flattenSpans",!0,br,!0),l("addModeClass",!1,br,!0),l("pollInterval",100),l("undoDepth",200,function(o,a){return o.doc.history.undoDepth=a}),l("historyEventDelay",1250),l("viewportMargin",10,function(o){return o.refresh()},!0),l("maxHighlightLength",1e4,br,!0),l("moveInputWithCursor",!0,function(o,a){a||o.display.input.resetPosition()}),l("tabindex",null,function(o,a){return o.display.input.getField().tabIndex=a||""}),l("autofocus",null),l("direction","ltr",function(o,a){return o.doc.setDirection(a)},!0),l("phrases",null)}function zg(e,n,l){var o=l&&l!=En;if(!n!=!o){var a=e.display.dragFunctions,c=n?$:Ae;c(e.display.scroller,"dragstart",a.start),c(e.display.scroller,"dragenter",a.enter),c(e.display.scroller,"dragover",a.over),c(e.display.scroller,"dragleave",a.leave),c(e.display.scroller,"drop",a.drop)}}function Kg(e){e.options.lineWrapping?(Ve(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(tt(e.display.wrapper,"CodeMirror-wrap"),Zo(e)),al(e),fe(e),ur(e),setTimeout(function(){return An(e)},100)}function St(e,n){var l=this;if(!(this instanceof St))return new St(e,n);this.options=n=n?Ui(n):{},Ui(iu,n,!1);var o=n.value;typeof o=="string"?o=new ue(o,n.mode,null,n.lineSeparator,n.direction):n.mode&&(o.modeOption=n.mode),this.doc=o;var a=new St.inputStyles[n.inputStyle](this),c=this.display=new tg(e,o,a,n);c.wrapper.CodeMirror=this,eu(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),rf(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new xi,keySeq:null,specialChars:null},n.autofocus&&!J&&c.input.focus(),p&&v<11&&setTimeout(function(){return l.display.input.reset(!0)},20),Ug(this),bg(),Qi(this),this.curOp.forceUpdate=!0,pf(this,o),n.autofocus&&!J||this.hasFocus()?setTimeout(function(){l.hasFocus()&&!l.state.focused&&cl(l)},20):kn(this);for(var g in Rs)Rs.hasOwnProperty(g)&&Rs[g](this,n[g],En);lf(this),n.finishInit&&n.finishInit(this);for(var m=0;m<Pl.length;++m)Pl[m](this);$i(this),y&&n.lineWrapping&&getComputedStyle(c.lineDiv).textRendering=="optimizelegibility"&&(c.lineDiv.style.textRendering="auto")}St.defaults=iu,St.optionHandlers=Rs;function Ug(e){var n=e.display;$(n.scroller,"mousedown",Kt(e,Zf)),p&&v<11?$(n.scroller,"dblclick",Kt(e,function(b){if(!Ft(e,b)){var x=Xi(e,b);if(!(!x||Nl(e,b)||ui(e.display,b))){he(b);var k=e.findWordAt(x);Ls(e.doc,k.anchor,k.head)}}})):$(n.scroller,"dblclick",function(b){return Ft(e,b)||he(b)}),$(n.scroller,"contextmenu",function(b){return tu(e,b)}),$(n.input.getField(),"contextmenu",function(b){n.scroller.contains(b.target)||tu(e,b)});var l,o={end:0};function a(){n.activeTouch&&(l=setTimeout(function(){return n.activeTouch=null},1e3),o=n.activeTouch,o.end=+new Date)}function c(b){if(b.touches.length!=1)return!1;var x=b.touches[0];return x.radiusX<=1&&x.radiusY<=1}function g(b,x){if(x.left==null)return!0;var k=x.left-b.left,C=x.top-b.top;return k*k+C*C>20*20}$(n.scroller,"touchstart",function(b){if(!Ft(e,b)&&!c(b)&&!Nl(e,b)){n.input.ensurePolled(),clearTimeout(l);var x=+new Date;n.activeTouch={start:x,moved:!1,prev:x-o.end<=300?o:null},b.touches.length==1&&(n.activeTouch.left=b.touches[0].pageX,n.activeTouch.top=b.touches[0].pageY)}}),$(n.scroller,"touchmove",function(){n.activeTouch&&(n.activeTouch.moved=!0)}),$(n.scroller,"touchend",function(b){var x=n.activeTouch;if(x&&!ui(n,b)&&x.left!=null&&!x.moved&&new Date-x.start<300){var k=e.coordsChar(n.activeTouch,"page"),C;!x.prev||g(x,x.prev)?C=new ft(k,k):!x.prev.prev||g(x,x.prev.prev)?C=e.findWordAt(k):C=new ft(B(k.line,0),nt(e.doc,B(k.line+1,0))),e.setSelection(C.anchor,C.head),e.focus(),he(b)}a()}),$(n.scroller,"touchcancel",a),$(n.scroller,"scroll",function(){n.scroller.clientHeight&&(pr(e,n.scroller.scrollTop),Ji(e,n.scroller.scrollLeft,!0),Ot(e,"scroll",e))}),$(n.scroller,"mousewheel",function(b){return ff(e,b)}),$(n.scroller,"DOMMouseScroll",function(b){return ff(e,b)}),$(n.wrapper,"scroll",function(){return n.wrapper.scrollTop=n.wrapper.scrollLeft=0}),n.dragFunctions={enter:function(b){Ft(e,b)||rr(b)},over:function(b){Ft(e,b)||(yg(e,b),rr(b))},start:function(b){return vg(e,b)},drop:Kt(e,mg),leave:function(b){Ft(e,b)||Hf(e)}};var m=n.input.getField();$(m,"keyup",function(b){return jf.call(e,b)}),$(m,"keydown",Kt(e,Xf)),$(m,"keypress",Kt(e,Jf)),$(m,"focus",function(b){return cl(e,b)}),$(m,"blur",function(b){return kn(e,b)})}var Pl=[];St.defineInitHook=function(e){return Pl.push(e)};function Pr(e,n,l,o){var a=e.doc,c;l==null&&(l="add"),l=="smart"&&(a.mode.indent?c=or(e,n).state:l="prev");var g=e.options.tabSize,m=Y(a,n),b=Oe(m.text,null,g);m.stateAfter&&(m.stateAfter=null);var x=m.text.match(/^\s*/)[0],k;if(!o&&!/\S/.test(m.text))k=0,l="not";else if(l=="smart"&&(k=a.mode.indent(c,m.text.slice(x.length),m.text),k==is||k>150)){if(!o)return;l="prev"}l=="prev"?n>a.first?k=Oe(Y(a,n-1).text,null,g):k=0:l=="add"?k=b+e.options.indentUnit:l=="subtract"?k=b-e.options.indentUnit:typeof l=="number"&&(k=b+l),k=Math.max(0,k);var C="",L=0;if(e.options.indentWithTabs)for(var T=Math.floor(k/g);T;--T)L+=g,C+="	";if(L<k&&(C+=Lo(k-L)),C!=x)return On(a,C,B(n,0),B(n,x.length),"+input"),m.stateAfter=null,!0;for(var O=0;O<a.sel.ranges.length;O++){var E=a.sel.ranges[O];if(E.head.line==n&&E.head.ch<x.length){var R=B(n,x.length);Al(a,O,new ft(R,R));break}}}var ze=null;function Is(e){ze=e}function El(e,n,l,o,a){var c=e.doc;e.display.shift=!1,o||(o=c.sel);var g=+new Date-200,m=a=="paste"||e.state.pasteIncoming>g,b=Io(n),x=null;if(m&&o.ranges.length>1)if(ze&&ze.text.join(`
`)==n){if(o.ranges.length%ze.text.length==0){x=[];for(var k=0;k<ze.text.length;k++)x.push(c.splitLines(ze.text[k]))}}else b.length==o.ranges.length&&e.options.pasteLinesPerSelection&&(x=rs(b,function(I){return[I]}));for(var C=e.curOp.updateInput,L=o.ranges.length-1;L>=0;L--){var T=o.ranges[L],O=T.from(),E=T.to();T.empty()&&(l&&l>0?O=B(O.line,O.ch-l):e.state.overwrite&&!m?E=B(E.line,Math.min(Y(c,E.line).text.length,E.ch+ct(b).length)):m&&ze&&ze.lineWise&&ze.text.join(`
`)==b.join(`
`)&&(O=E=B(O.line,0)));var R={from:O,to:E,text:x?x[L%x.length]:b,origin:a||(m?"paste":e.state.cutIncoming>g?"cut":"+input")};Ln(e.doc,R),zt(e,"inputRead",e,R)}n&&!m&&ru(e,n),Cn(e),e.curOp.updateInput<2&&(e.curOp.updateInput=C),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function nu(e,n){var l=e.clipboardData&&e.clipboardData.getData("Text");if(l)return e.preventDefault(),!n.isReadOnly()&&!n.options.disableInput&&n.hasFocus()&&be(n,function(){return El(n,l,0,null,"paste")}),!0}function ru(e,n){if(!(!e.options.electricChars||!e.options.smartIndent))for(var l=e.doc.sel,o=l.ranges.length-1;o>=0;o--){var a=l.ranges[o];if(!(a.head.ch>100||o&&l.ranges[o-1].head.line==a.head.line)){var c=e.getModeAt(a.head),g=!1;if(c.electricChars){for(var m=0;m<c.electricChars.length;m++)if(n.indexOf(c.electricChars.charAt(m))>-1){g=Pr(e,a.head.line,"smart");break}}else c.electricInput&&c.electricInput.test(Y(e.doc,a.head.line).text.slice(0,a.head.ch))&&(g=Pr(e,a.head.line,"smart"));g&&zt(e,"electricInput",e,a.head.line)}}}function su(e){for(var n=[],l=[],o=0;o<e.doc.sel.ranges.length;o++){var a=e.doc.sel.ranges[o].head.line,c={anchor:B(a,0),head:B(a+1,0)};l.push(c),n.push(e.getRange(c.anchor,c.head))}return{text:n,ranges:l}}function Bl(e,n,l,o){e.setAttribute("autocorrect",l?"on":"off"),e.setAttribute("autocapitalize",o?"on":"off"),e.setAttribute("spellcheck",!!n)}function ou(){var e=V("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),n=V("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return y?e.style.width="1000px":e.setAttribute("wrap","off"),H&&(e.style.border="1px solid black"),n}function Vg(e){var n=e.optionHandlers,l=e.helpers={};e.prototype={constructor:e,focus:function(){li(this).focus(),this.display.input.focus()},setOption:function(o,a){var c=this.options,g=c[o];c[o]==a&&o!="mode"||(c[o]=a,n.hasOwnProperty(o)&&Kt(this,n[o])(this,a,g),Ot(this,"optionChange",this,o))},getOption:function(o){return this.options[o]},getDoc:function(){return this.doc},addKeyMap:function(o,a){this.state.keyMaps[a?"push":"unshift"](Es(o))},removeKeyMap:function(o){for(var a=this.state.keyMaps,c=0;c<a.length;++c)if(a[c]==o||a[c].name==o)return a.splice(c,1),!0},addOverlay:ie(function(o,a){var c=o.token?o:e.getMode(this.options,o);if(c.startState)throw new Error("Overlays may not be stateful.");Wd(this.state.overlays,{mode:c,modeSpec:o,opaque:a&&a.opaque,priority:a&&a.priority||0},function(g){return g.priority}),this.state.modeGen++,fe(this)}),removeOverlay:ie(function(o){for(var a=this.state.overlays,c=0;c<a.length;++c){var g=a[c].modeSpec;if(g==o||typeof o=="string"&&g.name==o){a.splice(c,1),this.state.modeGen++,fe(this);return}}}),indentLine:ie(function(o,a,c){typeof a!="string"&&typeof a!="number"&&(a==null?a=this.options.smartIndent?"smart":"prev":a=a?"add":"subtract"),sr(this.doc,o)&&Pr(this,o,a,c)}),indentSelection:ie(function(o){for(var a=this.doc.sel.ranges,c=-1,g=0;g<a.length;g++){var m=a[g];if(m.empty())m.head.line>c&&(Pr(this,m.head.line,o,!0),c=m.head.line,g==this.doc.sel.primIndex&&Cn(this));else{var b=m.from(),x=m.to(),k=Math.max(c,b.line);c=Math.min(this.lastLine(),x.line-(x.ch?0:1))+1;for(var C=k;C<c;++C)Pr(this,C,o);var L=this.doc.sel.ranges;b.ch==0&&a.length==L.length&&L[g].from().ch>0&&Al(this.doc,g,new ft(b,L[g].to()),Ge)}}}),getTokenAt:function(o,a){return gh(this,o,a)},getLineTokens:function(o,a){return gh(this,B(o),a,!0)},getTokenTypeAt:function(o){o=nt(this.doc,o);var a=ch(this,Y(this.doc,o.line)),c=0,g=(a.length-1)/2,m=o.ch,b;if(m==0)b=a[2];else for(;;){var x=c+g>>1;if((x?a[x*2-1]:0)>=m)g=x;else if(a[x*2+1]<m)c=x+1;else{b=a[x*2+2];break}}var k=b?b.indexOf("overlay "):-1;return k<0?b:k==0?null:b.slice(0,k-1)},getModeAt:function(o){var a=this.doc.mode;return a.innerMode?e.innerMode(a,this.getTokenAt(o).state).mode:a},getHelper:function(o,a){return this.getHelpers(o,a)[0]},getHelpers:function(o,a){var c=[];if(!l.hasOwnProperty(a))return c;var g=l[a],m=this.getModeAt(o);if(typeof m[a]=="string")g[m[a]]&&c.push(g[m[a]]);else if(m[a])for(var b=0;b<m[a].length;b++){var x=g[m[a][b]];x&&c.push(x)}else m.helperType&&g[m.helperType]?c.push(g[m.helperType]):g[m.name]&&c.push(g[m.name]);for(var k=0;k<g._global.length;k++){var C=g._global[k];C.pred(m,this)&&Xt(c,C.val)==-1&&c.push(C.val)}return c},getStateAfter:function(o,a){var c=this.doc;return o=hh(c,o??c.first+c.size-1),or(this,o+1,a).state},cursorCoords:function(o,a){var c,g=this.doc.sel.primary();return o==null?c=g.head:typeof o=="object"?c=nt(this.doc,o):c=o?g.from():g.to(),He(this,c,a||"page")},charCoords:function(o,a){return ys(this,nt(this.doc,o),a||"page")},coordsChar:function(o,a){return o=Gh(this,o,a||"page"),rl(this,o.left,o.top)},lineAtHeight:function(o,a){return o=Gh(this,{top:o,left:0},a||"page").top,_i(this.doc,o+this.display.viewOffset)},heightAtLine:function(o,a,c){var g=!1,m;if(typeof o=="number"){var b=this.doc.first+this.doc.size-1;o<this.doc.first?o=this.doc.first:o>b&&(o=b,g=!0),m=Y(this.doc,o)}else m=o;return vs(this,m,{top:0,left:0},a||"page",c||g).top+(g?this.doc.height-fi(m):0)},defaultTextHeight:function(){return wn(this.display)},defaultCharWidth:function(){return Sn(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(o,a,c,g,m){var b=this.display;o=He(this,nt(this.doc,o));var x=o.bottom,k=o.left;if(a.style.position="absolute",a.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(a),b.sizer.appendChild(a),g=="over")x=o.top;else if(g=="above"||g=="near"){var C=Math.max(b.wrapper.clientHeight,this.doc.height),L=Math.max(b.sizer.clientWidth,b.lineSpace.clientWidth);(g=="above"||o.bottom+a.offsetHeight>C)&&o.top>a.offsetHeight?x=o.top-a.offsetHeight:o.bottom+a.offsetHeight<=C&&(x=o.bottom),k+a.offsetWidth>L&&(k=L-a.offsetWidth)}a.style.top=x+"px",a.style.left=a.style.right="",m=="right"?(k=b.sizer.clientWidth-a.offsetWidth,a.style.right="0px"):(m=="left"?k=0:m=="middle"&&(k=(b.sizer.clientWidth-a.offsetWidth)/2),a.style.left=k+"px"),c&&zp(this,{left:k,top:x,right:k+a.offsetWidth,bottom:x+a.offsetHeight})},triggerOnKeyDown:ie(Xf),triggerOnKeyPress:ie(Jf),triggerOnKeyUp:jf,triggerOnMouseDown:ie(Zf),execCommand:function(o){if(Lr.hasOwnProperty(o))return Lr[o].call(null,this)},triggerElectric:ie(function(o){ru(this,o)}),findPosH:function(o,a,c,g){var m=1;a<0&&(m=-1,a=-a);for(var b=nt(this.doc,o),x=0;x<a&&(b=Rl(this.doc,b,m,c,g),!b.hitSide);++x);return b},moveH:ie(function(o,a){var c=this;this.extendSelectionsBy(function(g){return c.display.shift||c.doc.extend||g.empty()?Rl(c.doc,g.head,o,a,c.options.rtlMoveVisually):o<0?g.from():g.to()},tr)}),deleteH:ie(function(o,a){var c=this.doc.sel,g=this.doc;c.somethingSelected()?g.replaceSelection("",null,"+delete"):Pn(this,function(m){var b=Rl(g,m.head,o,a,!1);return o<0?{from:b,to:m.head}:{from:m.head,to:b}})}),findPosV:function(o,a,c,g){var m=1,b=g;a<0&&(m=-1,a=-a);for(var x=nt(this.doc,o),k=0;k<a;++k){var C=He(this,x,"div");if(b==null?b=C.left:C.left=b,x=lu(this,C,m,c),x.hitSide)break}return x},moveV:ie(function(o,a){var c=this,g=this.doc,m=[],b=!this.display.shift&&!g.extend&&g.sel.somethingSelected();if(g.extendSelectionsBy(function(k){if(b)return o<0?k.from():k.to();var C=He(c,k.head,"div");k.goalColumn!=null&&(C.left=k.goalColumn),m.push(C.left);var L=lu(c,C,o,a);return a=="page"&&k==g.sel.primary()&&pl(c,ys(c,L,"div").top-C.top),L},tr),m.length)for(var x=0;x<g.sel.ranges.length;x++)g.sel.ranges[x].goalColumn=m[x]}),findWordAt:function(o){var a=this.doc,c=Y(a,o.line).text,g=o.ch,m=o.ch;if(c){var b=this.getHelper(o,"wordChars");(o.sticky=="before"||m==c.length)&&g?--g:++m;for(var x=c.charAt(g),k=ss(x,b)?function(C){return ss(C,b)}:/\s/.test(x)?function(C){return/\s/.test(C)}:function(C){return!/\s/.test(C)&&!ss(C)};g>0&&k(c.charAt(g-1));)--g;for(;m<c.length&&k(c.charAt(m));)++m}return new ft(B(o.line,g),B(o.line,m))},toggleOverwrite:function(o){o!=null&&o==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Ve(this.display.cursorDiv,"CodeMirror-overwrite"):tt(this.display.cursorDiv,"CodeMirror-overwrite"),Ot(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Bt(ve(this))},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:ie(function(o,a){dr(this,o,a)}),getScrollInfo:function(){var o=this.display.scroller;return{left:o.scrollLeft,top:o.scrollTop,height:o.scrollHeight-Ye(this)-this.display.barHeight,width:o.scrollWidth-Ye(this)-this.display.barWidth,clientHeight:tl(this),clientWidth:qi(this)}},scrollIntoView:ie(function(o,a){o==null?(o={from:this.doc.sel.primary().head,to:null},a==null&&(a=this.options.cursorScrollMargin)):typeof o=="number"?o={from:B(o,0),to:null}:o.from==null&&(o={from:o,to:null}),o.to||(o.to=o.from),o.margin=a||0,o.from.line!=null?Kp(this,o):$h(this,o.from,o.to,o.margin)}),setSize:ie(function(o,a){var c=this,g=function(b){return typeof b=="number"||/^\d+$/.test(String(b))?b+"px":b};o!=null&&(this.display.wrapper.style.width=g(o)),a!=null&&(this.display.wrapper.style.height=g(a)),this.options.lineWrapping&&Kh(this);var m=this.display.viewFrom;this.doc.iter(m,this.display.viewTo,function(b){if(b.widgets){for(var x=0;x<b.widgets.length;x++)if(b.widgets[x].noHScroll){Si(c,m,"widget");break}}++m}),this.curOp.forceUpdate=!0,Ot(this,"refresh",this)}),operation:function(o){return be(this,o)},startOperation:function(){return Qi(this)},endOperation:function(){return $i(this)},refresh:ie(function(){var o=this.display.cachedTextHeight;fe(this),this.curOp.forceUpdate=!0,ur(this),dr(this,this.doc.scrollLeft,this.doc.scrollTop),vl(this.display),(o==null||Math.abs(o-wn(this.display))>.5||this.options.lineWrapping)&&al(this),Ot(this,"refresh",this)}),swapDoc:ie(function(o){var a=this.doc;return a.cm=null,this.state.selectingText&&this.state.selectingText(),pf(this,o),ur(this),this.display.input.reset(),dr(this,o.scrollLeft,o.scrollTop),this.curOp.forceScroll=!0,zt(this,"swapDoc",this,a),a}),phrase:function(o){var a=this.options.phrases;return a&&Object.prototype.hasOwnProperty.call(a,o)?a[o]:o},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},gn(e),e.registerHelper=function(o,a,c){l.hasOwnProperty(o)||(l[o]=e[o]={_global:[]}),l[o][a]=c},e.registerGlobalHelper=function(o,a,c,g){e.registerHelper(o,a,g),l[o]._global.push({pred:c,val:g})}}function Rl(e,n,l,o,a){var c=n,g=l,m=Y(e,n.line),b=a&&e.direction=="rtl"?-l:l;function x(){var F=n.line+b;return F<e.first||F>=e.first+e.size?!1:(n=new B(F,n.ch,n.sticky),m=Y(e,F))}function k(F){var W;if(o=="codepoint"){var U=m.text.charCodeAt(n.ch+(l>0?0:-1));if(isNaN(U))W=null;else{var Z=l>0?U>=55296&&U<56320:U>=56320&&U<57343;W=new B(n.line,Math.max(0,Math.min(m.text.length,n.ch+l*(Z?2:1))),-l)}}else a?W=Cg(e.cm,m,n,l):W=Tl(m,n,l);if(W==null)if(!F&&x())n=Ll(a,e.cm,m,n.line,b);else return!1;else n=W;return!0}if(o=="char"||o=="codepoint")k();else if(o=="column")k(!0);else if(o=="word"||o=="group")for(var C=null,L=o=="group",T=e.cm&&e.cm.getHelper(n,"wordChars"),O=!0;!(l<0&&!k(!O));O=!1){var E=m.text.charAt(n.ch)||`
`,R=ss(E,T)?"w":L&&E==`
`?"n":!L||/\s/.test(E)?null:"p";if(L&&!O&&!R&&(R="s"),C&&C!=R){l<0&&(l=1,k(),n.sticky="after");break}if(R&&(C=R),l>0&&!k(!O))break}var I=Ds(e,n,c,g,!0);return Vo(c,I)&&(I.hitSide=!0),I}function lu(e,n,l,o){var a=e.doc,c=n.left,g;if(o=="page"){var m=Math.min(e.display.wrapper.clientHeight,li(e).innerHeight||a(e).documentElement.clientHeight),b=Math.max(m-.5*wn(e.display),3);g=(l>0?n.bottom:n.top)+l*b}else o=="line"&&(g=l>0?n.bottom+3:n.top-3);for(var x;x=rl(e,c,g),!!x.outside;){if(l<0?g<=0:g>=a.height){x.hitSide=!0;break}g+=l*5}return x}var mt=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new xi,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};mt.prototype.init=function(e){var n=this,l=this,o=l.cm,a=l.div=e.lineDiv;a.contentEditable=!0,Bl(a,o.options.spellcheck,o.options.autocorrect,o.options.autocapitalize);function c(m){for(var b=m.target;b;b=b.parentNode){if(b==a)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(b.className))break}return!1}$(a,"paste",function(m){!c(m)||Ft(o,m)||nu(m,o)||v<=11&&setTimeout(Kt(o,function(){return n.updateFromDOM()}),20)}),$(a,"compositionstart",function(m){n.composing={data:m.data,done:!1}}),$(a,"compositionupdate",function(m){n.composing||(n.composing={data:m.data,done:!1})}),$(a,"compositionend",function(m){n.composing&&(m.data!=n.composing.data&&n.readFromDOMSoon(),n.composing.done=!0)}),$(a,"touchstart",function(){return l.forceCompositionEnd()}),$(a,"input",function(){n.composing||n.readFromDOMSoon()});function g(m){if(!(!c(m)||Ft(o,m))){if(o.somethingSelected())Is({lineWise:!1,text:o.getSelections()}),m.type=="cut"&&o.replaceSelection("",null,"cut");else if(o.options.lineWiseCopyCut){var b=su(o);Is({lineWise:!0,text:b.text}),m.type=="cut"&&o.operation(function(){o.setSelections(b.ranges,0,Ge),o.replaceSelection("",null,"cut")})}else return;if(m.clipboardData){m.clipboardData.clearData();var x=ze.text.join(`
`);if(m.clipboardData.setData("Text",x),m.clipboardData.getData("Text")==x){m.preventDefault();return}}var k=ou(),C=k.firstChild;Bl(C),o.display.lineSpace.insertBefore(k,o.display.lineSpace.firstChild),C.value=ze.text.join(`
`);var L=Bt(ye(a));_t(C),setTimeout(function(){o.display.lineSpace.removeChild(k),L.focus(),L==a&&l.showPrimarySelection()},50)}}$(a,"copy",g),$(a,"cut",g)},mt.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},mt.prototype.prepareSelection=function(){var e=Jh(this.cm,!1);return e.focus=Bt(ye(this.div))==this.div,e},mt.prototype.showSelection=function(e,n){!e||!this.cm.display.view.length||((e.focus||n)&&this.showPrimarySelection(),this.showMultipleSelections(e))},mt.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},mt.prototype.showPrimarySelection=function(){var e=this.getSelection(),n=this.cm,l=n.doc.sel.primary(),o=l.from(),a=l.to();if(n.display.viewTo==n.display.viewFrom||o.line>=n.display.viewTo||a.line<n.display.viewFrom){e.removeAllRanges();return}var c=Ws(n,e.anchorNode,e.anchorOffset),g=Ws(n,e.focusNode,e.focusOffset);if(!(c&&!c.bad&&g&&!g.bad&&it(as(c,g),o)==0&&it(ls(c,g),a)==0)){var m=n.display.view,b=o.line>=n.display.viewFrom&&au(n,o)||{node:m[0].measure.map[2],offset:0},x=a.line<n.display.viewTo&&au(n,a);if(!x){var k=m[m.length-1].measure,C=k.maps?k.maps[k.maps.length-1]:k.map;x={node:C[C.length-1],offset:C[C.length-2]-C[C.length-3]}}if(!b||!x){e.removeAllRanges();return}var L=e.rangeCount&&e.getRangeAt(0),T;try{T=Se(b.node,b.offset,x.offset,x.node)}catch{}T&&(!s&&n.state.focused?(e.collapse(b.node,b.offset),T.collapsed||(e.removeAllRanges(),e.addRange(T))):(e.removeAllRanges(),e.addRange(T)),L&&e.anchorNode==null?e.addRange(L):s&&this.startGracePeriod()),this.rememberSelection()}},mt.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},mt.prototype.showMultipleSelections=function(e){lt(this.cm.display.cursorDiv,e.cursors),lt(this.cm.display.selectionDiv,e.selection)},mt.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},mt.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var n=e.getRangeAt(0).commonAncestorContainer;return ke(this.div,n)},mt.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||Bt(ye(this.div))!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},mt.prototype.blur=function(){this.div.blur()},mt.prototype.getField=function(){return this.div},mt.prototype.supportsTouch=function(){return!0},mt.prototype.receivedFocus=function(){var e=this,n=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):be(this.cm,function(){return n.cm.curOp.selectionChanged=!0});function l(){n.cm.state.focused&&(n.pollSelection(),n.polling.set(n.cm.options.pollInterval,l))}this.polling.set(this.cm.options.pollInterval,l)},mt.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},mt.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var e=this.getSelection(),n=this.cm;if(q&&S&&this.cm.display.gutterSpecs.length&&Gg(e.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var l=Ws(n,e.anchorNode,e.anchorOffset),o=Ws(n,e.focusNode,e.focusOffset);l&&o&&be(n,function(){jt(n.doc,Ci(l,o),Ge),(l.bad||o.bad)&&(n.curOp.selectionChanged=!0)})}}},mt.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,n=e.display,l=e.doc.sel.primary(),o=l.from(),a=l.to();if(o.ch==0&&o.line>e.firstLine()&&(o=B(o.line-1,Y(e.doc,o.line-1).length)),a.ch==Y(e.doc,a.line).text.length&&a.line<e.lastLine()&&(a=B(a.line+1,0)),o.line<n.viewFrom||a.line>n.viewTo-1)return!1;var c,g,m;o.line==n.viewFrom||(c=ji(e,o.line))==0?(g=gt(n.view[0].line),m=n.view[0].node):(g=gt(n.view[c].line),m=n.view[c-1].node.nextSibling);var b=ji(e,a.line),x,k;if(b==n.view.length-1?(x=n.viewTo-1,k=n.lineDiv.lastChild):(x=gt(n.view[b+1].line)-1,k=n.view[b+1].node.previousSibling),!m)return!1;for(var C=e.doc.splitLines(_g(e,m,k,g,x)),L=Gi(e.doc,B(g,0),B(x,Y(e.doc,x).text.length));C.length>1&&L.length>1;)if(ct(C)==ct(L))C.pop(),L.pop(),x--;else if(C[0]==L[0])C.shift(),L.shift(),g++;else break;for(var T=0,O=0,E=C[0],R=L[0],I=Math.min(E.length,R.length);T<I&&E.charCodeAt(T)==R.charCodeAt(T);)++T;for(var F=ct(C),W=ct(L),U=Math.min(F.length-(C.length==1?T:0),W.length-(L.length==1?T:0));O<U&&F.charCodeAt(F.length-O-1)==W.charCodeAt(W.length-O-1);)++O;if(C.length==1&&L.length==1&&g==o.line)for(;T&&T>o.ch&&F.charCodeAt(F.length-O-1)==W.charCodeAt(W.length-O-1);)T--,O++;C[C.length-1]=F.slice(0,F.length-O).replace(/^\u200b+/,""),C[0]=C[0].slice(T).replace(/\u200b+$/,"");var Z=B(g,T),X=B(x,L.length?ct(L).length-O:0);if(C.length>1||C[0]||it(Z,X))return On(e.doc,C,Z,X,"+input"),!0},mt.prototype.ensurePolled=function(){this.forceCompositionEnd()},mt.prototype.reset=function(){this.forceCompositionEnd()},mt.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},mt.prototype.readFromDOMSoon=function(){var e=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing)if(e.composing.done)e.composing=null;else return;e.updateFromDOM()},80))},mt.prototype.updateFromDOM=function(){var e=this;(this.cm.isReadOnly()||!this.pollContent())&&be(this.cm,function(){return fe(e.cm)})},mt.prototype.setUneditable=function(e){e.contentEditable="false"},mt.prototype.onKeyPress=function(e){e.charCode==0||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Kt(this.cm,El)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0))},mt.prototype.readOnlyChanged=function(e){this.div.contentEditable=String(e!="nocursor")},mt.prototype.onContextMenu=function(){},mt.prototype.resetPosition=function(){},mt.prototype.needsContentAttribute=!0;function au(e,n){var l=el(e,n.line);if(!l||l.hidden)return null;var o=Y(e.doc,n.line),a=Ih(l,o,n.line),c=ai(o,e.doc.direction),g="left";if(c){var m=nr(c,n.ch);g=m%2?"right":"left"}var b=Fh(a.map,n.ch,g);return b.offset=b.collapse=="right"?b.end:b.start,b}function Gg(e){for(var n=e;n;n=n.parentNode)if(/CodeMirror-gutter-wrapper/.test(n.className))return!0;return!1}function Bn(e,n){return n&&(e.bad=!0),e}function _g(e,n,l,o,a){var c="",g=!1,m=e.doc.lineSeparator(),b=!1;function x(T){return function(O){return O.id==T}}function k(){g&&(c+=m,b&&(c+=m),g=b=!1)}function C(T){T&&(k(),c+=T)}function L(T){if(T.nodeType==1){var O=T.getAttribute("cm-text");if(O){C(O);return}var E=T.getAttribute("cm-marker"),R;if(E){var I=e.findMarks(B(o,0),B(a+1,0),x(+E));I.length&&(R=I[0].find(0))&&C(Gi(e.doc,R.from,R.to).join(m));return}if(T.getAttribute("contenteditable")=="false")return;var F=/^(pre|div|p|li|table|br)$/i.test(T.nodeName);if(!/^br$/i.test(T.nodeName)&&T.textContent.length==0)return;F&&k();for(var W=0;W<T.childNodes.length;W++)L(T.childNodes[W]);/^(pre|p)$/i.test(T.nodeName)&&(b=!0),F&&(g=!0)}else T.nodeType==3&&C(T.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;L(n),n!=l;)n=n.nextSibling,b=!1;return c}function Ws(e,n,l){var o;if(n==e.display.lineDiv){if(o=e.display.lineDiv.childNodes[l],!o)return Bn(e.clipPos(B(e.display.viewTo-1)),!0);n=null,l=0}else for(o=n;;o=o.parentNode){if(!o||o==e.display.lineDiv)return null;if(o.parentNode&&o.parentNode==e.display.lineDiv)break}for(var a=0;a<e.display.view.length;a++){var c=e.display.view[a];if(c.node==o)return qg(c,n,l)}}function qg(e,n,l){var o=e.text.firstChild,a=!1;if(!n||!ke(o,n))return Bn(B(gt(e.line),0),!0);if(n==o&&(a=!0,n=o.childNodes[l],l=0,!n)){var c=e.rest?ct(e.rest):e.line;return Bn(B(gt(c),c.text.length),a)}var g=n.nodeType==3?n:null,m=n;for(!g&&n.childNodes.length==1&&n.firstChild.nodeType==3&&(g=n.firstChild,l&&(l=g.nodeValue.length));m.parentNode!=o;)m=m.parentNode;var b=e.measure,x=b.maps;function k(R,I,F){for(var W=-1;W<(x?x.length:0);W++)for(var U=W<0?b.map:x[W],Z=0;Z<U.length;Z+=3){var X=U[Z+2];if(X==R||X==I){var rt=gt(W<0?e.line:e.rest[W]),yt=U[Z]+F;return(F<0||X!=R)&&(yt=U[Z+(F?1:0)]),B(rt,yt)}}}var C=k(g,m,l);if(C)return Bn(C,a);for(var L=m.nextSibling,T=g?g.nodeValue.length-l:0;L;L=L.nextSibling){if(C=k(L,L.firstChild,0),C)return Bn(B(C.line,C.ch-T),a);T+=L.textContent.length}for(var O=m.previousSibling,E=l;O;O=O.previousSibling){if(C=k(O,O.firstChild,-1),C)return Bn(B(C.line,C.ch+E),a);E+=O.textContent.length}}var Lt=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new xi,this.hasSelection=!1,this.composing=null,this.resetting=!1};Lt.prototype.init=function(e){var n=this,l=this,o=this.cm;this.createField(e);var a=this.textarea;e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),H&&(a.style.width="0px"),$(a,"input",function(){p&&v>=9&&n.hasSelection&&(n.hasSelection=null),l.poll()}),$(a,"paste",function(g){Ft(o,g)||nu(g,o)||(o.state.pasteIncoming=+new Date,l.fastPoll())});function c(g){if(!Ft(o,g)){if(o.somethingSelected())Is({lineWise:!1,text:o.getSelections()});else if(o.options.lineWiseCopyCut){var m=su(o);Is({lineWise:!0,text:m.text}),g.type=="cut"?o.setSelections(m.ranges,null,Ge):(l.prevInput="",a.value=m.text.join(`
`),_t(a))}else return;g.type=="cut"&&(o.state.cutIncoming=+new Date)}}$(a,"cut",c),$(a,"copy",c),$(e.scroller,"paste",function(g){if(!(ui(e,g)||Ft(o,g))){if(!a.dispatchEvent){o.state.pasteIncoming=+new Date,l.focus();return}var m=new Event("paste");m.clipboardData=g.clipboardData,a.dispatchEvent(m)}}),$(e.lineSpace,"selectstart",function(g){ui(e,g)||he(g)}),$(a,"compositionstart",function(){var g=o.getCursor("from");l.composing&&l.composing.range.clear(),l.composing={start:g,range:o.markText(g,o.getCursor("to"),{className:"CodeMirror-composing"})}}),$(a,"compositionend",function(){l.composing&&(l.poll(),l.composing.range.clear(),l.composing=null)})},Lt.prototype.createField=function(e){this.wrapper=ou(),this.textarea=this.wrapper.firstChild;var n=this.cm.options;Bl(this.textarea,n.spellcheck,n.autocorrect,n.autocapitalize)},Lt.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},Lt.prototype.prepareSelection=function(){var e=this.cm,n=e.display,l=e.doc,o=Jh(e);if(e.options.moveInputWithCursor){var a=He(e,l.sel.primary().head,"div"),c=n.wrapper.getBoundingClientRect(),g=n.lineDiv.getBoundingClientRect();o.teTop=Math.max(0,Math.min(n.wrapper.clientHeight-10,a.top+g.top-c.top)),o.teLeft=Math.max(0,Math.min(n.wrapper.clientWidth-10,a.left+g.left-c.left))}return o},Lt.prototype.showSelection=function(e){var n=this.cm,l=n.display;lt(l.cursorDiv,e.cursors),lt(l.selectionDiv,e.selection),e.teTop!=null&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Lt.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing&&e)){var n=this.cm;if(this.resetting=!0,n.somethingSelected()){this.prevInput="";var l=n.getSelection();this.textarea.value=l,n.state.focused&&_t(this.textarea),p&&v>=9&&(this.hasSelection=l)}else e||(this.prevInput=this.textarea.value="",p&&v>=9&&(this.hasSelection=null));this.resetting=!1}},Lt.prototype.getField=function(){return this.textarea},Lt.prototype.supportsTouch=function(){return!1},Lt.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!J||Bt(ye(this.textarea))!=this.textarea))try{this.textarea.focus()}catch{}},Lt.prototype.blur=function(){this.textarea.blur()},Lt.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Lt.prototype.receivedFocus=function(){this.slowPoll()},Lt.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},Lt.prototype.fastPoll=function(){var e=!1,n=this;n.pollingFast=!0;function l(){var o=n.poll();!o&&!e?(e=!0,n.polling.set(60,l)):(n.pollingFast=!1,n.slowPoll())}n.polling.set(20,l)},Lt.prototype.poll=function(){var e=this,n=this.cm,l=this.textarea,o=this.prevInput;if(this.contextMenuPending||this.resetting||!n.state.focused||_d(l)&&!o&&!this.composing||n.isReadOnly()||n.options.disableInput||n.state.keySeq)return!1;var a=l.value;if(a==o&&!n.somethingSelected())return!1;if(p&&v>=9&&this.hasSelection===a||_&&/[\uf700-\uf7ff]/.test(a))return n.display.input.reset(),!1;if(n.doc.sel==n.display.selForContextMenu){var c=a.charCodeAt(0);if(c==8203&&!o&&(o="​"),c==8666)return this.reset(),this.cm.execCommand("undo")}for(var g=0,m=Math.min(o.length,a.length);g<m&&o.charCodeAt(g)==a.charCodeAt(g);)++g;return be(n,function(){El(n,a.slice(g),o.length-g,null,e.composing?"*compose":null),a.length>1e3||a.indexOf(`
`)>-1?l.value=e.prevInput="":e.prevInput=a,e.composing&&(e.composing.range.clear(),e.composing.range=n.markText(e.composing.start,n.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Lt.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Lt.prototype.onKeyPress=function(){p&&v>=9&&(this.hasSelection=null),this.fastPoll()},Lt.prototype.onContextMenu=function(e){var n=this,l=n.cm,o=l.display,a=n.textarea;n.contextMenuPending&&n.contextMenuPending();var c=Xi(l,e),g=o.scroller.scrollTop;if(!c||M)return;var m=l.options.resetSelectionOnContextMenu;m&&l.doc.sel.contains(c)==-1&&Kt(l,jt)(l.doc,Ci(c),Ge);var b=a.style.cssText,x=n.wrapper.style.cssText,k=n.wrapper.offsetParent.getBoundingClientRect();n.wrapper.style.cssText="position: static",a.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(e.clientY-k.top-5)+"px; left: "+(e.clientX-k.left-5)+`px;
      z-index: 1000; background: `+(p?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var C;y&&(C=a.ownerDocument.defaultView.scrollY),o.input.focus(),y&&a.ownerDocument.defaultView.scrollTo(null,C),o.input.reset(),l.somethingSelected()||(a.value=n.prevInput=" "),n.contextMenuPending=T,o.selForContextMenu=l.doc.sel,clearTimeout(o.detectingSelectAll);function L(){if(a.selectionStart!=null){var E=l.somethingSelected(),R="​"+(E?a.value:"");a.value="⇚",a.value=R,n.prevInput=E?"":"​",a.selectionStart=1,a.selectionEnd=R.length,o.selForContextMenu=l.doc.sel}}function T(){if(n.contextMenuPending==T&&(n.contextMenuPending=!1,n.wrapper.style.cssText=x,a.style.cssText=b,p&&v<9&&o.scrollbars.setScrollTop(o.scroller.scrollTop=g),a.selectionStart!=null)){(!p||p&&v<9)&&L();var E=0,R=function(){o.selForContextMenu==l.doc.sel&&a.selectionStart==0&&a.selectionEnd>0&&n.prevInput=="​"?Kt(l,Tf)(l):E++<10?o.detectingSelectAll=setTimeout(R,500):(o.selForContextMenu=null,o.input.reset())};o.detectingSelectAll=setTimeout(R,200)}}if(p&&v>=9&&L(),wt){rr(e);var O=function(){Ae(window,"mouseup",O),setTimeout(T,20)};$(window,"mouseup",O)}else setTimeout(T,50)},Lt.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled=e=="nocursor",this.textarea.readOnly=!!e},Lt.prototype.setUneditable=function(){},Lt.prototype.needsContentAttribute=!1;function Yg(e,n){if(n=n?Ui(n):{},n.value=e.value,!n.tabindex&&e.tabIndex&&(n.tabindex=e.tabIndex),!n.placeholder&&e.placeholder&&(n.placeholder=e.placeholder),n.autofocus==null){var l=Bt(ye(e));n.autofocus=l==e||e.getAttribute("autofocus")!=null&&l==document.body}function o(){e.value=m.getValue()}var a;if(e.form&&($(e.form,"submit",o),!n.leaveSubmitMethodAlone)){var c=e.form;a=c.submit;try{var g=c.submit=function(){o(),c.submit=a,c.submit(),c.submit=g}}catch{}}n.finishInit=function(b){b.save=o,b.getTextArea=function(){return e},b.toTextArea=function(){b.toTextArea=isNaN,o(),e.parentNode.removeChild(b.getWrapperElement()),e.style.display="",e.form&&(Ae(e.form,"submit",o),!n.leaveSubmitMethodAlone&&typeof e.form.submit=="function"&&(e.form.submit=a))}},e.style.display="none";var m=St(function(b){return e.parentNode.insertBefore(b,e.nextSibling)},n);return m}function Xg(e){e.off=Ae,e.on=$,e.wheelEventPixels=eg,e.Doc=ue,e.splitLines=Io,e.countColumn=Oe,e.findColumn=To,e.isWordChar=Oo,e.Pass=is,e.signal=Ot,e.Line=yn,e.changeEnd=Ai,e.scrollbarModel=nf,e.Pos=B,e.cmpPos=it,e.modes=Ho,e.mimeModes=mn,e.resolveMode=os,e.getMode=Fo,e.modeExtensions=vn,e.extendMode=Jd,e.copyState=Vi,e.startState=ah,e.innerMode=zo,e.commands=Lr,e.keyMap=di,e.keyName=Vf,e.isModifierKey=Kf,e.lookupKey=Nn,e.normalizeKeyMap=kg,e.StringStream=Dt,e.SharedTextMarker=Ar,e.TextMarker=Ti,e.LineWidget=Cr,e.e_preventDefault=he,e.e_stopPropagation=oh,e.e_stop=rr,e.addClass=Ve,e.contains=ke,e.rmClass=tt,e.keyNames=Li}Fg(St),Vg(St);var jg="iter insert remove copy getEditor constructor".split(" ");for(var Hs in ue.prototype)ue.prototype.hasOwnProperty(Hs)&&Xt(jg,Hs)<0&&(St.prototype[Hs]=function(e){return function(){return e.apply(this.doc,arguments)}}(ue.prototype[Hs]));return gn(ue),St.inputStyles={textarea:Lt,contenteditable:mt},St.defineMode=function(e){!St.defaults.mode&&e!="null"&&(St.defaults.mode=e),Xd.apply(this,arguments)},St.defineMIME=jd,St.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),St.defineMIME("text/plain","null"),St.defineExtension=function(e,n){St.prototype[e]=n},St.defineDocExtension=function(e,n){ue.prototype[e]=n},St.fromTextArea=Yg,Xg(St),St.version="5.65.19",St})})(dc);var h0=dc.exports;let ea=[],pc=[];(()=>{let f="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=0,i=0;t<f.length;t++)(t%2?pc:ea).push(i=i+f[t])})();function f0(f){if(f<768)return!1;for(let t=0,i=ea.length;;){let r=t+i>>1;if(f<ea[r])i=r;else if(f>=pc[r])t=r+1;else return!0;if(t==i)return!1}}function fu(f){return f>=127462&&f<=127487}const uu=8205;function u0(f,t,i=!0,r=!0){return(i?gc:c0)(f,t,r)}function gc(f,t,i){if(t==f.length)return t;t&&mc(f.charCodeAt(t))&&vc(f.charCodeAt(t-1))&&t--;let r=Kl(f,t);for(t+=cu(r);t<f.length;){let s=Kl(f,t);if(r==uu||s==uu||i&&f0(s))t+=cu(s),r=s;else if(fu(s)){let h=0,u=t-2;for(;u>=0&&fu(Kl(f,u));)h++,u-=2;if(h%2==0)break;t+=2}else break}return t}function c0(f,t,i){for(;t>0;){let r=gc(f,t-2,i);if(r<t)return r;t--}return 0}function Kl(f,t){let i=f.charCodeAt(t);if(!vc(i)||t+1==f.length)return i;let r=f.charCodeAt(t+1);return mc(r)?(i-55296<<10)+(r-56320)+65536:i}function mc(f){return f>=56320&&f<57344}function vc(f){return f>=55296&&f<56320}function cu(f){return f<65536?1:2}class dt{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,i,r){[t,i]=Gn(this,t,i);let s=[];return this.decompose(0,t,s,2),r.length&&r.decompose(0,r.length,s,3),this.decompose(i,this.length,s,1),ti.from(s,this.length-(i-t)+r.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,i=this.length){[t,i]=Gn(this,t,i);let r=[];return this.decompose(t,i,r,0),ti.from(r,i-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let i=this.scanIdentical(t,1),r=this.length-this.scanIdentical(t,-1),s=new Ur(this),h=new Ur(t);for(let u=i,d=i;;){if(s.next(u),h.next(u),u=0,s.lineBreak!=h.lineBreak||s.done!=h.done||s.value!=h.value)return!1;if(d+=s.value.length,s.done||d>=r)return!0}}iter(t=1){return new Ur(this,t)}iterRange(t,i=this.length){return new yc(this,t,i)}iterLines(t,i){let r;if(t==null)r=this.iter();else{i==null&&(i=this.lines+1);let s=this.line(t).from;r=this.iterRange(s,Math.max(s,i==this.lines+1?this.length:i<=1?0:this.line(i-1).to))}return new bc(r)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?dt.empty:t.length<=32?new Et(t):ti.from(Et.split(t,[]))}}class Et extends dt{constructor(t,i=d0(t)){super(),this.text=t,this.length=i}get lines(){return this.text.length}get children(){return null}lineInner(t,i,r,s){for(let h=0;;h++){let u=this.text[h],d=s+u.length;if((i?r:d)>=t)return new p0(s,d,r,u);s=d+1,r++}}decompose(t,i,r,s){let h=t<=0&&i>=this.length?this:new Et(du(this.text,t,i),Math.min(i,this.length)-Math.max(0,t));if(s&1){let u=r.pop(),d=no(h.text,u.text.slice(),0,h.length);if(d.length<=32)r.push(new Et(d,u.length+h.length));else{let p=d.length>>1;r.push(new Et(d.slice(0,p)),new Et(d.slice(p)))}}else r.push(h)}replace(t,i,r){if(!(r instanceof Et))return super.replace(t,i,r);[t,i]=Gn(this,t,i);let s=no(this.text,no(r.text,du(this.text,0,t)),i),h=this.length+r.length-(i-t);return s.length<=32?new Et(s,h):ti.from(Et.split(s,[]),h)}sliceString(t,i=this.length,r=`
`){[t,i]=Gn(this,t,i);let s="";for(let h=0,u=0;h<=i&&u<this.text.length;u++){let d=this.text[u],p=h+d.length;h>t&&u&&(s+=r),t<p&&i>h&&(s+=d.slice(Math.max(0,t-h),i-h)),h=p+1}return s}flatten(t){for(let i of this.text)t.push(i)}scanIdentical(){return 0}static split(t,i){let r=[],s=-1;for(let h of t)r.push(h),s+=h.length+1,r.length==32&&(i.push(new Et(r,s)),r=[],s=-1);return s>-1&&i.push(new Et(r,s)),i}}class ti extends dt{constructor(t,i){super(),this.children=t,this.length=i,this.lines=0;for(let r of t)this.lines+=r.lines}lineInner(t,i,r,s){for(let h=0;;h++){let u=this.children[h],d=s+u.length,p=r+u.lines-1;if((i?p:d)>=t)return u.lineInner(t,i,r,s);s=d+1,r=p+1}}decompose(t,i,r,s){for(let h=0,u=0;u<=i&&h<this.children.length;h++){let d=this.children[h],p=u+d.length;if(t<=p&&i>=u){let v=s&((u<=t?1:0)|(p>=i?2:0));u>=t&&p<=i&&!v?r.push(d):d.decompose(t-u,i-u,r,v)}u=p+1}}replace(t,i,r){if([t,i]=Gn(this,t,i),r.lines<this.lines)for(let s=0,h=0;s<this.children.length;s++){let u=this.children[s],d=h+u.length;if(t>=h&&i<=d){let p=u.replace(t-h,i-h,r),v=this.lines-u.lines+p.lines;if(p.lines<v>>5-1&&p.lines>v>>5+1){let y=this.children.slice();return y[s]=p,new ti(y,this.length-(i-t)+r.length)}return super.replace(h,d,p)}h=d+1}return super.replace(t,i,r)}sliceString(t,i=this.length,r=`
`){[t,i]=Gn(this,t,i);let s="";for(let h=0,u=0;h<this.children.length&&u<=i;h++){let d=this.children[h],p=u+d.length;u>t&&h&&(s+=r),t<p&&i>u&&(s+=d.sliceString(t-u,i-u,r)),u=p+1}return s}flatten(t){for(let i of this.children)i.flatten(t)}scanIdentical(t,i){if(!(t instanceof ti))return 0;let r=0,[s,h,u,d]=i>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;s+=i,h+=i){if(s==u||h==d)return r;let p=this.children[s],v=t.children[h];if(p!=v)return r+p.scanIdentical(v,i);r+=p.length+1}}static from(t,i=t.reduce((r,s)=>r+s.length+1,-1)){let r=0;for(let A of t)r+=A.lines;if(r<32){let A=[];for(let M of t)M.flatten(A);return new Et(A,i)}let s=Math.max(32,r>>5),h=s<<1,u=s>>1,d=[],p=0,v=-1,y=[];function w(A){let M;if(A.lines>h&&A instanceof ti)for(let D of A.children)w(D);else A.lines>u&&(p>u||!p)?(S(),d.push(A)):A instanceof Et&&p&&(M=y[y.length-1])instanceof Et&&A.lines+M.lines<=32?(p+=A.lines,v+=A.length+1,y[y.length-1]=new Et(M.text.concat(A.text),M.length+1+A.length)):(p+A.lines>s&&S(),p+=A.lines,v+=A.length+1,y.push(A))}function S(){p!=0&&(d.push(y.length==1?y[0]:ti.from(y,v)),v=-1,p=y.length=0)}for(let A of t)w(A);return S(),d.length==1?d[0]:new ti(d,i)}}dt.empty=new Et([""],0);function d0(f){let t=-1;for(let i of f)t+=i.length+1;return t}function no(f,t,i=0,r=1e9){for(let s=0,h=0,u=!0;h<f.length&&s<=r;h++){let d=f[h],p=s+d.length;p>=i&&(p>r&&(d=d.slice(0,r-s)),s<i&&(d=d.slice(i-s)),u?(t[t.length-1]+=d,u=!1):t.push(d)),s=p+1}return t}function du(f,t,i){return no(f,[""],t,i)}class Ur{constructor(t,i=1){this.dir=i,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[i>0?1:(t instanceof Et?t.text.length:t.children.length)<<1]}nextInner(t,i){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,s=this.nodes[r],h=this.offsets[r],u=h>>1,d=s instanceof Et?s.text.length:s.children.length;if(u==(i>0?d:0)){if(r==0)return this.done=!0,this.value="",this;i>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((h&1)==(i>0?0:1)){if(this.offsets[r]+=i,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(s instanceof Et){let p=s.text[u+(i<0?-1:0)];if(this.offsets[r]+=i,p.length>Math.max(0,t))return this.value=t==0?p:i>0?p.slice(t):p.slice(0,p.length-t),this;t-=p.length}else{let p=s.children[u+(i<0?-1:0)];t>p.length?(t-=p.length,this.offsets[r]+=i):(i<0&&this.offsets[r]--,this.nodes.push(p),this.offsets.push(i>0?1:(p instanceof Et?p.text.length:p.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class yc{constructor(t,i,r){this.value="",this.done=!1,this.cursor=new Ur(t,i>r?-1:1),this.pos=i>r?t.length:0,this.from=Math.min(i,r),this.to=Math.max(i,r)}nextInner(t,i){if(i<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,i<0?this.pos-this.to:this.from-this.pos);let r=i<0?this.pos-this.from:this.to-this.pos;t>r&&(t=r),r-=t;let{value:s}=this.cursor.next(t);return this.pos+=(s.length+t)*i,this.value=s.length<=r?s:i<0?s.slice(s.length-r):s.slice(0,r),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class bc{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:i,lineBreak:r,value:s}=this.inner.next(t);return i&&this.afterBreak?(this.value="",this.afterBreak=!1):i?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(dt.prototype[Symbol.iterator]=function(){return this.iter()},Ur.prototype[Symbol.iterator]=yc.prototype[Symbol.iterator]=bc.prototype[Symbol.iterator]=function(){return this});class p0{constructor(t,i,r,s){this.from=t,this.to=i,this.number=r,this.text=s}get length(){return this.to-this.from}}function Gn(f,t,i){return t=Math.max(0,Math.min(f.length,t)),[t,Math.max(t,Math.min(f.length,i))]}function ii(f,t,i=!0,r=!0){return u0(f,t,i,r)}function g0(f){return f>=56320&&f<57344}function m0(f){return f>=55296&&f<56320}function v0(f,t){let i=f.charCodeAt(t);if(!m0(i)||t+1==f.length)return i;let r=f.charCodeAt(t+1);return g0(r)?(i-55296<<10)+(r-56320)+65536:i}function y0(f){return f<65536?1:2}const ia=/\r\n?|\n/;var Le=function(f){return f[f.Simple=0]="Simple",f[f.TrackDel=1]="TrackDel",f[f.TrackBefore=2]="TrackBefore",f[f.TrackAfter=3]="TrackAfter",f}(Le||(Le={}));class vi{constructor(t){this.sections=t}get length(){let t=0;for(let i=0;i<this.sections.length;i+=2)t+=this.sections[i];return t}get newLength(){let t=0;for(let i=0;i<this.sections.length;i+=2){let r=this.sections[i+1];t+=r<0?this.sections[i]:r}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let i=0,r=0,s=0;i<this.sections.length;){let h=this.sections[i++],u=this.sections[i++];u<0?(t(r,s,h),s+=h):s+=u,r+=h}}iterChangedRanges(t,i=!1){na(this,t,i)}get invertedDesc(){let t=[];for(let i=0;i<this.sections.length;){let r=this.sections[i++],s=this.sections[i++];s<0?t.push(r,s):t.push(s,r)}return new vi(t)}composeDesc(t){return this.empty?t:t.empty?this:xc(this,t)}mapDesc(t,i=!1){return t.empty?this:ra(this,t,i)}mapPos(t,i=-1,r=Le.Simple){let s=0,h=0;for(let u=0;u<this.sections.length;){let d=this.sections[u++],p=this.sections[u++],v=s+d;if(p<0){if(v>t)return h+(t-s);h+=d}else{if(r!=Le.Simple&&v>=t&&(r==Le.TrackDel&&s<t&&v>t||r==Le.TrackBefore&&s<t||r==Le.TrackAfter&&v>t))return null;if(v>t||v==t&&i<0&&!d)return t==s||i<0?h:h+p;h+=p}s=v}if(t>s)throw new RangeError(`Position ${t} is out of range for changeset of length ${s}`);return h}touchesRange(t,i=t){for(let r=0,s=0;r<this.sections.length&&s<=i;){let h=this.sections[r++],u=this.sections[r++],d=s+h;if(u>=0&&s<=i&&d>=t)return s<t&&d>i?"cover":!0;s=d}return!1}toString(){let t="";for(let i=0;i<this.sections.length;){let r=this.sections[i++],s=this.sections[i++];t+=(t?" ":"")+r+(s>=0?":"+s:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(i=>typeof i!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new vi(t)}static create(t){return new vi(t)}}class Yt extends vi{constructor(t,i){super(t),this.inserted=i}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return na(this,(i,r,s,h,u)=>t=t.replace(s,s+(r-i),u),!1),t}mapDesc(t,i=!1){return ra(this,t,i,!0)}invert(t){let i=this.sections.slice(),r=[];for(let s=0,h=0;s<i.length;s+=2){let u=i[s],d=i[s+1];if(d>=0){i[s]=d,i[s+1]=u;let p=s>>1;for(;r.length<p;)r.push(dt.empty);r.push(u?t.slice(h,h+u):dt.empty)}h+=u}return new Yt(i,r)}compose(t){return this.empty?t:t.empty?this:xc(this,t,!0)}map(t,i=!1){return t.empty?this:ra(this,t,i,!0)}iterChanges(t,i=!1){na(this,t,i)}get desc(){return vi.create(this.sections)}filter(t){let i=[],r=[],s=[],h=new qr(this);t:for(let u=0,d=0;;){let p=u==t.length?1e9:t[u++];for(;d<p||d==p&&h.len==0;){if(h.done)break t;let y=Math.min(h.len,p-d);re(s,y,-1);let w=h.ins==-1?-1:h.off==0?h.ins:0;re(i,y,w),w>0&&Ri(r,i,h.text),h.forward(y),d+=y}let v=t[u++];for(;d<v;){if(h.done)break t;let y=Math.min(h.len,v-d);re(i,y,-1),re(s,y,h.ins==-1?-1:h.off==0?h.ins:0),h.forward(y),d+=y}}return{changes:new Yt(i,r),filtered:vi.create(s)}}toJSON(){let t=[];for(let i=0;i<this.sections.length;i+=2){let r=this.sections[i],s=this.sections[i+1];s<0?t.push(r):s==0?t.push([r]):t.push([r].concat(this.inserted[i>>1].toJSON()))}return t}static of(t,i,r){let s=[],h=[],u=0,d=null;function p(y=!1){if(!y&&!s.length)return;u<i&&re(s,i-u,-1);let w=new Yt(s,h);d=d?d.compose(w.map(d)):w,s=[],h=[],u=0}function v(y){if(Array.isArray(y))for(let w of y)v(w);else if(y instanceof Yt){if(y.length!=i)throw new RangeError(`Mismatched change set length (got ${y.length}, expected ${i})`);p(),d=d?d.compose(y.map(d)):y}else{let{from:w,to:S=w,insert:A}=y;if(w>S||w<0||S>i)throw new RangeError(`Invalid change range ${w} to ${S} (in doc of length ${i})`);let M=A?typeof A=="string"?dt.of(A.split(r||ia)):A:dt.empty,D=M.length;if(w==S&&D==0)return;w<u&&p(),w>u&&re(s,w-u,-1),re(s,S-w,D),Ri(h,s,M),u=S}}return v(t),p(!d),d}static empty(t){return new Yt(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let i=[],r=[];for(let s=0;s<t.length;s++){let h=t[s];if(typeof h=="number")i.push(h,-1);else{if(!Array.isArray(h)||typeof h[0]!="number"||h.some((u,d)=>d&&typeof u!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(h.length==1)i.push(h[0],0);else{for(;r.length<s;)r.push(dt.empty);r[s]=dt.of(h.slice(1)),i.push(h[0],r[s].length)}}}return new Yt(i,r)}static createSet(t,i){return new Yt(t,i)}}function re(f,t,i,r=!1){if(t==0&&i<=0)return;let s=f.length-2;s>=0&&i<=0&&i==f[s+1]?f[s]+=t:s>=0&&t==0&&f[s]==0?f[s+1]+=i:r?(f[s]+=t,f[s+1]+=i):f.push(t,i)}function Ri(f,t,i){if(i.length==0)return;let r=t.length-2>>1;if(r<f.length)f[f.length-1]=f[f.length-1].append(i);else{for(;f.length<r;)f.push(dt.empty);f.push(i)}}function na(f,t,i){let r=f.inserted;for(let s=0,h=0,u=0;u<f.sections.length;){let d=f.sections[u++],p=f.sections[u++];if(p<0)s+=d,h+=d;else{let v=s,y=h,w=dt.empty;for(;v+=d,y+=p,p&&r&&(w=w.append(r[u-2>>1])),!(i||u==f.sections.length||f.sections[u+1]<0);)d=f.sections[u++],p=f.sections[u++];t(s,v,h,y,w),s=v,h=y}}}function ra(f,t,i,r=!1){let s=[],h=r?[]:null,u=new qr(f),d=new qr(t);for(let p=-1;;){if(u.done&&d.len||d.done&&u.len)throw new Error("Mismatched change set lengths");if(u.ins==-1&&d.ins==-1){let v=Math.min(u.len,d.len);re(s,v,-1),u.forward(v),d.forward(v)}else if(d.ins>=0&&(u.ins<0||p==u.i||u.off==0&&(d.len<u.len||d.len==u.len&&!i))){let v=d.len;for(re(s,d.ins,-1);v;){let y=Math.min(u.len,v);u.ins>=0&&p<u.i&&u.len<=y&&(re(s,0,u.ins),h&&Ri(h,s,u.text),p=u.i),u.forward(y),v-=y}d.next()}else if(u.ins>=0){let v=0,y=u.len;for(;y;)if(d.ins==-1){let w=Math.min(y,d.len);v+=w,y-=w,d.forward(w)}else if(d.ins==0&&d.len<y)y-=d.len,d.next();else break;re(s,v,p<u.i?u.ins:0),h&&p<u.i&&Ri(h,s,u.text),p=u.i,u.forward(u.len-y)}else{if(u.done&&d.done)return h?Yt.createSet(s,h):vi.create(s);throw new Error("Mismatched change set lengths")}}}function xc(f,t,i=!1){let r=[],s=i?[]:null,h=new qr(f),u=new qr(t);for(let d=!1;;){if(h.done&&u.done)return s?Yt.createSet(r,s):vi.create(r);if(h.ins==0)re(r,h.len,0,d),h.next();else if(u.len==0&&!u.done)re(r,0,u.ins,d),s&&Ri(s,r,u.text),u.next();else{if(h.done||u.done)throw new Error("Mismatched change set lengths");{let p=Math.min(h.len2,u.len),v=r.length;if(h.ins==-1){let y=u.ins==-1?-1:u.off?0:u.ins;re(r,p,y,d),s&&y&&Ri(s,r,u.text)}else u.ins==-1?(re(r,h.off?0:h.len,p,d),s&&Ri(s,r,h.textBit(p))):(re(r,h.off?0:h.len,u.off?0:u.ins,d),s&&!u.off&&Ri(s,r,u.text));d=(h.ins>p||u.ins>=0&&u.len>p)&&(d||r.length>v),h.forward2(p),u.forward(p)}}}}class qr{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length?dt.empty:t[i]}textBit(t){let{inserted:i}=this.set,r=this.i-2>>1;return r>=i.length&&!t?dt.empty:i[r].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class on{constructor(t,i,r){this.from=t,this.to=i,this.flags=r}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,i=-1){let r,s;return this.empty?r=s=t.mapPos(this.from,i):(r=t.mapPos(this.from,1),s=t.mapPos(this.to,-1)),r==this.from&&s==this.to?this:new on(r,s,this.flags)}extend(t,i=t){if(t<=this.anchor&&i>=this.anchor)return j.range(t,i);let r=Math.abs(t-this.anchor)>Math.abs(i-this.anchor)?t:i;return j.range(this.anchor,r)}eq(t,i=!1){return this.anchor==t.anchor&&this.head==t.head&&(!i||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return j.range(t.anchor,t.head)}static create(t,i,r){return new on(t,i,r)}}class j{constructor(t,i){this.ranges=t,this.mainIndex=i}map(t,i=-1){return t.empty?this:j.create(this.ranges.map(r=>r.map(t,i)),this.mainIndex)}eq(t,i=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(t.ranges[r],i))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new j([this.main],0)}addRange(t,i=!0){return j.create([t].concat(this.ranges),i?0:this.mainIndex+1)}replaceRange(t,i=this.mainIndex){let r=this.ranges.slice();return r[i]=t,j.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new j(t.ranges.map(i=>on.fromJSON(i)),t.main)}static single(t,i=t){return new j([j.range(t,i)],0)}static create(t,i=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,s=0;s<t.length;s++){let h=t[s];if(h.empty?h.from<=r:h.from<r)return j.normalized(t.slice(),i);r=h.to}return new j(t,i)}static cursor(t,i=0,r,s){return on.create(t,t,(i==0?0:i<0?8:16)|(r==null?7:Math.min(6,r))|(s??16777215)<<6)}static range(t,i,r,s){let h=(r??16777215)<<6|(s==null?7:Math.min(6,s));return i<t?on.create(i,t,48|h):on.create(t,i,(i>t?8:0)|h)}static normalized(t,i=0){let r=t[i];t.sort((s,h)=>s.from-h.from),i=t.indexOf(r);for(let s=1;s<t.length;s++){let h=t[s],u=t[s-1];if(h.empty?h.from<=u.to:h.from<u.to){let d=u.from,p=Math.max(h.to,u.to);s<=i&&i--,t.splice(--s,2,h.anchor>h.head?j.range(p,d):j.range(d,p))}}return new j(t,i)}}function wc(f,t){for(let i of f.ranges)if(i.to>t)throw new RangeError("Selection points outside of document")}let Wa=0;class ot{constructor(t,i,r,s,h){this.combine=t,this.compareInput=i,this.compare=r,this.isStatic=s,this.id=Wa++,this.default=t([]),this.extensions=typeof h=="function"?h(this):h}get reader(){return this}static define(t={}){return new ot(t.combine||(i=>i),t.compareInput||((i,r)=>i===r),t.compare||(t.combine?(i,r)=>i===r:Ha),!!t.static,t.enables)}of(t){return new ro([],this,0,t)}compute(t,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new ro(t,this,1,i)}computeN(t,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new ro(t,this,2,i)}from(t,i){return i||(i=r=>r),this.compute([t],r=>i(r.field(t)))}}function Ha(f,t){return f==t||f.length==t.length&&f.every((i,r)=>i===t[r])}class ro{constructor(t,i,r,s){this.dependencies=t,this.facet=i,this.type=r,this.value=s,this.id=Wa++}dynamicSlot(t){var i;let r=this.value,s=this.facet.compareInput,h=this.id,u=t[h]>>1,d=this.type==2,p=!1,v=!1,y=[];for(let w of this.dependencies)w=="doc"?p=!0:w=="selection"?v=!0:((i=t[w.id])!==null&&i!==void 0?i:1)&1||y.push(t[w.id]);return{create(w){return w.values[u]=r(w),1},update(w,S){if(p&&S.docChanged||v&&(S.docChanged||S.selection)||sa(w,y)){let A=r(w);if(d?!pu(A,w.values[u],s):!s(A,w.values[u]))return w.values[u]=A,1}return 0},reconfigure:(w,S)=>{let A,M=S.config.address[h];if(M!=null){let D=uo(S,M);if(this.dependencies.every(N=>N instanceof ot?S.facet(N)===w.facet(N):N instanceof dn?S.field(N,!1)==w.field(N,!1):!0)||(d?pu(A=r(w),D,s):s(A=r(w),D)))return w.values[u]=D,0}else A=r(w);return w.values[u]=A,1}}}}function pu(f,t,i){if(f.length!=t.length)return!1;for(let r=0;r<f.length;r++)if(!i(f[r],t[r]))return!1;return!0}function sa(f,t){let i=!1;for(let r of t)Vr(f,r)&1&&(i=!0);return i}function b0(f,t,i){let r=i.map(p=>f[p.id]),s=i.map(p=>p.type),h=r.filter(p=>!(p&1)),u=f[t.id]>>1;function d(p){let v=[];for(let y=0;y<r.length;y++){let w=uo(p,r[y]);if(s[y]==2)for(let S of w)v.push(S);else v.push(w)}return t.combine(v)}return{create(p){for(let v of r)Vr(p,v);return p.values[u]=d(p),1},update(p,v){if(!sa(p,h))return 0;let y=d(p);return t.compare(y,p.values[u])?0:(p.values[u]=y,1)},reconfigure(p,v){let y=sa(p,r),w=v.config.facets[t.id],S=v.facet(t);if(w&&!y&&Ha(i,w))return p.values[u]=S,0;let A=d(p);return t.compare(A,S)?(p.values[u]=S,0):(p.values[u]=A,1)}}}const zs=ot.define({static:!0});class dn{constructor(t,i,r,s,h){this.id=t,this.createF=i,this.updateF=r,this.compareF=s,this.spec=h,this.provides=void 0}static define(t){let i=new dn(Wa++,t.create,t.update,t.compare||((r,s)=>r===s),t);return t.provide&&(i.provides=t.provide(i)),i}create(t){let i=t.facet(zs).find(r=>r.field==this);return((i==null?void 0:i.create)||this.createF)(t)}slot(t){let i=t[this.id]>>1;return{create:r=>(r.values[i]=this.create(r),1),update:(r,s)=>{let h=r.values[i],u=this.updateF(h,s);return this.compareF(h,u)?0:(r.values[i]=u,1)},reconfigure:(r,s)=>{let h=r.facet(zs),u=s.facet(zs),d;return(d=h.find(p=>p.field==this))&&d!=u.find(p=>p.field==this)?(r.values[i]=d.create(r),1):s.config.address[this.id]!=null?(r.values[i]=s.field(this),0):(r.values[i]=this.create(r),1)}}}init(t){return[this,zs.of({field:this,create:t})]}get extension(){return this}}const rn={lowest:4,low:3,default:2,high:1,highest:0};function Br(f){return t=>new kc(t,f)}const Sc={highest:Br(rn.highest),high:Br(rn.high),default:Br(rn.default),low:Br(rn.low),lowest:Br(rn.lowest)};class kc{constructor(t,i){this.inner=t,this.prec=i}}class Qr{of(t){return new oa(this,t)}reconfigure(t){return Qr.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class oa{constructor(t,i){this.compartment=t,this.inner=i}}class fo{constructor(t,i,r,s,h,u){for(this.base=t,this.compartments=i,this.dynamicSlots=r,this.address=s,this.staticValues=h,this.facets=u,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(t){let i=this.address[t.id];return i==null?t.default:this.staticValues[i>>1]}static resolve(t,i,r){let s=[],h=Object.create(null),u=new Map;for(let S of x0(t,i,u))S instanceof dn?s.push(S):(h[S.facet.id]||(h[S.facet.id]=[])).push(S);let d=Object.create(null),p=[],v=[];for(let S of s)d[S.id]=v.length<<1,v.push(A=>S.slot(A));let y=r==null?void 0:r.config.facets;for(let S in h){let A=h[S],M=A[0].facet,D=y&&y[S]||[];if(A.every(N=>N.type==0))if(d[M.id]=p.length<<1|1,Ha(D,A))p.push(r.facet(M));else{let N=M.combine(A.map(P=>P.value));p.push(r&&M.compare(N,r.facet(M))?r.facet(M):N)}else{for(let N of A)N.type==0?(d[N.id]=p.length<<1|1,p.push(N.value)):(d[N.id]=v.length<<1,v.push(P=>N.dynamicSlot(P)));d[M.id]=v.length<<1,v.push(N=>b0(N,M,A))}}let w=v.map(S=>S(d));return new fo(t,u,w,d,p,h)}}function x0(f,t,i){let r=[[],[],[],[],[]],s=new Map;function h(u,d){let p=s.get(u);if(p!=null){if(p<=d)return;let v=r[p].indexOf(u);v>-1&&r[p].splice(v,1),u instanceof oa&&i.delete(u.compartment)}if(s.set(u,d),Array.isArray(u))for(let v of u)h(v,d);else if(u instanceof oa){if(i.has(u.compartment))throw new RangeError("Duplicate use of compartment in extensions");let v=t.get(u.compartment)||u.inner;i.set(u.compartment,v),h(v,d)}else if(u instanceof kc)h(u.inner,u.prec);else if(u instanceof dn)r[d].push(u),u.provides&&h(u.provides,d);else if(u instanceof ro)r[d].push(u),u.facet.extensions&&h(u.facet.extensions,rn.default);else{let v=u.extension;if(!v)throw new Error(`Unrecognized extension value in extension set (${u}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);h(v,d)}}return h(f,rn.default),r.reduce((u,d)=>u.concat(d))}function Vr(f,t){if(t&1)return 2;let i=t>>1,r=f.status[i];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;f.status[i]=4;let s=f.computeSlot(f,f.config.dynamicSlots[i]);return f.status[i]=2|s}function uo(f,t){return t&1?f.config.staticValues[t>>1]:f.values[t>>1]}const Cc=ot.define(),la=ot.define({combine:f=>f.some(t=>t),static:!0}),Ac=ot.define({combine:f=>f.length?f[0]:void 0,static:!0}),Mc=ot.define(),Tc=ot.define(),Lc=ot.define(),Oc=ot.define({combine:f=>f.length?f[0]:!1});class $n{constructor(t,i){this.type=t,this.value=i}static define(){return new w0}}class w0{of(t){return new $n(this,t)}}class S0{constructor(t){this.map=t}of(t){return new Wt(this,t)}}class Wt{constructor(t,i){this.type=t,this.value=i}map(t){let i=this.type.map(this.value,t);return i===void 0?void 0:i==this.value?this:new Wt(this.type,i)}is(t){return this.type==t}static define(t={}){return new S0(t.map||(i=>i))}static mapEffects(t,i){if(!t.length)return t;let r=[];for(let s of t){let h=s.map(i);h&&r.push(h)}return r}}Wt.reconfigure=Wt.define();Wt.appendConfig=Wt.define();class oe{constructor(t,i,r,s,h,u){this.startState=t,this.changes=i,this.selection=r,this.effects=s,this.annotations=h,this.scrollIntoView=u,this._doc=null,this._state=null,r&&wc(r,i.newLength),h.some(d=>d.type==oe.time)||(this.annotations=h.concat(oe.time.of(Date.now())))}static create(t,i,r,s,h,u){return new oe(t,i,r,s,h,u)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let i of this.annotations)if(i.type==t)return i.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let i=this.annotation(oe.userEvent);return!!(i&&(i==t||i.length>t.length&&i.slice(0,t.length)==t&&i[t.length]=="."))}}oe.time=$n.define();oe.userEvent=$n.define();oe.addToHistory=$n.define();oe.remote=$n.define();function k0(f,t){let i=[];for(let r=0,s=0;;){let h,u;if(r<f.length&&(s==t.length||t[s]>=f[r]))h=f[r++],u=f[r++];else if(s<t.length)h=t[s++],u=t[s++];else return i;!i.length||i[i.length-1]<h?i.push(h,u):i[i.length-1]<u&&(i[i.length-1]=u)}}function Dc(f,t,i){var r;let s,h,u;return i?(s=t.changes,h=Yt.empty(t.changes.length),u=f.changes.compose(t.changes)):(s=t.changes.map(f.changes),h=f.changes.mapDesc(t.changes,!0),u=f.changes.compose(s)),{changes:u,selection:t.selection?t.selection.map(h):(r=f.selection)===null||r===void 0?void 0:r.map(s),effects:Wt.mapEffects(f.effects,s).concat(Wt.mapEffects(t.effects,h)),annotations:f.annotations.length?f.annotations.concat(t.annotations):t.annotations,scrollIntoView:f.scrollIntoView||t.scrollIntoView}}function aa(f,t,i){let r=t.selection,s=Kn(t.annotations);return t.userEvent&&(s=s.concat(oe.userEvent.of(t.userEvent))),{changes:t.changes instanceof Yt?t.changes:Yt.of(t.changes||[],i,f.facet(Ac)),selection:r&&(r instanceof j?r:j.single(r.anchor,r.head)),effects:Kn(t.effects),annotations:s,scrollIntoView:!!t.scrollIntoView}}function Nc(f,t,i){let r=aa(f,t.length?t[0]:{},f.doc.length);t.length&&t[0].filter===!1&&(i=!1);for(let h=1;h<t.length;h++){t[h].filter===!1&&(i=!1);let u=!!t[h].sequential;r=Dc(r,aa(f,t[h],u?r.changes.newLength:f.doc.length),u)}let s=oe.create(f,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return A0(i?C0(s):s)}function C0(f){let t=f.startState,i=!0;for(let s of t.facet(Mc)){let h=s(f);if(h===!1){i=!1;break}Array.isArray(h)&&(i=i===!0?h:k0(i,h))}if(i!==!0){let s,h;if(i===!1)h=f.changes.invertedDesc,s=Yt.empty(t.doc.length);else{let u=f.changes.filter(i);s=u.changes,h=u.filtered.mapDesc(u.changes).invertedDesc}f=oe.create(t,s,f.selection&&f.selection.map(h),Wt.mapEffects(f.effects,h),f.annotations,f.scrollIntoView)}let r=t.facet(Tc);for(let s=r.length-1;s>=0;s--){let h=r[s](f);h instanceof oe?f=h:Array.isArray(h)&&h.length==1&&h[0]instanceof oe?f=h[0]:f=Nc(t,Kn(h),!1)}return f}function A0(f){let t=f.startState,i=t.facet(Lc),r=f;for(let s=i.length-1;s>=0;s--){let h=i[s](f);h&&Object.keys(h).length&&(r=Dc(r,aa(t,h,f.changes.newLength),!0))}return r==f?f:oe.create(t,f.changes,f.selection,r.effects,r.annotations,r.scrollIntoView)}const M0=[];function Kn(f){return f==null?M0:Array.isArray(f)?f:[f]}var mi=function(f){return f[f.Word=0]="Word",f[f.Space=1]="Space",f[f.Other=2]="Other",f}(mi||(mi={}));const T0=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ha;try{ha=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function L0(f){if(ha)return ha.test(f);for(let t=0;t<f.length;t++){let i=f[t];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||T0.test(i)))return!0}return!1}function O0(f){return t=>{if(!/\S/.test(t))return mi.Space;if(L0(t))return mi.Word;for(let i=0;i<f.length;i++)if(t.indexOf(f[i])>-1)return mi.Word;return mi.Other}}class ut{constructor(t,i,r,s,h,u){this.config=t,this.doc=i,this.selection=r,this.values=s,this.status=t.statusTemplate.slice(),this.computeSlot=h,u&&(u._state=this);for(let d=0;d<this.config.dynamicSlots.length;d++)Vr(this,d<<1);this.computeSlot=null}field(t,i=!0){let r=this.config.address[t.id];if(r==null){if(i)throw new RangeError("Field is not present in this state");return}return Vr(this,r),uo(this,r)}update(...t){return Nc(this,t,!0)}applyTransaction(t){let i=this.config,{base:r,compartments:s}=i;for(let d of t.effects)d.is(Qr.reconfigure)?(i&&(s=new Map,i.compartments.forEach((p,v)=>s.set(v,p)),i=null),s.set(d.value.compartment,d.value.extension)):d.is(Wt.reconfigure)?(i=null,r=d.value):d.is(Wt.appendConfig)&&(i=null,r=Kn(r).concat(d.value));let h;i?h=t.startState.values.slice():(i=fo.resolve(r,s,this),h=new ut(i,this.doc,this.selection,i.dynamicSlots.map(()=>null),(p,v)=>v.reconfigure(p,this),null).values);let u=t.startState.facet(la)?t.newSelection:t.newSelection.asSingle();new ut(i,t.newDoc,u,h,(d,p)=>p.update(d,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:t},range:j.cursor(i.from+t.length)}))}changeByRange(t){let i=this.selection,r=t(i.ranges[0]),s=this.changes(r.changes),h=[r.range],u=Kn(r.effects);for(let d=1;d<i.ranges.length;d++){let p=t(i.ranges[d]),v=this.changes(p.changes),y=v.map(s);for(let S=0;S<d;S++)h[S]=h[S].map(y);let w=s.mapDesc(v,!0);h.push(p.range.map(w)),s=s.compose(y),u=Wt.mapEffects(u,y).concat(Wt.mapEffects(Kn(p.effects),w))}return{changes:s,selection:j.create(h,i.mainIndex),effects:u}}changes(t=[]){return t instanceof Yt?t:Yt.of(t,this.doc.length,this.facet(ut.lineSeparator))}toText(t){return dt.of(t.split(this.facet(ut.lineSeparator)||ia))}sliceDoc(t=0,i=this.doc.length){return this.doc.sliceString(t,i,this.lineBreak)}facet(t){let i=this.config.address[t.id];return i==null?t.default:(Vr(this,i),uo(this,i))}toJSON(t){let i={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let r in t){let s=t[r];s instanceof dn&&this.config.address[s.id]!=null&&(i[r]=s.spec.toJSON(this.field(t[r]),this))}return i}static fromJSON(t,i={},r){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(r){for(let h in r)if(Object.prototype.hasOwnProperty.call(t,h)){let u=r[h],d=t[h];s.push(u.init(p=>u.spec.fromJSON(d,p)))}}return ut.create({doc:t.doc,selection:j.fromJSON(t.selection),extensions:i.extensions?s.concat([i.extensions]):s})}static create(t={}){let i=fo.resolve(t.extensions||[],new Map),r=t.doc instanceof dt?t.doc:dt.of((t.doc||"").split(i.staticFacet(ut.lineSeparator)||ia)),s=t.selection?t.selection instanceof j?t.selection:j.single(t.selection.anchor,t.selection.head):j.single(0);return wc(s,r.length),i.staticFacet(la)||(s=s.asSingle()),new ut(i,r,s,i.dynamicSlots.map(()=>null),(h,u)=>u.create(h),null)}get tabSize(){return this.facet(ut.tabSize)}get lineBreak(){return this.facet(ut.lineSeparator)||`
`}get readOnly(){return this.facet(Oc)}phrase(t,...i){for(let r of this.facet(ut.phrases))if(Object.prototype.hasOwnProperty.call(r,t)){t=r[t];break}return i.length&&(t=t.replace(/\$(\$|\d*)/g,(r,s)=>{if(s=="$")return"$";let h=+(s||1);return!h||h>i.length?r:i[h-1]})),t}languageDataAt(t,i,r=-1){let s=[];for(let h of this.facet(Cc))for(let u of h(this,i,r))Object.prototype.hasOwnProperty.call(u,t)&&s.push(u[t]);return s}charCategorizer(t){return O0(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:i,from:r,length:s}=this.doc.lineAt(t),h=this.charCategorizer(t),u=t-r,d=t-r;for(;u>0;){let p=ii(i,u,!1);if(h(i.slice(p,u))!=mi.Word)break;u=p}for(;d<s;){let p=ii(i,d);if(h(i.slice(d,p))!=mi.Word)break;d=p}return u==d?null:j.range(u+r,d+r)}}ut.allowMultipleSelections=la;ut.tabSize=ot.define({combine:f=>f.length?f[0]:4});ut.lineSeparator=Ac;ut.readOnly=Oc;ut.phrases=ot.define({compare(f,t){let i=Object.keys(f),r=Object.keys(t);return i.length==r.length&&i.every(s=>f[s]==t[s])}});ut.languageData=Cc;ut.changeFilter=Mc;ut.transactionFilter=Tc;ut.transactionExtender=Lc;Qr.reconfigure=Wt.define();class _n{eq(t){return this==t}range(t,i=t){return fa.create(t,i,this)}}_n.prototype.startSide=_n.prototype.endSide=0;_n.prototype.point=!1;_n.prototype.mapMode=Le.TrackDel;let fa=class Pc{constructor(t,i,r){this.from=t,this.to=i,this.value=r}static create(t,i,r){return new Pc(t,i,r)}};function ua(f,t){return f.from-t.from||f.value.startSide-t.value.startSide}class Fa{constructor(t,i,r,s){this.from=t,this.to=i,this.value=r,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(t,i,r,s=0){let h=r?this.to:this.from;for(let u=s,d=h.length;;){if(u==d)return u;let p=u+d>>1,v=h[p]-t||(r?this.value[p].endSide:this.value[p].startSide)-i;if(p==u)return v>=0?u:d;v>=0?d=p:u=p+1}}between(t,i,r,s){for(let h=this.findIndex(i,-1e9,!0),u=this.findIndex(r,1e9,!1,h);h<u;h++)if(s(this.from[h]+t,this.to[h]+t,this.value[h])===!1)return!1}map(t,i){let r=[],s=[],h=[],u=-1,d=-1;for(let p=0;p<this.value.length;p++){let v=this.value[p],y=this.from[p]+t,w=this.to[p]+t,S,A;if(y==w){let M=i.mapPos(y,v.startSide,v.mapMode);if(M==null||(S=A=M,v.startSide!=v.endSide&&(A=i.mapPos(y,v.endSide),A<S)))continue}else if(S=i.mapPos(y,v.startSide),A=i.mapPos(w,v.endSide),S>A||S==A&&v.startSide>0&&v.endSide<=0)continue;(A-S||v.endSide-v.startSide)<0||(u<0&&(u=S),v.point&&(d=Math.max(d,A-S)),r.push(v),s.push(S-u),h.push(A-u))}return{mapped:r.length?new Fa(s,h,r,d):null,pos:u}}}class Ct{constructor(t,i,r,s){this.chunkPos=t,this.chunk=i,this.nextLayer=r,this.maxPoint=s}static create(t,i,r,s){return new Ct(t,i,r,s)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let i of this.chunk)t+=i.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:i=[],sort:r=!1,filterFrom:s=0,filterTo:h=this.length}=t,u=t.filter;if(i.length==0&&!u)return this;if(r&&(i=i.slice().sort(ua)),this.isEmpty)return i.length?Ct.of(i):this;let d=new Ec(this,null,-1).goto(0),p=0,v=[],y=new co;for(;d.value||p<i.length;)if(p<i.length&&(d.from-i[p].from||d.startSide-i[p].value.startSide)>=0){let w=i[p++];y.addInner(w.from,w.to,w.value)||v.push(w)}else d.rangeIndex==1&&d.chunkIndex<this.chunk.length&&(p==i.length||this.chunkEnd(d.chunkIndex)<i[p].from)&&(!u||s>this.chunkEnd(d.chunkIndex)||h<this.chunkPos[d.chunkIndex])&&y.addChunk(this.chunkPos[d.chunkIndex],this.chunk[d.chunkIndex])?d.nextChunk():((!u||s>d.to||h<d.from||u(d.from,d.to,d.value))&&(y.addInner(d.from,d.to,d.value)||v.push(fa.create(d.from,d.to,d.value))),d.next());return y.finishInner(this.nextLayer.isEmpty&&!v.length?Ct.empty:this.nextLayer.update({add:v,filter:u,filterFrom:s,filterTo:h}))}map(t){if(t.empty||this.isEmpty)return this;let i=[],r=[],s=-1;for(let u=0;u<this.chunk.length;u++){let d=this.chunkPos[u],p=this.chunk[u],v=t.touchesRange(d,d+p.length);if(v===!1)s=Math.max(s,p.maxPoint),i.push(p),r.push(t.mapPos(d));else if(v===!0){let{mapped:y,pos:w}=p.map(d,t);y&&(s=Math.max(s,y.maxPoint),i.push(y),r.push(w))}}let h=this.nextLayer.map(t);return i.length==0?h:new Ct(r,i,h||Ct.empty,s)}between(t,i,r){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let h=this.chunkPos[s],u=this.chunk[s];if(i>=h&&t<=h+u.length&&u.between(h,t-h,i-h,r)===!1)return}this.nextLayer.between(t,i,r)}}iter(t=0){return Yr.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,i=0){return Yr.from(t).goto(i)}static compare(t,i,r,s,h=-1){let u=t.filter(w=>w.maxPoint>0||!w.isEmpty&&w.maxPoint>=h),d=i.filter(w=>w.maxPoint>0||!w.isEmpty&&w.maxPoint>=h),p=gu(u,d,r),v=new Rr(u,p,h),y=new Rr(d,p,h);r.iterGaps((w,S,A)=>mu(v,w,y,S,A,s)),r.empty&&r.length==0&&mu(v,0,y,0,0,s)}static eq(t,i,r=0,s){s==null&&(s=1e9-1);let h=t.filter(y=>!y.isEmpty&&i.indexOf(y)<0),u=i.filter(y=>!y.isEmpty&&t.indexOf(y)<0);if(h.length!=u.length)return!1;if(!h.length)return!0;let d=gu(h,u),p=new Rr(h,d,0).goto(r),v=new Rr(u,d,0).goto(r);for(;;){if(p.to!=v.to||!ca(p.active,v.active)||p.point&&(!v.point||!p.point.eq(v.point)))return!1;if(p.to>s)return!0;p.next(),v.next()}}static spans(t,i,r,s,h=-1){let u=new Rr(t,null,h).goto(i),d=i,p=u.openStart;for(;;){let v=Math.min(u.to,r);if(u.point){let y=u.activeForPoint(u.to),w=u.pointFrom<i?y.length+1:u.point.startSide<0?y.length:Math.min(y.length,p);s.point(d,v,u.point,y,w,u.pointRank),p=Math.min(u.openEnd(v),y.length)}else v>d&&(s.span(d,v,u.active,p),p=u.openEnd(v));if(u.to>r)return p+(u.point&&u.to>r?1:0);d=u.to,u.next()}}static of(t,i=!1){let r=new co;for(let s of t instanceof fa?[t]:i?D0(t):t)r.add(s.from,s.to,s.value);return r.finish()}static join(t){if(!t.length)return Ct.empty;let i=t[t.length-1];for(let r=t.length-2;r>=0;r--)for(let s=t[r];s!=Ct.empty;s=s.nextLayer)i=new Ct(s.chunkPos,s.chunk,i,Math.max(s.maxPoint,i.maxPoint));return i}}Ct.empty=new Ct([],[],null,-1);function D0(f){if(f.length>1)for(let t=f[0],i=1;i<f.length;i++){let r=f[i];if(ua(t,r)>0)return f.slice().sort(ua);t=r}return f}Ct.empty.nextLayer=Ct.empty;class co{finishChunk(t){this.chunks.push(new Fa(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,i,r){this.addInner(t,i,r)||(this.nextLayer||(this.nextLayer=new co)).add(t,i,r)}addInner(t,i,r){let s=t-this.lastTo||r.startSide-this.last.endSide;if(s<=0&&(t-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(i-this.chunkStart),this.last=r,this.lastFrom=t,this.lastTo=i,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,i-t)),!0)}addChunk(t,i){if((t-this.lastTo||i.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,i.maxPoint),this.chunks.push(i),this.chunkPos.push(t);let r=i.value.length-1;return this.last=i.value[r],this.lastFrom=i.from[r]+t,this.lastTo=i.to[r]+t,!0}finish(){return this.finishInner(Ct.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let i=Ct.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,i}}function gu(f,t,i){let r=new Map;for(let h of f)for(let u=0;u<h.chunk.length;u++)h.chunk[u].maxPoint<=0&&r.set(h.chunk[u],h.chunkPos[u]);let s=new Set;for(let h of t)for(let u=0;u<h.chunk.length;u++){let d=r.get(h.chunk[u]);d!=null&&(i?i.mapPos(d):d)==h.chunkPos[u]&&!(i!=null&&i.touchesRange(d,d+h.chunk[u].length))&&s.add(h.chunk[u])}return s}class Ec{constructor(t,i,r,s=0){this.layer=t,this.skip=i,this.minPoint=r,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,i=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,i,!1),this}gotoInner(t,i,r){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<t||s.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],i,!0);(!r||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(t,i){(this.to-t||this.endSide-i)<0&&this.gotoInner(t,i,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],i=this.layer.chunk[this.chunkIndex],r=t+i.from[this.rangeIndex];if(this.from=r,this.to=t+i.to[this.rangeIndex],this.value=i.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Yr{constructor(t){this.heap=t}static from(t,i=null,r=-1){let s=[];for(let h=0;h<t.length;h++)for(let u=t[h];!u.isEmpty;u=u.nextLayer)u.maxPoint>=r&&s.push(new Ec(u,i,r,h));return s.length==1?s[0]:new Yr(s)}get startSide(){return this.value?this.value.startSide:0}goto(t,i=-1e9){for(let r of this.heap)r.goto(t,i);for(let r=this.heap.length>>1;r>=0;r--)Ul(this.heap,r);return this.next(),this}forward(t,i){for(let r of this.heap)r.forward(t,i);for(let r=this.heap.length>>1;r>=0;r--)Ul(this.heap,r);(this.to-t||this.value.endSide-i)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Ul(this.heap,0)}}}function Ul(f,t){for(let i=f[t];;){let r=(t<<1)+1;if(r>=f.length)break;let s=f[r];if(r+1<f.length&&s.compare(f[r+1])>=0&&(s=f[r+1],r++),i.compare(s)<0)break;f[r]=i,f[t]=s,t=r}}class Rr{constructor(t,i,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Yr.from(t,i,r)}goto(t,i=-1e9){return this.cursor.goto(t,i),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=i,this.openStart=-1,this.next(),this}forward(t,i){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-i)<0;)this.removeActive(this.minActive);this.cursor.forward(t,i)}removeActive(t){Ks(this.active,t),Ks(this.activeTo,t),Ks(this.activeRank,t),this.minActive=vu(this.active,this.activeTo)}addActive(t){let i=0,{value:r,to:s,rank:h}=this.cursor;for(;i<this.activeRank.length&&(h-this.activeRank[i]||s-this.activeTo[i])>0;)i++;Us(this.active,i,r),Us(this.activeTo,i,s),Us(this.activeRank,i,h),t&&Us(t,i,this.cursor.from),this.minActive=vu(this.active,this.activeTo)}next(){let t=this.to,i=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>t){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),r&&Ks(r,s)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let h=this.cursor.value;if(!h.point)this.addActive(r),this.cursor.next();else if(i&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=h,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=h.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let s=r.length-1;s>=0&&r[s]<t;s--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let i=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>t||this.activeTo[r]==t&&this.active[r].endSide>=this.point.endSide)&&i.push(this.active[r]);return i.reverse()}openEnd(t){let i=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>t;r--)i++;return i}}function mu(f,t,i,r,s,h){f.goto(t),i.goto(r);let u=r+s,d=r,p=r-t;for(;;){let v=f.to+p-i.to,y=v||f.endSide-i.endSide,w=y<0?f.to+p:i.to,S=Math.min(w,u);if(f.point||i.point?f.point&&i.point&&(f.point==i.point||f.point.eq(i.point))&&ca(f.activeForPoint(f.to),i.activeForPoint(i.to))||h.comparePoint(d,S,f.point,i.point):S>d&&!ca(f.active,i.active)&&h.compareRange(d,S,f.active,i.active),w>u)break;(v||f.openEnd!=i.openEnd)&&h.boundChange&&h.boundChange(w),d=w,y<=0&&f.next(),y>=0&&i.next()}}function ca(f,t){if(f.length!=t.length)return!1;for(let i=0;i<f.length;i++)if(f[i]!=t[i]&&!f[i].eq(t[i]))return!1;return!0}function Ks(f,t){for(let i=t,r=f.length-1;i<r;i++)f[i]=f[i+1];f.pop()}function Us(f,t,i){for(let r=f.length-1;r>=t;r--)f[r+1]=f[r];f[t]=i}function vu(f,t){let i=-1,r=1e9;for(let s=0;s<t.length;s++)(t[s]-r||f[s].endSide-f[i].endSide)<0&&(i=s,r=t[s]);return i}function N0(f,t,i=f.length){let r=0;for(let s=0;s<i&&s<f.length;)f.charCodeAt(s)==9?(r+=t-r%t,s++):(r++,s=ii(f,s));return r}function P0(f,t,i,r){for(let s=0,h=0;;){if(h>=t)return s;if(s==f.length)break;h+=f.charCodeAt(s)==9?i-h%i:1,s=ii(f,s)}return r===!0?-1:f.length}const da="ͼ",yu=typeof Symbol>"u"?"__"+da:Symbol.for(da),pa=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),bu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Hi{constructor(t,i){this.rules=[];let{finish:r}=i||{};function s(u){return/^@/.test(u)?[u]:u.split(/,\s*/)}function h(u,d,p,v){let y=[],w=/^@(\w+)\b/.exec(u[0]),S=w&&w[1]=="keyframes";if(w&&d==null)return p.push(u[0]+";");for(let A in d){let M=d[A];if(/&/.test(A))h(A.split(/,\s*/).map(D=>u.map(N=>D.replace(/&/,N))).reduce((D,N)=>D.concat(N)),M,p);else if(M&&typeof M=="object"){if(!w)throw new RangeError("The value of a property ("+A+") should be a primitive value.");h(s(A),M,y,S)}else M!=null&&y.push(A.replace(/_.*/,"").replace(/[A-Z]/g,D=>"-"+D.toLowerCase())+": "+M+";")}(y.length||S)&&p.push((r&&!w&&!v?u.map(r):u).join(", ")+" {"+y.join(" ")+"}")}for(let u in t)h(s(u),t[u],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=bu[yu]||1;return bu[yu]=t+1,da+t.toString(36)}static mount(t,i,r){let s=t[pa],h=r&&r.nonce;s?h&&s.setNonce(h):s=new E0(t,h),s.mount(Array.isArray(i)?i:[i],t)}}let xu=new Map;class E0{constructor(t,i){let r=t.ownerDocument||t,s=r.defaultView;if(!t.head&&t.adoptedStyleSheets&&s.CSSStyleSheet){let h=xu.get(r);if(h)return t[pa]=h;this.sheet=new s.CSSStyleSheet,xu.set(r,this)}else this.styleTag=r.createElement("style"),i&&this.styleTag.setAttribute("nonce",i);this.modules=[],t[pa]=this}mount(t,i){let r=this.sheet,s=0,h=0;for(let u=0;u<t.length;u++){let d=t[u],p=this.modules.indexOf(d);if(p<h&&p>-1&&(this.modules.splice(p,1),h--,p=-1),p==-1){if(this.modules.splice(h++,0,d),r)for(let v=0;v<d.rules.length;v++)r.insertRule(d.rules[v],s++)}else{for(;h<p;)s+=this.modules[h++].rules.length;s+=d.rules.length,h++}}if(r)i.adoptedStyleSheets.indexOf(this.sheet)<0&&(i.adoptedStyleSheets=[this.sheet,...i.adoptedStyleSheets]);else{let u="";for(let p=0;p<this.modules.length;p++)u+=this.modules[p].getRules()+`
`;this.styleTag.textContent=u;let d=i.head||i;this.styleTag.parentNode!=d&&d.insertBefore(this.styleTag,d.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var Fi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Xr={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},B0=typeof navigator<"u"&&/Mac/.test(navigator.platform),R0=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Qt=0;Qt<10;Qt++)Fi[48+Qt]=Fi[96+Qt]=String(Qt);for(var Qt=1;Qt<=24;Qt++)Fi[Qt+111]="F"+Qt;for(var Qt=65;Qt<=90;Qt++)Fi[Qt]=String.fromCharCode(Qt+32),Xr[Qt]=String.fromCharCode(Qt);for(var Vl in Fi)Xr.hasOwnProperty(Vl)||(Xr[Vl]=Fi[Vl]);function I0(f){var t=B0&&f.metaKey&&f.shiftKey&&!f.ctrlKey&&!f.altKey||R0&&f.shiftKey&&f.key&&f.key.length==1||f.key=="Unidentified",i=!t&&f.key||(f.shiftKey?Xr:Fi)[f.keyCode]||f.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}function jr(f){let t;return f.nodeType==11?t=f.getSelection?f:f.ownerDocument:t=f,t.getSelection()}function ga(f,t){return t?f==t||f.contains(t.nodeType!=1?t.parentNode:t):!1}function so(f,t){if(!t.anchorNode)return!1;try{return ga(f,t.anchorNode)}catch{return!1}}function qn(f){return f.nodeType==3?fn(f,0,f.nodeValue.length).getClientRects():f.nodeType==1?f.getClientRects():[]}function Gr(f,t,i,r){return i?wu(f,t,i,r,-1)||wu(f,t,i,r,1):!1}function hn(f){for(var t=0;;t++)if(f=f.previousSibling,!f)return t}function po(f){return f.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(f.nodeName)}function wu(f,t,i,r,s){for(;;){if(f==i&&t==r)return!0;if(t==(s<0?0:oi(f))){if(f.nodeName=="DIV")return!1;let h=f.parentNode;if(!h||h.nodeType!=1)return!1;t=hn(f)+(s<0?0:1),f=h}else if(f.nodeType==1){if(f=f.childNodes[t+(s<0?-1:0)],f.nodeType==1&&f.contentEditable=="false")return!1;t=s<0?oi(f):0}else return!1}}function oi(f){return f.nodeType==3?f.nodeValue.length:f.childNodes.length}function $r(f,t){let i=t?f.left:f.right;return{left:i,right:i,top:f.top,bottom:f.bottom}}function W0(f){let t=f.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:f.innerWidth,top:0,bottom:f.innerHeight}}function Bc(f,t){let i=t.width/f.offsetWidth,r=t.height/f.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.width-f.offsetWidth)<1)&&(i=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(t.height-f.offsetHeight)<1)&&(r=1),{scaleX:i,scaleY:r}}function H0(f,t,i,r,s,h,u,d){let p=f.ownerDocument,v=p.defaultView||window;for(let y=f,w=!1;y&&!w;)if(y.nodeType==1){let S,A=y==p.body,M=1,D=1;if(A)S=W0(v);else{if(/^(fixed|sticky)$/.test(getComputedStyle(y).position)&&(w=!0),y.scrollHeight<=y.clientHeight&&y.scrollWidth<=y.clientWidth){y=y.assignedSlot||y.parentNode;continue}let H=y.getBoundingClientRect();({scaleX:M,scaleY:D}=Bc(y,H)),S={left:H.left,right:H.left+y.clientWidth*M,top:H.top,bottom:H.top+y.clientHeight*D}}let N=0,P=0;if(s=="nearest")t.top<S.top?(P=t.top-(S.top+u),i>0&&t.bottom>S.bottom+P&&(P=t.bottom-S.bottom+u)):t.bottom>S.bottom&&(P=t.bottom-S.bottom+u,i<0&&t.top-P<S.top&&(P=t.top-(S.top+u)));else{let H=t.bottom-t.top,q=S.bottom-S.top;P=(s=="center"&&H<=q?t.top+H/2-q/2:s=="start"||s=="center"&&i<0?t.top-u:t.bottom-q+u)-S.top}if(r=="nearest"?t.left<S.left?(N=t.left-(S.left+h),i>0&&t.right>S.right+N&&(N=t.right-S.right+h)):t.right>S.right&&(N=t.right-S.right+h,i<0&&t.left<S.left+N&&(N=t.left-(S.left+h))):N=(r=="center"?t.left+(t.right-t.left)/2-(S.right-S.left)/2:r=="start"==d?t.left-h:t.right-(S.right-S.left)+h)-S.left,N||P)if(A)v.scrollBy(N,P);else{let H=0,q=0;if(P){let J=y.scrollTop;y.scrollTop+=P/D,q=(y.scrollTop-J)*D}if(N){let J=y.scrollLeft;y.scrollLeft+=N/M,H=(y.scrollLeft-J)*M}t={left:t.left-H,top:t.top-q,right:t.right-H,bottom:t.bottom-q},H&&Math.abs(H-N)<1&&(r="nearest"),q&&Math.abs(q-P)<1&&(s="nearest")}if(A)break;(t.top<S.top||t.bottom>S.bottom||t.left<S.left||t.right>S.right)&&(t={left:Math.max(t.left,S.left),right:Math.min(t.right,S.right),top:Math.max(t.top,S.top),bottom:Math.min(t.bottom,S.bottom)}),y=y.assignedSlot||y.parentNode}else if(y.nodeType==11)y=y.host;else break}function F0(f){let t=f.ownerDocument,i,r;for(let s=f.parentNode;s&&!(s==t.body||i&&r);)if(s.nodeType==1)!r&&s.scrollHeight>s.clientHeight&&(r=s),!i&&s.scrollWidth>s.clientWidth&&(i=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:i,y:r}}class z0{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:i,focusNode:r}=t;this.set(i,Math.min(t.anchorOffset,i?oi(i):0),r,Math.min(t.focusOffset,r?oi(r):0))}set(t,i,r,s){this.anchorNode=t,this.anchorOffset=i,this.focusNode=r,this.focusOffset=s}}let Hn=null;function Rc(f){if(f.setActive)return f.setActive();if(Hn)return f.focus(Hn);let t=[];for(let i=f;i&&(t.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(f.focus(Hn==null?{get preventScroll(){return Hn={preventScroll:!0},!0}}:void 0),!Hn){Hn=!1;for(let i=0;i<t.length;){let r=t[i++],s=t[i++],h=t[i++];r.scrollTop!=s&&(r.scrollTop=s),r.scrollLeft!=h&&(r.scrollLeft=h)}}}let Su;function fn(f,t,i=t){let r=Su||(Su=document.createRange());return r.setEnd(f,i),r.setStart(f,t),r}function Un(f,t,i,r){let s={key:t,code:t,keyCode:i,which:i,cancelable:!0};r&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=r);let h=new KeyboardEvent("keydown",s);h.synthetic=!0,f.dispatchEvent(h);let u=new KeyboardEvent("keyup",s);return u.synthetic=!0,f.dispatchEvent(u),h.defaultPrevented||u.defaultPrevented}function K0(f){for(;f;){if(f&&(f.nodeType==9||f.nodeType==11&&f.host))return f;f=f.assignedSlot||f.parentNode}return null}function Ic(f){for(;f.attributes.length;)f.removeAttributeNode(f.attributes[0])}function U0(f,t){let i=t.focusNode,r=t.focusOffset;if(!i||t.anchorNode!=i||t.anchorOffset!=r)return!1;for(r=Math.min(r,oi(i));;)if(r){if(i.nodeType!=1)return!1;let s=i.childNodes[r-1];s.contentEditable=="false"?r--:(i=s,r=oi(i))}else{if(i==f)return!0;r=hn(i),i=i.parentNode}}function Wc(f){return f.scrollTop>Math.max(1,f.scrollHeight-f.clientHeight-4)}function Hc(f,t){for(let i=f,r=t;;){if(i.nodeType==3&&r>0)return{node:i,offset:r};if(i.nodeType==1&&r>0){if(i.contentEditable=="false")return null;i=i.childNodes[r-1],r=oi(i)}else if(i.parentNode&&!po(i))r=hn(i),i=i.parentNode;else return null}}function Fc(f,t){for(let i=f,r=t;;){if(i.nodeType==3&&r<i.nodeValue.length)return{node:i,offset:r};if(i.nodeType==1&&r<i.childNodes.length){if(i.contentEditable=="false")return null;i=i.childNodes[r],r=0}else if(i.parentNode&&!po(i))r=hn(i)+1,i=i.parentNode;else return null}}class se{constructor(t,i,r=!0){this.node=t,this.offset=i,this.precise=r}static before(t,i){return new se(t.parentNode,hn(t),i)}static after(t,i){return new se(t.parentNode,hn(t)+1,i)}}const za=[];class xt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let i=this.posAtStart;for(let r of this.children){if(r==t)return i;i+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,i){if(this.flags&2){let r=this.dom,s=null,h;for(let u of this.children){if(u.flags&7){if(!u.dom&&(h=s?s.nextSibling:r.firstChild)){let d=xt.get(h);(!d||!d.parent&&d.canReuseDOM(u))&&u.reuseDOM(h)}u.sync(t,i),u.flags&=-8}if(h=s?s.nextSibling:r.firstChild,i&&!i.written&&i.node==r&&h!=u.dom&&(i.written=!0),u.dom.parentNode==r)for(;h&&h!=u.dom;)h=ku(h);else r.insertBefore(u.dom,h);s=u.dom}for(h=s?s.nextSibling:r.firstChild,h&&i&&i.node==r&&(i.written=!0);h;)h=ku(h)}else if(this.flags&1)for(let r of this.children)r.flags&7&&(r.sync(t,i),r.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,i){let r;if(t==this.dom)r=this.dom.childNodes[i];else{let s=oi(t)==0?0:i==0?-1:1;for(;;){let h=t.parentNode;if(h==this.dom)break;s==0&&h.firstChild!=h.lastChild&&(t==h.firstChild?s=-1:s=1),t=h}s<0?r=t:r=t.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!xt.get(r);)r=r.nextSibling;if(!r)return this.length;for(let s=0,h=0;;s++){let u=this.children[s];if(u.dom==r)return h;h+=u.length+u.breakAfter}}domBoundsAround(t,i,r=0){let s=-1,h=-1,u=-1,d=-1;for(let p=0,v=r,y=r;p<this.children.length;p++){let w=this.children[p],S=v+w.length;if(v<t&&S>i)return w.domBoundsAround(t,i,v);if(S>=t&&s==-1&&(s=p,h=v),v>i&&w.dom.parentNode==this.dom){u=p,d=y;break}y=S,v=S+w.breakAfter}return{from:h,to:d<0?r+this.length:d,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:u<this.children.length&&u>=0?this.children[u].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let i=this.parent;i;i=i.parent){if(t&&(i.flags|=2),i.flags&1)return;i.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let i=t.parent;if(!i)return t;t=i}}replaceChildren(t,i,r=za){this.markDirty();for(let s=t;s<i;s++){let h=this.children[s];h.parent==this&&r.indexOf(h)<0&&h.destroy()}r.length<250?this.children.splice(t,i-t,...r):this.children=[].concat(this.children.slice(0,t),r,this.children.slice(i));for(let s=0;s<r.length;s++)r[s].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new zc(this.children,t,this.children.length)}childPos(t,i=1){return this.childCursor().findPos(t,i)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,i,r,s,h,u){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}xt.prototype.breakAfter=0;function ku(f){let t=f.nextSibling;return f.parentNode.removeChild(f),t}class zc{constructor(t,i,r){this.children=t,this.pos=i,this.i=r,this.off=0}findPos(t,i=1){for(;;){if(t>this.pos||t==this.pos&&(i>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function Kc(f,t,i,r,s,h,u,d,p){let{children:v}=f,y=v.length?v[t]:null,w=h.length?h[h.length-1]:null,S=w?w.breakAfter:u;if(!(t==r&&y&&!u&&!S&&h.length<2&&y.merge(i,s,h.length?w:null,i==0,d,p))){if(r<v.length){let A=v[r];A&&(s<A.length||A.breakAfter&&(w!=null&&w.breakAfter))?(t==r&&(A=A.split(s),s=0),!S&&w&&A.merge(0,s,w,!0,0,p)?h[h.length-1]=A:((s||A.children.length&&!A.children[0].length)&&A.merge(0,s,null,!1,0,p),h.push(A))):A!=null&&A.breakAfter&&(w?w.breakAfter=1:u=1),r++}for(y&&(y.breakAfter=u,i>0&&(!u&&h.length&&y.merge(i,y.length,h[0],!1,d,0)?y.breakAfter=h.shift().breakAfter:(i<y.length||y.children.length&&y.children[y.children.length-1].length==0)&&y.merge(i,y.length,null,!1,d,0),t++));t<r&&h.length;)if(v[r-1].become(h[h.length-1]))r--,h.pop(),p=h.length?0:d;else if(v[t].become(h[0]))t++,h.shift(),d=h.length?0:p;else break;!h.length&&t&&r<v.length&&!v[t-1].breakAfter&&v[r].merge(0,0,v[t-1],!1,d,p)&&t--,(t<r||h.length)&&f.replaceChildren(t,r,h)}}function Uc(f,t,i,r,s,h){let u=f.childCursor(),{i:d,off:p}=u.findPos(i,1),{i:v,off:y}=u.findPos(t,-1),w=t-i;for(let S of r)w+=S.length;f.length+=w,Kc(f,v,y,d,p,r,0,s,h)}let we=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},ma=typeof document<"u"?document:{documentElement:{style:{}}};const va=/Edge\/(\d+)/.exec(we.userAgent),Vc=/MSIE \d/.test(we.userAgent),ya=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(we.userAgent),So=!!(Vc||ya||va),Cu=!So&&/gecko\/(\d+)/i.test(we.userAgent),Gl=!So&&/Chrome\/(\d+)/.exec(we.userAgent),Au="webkitFontSmoothing"in ma.documentElement.style,Gc=!So&&/Apple Computer/.test(we.vendor),Mu=Gc&&(/Mobile\/\w+/.test(we.userAgent)||we.maxTouchPoints>2);var G={mac:Mu||/Mac/.test(we.platform),windows:/Win/.test(we.platform),linux:/Linux|X11/.test(we.platform),ie:So,ie_version:Vc?ma.documentMode||6:ya?+ya[1]:va?+va[1]:0,gecko:Cu,gecko_version:Cu?+(/Firefox\/(\d+)/.exec(we.userAgent)||[0,0])[1]:0,chrome:!!Gl,chrome_version:Gl?+Gl[1]:0,ios:Mu,android:/Android\b/.test(we.userAgent),webkit:Au,safari:Gc,webkit_version:Au?+(/\bAppleWebKit\/(\d+)/.exec(we.userAgent)||[0,0])[1]:0,tabSize:ma.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const V0=256;class Ke extends xt{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,i){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(i&&i.node==this.dom&&(i.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,i,r){return this.flags&8||r&&(!(r instanceof Ke)||this.length-(i-t)+r.length>V0||r.flags&8)?!1:(this.text=this.text.slice(0,t)+(r?r.text:"")+this.text.slice(i),this.markDirty(),!0)}split(t){let i=new Ke(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),i.flags|=this.flags&8,i}localPosFromDOM(t,i){return t==this.dom?i:i?this.text.length:0}domAtPos(t){return new se(this.dom,t)}domBoundsAround(t,i,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,i){return G0(this.dom,t,i)}}class bi extends xt{constructor(t,i=[],r=0){super(),this.mark=t,this.children=i,this.length=r;for(let s of i)s.setParent(this)}setAttrs(t){if(Ic(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let i in this.mark.attrs)t.setAttribute(i,this.mark.attrs[i]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,i){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,i)}merge(t,i,r,s,h,u){return r&&(!(r instanceof bi&&r.mark.eq(this.mark))||t&&h<=0||i<this.length&&u<=0)?!1:(Uc(this,t,i,r?r.children.slice():[],h-1,u-1),this.markDirty(),!0)}split(t){let i=[],r=0,s=-1,h=0;for(let d of this.children){let p=r+d.length;p>t&&i.push(r<t?d.split(t-r):d),s<0&&r>=t&&(s=h),r=p,h++}let u=this.length-t;return this.length=t,s>-1&&(this.children.length=s,this.markDirty()),new bi(this.mark,i,u)}domAtPos(t){return _c(this,t)}coordsAt(t,i){return Yc(this,t,i)}}function G0(f,t,i){let r=f.nodeValue.length;t>r&&(t=r);let s=t,h=t,u=0;t==0&&i<0||t==r&&i>=0?G.chrome||G.gecko||(t?(s--,u=1):h<r&&(h++,u=-1)):i<0?s--:h<r&&h++;let d=fn(f,s,h).getClientRects();if(!d.length)return null;let p=d[(u?u<0:i>=0)?0:d.length-1];return G.safari&&!u&&p.width==0&&(p=Array.prototype.find.call(d,v=>v.width)||p),u?$r(p,u<0):p||null}class ln extends xt{static create(t,i,r){return new ln(t,i,r)}constructor(t,i,r){super(),this.widget=t,this.length=i,this.side=r,this.prevWidget=null}split(t){let i=ln.create(this.widget,this.length-t,this.side);return this.length-=t,i}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,i,r,s,h,u){return r&&(!(r instanceof ln)||!this.widget.compare(r.widget)||t>0&&h<=0||i<this.length&&u<=0)?!1:(this.length=t+(r?r.length:0)+(this.length-i),!0)}become(t){return t instanceof ln&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return dt.empty;let t=this;for(;t.parent;)t=t.parent;let{view:i}=t,r=i&&i.state.doc,s=this.posAtStart;return r?r.slice(s,s+this.length):dt.empty}domAtPos(t){return(this.length?t==0:this.side>0)?se.before(this.dom):se.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,i){let r=this.widget.coordsAt(this.dom,t,i);if(r)return r;let s=this.dom.getClientRects(),h=null;if(!s.length)return null;let u=this.side?this.side<0:t>0;for(let d=u?s.length-1:0;h=s[d],!(t>0?d==0:d==s.length-1||h.top<h.bottom);d+=u?-1:1);return $r(h,!u)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Yn extends xt{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Yn&&t.side==this.side}split(){return new Yn(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?se.before(this.dom):se.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return dt.empty}get isHidden(){return!0}}Ke.prototype.children=ln.prototype.children=Yn.prototype.children=za;function _c(f,t){let i=f.dom,{children:r}=f,s=0;for(let h=0;s<r.length;s++){let u=r[s],d=h+u.length;if(!(d==h&&u.getSide()<=0)){if(t>h&&t<d&&u.dom.parentNode==i)return u.domAtPos(t-h);if(t<=h)break;h=d}}for(let h=s;h>0;h--){let u=r[h-1];if(u.dom.parentNode==i)return u.domAtPos(u.length)}for(let h=s;h<r.length;h++){let u=r[h];if(u.dom.parentNode==i)return u.domAtPos(0)}return new se(i,0)}function qc(f,t,i){let r,{children:s}=f;i>0&&t instanceof bi&&s.length&&(r=s[s.length-1])instanceof bi&&r.mark.eq(t.mark)?qc(r,t.children[0],i-1):(s.push(t),t.setParent(f)),f.length+=t.length}function Yc(f,t,i){let r=null,s=-1,h=null,u=-1;function d(v,y){for(let w=0,S=0;w<v.children.length&&S<=y;w++){let A=v.children[w],M=S+A.length;M>=y&&(A.children.length?d(A,y-S):(!h||h.isHidden&&(i>0||q0(h,A)))&&(M>y||S==M&&A.getSide()>0)?(h=A,u=y-S):(S<y||S==M&&A.getSide()<0&&!A.isHidden)&&(r=A,s=y-S)),S=M}}d(f,t);let p=(i<0?r:h)||r||h;return p?p.coordsAt(Math.max(0,p==r?s:u),i):_0(f)}function _0(f){let t=f.dom.lastChild;if(!t)return f.dom.getBoundingClientRect();let i=qn(t);return i[i.length-1]||null}function q0(f,t){let i=f.coordsAt(0,1),r=t.coordsAt(0,1);return i&&r&&r.top<i.bottom}function ba(f,t){for(let i in f)i=="class"&&t.class?t.class+=" "+f.class:i=="style"&&t.style?t.style+=";"+f.style:t[i]=f[i];return t}const Tu=Object.create(null);function go(f,t,i){if(f==t)return!0;f||(f=Tu),t||(t=Tu);let r=Object.keys(f),s=Object.keys(t);if(r.length-(i&&r.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let h of r)if(h!=i&&(s.indexOf(h)==-1||f[h]!==t[h]))return!1;return!0}function xa(f,t,i){let r=!1;if(t)for(let s in t)i&&s in i||(r=!0,s=="style"?f.style.cssText="":f.removeAttribute(s));if(i)for(let s in i)t&&t[s]==i[s]||(r=!0,s=="style"?f.style.cssText=i[s]:f.setAttribute(s,i[s]));return r}function Y0(f){let t=Object.create(null);for(let i=0;i<f.attributes.length;i++){let r=f.attributes[i];t[r.name]=r.value}return t}class ko{eq(t){return!1}updateDOM(t,i){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,i,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var si=function(f){return f[f.Text=0]="Text",f[f.WidgetBefore=1]="WidgetBefore",f[f.WidgetAfter=2]="WidgetAfter",f[f.WidgetRange=3]="WidgetRange",f}(si||(si={}));class Ht extends _n{constructor(t,i,r,s){super(),this.startSide=t,this.endSide=i,this.widget=r,this.spec=s}get heightRelevant(){return!1}static mark(t){return new ts(t)}static widget(t){let i=Math.max(-1e4,Math.min(1e4,t.side||0)),r=!!t.block;return i+=r&&!t.inlineOrder?i>0?3e8:-4e8:i>0?1e8:-1e8,new zi(t,i,i,r,t.widget||null,!1)}static replace(t){let i=!!t.block,r,s;if(t.isBlockGap)r=-5e8,s=4e8;else{let{start:h,end:u}=Xc(t,i);r=(h?i?-3e8:-1:5e8)-1,s=(u?i?2e8:1:-6e8)+1}return new zi(t,r,s,i,t.widget||null,!0)}static line(t){return new es(t)}static set(t,i=!1){return Ct.of(t,i)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ht.none=Ct.empty;class ts extends Ht{constructor(t){let{start:i,end:r}=Xc(t);super(i?-1:5e8,r?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var i,r;return this==t||t instanceof ts&&this.tagName==t.tagName&&(this.class||((i=this.attrs)===null||i===void 0?void 0:i.class))==(t.class||((r=t.attrs)===null||r===void 0?void 0:r.class))&&go(this.attrs,t.attrs,"class")}range(t,i=t){if(t>=i)throw new RangeError("Mark decorations may not be empty");return super.range(t,i)}}ts.prototype.point=!1;class es extends Ht{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof es&&this.spec.class==t.spec.class&&go(this.spec.attributes,t.spec.attributes)}range(t,i=t){if(i!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,i)}}es.prototype.mapMode=Le.TrackBefore;es.prototype.point=!0;class zi extends Ht{constructor(t,i,r,s,h,u){super(i,r,h,t),this.block=s,this.isReplace=u,this.mapMode=s?i<=0?Le.TrackBefore:Le.TrackAfter:Le.TrackDel}get type(){return this.startSide!=this.endSide?si.WidgetRange:this.startSide<=0?si.WidgetBefore:si.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof zi&&X0(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,i=t){if(this.isReplace&&(t>i||t==i&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&i!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,i)}}zi.prototype.point=!0;function Xc(f,t=!1){let{inclusiveStart:i,inclusiveEnd:r}=f;return i==null&&(i=f.inclusive),r==null&&(r=f.inclusive),{start:i??t,end:r??t}}function X0(f,t){return f==t||!!(f&&t&&f.compare(t))}function oo(f,t,i,r=0){let s=i.length-1;s>=0&&i[s]+r>=f?i[s]=Math.max(i[s],t):i.push(f,t)}class It extends xt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,i,r,s,h,u){if(r){if(!(r instanceof It))return!1;this.dom||r.transferDOM(this)}return s&&this.setDeco(r?r.attrs:null),Uc(this,t,i,r?r.children.slice():[],h,u),!0}split(t){let i=new It;if(i.breakAfter=this.breakAfter,this.length==0)return i;let{i:r,off:s}=this.childPos(t);s&&(i.append(this.children[r].split(s),0),this.children[r].merge(s,this.children[r].length,null,!1,0,0),r++);for(let h=r;h<this.children.length;h++)i.append(this.children[h],0);for(;r>0&&this.children[r-1].length==0;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=t,i}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){go(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,i){qc(this,t,i)}addLineDeco(t){let i=t.spec.attributes,r=t.spec.class;i&&(this.attrs=ba(i,this.attrs||{})),r&&(this.attrs=ba({class:r},this.attrs||{}))}domAtPos(t){return _c(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,i){var r;this.dom?this.flags&4&&(Ic(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(xa(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,i);let s=this.dom.lastChild;for(;s&&xt.get(s)instanceof bi;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((r=xt.get(s))===null||r===void 0?void 0:r.isEditable)==!1&&(!G.ios||!this.children.some(h=>h instanceof Ke))){let h=document.createElement("BR");h.cmIgnore=!0,this.dom.appendChild(h)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,i;for(let r of this.children){if(!(r instanceof Ke)||/[^ -~]/.test(r.text))return null;let s=qn(r.dom);if(s.length!=1)return null;t+=s[0].width,i=s[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:i}:null}coordsAt(t,i){let r=Yc(this,t,i);if(!this.children.length&&r&&this.parent){let{heightOracle:s}=this.parent.view.viewState,h=r.bottom-r.top;if(Math.abs(h-s.lineHeight)<2&&s.textHeight<h){let u=(h-s.textHeight)/2;return{top:r.top+u,bottom:r.bottom-u,left:r.left,right:r.left}}}return r}become(t){return t instanceof It&&this.children.length==0&&t.children.length==0&&go(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,i){for(let r=0,s=0;r<t.children.length;r++){let h=t.children[r],u=s+h.length;if(u>=i){if(h instanceof It)return h;if(u>i)break}s=u+h.breakAfter}return null}}class yi extends xt{constructor(t,i,r){super(),this.widget=t,this.length=i,this.deco=r,this.breakAfter=0,this.prevWidget=null}merge(t,i,r,s,h,u){return r&&(!(r instanceof yi)||!this.widget.compare(r.widget)||t>0&&h<=0||i<this.length&&u<=0)?!1:(this.length=t+(r?r.length:0)+(this.length-i),!0)}domAtPos(t){return t==0?se.before(this.dom):se.after(this.dom,t==this.length)}split(t){let i=this.length-t;this.length=t;let r=new yi(this.widget,i,this.deco);return r.breakAfter=this.breakAfter,r}get children(){return za}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):dt.empty}domBoundsAround(){return null}become(t){return t instanceof yi&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,i){let r=this.widget.coordsAt(this.dom,t,i);return r||(this.widget instanceof wa?null:$r(this.dom.getBoundingClientRect(),this.length?t==0:i<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:i,endSide:r}=this.deco;return i==r?!1:t<0?i<0:r>0}}class wa extends ko{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class _r{constructor(t,i,r,s){this.doc=t,this.pos=i,this.end=r,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=i}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof yi&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new It),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Vs(new Yn(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof yi)&&this.getLine()}buildText(t,i,r){for(;t>0;){if(this.textOff==this.text.length){let{value:h,lineBreak:u,done:d}=this.cursor.next(this.skip);if(this.skip=0,d)throw new Error("Ran out of text content when drawing inline views");if(u){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=h,this.textOff=0}let s=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(i.slice(i.length-r)),this.getLine().append(Vs(new Ke(this.text.slice(this.textOff,this.textOff+s)),i),r),this.atCursorPos=!0,this.textOff+=s,t-=s,r=0}}span(t,i,r,s){this.buildText(i-t,r,s),this.pos=i,this.openStart<0&&(this.openStart=s)}point(t,i,r,s,h,u){if(this.disallowBlockEffectsFor[u]&&r instanceof zi){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(i>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let d=i-t;if(r instanceof zi)if(r.block)r.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new yi(r.widget||Xn.block,d,r));else{let p=ln.create(r.widget||Xn.inline,d,d?0:r.startSide),v=this.atCursorPos&&!p.isEditable&&h<=s.length&&(t<i||r.startSide>0),y=!p.isEditable&&(t<i||h>s.length||r.startSide<=0),w=this.getLine();this.pendingBuffer==2&&!v&&!p.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),v&&(w.append(Vs(new Yn(1),s),h),h=s.length+Math.max(0,h-s.length)),w.append(Vs(p,s),h),this.atCursorPos=y,this.pendingBuffer=y?t<i||h>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);d&&(this.textOff+d<=this.text.length?this.textOff+=d:(this.skip+=d-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=i),this.openStart<0&&(this.openStart=h)}static build(t,i,r,s,h){let u=new _r(t,i,r,h);return u.openEnd=Ct.spans(s,i,r,u),u.openStart<0&&(u.openStart=u.openEnd),u.finish(u.openEnd),u}}function Vs(f,t){for(let i of t)f=new bi(i,[f],f.length);return f}class Xn extends ko{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Xn.inline=new Xn("span");Xn.block=new Xn("div");var te=function(f){return f[f.LTR=0]="LTR",f[f.RTL=1]="RTL",f}(te||(te={}));const un=te.LTR,Ka=te.RTL;function jc(f){let t=[];for(let i=0;i<f.length;i++)t.push(1<<+f[i]);return t}const j0=jc("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),J0=jc("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Sa=Object.create(null),Je=[];for(let f of["()","[]","{}"]){let t=f.charCodeAt(0),i=f.charCodeAt(1);Sa[t]=i,Sa[i]=-t}function Jc(f){return f<=247?j0[f]:1424<=f&&f<=1524?2:1536<=f&&f<=1785?J0[f-1536]:1774<=f&&f<=2220?4:8192<=f&&f<=8204?256:64336<=f&&f<=65023?4:1}const Z0=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ii{get dir(){return this.level%2?Ka:un}constructor(t,i,r){this.from=t,this.to=i,this.level=r}side(t,i){return this.dir==i==t?this.to:this.from}forward(t,i){return t==(this.dir==i)}static find(t,i,r,s){let h=-1;for(let u=0;u<t.length;u++){let d=t[u];if(d.from<=i&&d.to>=i){if(d.level==r)return u;(h<0||(s!=0?s<0?d.from<i:d.to>i:t[h].level>d.level))&&(h=u)}}if(h<0)throw new RangeError("Index out of range");return h}}function Zc(f,t){if(f.length!=t.length)return!1;for(let i=0;i<f.length;i++){let r=f[i],s=t[i];if(r.from!=s.from||r.to!=s.to||r.direction!=s.direction||!Zc(r.inner,s.inner))return!1}return!0}const bt=[];function Q0(f,t,i,r,s){for(let h=0;h<=r.length;h++){let u=h?r[h-1].to:t,d=h<r.length?r[h].from:i,p=h?256:s;for(let v=u,y=p,w=p;v<d;v++){let S=Jc(f.charCodeAt(v));S==512?S=y:S==8&&w==4&&(S=16),bt[v]=S==4?2:S,S&7&&(w=S),y=S}for(let v=u,y=p,w=p;v<d;v++){let S=bt[v];if(S==128)v<d-1&&y==bt[v+1]&&y&24?S=bt[v]=y:bt[v]=256;else if(S==64){let A=v+1;for(;A<d&&bt[A]==64;)A++;let M=v&&y==8||A<i&&bt[A]==8?w==1?1:8:256;for(let D=v;D<A;D++)bt[D]=M;v=A-1}else S==8&&w==1&&(bt[v]=1);y=S,S&7&&(w=S)}}}function $0(f,t,i,r,s){let h=s==1?2:1;for(let u=0,d=0,p=0;u<=r.length;u++){let v=u?r[u-1].to:t,y=u<r.length?r[u].from:i;for(let w=v,S,A,M;w<y;w++)if(A=Sa[S=f.charCodeAt(w)])if(A<0){for(let D=d-3;D>=0;D-=3)if(Je[D+1]==-A){let N=Je[D+2],P=N&2?s:N&4?N&1?h:s:0;P&&(bt[w]=bt[Je[D]]=P),d=D;break}}else{if(Je.length==189)break;Je[d++]=w,Je[d++]=S,Je[d++]=p}else if((M=bt[w])==2||M==1){let D=M==s;p=D?0:1;for(let N=d-3;N>=0;N-=3){let P=Je[N+2];if(P&2)break;if(D)Je[N+2]|=2;else{if(P&4)break;Je[N+2]|=4}}}}}function tm(f,t,i,r){for(let s=0,h=r;s<=i.length;s++){let u=s?i[s-1].to:f,d=s<i.length?i[s].from:t;for(let p=u;p<d;){let v=bt[p];if(v==256){let y=p+1;for(;;)if(y==d){if(s==i.length)break;y=i[s++].to,d=s<i.length?i[s].from:t}else if(bt[y]==256)y++;else break;let w=h==1,S=(y<t?bt[y]:r)==1,A=w==S?w?1:2:r;for(let M=y,D=s,N=D?i[D-1].to:f;M>p;)M==N&&(M=i[--D].from,N=D?i[D-1].to:f),bt[--M]=A;p=y}else h=v,p++}}}function ka(f,t,i,r,s,h,u){let d=r%2?2:1;if(r%2==s%2)for(let p=t,v=0;p<i;){let y=!0,w=!1;if(v==h.length||p<h[v].from){let D=bt[p];D!=d&&(y=!1,w=D==16)}let S=!y&&d==1?[]:null,A=y?r:r+1,M=p;t:for(;;)if(v<h.length&&M==h[v].from){if(w)break t;let D=h[v];if(!y)for(let N=D.to,P=v+1;;){if(N==i)break t;if(P<h.length&&h[P].from==N)N=h[P++].to;else{if(bt[N]==d)break t;break}}if(v++,S)S.push(D);else{D.from>p&&u.push(new Ii(p,D.from,A));let N=D.direction==un!=!(A%2);Ca(f,N?r+1:r,s,D.inner,D.from,D.to,u),p=D.to}M=D.to}else{if(M==i||(y?bt[M]!=d:bt[M]==d))break;M++}S?ka(f,p,M,r+1,s,S,u):p<M&&u.push(new Ii(p,M,A)),p=M}else for(let p=i,v=h.length;p>t;){let y=!0,w=!1;if(!v||p>h[v-1].to){let D=bt[p-1];D!=d&&(y=!1,w=D==16)}let S=!y&&d==1?[]:null,A=y?r:r+1,M=p;t:for(;;)if(v&&M==h[v-1].to){if(w)break t;let D=h[--v];if(!y)for(let N=D.from,P=v;;){if(N==t)break t;if(P&&h[P-1].to==N)N=h[--P].from;else{if(bt[N-1]==d)break t;break}}if(S)S.push(D);else{D.to<p&&u.push(new Ii(D.to,p,A));let N=D.direction==un!=!(A%2);Ca(f,N?r+1:r,s,D.inner,D.from,D.to,u),p=D.from}M=D.from}else{if(M==t||(y?bt[M-1]!=d:bt[M-1]==d))break;M--}S?ka(f,M,p,r+1,s,S,u):M<p&&u.push(new Ii(M,p,A)),p=M}}function Ca(f,t,i,r,s,h,u){let d=t%2?2:1;Q0(f,s,h,r,d),$0(f,s,h,r,d),tm(s,h,r,d),ka(f,s,h,t,i,r,u)}function em(f,t,i){if(!f)return[new Ii(0,0,t==Ka?1:0)];if(t==un&&!i.length&&!Z0.test(f))return Qc(f.length);if(i.length)for(;f.length>bt.length;)bt[bt.length]=256;let r=[],s=t==un?0:1;return Ca(f,s,s,i,0,f.length,r),r}function Qc(f){return[new Ii(0,f,0)]}let $c="";function im(f,t,i,r,s){var h;let u=r.head-f.from,d=Ii.find(t,u,(h=r.bidiLevel)!==null&&h!==void 0?h:-1,r.assoc),p=t[d],v=p.side(s,i);if(u==v){let S=d+=s?1:-1;if(S<0||S>=t.length)return null;p=t[d=S],u=p.side(!s,i),v=p.side(s,i)}let y=ii(f.text,u,p.forward(s,i));(y<p.from||y>p.to)&&(y=v),$c=f.text.slice(Math.min(u,y),Math.max(u,y));let w=d==(s?t.length-1:0)?null:t[d+(s?1:-1)];return w&&y==v&&w.level+(s?0:1)<p.level?j.cursor(w.side(!s,i)+f.from,w.forward(s,i)?1:-1,w.level):j.cursor(y+f.from,p.forward(s,i)?-1:1,p.level)}function nm(f,t,i){for(let r=t;r<i;r++){let s=Jc(f.charCodeAt(r));if(s==1)return un;if(s==2||s==4)return Ka}return un}const td=ot.define(),ed=ot.define(),id=ot.define(),nd=ot.define(),Aa=ot.define(),rd=ot.define(),sd=ot.define(),Ua=ot.define(),Va=ot.define(),od=ot.define({combine:f=>f.some(t=>t)}),rm=ot.define({combine:f=>f.some(t=>t)}),ld=ot.define();class Vn{constructor(t,i="nearest",r="nearest",s=5,h=5,u=!1){this.range=t,this.y=i,this.x=r,this.yMargin=s,this.xMargin=h,this.isSnapshot=u}map(t){return t.empty?this:new Vn(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Vn(j.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Gs=Wt.define({map:(f,t)=>f.map(t)}),ad=Wt.define();function ni(f,t,i){let r=f.facet(nd);r.length?r[0](t):window.onerror&&window.onerror(String(t),i,void 0,void 0,t)||(i?console.error(i+":",t):console.error(t))}const gi=ot.define({combine:f=>f.length?f[0]:!0});let sm=0;const zn=ot.define({combine(f){return f.filter((t,i)=>{for(let r=0;r<i;r++)if(f[r].plugin==t.plugin)return!1;return!0})}});class cn{constructor(t,i,r,s,h){this.id=t,this.create=i,this.domEventHandlers=r,this.domEventObservers=s,this.baseExtensions=h(this),this.extension=this.baseExtensions.concat(zn.of({plugin:this,arg:void 0}))}of(t){return this.baseExtensions.concat(zn.of({plugin:this,arg:t}))}static define(t,i){const{eventHandlers:r,eventObservers:s,provide:h,decorations:u}=i||{};return new cn(sm++,t,r,s,d=>{let p=[];return u&&p.push(Jr.of(v=>{let y=v.plugin(d);return y?u(y):Ht.none})),h&&p.push(h(d)),p})}static fromClass(t,i){return cn.define((r,s)=>new t(r,s),i)}}class _l{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(t){if(this.value){if(this.mustUpdate){let i=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(i)}catch(r){if(ni(i.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(t,this.spec.arg)}catch(i){ni(t.state,i,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var i;if(!((i=this.value)===null||i===void 0)&&i.destroy)try{this.value.destroy()}catch(r){ni(t.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const hd=ot.define(),Ga=ot.define(),Jr=ot.define(),fd=ot.define(),_a=ot.define(),ud=ot.define();function Lu(f,t){let i=f.state.facet(ud);if(!i.length)return i;let r=i.map(h=>h instanceof Function?h(f):h),s=[];return Ct.spans(r,t.from,t.to,{point(){},span(h,u,d,p){let v=h-t.from,y=u-t.from,w=s;for(let S=d.length-1;S>=0;S--,p--){let A=d[S].spec.bidiIsolate,M;if(A==null&&(A=nm(t.text,v,y)),p>0&&w.length&&(M=w[w.length-1]).to==v&&M.direction==A)M.to=y,w=M.inner;else{let D={from:v,to:y,direction:A,inner:[]};w.push(D),w=D.inner}}}}),s}const cd=ot.define();function dd(f){let t=0,i=0,r=0,s=0;for(let h of f.state.facet(cd)){let u=h(f);u&&(u.left!=null&&(t=Math.max(t,u.left)),u.right!=null&&(i=Math.max(i,u.right)),u.top!=null&&(r=Math.max(r,u.top)),u.bottom!=null&&(s=Math.max(s,u.bottom)))}return{left:t,right:i,top:r,bottom:s}}const Hr=ot.define();class Ee{constructor(t,i,r,s){this.fromA=t,this.toA=i,this.fromB=r,this.toB=s}join(t){return new Ee(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let i=t.length,r=this;for(;i>0;i--){let s=t[i-1];if(!(s.fromA>r.toA)){if(s.toA<r.fromA)break;r=r.join(s),t.splice(i-1,1)}}return t.splice(i,0,r),t}static extendWithRanges(t,i){if(i.length==0)return t;let r=[];for(let s=0,h=0,u=0,d=0;;s++){let p=s==t.length?null:t[s],v=u-d,y=p?p.fromB:1e9;for(;h<i.length&&i[h]<y;){let w=i[h],S=i[h+1],A=Math.max(d,w),M=Math.min(y,S);if(A<=M&&new Ee(A+v,M+v,A,M).addToSet(r),S>y)break;h+=2}if(!p)return r;new Ee(p.fromA,p.toA,p.fromB,p.toB).addToSet(r),u=p.toA,d=p.toB}}}class mo{constructor(t,i,r){this.view=t,this.state=i,this.transactions=r,this.flags=0,this.startState=t.state,this.changes=Yt.empty(this.startState.doc.length);for(let h of r)this.changes=this.changes.compose(h.changes);let s=[];this.changes.iterChangedRanges((h,u,d,p)=>s.push(new Ee(h,u,d,p))),this.changedRanges=s}static create(t,i,r){return new mo(t,i,r)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Ou extends xt{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Ht.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new It],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Ee(0,0,0,t.state.doc.length)],0,null)}update(t){var i;let r=t.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:v,toA:y})=>y<this.minWidthFrom||v>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((i=this.domChanged)===null||i===void 0)&&i.newSel?s=this.domChanged.newSel.head:!cm(t.changes,this.hasComposition)&&!t.selectionSet&&(s=t.state.selection.main.head));let h=s>-1?lm(this.view,t.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:v,to:y}=this.hasComposition;r=new Ee(v,y,t.changes.mapPos(v,-1),t.changes.mapPos(y,1)).addToSet(r.slice())}this.hasComposition=h?{from:h.range.fromB,to:h.range.toB}:null,(G.ie||G.chrome)&&!h&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let u=this.decorations,d=this.updateDeco(),p=fm(u,d,t.changes);return r=Ee.extendWithRanges(r,p),!(this.flags&7)&&r.length==0?!1:(this.updateInner(r,t.startState.doc.length,h),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,i,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,i,r);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let u=G.chrome||G.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,u),this.flags&=-8,u&&(u.written||s.selectionRange.focusNode!=u.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(u=>u.flags&=-9);let h=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let u of this.children)u instanceof yi&&u.widget instanceof wa&&h.push(u.dom);s.updateGaps(h)}updateChildren(t,i,r){let s=r?r.range.addToSet(t.slice()):t,h=this.childCursor(i);for(let u=s.length-1;;u--){let d=u>=0?s[u]:null;if(!d)break;let{fromA:p,toA:v,fromB:y,toB:w}=d,S,A,M,D;if(r&&r.range.fromB<w&&r.range.toB>y){let J=_r.build(this.view.state.doc,y,r.range.fromB,this.decorations,this.dynamicDecorationMap),_=_r.build(this.view.state.doc,r.range.toB,w,this.decorations,this.dynamicDecorationMap);A=J.breakAtStart,M=J.openStart,D=_.openEnd;let et=this.compositionView(r);_.breakAtStart?et.breakAfter=1:_.content.length&&et.merge(et.length,et.length,_.content[0],!1,_.openStart,0)&&(et.breakAfter=_.content[0].breakAfter,_.content.shift()),J.content.length&&et.merge(0,0,J.content[J.content.length-1],!0,0,J.openEnd)&&J.content.pop(),S=J.content.concat(et).concat(_.content)}else({content:S,breakAtStart:A,openStart:M,openEnd:D}=_r.build(this.view.state.doc,y,w,this.decorations,this.dynamicDecorationMap));let{i:N,off:P}=h.findPos(v,1),{i:H,off:q}=h.findPos(p,-1);Kc(this,H,q,N,P,S,A,M,D)}r&&this.fixCompositionDOM(r)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let i of t.transactions)for(let r of i.effects)r.is(ad)&&(this.editContextFormatting=r.value)}compositionView(t){let i=new Ke(t.text.nodeValue);i.flags|=8;for(let{deco:s}of t.marks)i=new bi(s,[i],i.length);let r=new It;return r.append(i,0),r}fixCompositionDOM(t){let i=(h,u)=>{u.flags|=8|(u.children.some(p=>p.flags&7)?1:0),this.markedForComposition.add(u);let d=xt.get(h);d&&d!=u&&(d.dom=null),u.setDOM(h)},r=this.childPos(t.range.fromB,1),s=this.children[r.i];i(t.line,s);for(let h=t.marks.length-1;h>=-1;h--)r=s.childPos(r.off,1),s=s.children[r.i],i(h>=0?t.marks[h].node:t.text,s)}updateSelection(t=!1,i=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,s=r==this.dom,h=!s&&!(this.view.state.facet(gi)||this.dom.tabIndex>-1)&&so(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(s||i||h))return;let u=this.forceSelection;this.forceSelection=!1;let d=this.view.state.selection.main,p=this.moveToLine(this.domAtPos(d.anchor)),v=d.empty?p:this.moveToLine(this.domAtPos(d.head));if(G.gecko&&d.empty&&!this.hasComposition&&om(p)){let w=document.createTextNode("");this.view.observer.ignore(()=>p.node.insertBefore(w,p.node.childNodes[p.offset]||null)),p=v=new se(w,0),u=!0}let y=this.view.observer.selectionRange;(u||!y.focusNode||(!Gr(p.node,p.offset,y.anchorNode,y.anchorOffset)||!Gr(v.node,v.offset,y.focusNode,y.focusOffset))&&!this.suppressWidgetCursorChange(y,d))&&(this.view.observer.ignore(()=>{G.android&&G.chrome&&this.dom.contains(y.focusNode)&&um(y.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let w=jr(this.view.root);if(w)if(d.empty){if(G.gecko){let S=am(p.node,p.offset);if(S&&S!=3){let A=(S==1?Hc:Fc)(p.node,p.offset);A&&(p=new se(A.node,A.offset))}}w.collapse(p.node,p.offset),d.bidiLevel!=null&&w.caretBidiLevel!==void 0&&(w.caretBidiLevel=d.bidiLevel)}else if(w.extend){w.collapse(p.node,p.offset);try{w.extend(v.node,v.offset)}catch{}}else{let S=document.createRange();d.anchor>d.head&&([p,v]=[v,p]),S.setEnd(v.node,v.offset),S.setStart(p.node,p.offset),w.removeAllRanges(),w.addRange(S)}h&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(p,v)),this.impreciseAnchor=p.precise?null:new se(y.anchorNode,y.anchorOffset),this.impreciseHead=v.precise?null:new se(y.focusNode,y.focusOffset)}suppressWidgetCursorChange(t,i){return this.hasComposition&&i.empty&&Gr(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==i.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,i=t.state.selection.main,r=jr(t.root),{anchorNode:s,anchorOffset:h}=t.observer.selectionRange;if(!r||!i.empty||!i.assoc||!r.modify)return;let u=It.find(this,i.head);if(!u)return;let d=u.posAtStart;if(i.head==d||i.head==d+u.length)return;let p=this.coordsAt(i.head,-1),v=this.coordsAt(i.head,1);if(!p||!v||p.bottom>v.top)return;let y=this.domAtPos(i.head+i.assoc);r.collapse(y.node,y.offset),r.modify("move",i.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let w=t.observer.selectionRange;t.docView.posFromDOM(w.anchorNode,w.anchorOffset)!=i.from&&r.collapse(s,h)}moveToLine(t){let i=this.dom,r;if(t.node!=i)return t;for(let s=t.offset;!r&&s<i.childNodes.length;s++){let h=xt.get(i.childNodes[s]);h instanceof It&&(r=h.domAtPos(0))}for(let s=t.offset-1;!r&&s>=0;s--){let h=xt.get(i.childNodes[s]);h instanceof It&&(r=h.domAtPos(h.length))}return r?new se(r.node,r.offset,!0):t}nearest(t){for(let i=t;i;){let r=xt.get(i);if(r&&r.rootView==this)return r;i=i.parentNode}return null}posFromDOM(t,i){let r=this.nearest(t);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(t,i)+r.posAtStart}domAtPos(t){let{i,off:r}=this.childCursor().findPos(t,-1);for(;i<this.children.length-1;){let s=this.children[i];if(r<s.length||s instanceof It)break;i++,r=0}return this.children[i].domAtPos(r)}coordsAt(t,i){let r=null,s=0;for(let h=this.length,u=this.children.length-1;u>=0;u--){let d=this.children[u],p=h-d.breakAfter,v=p-d.length;if(p<t)break;if(v<=t&&(v<t||d.covers(-1))&&(p>t||d.covers(1))&&(!r||d instanceof It&&!(r instanceof It&&i>=0)))r=d,s=v;else if(r&&v==t&&p==t&&d instanceof yi&&Math.abs(i)<2){if(d.deco.startSide<0)break;u&&(r=null)}h=v}return r?r.coordsAt(t-s,i):null}coordsForChar(t){let{i,off:r}=this.childPos(t,1),s=this.children[i];if(!(s instanceof It))return null;for(;s.children.length;){let{i:d,off:p}=s.childPos(r,1);for(;;d++){if(d==s.children.length)return null;if((s=s.children[d]).length)break}r=p}if(!(s instanceof Ke))return null;let h=ii(s.text,r);if(h==r)return null;let u=fn(s.dom,r,h).getClientRects();for(let d=0;d<u.length;d++){let p=u[d];if(d==u.length-1||p.top<p.bottom&&p.left<p.right)return p}return null}measureVisibleLineHeights(t){let i=[],{from:r,to:s}=t,h=this.view.contentDOM.clientWidth,u=h>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,d=-1,p=this.view.textDirection==te.LTR;for(let v=0,y=0;y<this.children.length;y++){let w=this.children[y],S=v+w.length;if(S>s)break;if(v>=r){let A=w.dom.getBoundingClientRect();if(i.push(A.height),u){let M=w.dom.lastChild,D=M?qn(M):[];if(D.length){let N=D[D.length-1],P=p?N.right-A.left:A.right-N.left;P>d&&(d=P,this.minWidth=h,this.minWidthFrom=v,this.minWidthTo=S)}}}v=S+w.breakAfter}return i}textDirectionAt(t){let{i}=this.childPos(t,1);return getComputedStyle(this.children[i].dom).direction=="rtl"?te.RTL:te.LTR}measureTextSize(){for(let h of this.children)if(h instanceof It){let u=h.measureTextSize();if(u)return u}let t=document.createElement("div"),i,r,s;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let h=qn(t.firstChild)[0];i=t.getBoundingClientRect().height,r=h?h.width/27:7,s=h?h.height:i,t.remove()}),{lineHeight:i,charWidth:r,textHeight:s}}childCursor(t=this.length){let i=this.children.length;return i&&(t-=this.children[--i].length),new zc(this.children,t,i)}computeBlockGapDeco(){let t=[],i=this.view.viewState;for(let r=0,s=0;;s++){let h=s==i.viewports.length?null:i.viewports[s],u=h?h.from-1:this.length;if(u>r){let d=(i.lineBlockAt(u).bottom-i.lineBlockAt(r).top)/this.view.scaleY;t.push(Ht.replace({widget:new wa(d),block:!0,inclusive:!0,isBlockGap:!0}).range(r,u))}if(!h)break;r=h.to+1}return Ht.set(t)}updateDeco(){let t=1,i=this.view.state.facet(Jr).map(h=>(this.dynamicDecorationMap[t++]=typeof h=="function")?h(this.view):h),r=!1,s=this.view.state.facet(fd).map((h,u)=>{let d=typeof h=="function";return d&&(r=!0),d?h(this.view):h});for(s.length&&(this.dynamicDecorationMap[t++]=r,i.push(Ct.join(s))),this.decorations=[this.editContextFormatting,...i,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let v=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=v.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let v of this.view.state.facet(ld))try{if(v(this.view,t.range,t))return!0}catch(y){ni(this.view.state,y,"scroll handler")}let{range:i}=t,r=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1),s;if(!r)return;!i.empty&&(s=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(r={left:Math.min(r.left,s.left),top:Math.min(r.top,s.top),right:Math.max(r.right,s.right),bottom:Math.max(r.bottom,s.bottom)});let h=dd(this.view),u={left:r.left-h.left,top:r.top-h.top,right:r.right+h.right,bottom:r.bottom+h.bottom},{offsetWidth:d,offsetHeight:p}=this.view.scrollDOM;H0(this.view.scrollDOM,u,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,d),-d),Math.max(Math.min(t.yMargin,p),-p),this.view.textDirection==te.LTR)}}function om(f){return f.node.nodeType==1&&f.node.firstChild&&(f.offset==0||f.node.childNodes[f.offset-1].contentEditable=="false")&&(f.offset==f.node.childNodes.length||f.node.childNodes[f.offset].contentEditable=="false")}function pd(f,t){let i=f.observer.selectionRange;if(!i.focusNode)return null;let r=Hc(i.focusNode,i.focusOffset),s=Fc(i.focusNode,i.focusOffset),h=r||s;if(s&&r&&s.node!=r.node){let d=xt.get(s.node);if(!d||d instanceof Ke&&d.text!=s.node.nodeValue)h=s;else if(f.docView.lastCompositionAfterCursor){let p=xt.get(r.node);!p||p instanceof Ke&&p.text!=r.node.nodeValue||(h=s)}}if(f.docView.lastCompositionAfterCursor=h!=r,!h)return null;let u=t-h.offset;return{from:u,to:u+h.node.nodeValue.length,node:h.node}}function lm(f,t,i){let r=pd(f,i);if(!r)return null;let{node:s,from:h,to:u}=r,d=s.nodeValue;if(/[\n\r]/.test(d)||f.state.doc.sliceString(r.from,r.to)!=d)return null;let p=t.invertedDesc,v=new Ee(p.mapPos(h),p.mapPos(u),h,u),y=[];for(let w=s.parentNode;;w=w.parentNode){let S=xt.get(w);if(S instanceof bi)y.push({node:w,deco:S.mark});else{if(S instanceof It||w.nodeName=="DIV"&&w.parentNode==f.contentDOM)return{range:v,text:s,marks:y,line:w};if(w!=f.contentDOM)y.push({node:w,deco:new ts({inclusive:!0,attributes:Y0(w),tagName:w.tagName.toLowerCase()})});else return null}}}function am(f,t){return f.nodeType!=1?0:(t&&f.childNodes[t-1].contentEditable=="false"?1:0)|(t<f.childNodes.length&&f.childNodes[t].contentEditable=="false"?2:0)}let hm=class{constructor(){this.changes=[]}compareRange(t,i){oo(t,i,this.changes)}comparePoint(t,i){oo(t,i,this.changes)}boundChange(t){oo(t,t,this.changes)}};function fm(f,t,i){let r=new hm;return Ct.compare(f,t,i,r),r.changes}function um(f,t){for(let i=f;i&&i!=t;i=i.assignedSlot||i.parentNode)if(i.nodeType==1&&i.contentEditable=="false")return!0;return!1}function cm(f,t){let i=!1;return t&&f.iterChangedRanges((r,s)=>{r<t.to&&s>t.from&&(i=!0)}),i}function dm(f,t,i=1){let r=f.charCategorizer(t),s=f.doc.lineAt(t),h=t-s.from;if(s.length==0)return j.cursor(t);h==0?i=1:h==s.length&&(i=-1);let u=h,d=h;i<0?u=ii(s.text,h,!1):d=ii(s.text,h);let p=r(s.text.slice(u,d));for(;u>0;){let v=ii(s.text,u,!1);if(r(s.text.slice(v,u))!=p)break;u=v}for(;d<s.length;){let v=ii(s.text,d);if(r(s.text.slice(d,v))!=p)break;d=v}return j.range(u+s.from,d+s.from)}function pm(f,t){return t.left>f?t.left-f:Math.max(0,f-t.right)}function gm(f,t){return t.top>f?t.top-f:Math.max(0,f-t.bottom)}function ql(f,t){return f.top<t.bottom-1&&f.bottom>t.top+1}function Du(f,t){return t<f.top?{top:t,left:f.left,right:f.right,bottom:f.bottom}:f}function Nu(f,t){return t>f.bottom?{top:f.top,left:f.left,right:f.right,bottom:t}:f}function Ma(f,t,i){let r,s,h,u,d=!1,p,v,y,w;for(let M=f.firstChild;M;M=M.nextSibling){let D=qn(M);for(let N=0;N<D.length;N++){let P=D[N];s&&ql(s,P)&&(P=Du(Nu(P,s.bottom),s.top));let H=pm(t,P),q=gm(i,P);if(H==0&&q==0)return M.nodeType==3?Pu(M,t,i):Ma(M,t,i);(!r||u>q||u==q&&h>H)&&(r=M,s=P,h=H,u=q,d=H?t<P.left?N>0:N<D.length-1:!0),H==0?i>P.bottom&&(!y||y.bottom<P.bottom)?(p=M,y=P):i<P.top&&(!w||w.top>P.top)&&(v=M,w=P):y&&ql(y,P)?y=Nu(y,P.bottom):w&&ql(w,P)&&(w=Du(w,P.top))}}if(y&&y.bottom>=i?(r=p,s=y):w&&w.top<=i&&(r=v,s=w),!r)return{node:f,offset:0};let S=Math.max(s.left,Math.min(s.right,t));if(r.nodeType==3)return Pu(r,S,i);if(d&&r.contentEditable!="false")return Ma(r,S,i);let A=Array.prototype.indexOf.call(f.childNodes,r)+(t>=(s.left+s.right)/2?1:0);return{node:f,offset:A}}function Pu(f,t,i){let r=f.nodeValue.length,s=-1,h=1e9,u=0;for(let d=0;d<r;d++){let p=fn(f,d,d+1).getClientRects();for(let v=0;v<p.length;v++){let y=p[v];if(y.top==y.bottom)continue;u||(u=t-y.left);let w=(y.top>i?y.top-i:i-y.bottom)-1;if(y.left-1<=t&&y.right+1>=t&&w<h){let S=t>=(y.left+y.right)/2,A=S;if((G.chrome||G.gecko)&&fn(f,d).getBoundingClientRect().left==y.right&&(A=!S),w<=0)return{node:f,offset:d+(A?1:0)};s=d+(A?1:0),h=w}}}return{node:f,offset:s>-1?s:u>0?f.nodeValue.length:0}}function gd(f,t,i,r=-1){var s,h;let u=f.contentDOM.getBoundingClientRect(),d=u.top+f.viewState.paddingTop,p,{docHeight:v}=f.viewState,{x:y,y:w}=t,S=w-d;if(S<0)return 0;if(S>v)return f.state.doc.length;for(let J=f.viewState.heightOracle.textHeight/2,_=!1;p=f.elementAtHeight(S),p.type!=si.Text;)for(;S=r>0?p.bottom+J:p.top-J,!(S>=0&&S<=v);){if(_)return i?null:0;_=!0,r=-r}w=d+S;let A=p.from;if(A<f.viewport.from)return f.viewport.from==0?0:i?null:Eu(f,u,p,y,w);if(A>f.viewport.to)return f.viewport.to==f.state.doc.length?f.state.doc.length:i?null:Eu(f,u,p,y,w);let M=f.dom.ownerDocument,D=f.root.elementFromPoint?f.root:M,N=D.elementFromPoint(y,w);N&&!f.contentDOM.contains(N)&&(N=null),N||(y=Math.max(u.left+1,Math.min(u.right-1,y)),N=D.elementFromPoint(y,w),N&&!f.contentDOM.contains(N)&&(N=null));let P,H=-1;if(N&&((s=f.docView.nearest(N))===null||s===void 0?void 0:s.isEditable)!=!1){if(M.caretPositionFromPoint){let J=M.caretPositionFromPoint(y,w);J&&({offsetNode:P,offset:H}=J)}else if(M.caretRangeFromPoint){let J=M.caretRangeFromPoint(y,w);J&&({startContainer:P,startOffset:H}=J,(!f.contentDOM.contains(P)||G.safari&&mm(P,H,y)||G.chrome&&vm(P,H,y))&&(P=void 0))}P&&(H=Math.min(oi(P),H))}if(!P||!f.docView.dom.contains(P)){let J=It.find(f.docView,A);if(!J)return S>p.top+p.height/2?p.to:p.from;({node:P,offset:H}=Ma(J.dom,y,w))}let q=f.docView.nearest(P);if(!q)return null;if(q.isWidget&&((h=q.dom)===null||h===void 0?void 0:h.nodeType)==1){let J=q.dom.getBoundingClientRect();return t.y<J.top||t.y<=J.bottom&&t.x<=(J.left+J.right)/2?q.posAtStart:q.posAtEnd}else return q.localPosFromDOM(P,H)+q.posAtStart}function Eu(f,t,i,r,s){let h=Math.round((r-t.left)*f.defaultCharacterWidth);if(f.lineWrapping&&i.height>f.defaultLineHeight*1.5){let d=f.viewState.heightOracle.textHeight,p=Math.floor((s-i.top-(f.defaultLineHeight-d)*.5)/d);h+=p*f.viewState.heightOracle.lineLength}let u=f.state.sliceDoc(i.from,i.to);return i.from+P0(u,h,f.state.tabSize)}function mm(f,t,i){let r,s=f;if(f.nodeType!=3||t!=(r=f.nodeValue.length))return!1;for(;;){let h=s.nextSibling;if(h){if(h.nodeName=="BR")break;return!1}else{let u=s.parentNode;if(!u||u.nodeName=="DIV")break;s=u}}return fn(f,r-1,r).getBoundingClientRect().right>i}function vm(f,t,i){if(t!=0)return!1;for(let s=f;;){let h=s.parentNode;if(!h||h.nodeType!=1||h.firstChild!=s)return!1;if(h.classList.contains("cm-line"))break;s=h}let r=f.nodeType==1?f.getBoundingClientRect():fn(f,0,Math.max(f.nodeValue.length,1)).getBoundingClientRect();return i-r.left>5}function ym(f,t,i){let r=f.lineBlockAt(t);if(Array.isArray(r.type)){let s;for(let h of r.type){if(h.from>t)break;if(!(h.to<t)){if(h.from<t&&h.to>t)return h;(!s||h.type==si.Text&&(s.type!=h.type||(i<0?h.from<t:h.to>t)))&&(s=h)}}return s||r}return r}function bm(f,t,i,r){let s=ym(f,t.head,t.assoc||-1),h=!r||s.type!=si.Text||!(f.lineWrapping||s.widgetLineBreaks)?null:f.coordsAtPos(t.assoc<0&&t.head>s.from?t.head-1:t.head);if(h){let u=f.dom.getBoundingClientRect(),d=f.textDirectionAt(s.from),p=f.posAtCoords({x:i==(d==te.LTR)?u.right-1:u.left+1,y:(h.top+h.bottom)/2});if(p!=null)return j.cursor(p,i?-1:1)}return j.cursor(i?s.to:s.from,i?-1:1)}function Bu(f,t,i,r){let s=f.state.doc.lineAt(t.head),h=f.bidiSpans(s),u=f.textDirectionAt(s.from);for(let d=t,p=null;;){let v=im(s,h,u,d,i),y=$c;if(!v){if(s.number==(i?f.state.doc.lines:1))return d;y=`
`,s=f.state.doc.line(s.number+(i?1:-1)),h=f.bidiSpans(s),v=f.visualLineSide(s,!i)}if(p){if(!p(y))return d}else{if(!r)return v;p=r(y)}d=v}}function xm(f,t,i){let r=f.state.charCategorizer(t),s=r(i);return h=>{let u=r(h);return s==mi.Space&&(s=u),s==u}}function wm(f,t,i,r){let s=t.head,h=i?1:-1;if(s==(i?f.state.doc.length:0))return j.cursor(s,t.assoc);let u=t.goalColumn,d,p=f.contentDOM.getBoundingClientRect(),v=f.coordsAtPos(s,t.assoc||-1),y=f.documentTop;if(v)u==null&&(u=v.left-p.left),d=h<0?v.top:v.bottom;else{let A=f.viewState.lineBlockAt(s);u==null&&(u=Math.min(p.right-p.left,f.defaultCharacterWidth*(s-A.from))),d=(h<0?A.top:A.bottom)+y}let w=p.left+u,S=r??f.viewState.heightOracle.textHeight>>1;for(let A=0;;A+=10){let M=d+(S+A)*h,D=gd(f,{x:w,y:M},!1,h);if(M<p.top||M>p.bottom||(h<0?D<s:D>s)){let N=f.docView.coordsForChar(D),P=!N||M<N.top?-1:1;return j.cursor(D,P,void 0,u)}}}function lo(f,t,i){for(;;){let r=0;for(let s of f)s.between(t-1,t+1,(h,u,d)=>{if(t>h&&t<u){let p=r||i||(t-h<u-t?-1:1);t=p<0?h:u,r=p}});if(!r)return t}}function Yl(f,t,i){let r=lo(f.state.facet(_a).map(s=>s(f)),i.from,t.head>i.from?-1:1);return r==i.from?i:j.cursor(r,r<i.from?1:-1)}const Fr="￿";class Sm{constructor(t,i){this.points=t,this.text="",this.lineSeparator=i.facet(ut.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Fr}readRange(t,i){if(!t)return this;let r=t.parentNode;for(let s=t;;){this.findPointBefore(r,s);let h=this.text.length;this.readNode(s);let u=s.nextSibling;if(u==i)break;let d=xt.get(s),p=xt.get(u);(d&&p?d.breakAfter:(d?d.breakAfter:po(s))||po(u)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>h)&&this.lineBreak(),s=u}return this.findPointBefore(r,i),this}readTextNode(t){let i=t.nodeValue;for(let r of this.points)r.node==t&&(r.pos=this.text.length+Math.min(r.offset,i.length));for(let r=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let h=-1,u=1,d;if(this.lineSeparator?(h=i.indexOf(this.lineSeparator,r),u=this.lineSeparator.length):(d=s.exec(i))&&(h=d.index,u=d[0].length),this.append(i.slice(r,h<0?i.length:h)),h<0)break;if(this.lineBreak(),u>1)for(let p of this.points)p.node==t&&p.pos>this.text.length&&(p.pos-=u-1);r=h+u}}readNode(t){if(t.cmIgnore)return;let i=xt.get(t),r=i&&i.overrideDOMText;if(r!=null){this.findPointInside(t,r.length);for(let s=r.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,i){for(let r of this.points)r.node==t&&t.childNodes[r.offset]==i&&(r.pos=this.text.length)}findPointInside(t,i){for(let r of this.points)(t.nodeType==3?r.node==t:t.contains(r.node))&&(r.pos=this.text.length+(km(t,r.node,r.offset)?i:0))}}function km(f,t,i){for(;;){if(!t||i<oi(t))return!1;if(t==f)return!0;i=hn(t)+1,t=t.parentNode}}class Ru{constructor(t,i){this.node=t,this.offset=i,this.pos=-1}}class Cm{constructor(t,i,r,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=i>-1;let{impreciseHead:h,impreciseAnchor:u}=t.docView;if(t.state.readOnly&&i>-1)this.newSel=null;else if(i>-1&&(this.bounds=t.docView.domBoundsAround(i,r,0))){let d=h||u?[]:Tm(t),p=new Sm(d,t.state);p.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=p.text,this.newSel=Lm(d,this.bounds.from)}else{let d=t.observer.selectionRange,p=h&&h.node==d.focusNode&&h.offset==d.focusOffset||!ga(t.contentDOM,d.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(d.focusNode,d.focusOffset),v=u&&u.node==d.anchorNode&&u.offset==d.anchorOffset||!ga(t.contentDOM,d.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(d.anchorNode,d.anchorOffset),y=t.viewport;if((G.ios||G.chrome)&&t.state.selection.main.empty&&p!=v&&(y.from>0||y.to<t.state.doc.length)){let w=Math.min(p,v),S=Math.max(p,v),A=y.from-w,M=y.to-S;(A==0||A==1||w==0)&&(M==0||M==-1||S==t.state.doc.length)&&(p=0,v=t.state.doc.length)}this.newSel=j.single(v,p)}}}function md(f,t){let i,{newSel:r}=t,s=f.state.selection.main,h=f.inputState.lastKeyTime>Date.now()-100?f.inputState.lastKeyCode:-1;if(t.bounds){let{from:u,to:d}=t.bounds,p=s.from,v=null;(h===8||G.android&&t.text.length<d-u)&&(p=s.to,v="end");let y=Mm(f.state.doc.sliceString(u,d,Fr),t.text,p-u,v);y&&(G.chrome&&h==13&&y.toB==y.from+2&&t.text.slice(y.from,y.toB)==Fr+Fr&&y.toB--,i={from:u+y.from,to:u+y.toA,insert:dt.of(t.text.slice(y.from,y.toB).split(Fr))})}else r&&(!f.hasFocus&&f.state.facet(gi)||r.main.eq(s))&&(r=null);if(!i&&!r)return!1;if(!i&&t.typeOver&&!s.empty&&r&&r.main.empty?i={from:s.from,to:s.to,insert:f.state.doc.slice(s.from,s.to)}:(G.mac||G.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&f.contentDOM.getAttribute("autocorrect")=="off"?(r&&i.insert.length==2&&(r=j.single(r.main.anchor-1,r.main.head-1)),i={from:i.from,to:i.to,insert:dt.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:f.state.doc.slice(s.from,i.from).append(i.insert).append(f.state.doc.slice(i.to,s.to))}:G.chrome&&i&&i.from==i.to&&i.from==s.head&&i.insert.toString()==`
 `&&f.lineWrapping&&(r&&(r=j.single(r.main.anchor-1,r.main.head-1)),i={from:s.from,to:s.to,insert:dt.of([" "])}),i)return qa(f,i,r,h);if(r&&!r.main.eq(s)){let u=!1,d="select";return f.inputState.lastSelectionTime>Date.now()-50&&(f.inputState.lastSelectionOrigin=="select"&&(u=!0),d=f.inputState.lastSelectionOrigin),f.dispatch({selection:r,scrollIntoView:u,userEvent:d}),!0}else return!1}function qa(f,t,i,r=-1){if(G.ios&&f.inputState.flushIOSKey(t))return!0;let s=f.state.selection.main;if(G.android&&(t.to==s.to&&(t.from==s.from||t.from==s.from-1&&f.state.sliceDoc(t.from,s.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&Un(f.contentDOM,"Enter",13)||(t.from==s.from-1&&t.to==s.to&&t.insert.length==0||r==8&&t.insert.length<t.to-t.from&&t.to>s.head)&&Un(f.contentDOM,"Backspace",8)||t.from==s.from&&t.to==s.to+1&&t.insert.length==0&&Un(f.contentDOM,"Delete",46)))return!0;let h=t.insert.toString();f.inputState.composing>=0&&f.inputState.composing++;let u,d=()=>u||(u=Am(f,t,i));return f.state.facet(rd).some(p=>p(f,t.from,t.to,h,d))||f.dispatch(d()),!0}function Am(f,t,i){let r,s=f.state,h=s.selection.main;if(t.from>=h.from&&t.to<=h.to&&t.to-t.from>=(h.to-h.from)/3&&(!i||i.main.empty&&i.main.from==t.from+t.insert.length)&&f.inputState.composing<0){let d=h.from<t.from?s.sliceDoc(h.from,t.from):"",p=h.to>t.to?s.sliceDoc(t.to,h.to):"";r=s.replaceSelection(f.state.toText(d+t.insert.sliceString(0,void 0,f.state.lineBreak)+p))}else{let d=s.changes(t),p=i&&i.main.to<=d.newLength?i.main:void 0;if(s.selection.ranges.length>1&&f.inputState.composing>=0&&t.to<=h.to&&t.to>=h.to-10){let v=f.state.sliceDoc(t.from,t.to),y,w=i&&pd(f,i.main.head);if(w){let M=t.insert.length-(t.to-t.from);y={from:w.from,to:w.to-M}}else y=f.state.doc.lineAt(h.head);let S=h.to-t.to,A=h.to-h.from;r=s.changeByRange(M=>{if(M.from==h.from&&M.to==h.to)return{changes:d,range:p||M.map(d)};let D=M.to-S,N=D-v.length;if(M.to-M.from!=A||f.state.sliceDoc(N,D)!=v||M.to>=y.from&&M.from<=y.to)return{range:M};let P=s.changes({from:N,to:D,insert:t.insert}),H=M.to-h.to;return{changes:P,range:p?j.range(Math.max(0,p.anchor+H),Math.max(0,p.head+H)):M.map(P)}})}else r={changes:d,selection:p&&s.selection.replaceRange(p)}}let u="input.type";return(f.composing||f.inputState.compositionPendingChange&&f.inputState.compositionEndedAt>Date.now()-50)&&(f.inputState.compositionPendingChange=!1,u+=".compose",f.inputState.compositionFirstChange&&(u+=".start",f.inputState.compositionFirstChange=!1)),s.update(r,{userEvent:u,scrollIntoView:!0})}function Mm(f,t,i,r){let s=Math.min(f.length,t.length),h=0;for(;h<s&&f.charCodeAt(h)==t.charCodeAt(h);)h++;if(h==s&&f.length==t.length)return null;let u=f.length,d=t.length;for(;u>0&&d>0&&f.charCodeAt(u-1)==t.charCodeAt(d-1);)u--,d--;if(r=="end"){let p=Math.max(0,h-Math.min(u,d));i-=u+p-h}if(u<h&&f.length<t.length){let p=i<=h&&i>=u?h-i:0;h-=p,d=h+(d-u),u=h}else if(d<h){let p=i<=h&&i>=d?h-i:0;h-=p,u=h+(u-d),d=h}return{from:h,toA:u,toB:d}}function Tm(f){let t=[];if(f.root.activeElement!=f.contentDOM)return t;let{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:h}=f.observer.selectionRange;return i&&(t.push(new Ru(i,r)),(s!=i||h!=r)&&t.push(new Ru(s,h))),t}function Lm(f,t){if(f.length==0)return null;let i=f[0].pos,r=f.length==2?f[1].pos:i;return i>-1&&r>-1?j.single(i+t,r+t):null}class Om{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,G.safari&&t.contentDOM.addEventListener("input",()=>null),G.gecko&&_m(t.contentDOM.ownerDocument)}handleEvent(t){!Wm(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(t.type,t)):this.runHandlers(t.type,t))}runHandlers(t,i){let r=this.handlers[t];if(r){for(let s of r.observers)s(this.view,i);for(let s of r.handlers){if(i.defaultPrevented)break;if(s(this.view,i)){i.preventDefault();break}}}}ensureHandlers(t){let i=Dm(t),r=this.handlers,s=this.view.contentDOM;for(let h in i)if(h!="scroll"){let u=!i[h].handlers.length,d=r[h];d&&u!=!d.handlers.length&&(s.removeEventListener(h,this.handleEvent),d=null),d||s.addEventListener(h,this.handleEvent,{passive:u})}for(let h in r)h!="scroll"&&!i[h]&&s.removeEventListener(h,this.handleEvent);this.handlers=i}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&yd.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),G.android&&G.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return G.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((i=vd.find(r=>r.keyCode==t.keyCode))&&!t.ctrlKey||Nm.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=i||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let i=this.pendingIOSKey;return!i||i.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,Un(this.view.contentDOM,i.key,i.keyCode,i instanceof KeyboardEvent?i:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:G.safari&&!G.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Iu(f,t){return(i,r)=>{try{return t.call(f,r,i)}catch(s){ni(i.state,s)}}}function Dm(f){let t=Object.create(null);function i(r){return t[r]||(t[r]={observers:[],handlers:[]})}for(let r of f){let s=r.spec,h=s&&s.plugin.domEventHandlers,u=s&&s.plugin.domEventObservers;if(h)for(let d in h){let p=h[d];p&&i(d).handlers.push(Iu(r.value,p))}if(u)for(let d in u){let p=u[d];p&&i(d).observers.push(Iu(r.value,p))}}for(let r in Ue)i(r).handlers.push(Ue[r]);for(let r in Re)i(r).observers.push(Re[r]);return t}const vd=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Nm="dthko",yd=[16,17,18,20,91,92,224,225],_s=6;function qs(f){return Math.max(0,f)*.7+8}function Pm(f,t){return Math.max(Math.abs(f.clientX-t.clientX),Math.abs(f.clientY-t.clientY))}class Em{constructor(t,i,r,s){this.view=t,this.startEvent=i,this.style=r,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=i,this.scrollParents=F0(t.contentDOM),this.atoms=t.state.facet(_a).map(u=>u(t));let h=t.contentDOM.ownerDocument;h.addEventListener("mousemove",this.move=this.move.bind(this)),h.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=t.state.facet(ut.allowMultipleSelections)&&Bm(t,i),this.dragging=Im(t,i)&&wd(i)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Pm(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let i=0,r=0,s=0,h=0,u=this.view.win.innerWidth,d=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:u}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:h,bottom:d}=this.scrollParents.y.getBoundingClientRect());let p=dd(this.view);t.clientX-p.left<=s+_s?i=-qs(s-t.clientX):t.clientX+p.right>=u-_s&&(i=qs(t.clientX-u)),t.clientY-p.top<=h+_s?r=-qs(h-t.clientY):t.clientY+p.bottom>=d-_s&&(r=qs(t.clientY-d)),this.setScrollSpeed(i,r)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,i){this.scrollSpeed={x:t,y:i},t||i?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:i}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),i&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=i,i=0),(t||i)&&this.view.win.scrollBy(t,i),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let i=null;for(let r=0;r<t.ranges.length;r++){let s=t.ranges[r],h=null;if(s.empty){let u=lo(this.atoms,s.from,0);u!=s.from&&(h=j.cursor(u,-1))}else{let u=lo(this.atoms,s.from,-1),d=lo(this.atoms,s.to,1);(u!=s.from||d!=s.to)&&(h=j.range(s.from==s.anchor?u:d,s.from==s.head?u:d))}h&&(i||(i=t.ranges.slice()),i[r]=h)}return i?j.create(i,t.mainIndex):t}select(t){let{view:i}=this,r=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!r.eq(i.state.selection,this.dragging===!1))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(i=>i.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Bm(f,t){let i=f.state.facet(td);return i.length?i[0](t):G.mac?t.metaKey:t.ctrlKey}function Rm(f,t){let i=f.state.facet(ed);return i.length?i[0](t):G.mac?!t.altKey:!t.ctrlKey}function Im(f,t){let{main:i}=f.state.selection;if(i.empty)return!1;let r=jr(f.root);if(!r||r.rangeCount==0)return!0;let s=r.getRangeAt(0).getClientRects();for(let h=0;h<s.length;h++){let u=s[h];if(u.left<=t.clientX&&u.right>=t.clientX&&u.top<=t.clientY&&u.bottom>=t.clientY)return!0}return!1}function Wm(f,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i=t.target,r;i!=f.contentDOM;i=i.parentNode)if(!i||i.nodeType==11||(r=xt.get(i))&&r.ignoreEvent(t))return!1;return!0}const Ue=Object.create(null),Re=Object.create(null),bd=G.ie&&G.ie_version<15||G.ios&&G.webkit_version<604;function Hm(f){let t=f.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{f.focus(),i.remove(),xd(f,i.value)},50)}function Co(f,t,i){for(let r of f.facet(t))i=r(i,f);return i}function xd(f,t){t=Co(f.state,Ua,t);let{state:i}=f,r,s=1,h=i.toText(t),u=h.lines==i.selection.ranges.length;if(Ta!=null&&i.selection.ranges.every(p=>p.empty)&&Ta==h.toString()){let p=-1;r=i.changeByRange(v=>{let y=i.doc.lineAt(v.from);if(y.from==p)return{range:v};p=y.from;let w=i.toText((u?h.line(s++).text:t)+i.lineBreak);return{changes:{from:y.from,insert:w},range:j.cursor(v.from+w.length)}})}else u?r=i.changeByRange(p=>{let v=h.line(s++);return{changes:{from:p.from,to:p.to,insert:v.text},range:j.cursor(p.from+v.length)}}):r=i.replaceSelection(h);f.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}Re.scroll=f=>{f.inputState.lastScrollTop=f.scrollDOM.scrollTop,f.inputState.lastScrollLeft=f.scrollDOM.scrollLeft};Ue.keydown=(f,t)=>(f.inputState.setSelectionOrigin("select"),t.keyCode==27&&f.inputState.tabFocusMode!=0&&(f.inputState.tabFocusMode=Date.now()+2e3),!1);Re.touchstart=(f,t)=>{f.inputState.lastTouchTime=Date.now(),f.inputState.setSelectionOrigin("select.pointer")};Re.touchmove=f=>{f.inputState.setSelectionOrigin("select.pointer")};Ue.mousedown=(f,t)=>{if(f.observer.flush(),f.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let r of f.state.facet(id))if(i=r(f,t),i)break;if(!i&&t.button==0&&(i=Km(f,t)),i){let r=!f.hasFocus;f.inputState.startMouseSelection(new Em(f,t,i,r)),r&&f.observer.ignore(()=>{Rc(f.contentDOM);let h=f.root.activeElement;h&&!h.contains(f.contentDOM)&&h.blur()});let s=f.inputState.mouseSelection;if(s)return s.start(t),s.dragging===!1}return!1};function Wu(f,t,i,r){if(r==1)return j.cursor(t,i);if(r==2)return dm(f.state,t,i);{let s=It.find(f.docView,t),h=f.state.doc.lineAt(s?s.posAtEnd:t),u=s?s.posAtStart:h.from,d=s?s.posAtEnd:h.to;return d<f.state.doc.length&&d==h.to&&d++,j.range(u,d)}}let Hu=(f,t,i)=>t>=i.top&&t<=i.bottom&&f>=i.left&&f<=i.right;function Fm(f,t,i,r){let s=It.find(f.docView,t);if(!s)return 1;let h=t-s.posAtStart;if(h==0)return 1;if(h==s.length)return-1;let u=s.coordsAt(h,-1);if(u&&Hu(i,r,u))return-1;let d=s.coordsAt(h,1);return d&&Hu(i,r,d)?1:u&&u.bottom>=r?-1:1}function Fu(f,t){let i=f.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:i,bias:Fm(f,i,t.clientX,t.clientY)}}const zm=G.ie&&G.ie_version<=11;let zu=null,Ku=0,Uu=0;function wd(f){if(!zm)return f.detail;let t=zu,i=Uu;return zu=f,Uu=Date.now(),Ku=!t||i>Date.now()-400&&Math.abs(t.clientX-f.clientX)<2&&Math.abs(t.clientY-f.clientY)<2?(Ku+1)%3:1}function Km(f,t){let i=Fu(f,t),r=wd(t),s=f.state.selection;return{update(h){h.docChanged&&(i.pos=h.changes.mapPos(i.pos),s=s.map(h.changes))},get(h,u,d){let p=Fu(f,h),v,y=Wu(f,p.pos,p.bias,r);if(i.pos!=p.pos&&!u){let w=Wu(f,i.pos,i.bias,r),S=Math.min(w.from,y.from),A=Math.max(w.to,y.to);y=S<y.from?j.range(S,A):j.range(A,S)}return u?s.replaceRange(s.main.extend(y.from,y.to)):d&&r==1&&s.ranges.length>1&&(v=Um(s,p.pos))?v:d?s.addRange(y):j.create([y])}}}function Um(f,t){for(let i=0;i<f.ranges.length;i++){let{from:r,to:s}=f.ranges[i];if(r<=t&&s>=t)return j.create(f.ranges.slice(0,i).concat(f.ranges.slice(i+1)),f.mainIndex==i?0:f.mainIndex-(f.mainIndex>i?1:0))}return null}Ue.dragstart=(f,t)=>{let{selection:{main:i}}=f.state;if(t.target.draggable){let s=f.docView.nearest(t.target);if(s&&s.isWidget){let h=s.posAtStart,u=h+s.length;(h>=i.to||u<=i.from)&&(i=j.range(h,u))}}let{inputState:r}=f;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=i,t.dataTransfer&&(t.dataTransfer.setData("Text",Co(f.state,Va,f.state.sliceDoc(i.from,i.to))),t.dataTransfer.effectAllowed="copyMove"),!1};Ue.dragend=f=>(f.inputState.draggedContent=null,!1);function Vu(f,t,i,r){if(i=Co(f.state,Ua,i),!i)return;let s=f.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:h}=f.inputState,u=r&&h&&Rm(f,t)?{from:h.from,to:h.to}:null,d={from:s,insert:i},p=f.state.changes(u?[u,d]:d);f.focus(),f.dispatch({changes:p,selection:{anchor:p.mapPos(s,-1),head:p.mapPos(s,1)},userEvent:u?"move.drop":"input.drop"}),f.inputState.draggedContent=null}Ue.drop=(f,t)=>{if(!t.dataTransfer)return!1;if(f.state.readOnly)return!0;let i=t.dataTransfer.files;if(i&&i.length){let r=Array(i.length),s=0,h=()=>{++s==i.length&&Vu(f,t,r.filter(u=>u!=null).join(f.state.lineBreak),!1)};for(let u=0;u<i.length;u++){let d=new FileReader;d.onerror=h,d.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(d.result)||(r[u]=d.result),h()},d.readAsText(i[u])}return!0}else{let r=t.dataTransfer.getData("Text");if(r)return Vu(f,t,r,!0),!0}return!1};Ue.paste=(f,t)=>{if(f.state.readOnly)return!0;f.observer.flush();let i=bd?null:t.clipboardData;return i?(xd(f,i.getData("text/plain")||i.getData("text/uri-list")),!0):(Hm(f),!1)};function Vm(f,t){let i=f.dom.parentNode;if(!i)return;let r=i.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=t,r.focus(),r.selectionEnd=t.length,r.selectionStart=0,setTimeout(()=>{r.remove(),f.focus()},50)}function Gm(f){let t=[],i=[],r=!1;for(let s of f.selection.ranges)s.empty||(t.push(f.sliceDoc(s.from,s.to)),i.push(s));if(!t.length){let s=-1;for(let{from:h}of f.selection.ranges){let u=f.doc.lineAt(h);u.number>s&&(t.push(u.text),i.push({from:u.from,to:Math.min(f.doc.length,u.to+1)})),s=u.number}r=!0}return{text:Co(f,Va,t.join(f.lineBreak)),ranges:i,linewise:r}}let Ta=null;Ue.copy=Ue.cut=(f,t)=>{let{text:i,ranges:r,linewise:s}=Gm(f.state);if(!i&&!s)return!1;Ta=s?i:null,t.type=="cut"&&!f.state.readOnly&&f.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let h=bd?null:t.clipboardData;return h?(h.clearData(),h.setData("text/plain",i),!0):(Vm(f,i),!1)};const Sd=$n.define();function kd(f,t){let i=[];for(let r of f.facet(sd)){let s=r(f,t);s&&i.push(s)}return i.length?f.update({effects:i,annotations:Sd.of(!0)}):null}function Cd(f){setTimeout(()=>{let t=f.hasFocus;if(t!=f.inputState.notifiedFocused){let i=kd(f.state,t);i?f.dispatch(i):f.update([])}},10)}Re.focus=f=>{f.inputState.lastFocusTime=Date.now(),!f.scrollDOM.scrollTop&&(f.inputState.lastScrollTop||f.inputState.lastScrollLeft)&&(f.scrollDOM.scrollTop=f.inputState.lastScrollTop,f.scrollDOM.scrollLeft=f.inputState.lastScrollLeft),Cd(f)};Re.blur=f=>{f.observer.clearSelectionRange(),Cd(f)};Re.compositionstart=Re.compositionupdate=f=>{f.observer.editContext||(f.inputState.compositionFirstChange==null&&(f.inputState.compositionFirstChange=!0),f.inputState.composing<0&&(f.inputState.composing=0))};Re.compositionend=f=>{f.observer.editContext||(f.inputState.composing=-1,f.inputState.compositionEndedAt=Date.now(),f.inputState.compositionPendingKey=!0,f.inputState.compositionPendingChange=f.observer.pendingRecords().length>0,f.inputState.compositionFirstChange=null,G.chrome&&G.android?f.observer.flushSoon():f.inputState.compositionPendingChange?Promise.resolve().then(()=>f.observer.flush()):setTimeout(()=>{f.inputState.composing<0&&f.docView.hasComposition&&f.update([])},50))};Re.contextmenu=f=>{f.inputState.lastContextMenu=Date.now()};Ue.beforeinput=(f,t)=>{var i,r;if(t.inputType=="insertReplacementText"&&f.observer.editContext){let h=(i=t.dataTransfer)===null||i===void 0?void 0:i.getData("text/plain"),u=t.getTargetRanges();if(h&&u.length){let d=u[0],p=f.posAtDOM(d.startContainer,d.startOffset),v=f.posAtDOM(d.endContainer,d.endOffset);return qa(f,{from:p,to:v,insert:f.state.toText(h)},null),!0}}let s;if(G.chrome&&G.android&&(s=vd.find(h=>h.inputType==t.inputType))&&(f.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let h=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var u;(((u=window.visualViewport)===null||u===void 0?void 0:u.height)||0)>h+10&&f.hasFocus&&(f.contentDOM.blur(),f.focus())},100)}return G.ios&&t.inputType=="deleteContentForward"&&f.observer.flushSoon(),G.safari&&t.inputType=="insertText"&&f.inputState.composing>=0&&setTimeout(()=>Re.compositionend(f,t),20),!1};const Gu=new Set;function _m(f){Gu.has(f)||(Gu.add(f),f.addEventListener("copy",()=>{}),f.addEventListener("cut",()=>{}))}const _u=["pre-wrap","normal","pre-line","break-spaces"];let jn=!1;function qu(){jn=!1}class qm{constructor(t){this.lineWrapping=t,this.doc=dt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,i){let r=this.doc.lineAt(i).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((i-t-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return _u.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let i=!1;for(let r=0;r<t.length;r++){let s=t[r];s<0?r++:this.heightSamples[Math.floor(s*10)]||(i=!0,this.heightSamples[Math.floor(s*10)]=!0)}return i}refresh(t,i,r,s,h,u){let d=_u.indexOf(t)>-1,p=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=d;if(this.lineWrapping=d,this.lineHeight=i,this.charWidth=r,this.textHeight=s,this.lineLength=h,p){this.heightSamples={};for(let v=0;v<u.length;v++){let y=u[v];y<0?v++:this.heightSamples[Math.floor(y*10)]=!0}}return p}}class Ym{constructor(t,i){this.from=t,this.heights=i,this.index=0}get more(){return this.index<this.heights.length}}class ei{constructor(t,i,r,s,h){this.from=t,this.length=i,this.top=r,this.height=s,this._content=h}get type(){return typeof this._content=="number"?si.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof zi?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let i=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new ei(this.from,this.length+t.length,this.top,this.height+t.height,i)}}var kt=function(f){return f[f.ByPos=0]="ByPos",f[f.ByHeight=1]="ByHeight",f[f.ByPosNoHeight=2]="ByPosNoHeight",f}(kt||(kt={}));const ao=.001;class me{constructor(t,i,r=2){this.length=t,this.height=i,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>ao&&(jn=!0),this.height=t)}replace(t,i,r){return me.of(r)}decomposeLeft(t,i){i.push(this)}decomposeRight(t,i){i.push(this)}applyChanges(t,i,r,s){let h=this,u=r.doc;for(let d=s.length-1;d>=0;d--){let{fromA:p,toA:v,fromB:y,toB:w}=s[d],S=h.lineAt(p,kt.ByPosNoHeight,r.setDoc(i),0,0),A=S.to>=v?S:h.lineAt(v,kt.ByPosNoHeight,r,0,0);for(w+=A.to-v,v=A.to;d>0&&S.from<=s[d-1].toA;)p=s[d-1].fromA,y=s[d-1].fromB,d--,p<S.from&&(S=h.lineAt(p,kt.ByPosNoHeight,r,0,0));y+=S.from-p,p=S.from;let M=Ya.build(r.setDoc(u),t,y,w);h=vo(h,h.replace(p,v,M))}return h.updateHeight(r,0)}static empty(){return new Te(0,0)}static of(t){if(t.length==1)return t[0];let i=0,r=t.length,s=0,h=0;for(;;)if(i==r)if(s>h*2){let d=t[i-1];d.break?t.splice(--i,1,d.left,null,d.right):t.splice(--i,1,d.left,d.right),r+=1+d.break,s-=d.size}else if(h>s*2){let d=t[r];d.break?t.splice(r,1,d.left,null,d.right):t.splice(r,1,d.left,d.right),r+=2+d.break,h-=d.size}else break;else if(s<h){let d=t[i++];d&&(s+=d.size)}else{let d=t[--r];d&&(h+=d.size)}let u=0;return t[i-1]==null?(u=1,i--):t[i]==null&&(u=1,r++),new Xm(me.of(t.slice(0,i)),u,me.of(t.slice(r)))}}function vo(f,t){return f==t?f:(f.constructor!=t.constructor&&(jn=!0),t)}me.prototype.size=1;class Ad extends me{constructor(t,i,r){super(t,i),this.deco=r}blockAt(t,i,r,s){return new ei(s,this.length,r,this.height,this.deco||0)}lineAt(t,i,r,s,h){return this.blockAt(0,r,s,h)}forEachLine(t,i,r,s,h,u){t<=h+this.length&&i>=h&&u(this.blockAt(0,r,s,h))}updateHeight(t,i=0,r=!1,s){return s&&s.from<=i&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Te extends Ad{constructor(t,i){super(t,i,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,i,r,s){return new ei(s,this.length,r,this.height,this.breaks)}replace(t,i,r){let s=r[0];return r.length==1&&(s instanceof Te||s instanceof Zt&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Zt?s=new Te(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):me.of(r)}updateHeight(t,i=0,r=!1,s){return s&&s.from<=i&&s.more?this.setHeight(s.heights[s.index++]):(r||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Zt extends me{constructor(t){super(t,0)}heightMetrics(t,i){let r=t.doc.lineAt(i).number,s=t.doc.lineAt(i+this.length).number,h=s-r+1,u,d=0;if(t.lineWrapping){let p=Math.min(this.height,t.lineHeight*h);u=p/h,this.length>h+1&&(d=(this.height-p)/(this.length-h-1))}else u=this.height/h;return{firstLine:r,lastLine:s,perLine:u,perChar:d}}blockAt(t,i,r,s){let{firstLine:h,lastLine:u,perLine:d,perChar:p}=this.heightMetrics(i,s);if(i.lineWrapping){let v=s+(t<i.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-r)/this.height))*this.length)),y=i.doc.lineAt(v),w=d+y.length*p,S=Math.max(r,t-w/2);return new ei(y.from,y.length,S,w,0)}else{let v=Math.max(0,Math.min(u-h,Math.floor((t-r)/d))),{from:y,length:w}=i.doc.line(h+v);return new ei(y,w,r+d*v,d,0)}}lineAt(t,i,r,s,h){if(i==kt.ByHeight)return this.blockAt(t,r,s,h);if(i==kt.ByPosNoHeight){let{from:A,to:M}=r.doc.lineAt(t);return new ei(A,M-A,0,0,0)}let{firstLine:u,perLine:d,perChar:p}=this.heightMetrics(r,h),v=r.doc.lineAt(t),y=d+v.length*p,w=v.number-u,S=s+d*w+p*(v.from-h-w);return new ei(v.from,v.length,Math.max(s,Math.min(S,s+this.height-y)),y,0)}forEachLine(t,i,r,s,h,u){t=Math.max(t,h),i=Math.min(i,h+this.length);let{firstLine:d,perLine:p,perChar:v}=this.heightMetrics(r,h);for(let y=t,w=s;y<=i;){let S=r.doc.lineAt(y);if(y==t){let M=S.number-d;w+=p*M+v*(t-h-M)}let A=p+v*S.length;u(new ei(S.from,S.length,w,A,0)),w+=A,y=S.to+1}}replace(t,i,r){let s=this.length-i;if(s>0){let h=r[r.length-1];h instanceof Zt?r[r.length-1]=new Zt(h.length+s):r.push(null,new Zt(s-1))}if(t>0){let h=r[0];h instanceof Zt?r[0]=new Zt(t+h.length):r.unshift(new Zt(t-1),null)}return me.of(r)}decomposeLeft(t,i){i.push(new Zt(t-1),null)}decomposeRight(t,i){i.push(null,new Zt(this.length-t-1))}updateHeight(t,i=0,r=!1,s){let h=i+this.length;if(s&&s.from<=i+this.length&&s.more){let u=[],d=Math.max(i,s.from),p=-1;for(s.from>i&&u.push(new Zt(s.from-i-1).updateHeight(t,i));d<=h&&s.more;){let y=t.doc.lineAt(d).length;u.length&&u.push(null);let w=s.heights[s.index++];p==-1?p=w:Math.abs(w-p)>=ao&&(p=-2);let S=new Te(y,w);S.outdated=!1,u.push(S),d+=y+1}d<=h&&u.push(null,new Zt(h-d).updateHeight(t,d));let v=me.of(u);return(p<0||Math.abs(v.height-this.height)>=ao||Math.abs(p-this.heightMetrics(t,i).perLine)>=ao)&&(jn=!0),vo(this,v)}else(r||this.outdated)&&(this.setHeight(t.heightForGap(i,i+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Xm extends me{constructor(t,i,r){super(t.length+i+r.length,t.height+r.height,i|(t.outdated||r.outdated?2:0)),this.left=t,this.right=r,this.size=t.size+r.size}get break(){return this.flags&1}blockAt(t,i,r,s){let h=r+this.left.height;return t<h?this.left.blockAt(t,i,r,s):this.right.blockAt(t,i,h,s+this.left.length+this.break)}lineAt(t,i,r,s,h){let u=s+this.left.height,d=h+this.left.length+this.break,p=i==kt.ByHeight?t<u:t<d,v=p?this.left.lineAt(t,i,r,s,h):this.right.lineAt(t,i,r,u,d);if(this.break||(p?v.to<d:v.from>d))return v;let y=i==kt.ByPosNoHeight?kt.ByPosNoHeight:kt.ByPos;return p?v.join(this.right.lineAt(d,y,r,u,d)):this.left.lineAt(d,y,r,s,h).join(v)}forEachLine(t,i,r,s,h,u){let d=s+this.left.height,p=h+this.left.length+this.break;if(this.break)t<p&&this.left.forEachLine(t,i,r,s,h,u),i>=p&&this.right.forEachLine(t,i,r,d,p,u);else{let v=this.lineAt(p,kt.ByPos,r,s,h);t<v.from&&this.left.forEachLine(t,v.from-1,r,s,h,u),v.to>=t&&v.from<=i&&u(v),i>v.to&&this.right.forEachLine(v.to+1,i,r,d,p,u)}}replace(t,i,r){let s=this.left.length+this.break;if(i<s)return this.balanced(this.left.replace(t,i,r),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-s,i-s,r));let h=[];t>0&&this.decomposeLeft(t,h);let u=h.length;for(let d of r)h.push(d);if(t>0&&Yu(h,u-1),i<this.length){let d=h.length;this.decomposeRight(i,h),Yu(h,d)}return me.of(h)}decomposeLeft(t,i){let r=this.left.length;if(t<=r)return this.left.decomposeLeft(t,i);i.push(this.left),this.break&&(r++,t>=r&&i.push(null)),t>r&&this.right.decomposeLeft(t-r,i)}decomposeRight(t,i){let r=this.left.length,s=r+this.break;if(t>=s)return this.right.decomposeRight(t-s,i);t<r&&this.left.decomposeRight(t,i),this.break&&t<s&&i.push(null),i.push(this.right)}balanced(t,i){return t.size>2*i.size||i.size>2*t.size?me.of(this.break?[t,null,i]:[t,i]):(this.left=vo(this.left,t),this.right=vo(this.right,i),this.setHeight(t.height+i.height),this.outdated=t.outdated||i.outdated,this.size=t.size+i.size,this.length=t.length+this.break+i.length,this)}updateHeight(t,i=0,r=!1,s){let{left:h,right:u}=this,d=i+h.length+this.break,p=null;return s&&s.from<=i+h.length&&s.more?p=h=h.updateHeight(t,i,r,s):h.updateHeight(t,i,r),s&&s.from<=d+u.length&&s.more?p=u=u.updateHeight(t,d,r,s):u.updateHeight(t,d,r),p?this.balanced(h,u):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Yu(f,t){let i,r;f[t]==null&&(i=f[t-1])instanceof Zt&&(r=f[t+1])instanceof Zt&&f.splice(t-1,3,new Zt(i.length+1+r.length))}const jm=5;class Ya{constructor(t,i){this.pos=t,this.oracle=i,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,i){if(this.lineStart>-1){let r=Math.min(i,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Te?s.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new Te(r-this.pos,-1)),this.writtenTo=r,i>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=i}point(t,i,r){if(t<i||r.heightRelevant){let s=r.widget?r.widget.estimatedHeight:0,h=r.widget?r.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let u=i-t;r.block?this.addBlock(new Ad(u,s,r)):(u||h||s>=jm)&&this.addLineDeco(s,h,u)}else i>t&&this.span(t,i);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:i}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=i,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Te(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,i){let r=new Zt(i-t);return this.oracle.doc.lineAt(t).to==i&&(r.flags|=4),r}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Te)return t;let i=new Te(0,-1);return this.nodes.push(i),i}addBlock(t){this.enterLine();let i=t.deco;i&&i.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,i&&i.endSide>0&&(this.covering=t)}addLineDeco(t,i,r){let s=this.ensureLine();s.length+=r,s.collapsed+=r,s.widgetHeight=Math.max(s.widgetHeight,t),s.breaks+=i,this.writtenTo=this.pos=this.pos+r}finish(t){let i=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(i instanceof Te)&&!this.isCovered?this.nodes.push(new Te(0,-1)):(this.writtenTo<this.pos||i==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=t;for(let s of this.nodes)s instanceof Te&&s.updateHeight(this.oracle,r),r+=s?s.length:1;return this.nodes}static build(t,i,r,s){let h=new Ya(r,t);return Ct.spans(i,r,s,h,0),h.finish(r)}}function Jm(f,t,i){let r=new Zm;return Ct.compare(f,t,i,r,0),r.changes}class Zm{constructor(){this.changes=[]}compareRange(){}comparePoint(t,i,r,s){(t<i||r&&r.heightRelevant||s&&s.heightRelevant)&&oo(t,i,this.changes,5)}}function Qm(f,t){let i=f.getBoundingClientRect(),r=f.ownerDocument,s=r.defaultView||window,h=Math.max(0,i.left),u=Math.min(s.innerWidth,i.right),d=Math.max(0,i.top),p=Math.min(s.innerHeight,i.bottom);for(let v=f.parentNode;v&&v!=r.body;)if(v.nodeType==1){let y=v,w=window.getComputedStyle(y);if((y.scrollHeight>y.clientHeight||y.scrollWidth>y.clientWidth)&&w.overflow!="visible"){let S=y.getBoundingClientRect();h=Math.max(h,S.left),u=Math.min(u,S.right),d=Math.max(d,S.top),p=Math.min(v==f.parentNode?s.innerHeight:p,S.bottom)}v=w.position=="absolute"||w.position=="fixed"?y.offsetParent:y.parentNode}else if(v.nodeType==11)v=v.host;else break;return{left:h-i.left,right:Math.max(h,u)-i.left,top:d-(i.top+t),bottom:Math.max(d,p)-(i.top+t)}}function $m(f){let t=f.getBoundingClientRect(),i=f.ownerDocument.defaultView||window;return t.left<i.innerWidth&&t.right>0&&t.top<i.innerHeight&&t.bottom>0}function tv(f,t){let i=f.getBoundingClientRect();return{left:0,right:i.right-i.left,top:t,bottom:i.bottom-(i.top+t)}}class Xl{constructor(t,i,r,s){this.from=t,this.to=i,this.size=r,this.displaySize=s}static same(t,i){if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){let s=t[r],h=i[r];if(s.from!=h.from||s.to!=h.to||s.size!=h.size)return!1}return!0}draw(t,i){return Ht.replace({widget:new ev(this.displaySize*(i?t.scaleY:t.scaleX),i)}).range(this.from,this.to)}}class ev extends ko{constructor(t,i){super(),this.size=t,this.vertical=i}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Xu{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=ju,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=te.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let i=t.facet(Ga).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new qm(i),this.stateDeco=t.facet(Jr).filter(r=>typeof r!="function"),this.heightMap=me.empty().applyChanges(this.stateDeco,dt.empty,this.heightOracle.setDoc(t.doc),[new Ee(0,0,0,t.doc.length)]);for(let r=0;r<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());r++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ht.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:i}=this.state.selection;for(let r=0;r<=1;r++){let s=r?i.head:i.anchor;if(!t.some(({from:h,to:u})=>s>=h&&s<=u)){let{from:h,to:u}=this.lineBlockAt(s);t.push(new Ys(h,u))}}return this.viewports=t.sort((r,s)=>r.from-s.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?ju:new Xa(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(zr(t,this.scaler))})}update(t,i=null){this.state=t.state;let r=this.stateDeco;this.stateDeco=this.state.facet(Jr).filter(y=>typeof y!="function");let s=t.changedRanges,h=Ee.extendWithRanges(s,Jm(r,this.stateDeco,t?t.changes:Yt.empty(this.state.doc.length))),u=this.heightMap.height,d=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);qu(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),h),(this.heightMap.height!=u||jn)&&(t.flags|=2),d?(this.scrollAnchorPos=t.changes.mapPos(d.from,-1),this.scrollAnchorHeight=d.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=u);let p=h.length?this.mapViewport(this.viewport,t.changes):this.viewport;(i&&(i.range.head<p.from||i.range.head>p.to)||!this.viewportIsAppropriate(p))&&(p=this.getViewport(0,i));let v=p.from!=this.viewport.from||p.to!=this.viewport.to;this.viewport=p,t.flags|=this.updateForViewport(),(v||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),i&&(this.scrollTarget=i),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(rm)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let i=t.contentDOM,r=window.getComputedStyle(i),s=this.heightOracle,h=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?te.RTL:te.LTR;let u=this.heightOracle.mustRefreshForWrapping(h),d=i.getBoundingClientRect(),p=u||this.mustMeasureContent||this.contentDOMHeight!=d.height;this.contentDOMHeight=d.height,this.mustMeasureContent=!1;let v=0,y=0;if(d.width&&d.height){let{scaleX:J,scaleY:_}=Bc(i,d);(J>.005&&Math.abs(this.scaleX-J)>.005||_>.005&&Math.abs(this.scaleY-_)>.005)&&(this.scaleX=J,this.scaleY=_,v|=16,u=p=!0)}let w=(parseInt(r.paddingTop)||0)*this.scaleY,S=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=w||this.paddingBottom!=S)&&(this.paddingTop=w,this.paddingBottom=S,v|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(s.lineWrapping&&(p=!0),this.editorWidth=t.scrollDOM.clientWidth,v|=16);let A=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=A&&(this.scrollAnchorHeight=-1,this.scrollTop=A),this.scrolledToBottom=Wc(t.scrollDOM);let M=(this.printing?tv:Qm)(i,this.paddingTop),D=M.top-this.pixelViewport.top,N=M.bottom-this.pixelViewport.bottom;this.pixelViewport=M;let P=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(P!=this.inView&&(this.inView=P,P&&(p=!0)),!this.inView&&!this.scrollTarget&&!$m(t.dom))return 0;let H=d.width;if((this.contentDOMWidth!=H||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=d.width,this.editorHeight=t.scrollDOM.clientHeight,v|=16),p){let J=t.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(J)&&(u=!0),u||s.lineWrapping&&Math.abs(H-this.contentDOMWidth)>s.charWidth){let{lineHeight:_,charWidth:et,textHeight:Q}=t.docView.measureTextSize();u=_>0&&s.refresh(h,_,et,Q,Math.max(5,H/et),J),u&&(t.docView.minWidth=0,v|=16)}D>0&&N>0?y=Math.max(D,N):D<0&&N<0&&(y=Math.min(D,N)),qu();for(let _ of this.viewports){let et=_.from==this.viewport.from?J:t.docView.measureVisibleLineHeights(_);this.heightMap=(u?me.empty().applyChanges(this.stateDeco,dt.empty,this.heightOracle,[new Ee(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(s,0,u,new Ym(_.from,et))}jn&&(v|=2)}let q=!this.viewportIsAppropriate(this.viewport,y)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return q&&(v&2&&(v|=this.updateScaler()),this.viewport=this.getViewport(y,this.scrollTarget),v|=this.updateForViewport()),(v&2||q)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(u?[]:this.lineGaps,t)),v|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),v}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,i){let r=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),s=this.heightMap,h=this.heightOracle,{visibleTop:u,visibleBottom:d}=this,p=new Ys(s.lineAt(u-r*1e3,kt.ByHeight,h,0,0).from,s.lineAt(d+(1-r)*1e3,kt.ByHeight,h,0,0).to);if(i){let{head:v}=i.range;if(v<p.from||v>p.to){let y=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),w=s.lineAt(v,kt.ByPos,h,0,0),S;i.y=="center"?S=(w.top+w.bottom)/2-y/2:i.y=="start"||i.y=="nearest"&&v<p.from?S=w.top:S=w.bottom-y,p=new Ys(s.lineAt(S-1e3/2,kt.ByHeight,h,0,0).from,s.lineAt(S+y+1e3/2,kt.ByHeight,h,0,0).to)}}return p}mapViewport(t,i){let r=i.mapPos(t.from,-1),s=i.mapPos(t.to,1);return new Ys(this.heightMap.lineAt(r,kt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,kt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:i},r=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(t,kt.ByPos,this.heightOracle,0,0),{bottom:h}=this.heightMap.lineAt(i,kt.ByPos,this.heightOracle,0,0),{visibleTop:u,visibleBottom:d}=this;return(t==0||s<=u-Math.max(10,Math.min(-r,250)))&&(i==this.state.doc.length||h>=d+Math.max(10,Math.min(r,250)))&&s>u-2*1e3&&h<d+2*1e3}mapLineGaps(t,i){if(!t.length||i.empty)return t;let r=[];for(let s of t)i.touchesRange(s.from,s.to)||r.push(new Xl(i.mapPos(s.from),i.mapPos(s.to),s.size,s.displaySize));return r}ensureLineGaps(t,i){let r=this.heightOracle.lineWrapping,s=r?1e4:2e3,h=s>>1,u=s<<1;if(this.defaultTextDirection!=te.LTR&&!r)return[];let d=[],p=(y,w,S,A)=>{if(w-y<h)return;let M=this.state.selection.main,D=[M.from];M.empty||D.push(M.to);for(let P of D)if(P>y&&P<w){p(y,P-10,S,A),p(P+10,w,S,A);return}let N=nv(t,P=>P.from>=S.from&&P.to<=S.to&&Math.abs(P.from-y)<h&&Math.abs(P.to-w)<h&&!D.some(H=>P.from<H&&P.to>H));if(!N){if(w<S.to&&i&&r&&i.visibleRanges.some(q=>q.from<=w&&q.to>=w)){let q=i.moveToLineBoundary(j.cursor(w),!1,!0).head;q>y&&(w=q)}let P=this.gapSize(S,y,w,A),H=r||P<2e6?P:2e6;N=new Xl(y,w,P,H)}d.push(N)},v=y=>{if(y.length<u||y.type!=si.Text)return;let w=iv(y.from,y.to,this.stateDeco);if(w.total<u)return;let S=this.scrollTarget?this.scrollTarget.range.head:null,A,M;if(r){let D=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,N,P;if(S!=null){let H=js(w,S),q=((this.visibleBottom-this.visibleTop)/2+D)/y.height;N=H-q,P=H+q}else N=(this.visibleTop-y.top-D)/y.height,P=(this.visibleBottom-y.top+D)/y.height;A=Xs(w,N),M=Xs(w,P)}else{let D=w.total*this.heightOracle.charWidth,N=s*this.heightOracle.charWidth,P=0;if(D>2e6)for(let et of t)et.from>=y.from&&et.from<y.to&&et.size!=et.displaySize&&et.from*this.heightOracle.charWidth+P<this.pixelViewport.left&&(P=et.size-et.displaySize);let H=this.pixelViewport.left+P,q=this.pixelViewport.right+P,J,_;if(S!=null){let et=js(w,S),Q=((q-H)/2+N)/D;J=et-Q,_=et+Q}else J=(H-N)/D,_=(q+N)/D;A=Xs(w,J),M=Xs(w,_)}A>y.from&&p(y.from,A,y,w),M<y.to&&p(M,y.to,y,w)};for(let y of this.viewportLines)Array.isArray(y.type)?y.type.forEach(v):v(y);return d}gapSize(t,i,r,s){let h=js(s,r)-js(s,i);return this.heightOracle.lineWrapping?t.height*h:s.total*this.heightOracle.charWidth*h}updateLineGaps(t){Xl.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=Ht.set(t.map(i=>i.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(t){let i=this.stateDeco;this.lineGaps.length&&(i=i.concat(this.lineGapDeco));let r=[];Ct.spans(i,this.viewport.from,this.viewport.to,{span(h,u){r.push({from:h,to:u})},point(){}},20);let s=0;if(r.length!=this.visibleRanges.length)s=12;else for(let h=0;h<r.length&&!(s&8);h++){let u=this.visibleRanges[h],d=r[h];(u.from!=d.from||u.to!=d.to)&&(s|=4,t&&t.mapPos(u.from,-1)==d.from&&t.mapPos(u.to,1)==d.to||(s|=8))}return this.visibleRanges=r,s}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(i=>i.from<=t&&i.to>=t)||zr(this.heightMap.lineAt(t,kt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(i=>i.top<=t&&i.bottom>=t)||zr(this.heightMap.lineAt(this.scaler.fromDOM(t),kt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let i=this.lineBlockAtHeight(t+8);return i.from>=this.viewport.from||this.viewportLines[0].top-t>200?i:this.viewportLines[0]}elementAtHeight(t){return zr(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Ys{constructor(t,i){this.from=t,this.to=i}}function iv(f,t,i){let r=[],s=f,h=0;return Ct.spans(i,f,t,{span(){},point(u,d){u>s&&(r.push({from:s,to:u}),h+=u-s),s=d}},20),s<t&&(r.push({from:s,to:t}),h+=t-s),{total:h,ranges:r}}function Xs({total:f,ranges:t},i){if(i<=0)return t[0].from;if(i>=1)return t[t.length-1].to;let r=Math.floor(f*i);for(let s=0;;s++){let{from:h,to:u}=t[s],d=u-h;if(r<=d)return h+r;r-=d}}function js(f,t){let i=0;for(let{from:r,to:s}of f.ranges){if(t<=s){i+=t-r;break}i+=s-r}return i/f.total}function nv(f,t){for(let i of f)if(t(i))return i}const ju={toDOM(f){return f},fromDOM(f){return f},scale:1,eq(f){return f==this}};class Xa{constructor(t,i,r){let s=0,h=0,u=0;this.viewports=r.map(({from:d,to:p})=>{let v=i.lineAt(d,kt.ByPos,t,0,0).top,y=i.lineAt(p,kt.ByPos,t,0,0).bottom;return s+=y-v,{from:d,to:p,top:v,bottom:y,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(i.height-s);for(let d of this.viewports)d.domTop=u+(d.top-h)*this.scale,u=d.domBottom=d.domTop+(d.bottom-d.top),h=d.bottom}toDOM(t){for(let i=0,r=0,s=0;;i++){let h=i<this.viewports.length?this.viewports[i]:null;if(!h||t<h.top)return s+(t-r)*this.scale;if(t<=h.bottom)return h.domTop+(t-h.top);r=h.bottom,s=h.domBottom}}fromDOM(t){for(let i=0,r=0,s=0;;i++){let h=i<this.viewports.length?this.viewports[i]:null;if(!h||t<h.domTop)return r+(t-s)/this.scale;if(t<=h.domBottom)return h.top+(t-h.domTop);r=h.bottom,s=h.domBottom}}eq(t){return t instanceof Xa?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((i,r)=>i.from==t.viewports[r].from&&i.to==t.viewports[r].to):!1}}function zr(f,t){if(t.scale==1)return f;let i=t.toDOM(f.top),r=t.toDOM(f.bottom);return new ei(f.from,f.length,i,r-i,Array.isArray(f._content)?f._content.map(s=>zr(s,t)):f._content)}const Js=ot.define({combine:f=>f.join(" ")}),La=ot.define({combine:f=>f.indexOf(!0)>-1}),Oa=Hi.newName(),Md=Hi.newName(),Td=Hi.newName(),Ld={"&light":"."+Md,"&dark":"."+Td};function Da(f,t,i){return new Hi(t,{finish(r){return/&/.test(r)?r.replace(/&\w*/,s=>{if(s=="&")return f;if(!i||!i[s])throw new RangeError(`Unsupported selector: ${s}`);return i[s]}):f+" "+r}})}const rv=Da("."+Oa,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Ld),sv={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},jl=G.ie&&G.ie_version<=11;class ov{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new z0,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(i=>{for(let r of i)this.queue.push(r);(G.ie&&G.ie_version<=11||G.ios&&t.composing)&&i.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&G.android&&t.constructor.EDIT_CONTEXT!==!1&&!(G.chrome&&G.chrome_version<126)&&(this.editContext=new av(t),t.state.facet(gi)&&(t.contentDOM.editContext=this.editContext.editContext)),jl&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var i;((i=this.view.docView)===null||i===void 0?void 0:i.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(i=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),i.length>0&&i[i.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(i=>{i.length>0&&i[i.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((i,r)=>i!=t[r]))){this.gapIntersection.disconnect();for(let i of t)this.gapIntersection.observe(i);this.gaps=t}}onSelectionChange(t){let i=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,s=this.selectionRange;if(r.state.facet(gi)?r.root.activeElement!=this.dom:!so(this.dom,s))return;let h=s.anchorNode&&r.docView.nearest(s.anchorNode);if(h&&h.ignoreEvent(t)){i||(this.selectionChanged=!1);return}(G.ie&&G.ie_version<=11||G.android&&G.chrome)&&!r.state.selection.main.empty&&s.focusNode&&Gr(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,i=jr(t.root);if(!i)return!1;let r=G.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&lv(this.view,i)||i;if(!r||this.selectionRange.eq(r))return!1;let s=so(this.dom,r);return s&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&U0(this.dom,r)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(r),s&&(this.selectionChanged=!0),!0)}setSelectionRange(t,i){this.selectionRange.set(t.node,t.offset,i.node,i.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,i=null;for(let r=this.dom;r;)if(r.nodeType==1)!i&&t<this.scrollTargets.length&&this.scrollTargets[t]==r?t++:i||(i=this.scrollTargets.slice(0,t)),i&&i.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(t<this.scrollTargets.length&&!i&&(i=this.scrollTargets.slice(0,t)),i){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=i)r.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,sv),jl&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),jl&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,i){var r;if(!this.delayedAndroidKey){let s=()=>{let h=this.delayedAndroidKey;h&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=h.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&h.force&&Un(this.dom,h.key,h.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:i,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let i=-1,r=-1,s=!1;for(let h of t){let u=this.readMutation(h);u&&(u.typeOver&&(s=!0),i==-1?{from:i,to:r}=u:(i=Math.min(u.from,i),r=Math.max(u.to,r)))}return{from:i,to:r,typeOver:s}}readChange(){let{from:t,to:i,typeOver:r}=this.processRecords(),s=this.selectionChanged&&so(this.dom,this.selectionRange);if(t<0&&!s)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let h=new Cm(this.view,t,i,r);return this.view.docView.domChanged={newSel:h.newSel?h.newSel.main:null},h}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let i=this.readChange();if(!i)return this.view.requestMeasure(),!1;let r=this.view.state,s=md(this.view,i);return this.view.state==r&&(i.domChanged||i.newSel&&!i.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(t){let i=this.view.docView.nearest(t.target);if(!i||i.ignoreMutation(t))return null;if(i.markDirty(t.type=="attributes"),t.type=="attributes"&&(i.flags|=4),t.type=="childList"){let r=Ju(i,t.previousSibling||t.target.previousSibling,-1),s=Ju(i,t.nextSibling||t.target.nextSibling,1);return{from:r?i.posAfter(r):i.posAtStart,to:s?i.posBefore(s):i.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:i.posAtStart,to:i.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(gi)!=t.state.facet(gi)&&(t.view.contentDOM.editContext=t.state.facet(gi)?this.editContext.editContext:null))}destroy(){var t,i,r;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(i=this.gapIntersection)===null||i===void 0||i.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Ju(f,t,i){for(;t;){let r=xt.get(t);if(r&&r.parent==f)return r;let s=t.parentNode;t=s!=f.dom?s:i>0?t.nextSibling:t.previousSibling}return null}function Zu(f,t){let i=t.startContainer,r=t.startOffset,s=t.endContainer,h=t.endOffset,u=f.docView.domAtPos(f.state.selection.main.anchor);return Gr(u.node,u.offset,s,h)&&([i,r,s,h]=[s,h,i,r]),{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:h}}function lv(f,t){if(t.getComposedRanges){let s=t.getComposedRanges(f.root)[0];if(s)return Zu(f,s)}let i=null;function r(s){s.preventDefault(),s.stopImmediatePropagation(),i=s.getTargetRanges()[0]}return f.contentDOM.addEventListener("beforeinput",r,!0),f.dom.ownerDocument.execCommand("indent"),f.contentDOM.removeEventListener("beforeinput",r,!0),i?Zu(f,i):null}class av{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let i=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=r=>{let s=t.state.selection.main,{anchor:h,head:u}=s,d=this.toEditorPos(r.updateRangeStart),p=this.toEditorPos(r.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:d,drifted:!1});let v={from:d,to:p,insert:dt.of(r.text.split(`
`))};if(v.from==this.from&&h<this.from?v.from=h:v.to==this.to&&h>this.to&&(v.to=h),v.from==v.to&&!v.insert.length){let y=j.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));y.main.eq(s)||t.dispatch({selection:y,userEvent:"select"});return}if((G.mac||G.android)&&v.from==u-1&&/^\. ?$/.test(r.text)&&t.contentDOM.getAttribute("autocorrect")=="off"&&(v={from:d,to:p,insert:dt.of([r.text.replace("."," ")])}),this.pendingContextChange=v,!t.state.readOnly){let y=this.to-this.from+(v.to-v.from+v.insert.length);qa(t,v,j.single(this.toEditorPos(r.selectionStart,y),this.toEditorPos(r.selectionEnd,y)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))},this.handlers.characterboundsupdate=r=>{let s=[],h=null;for(let u=this.toEditorPos(r.rangeStart),d=this.toEditorPos(r.rangeEnd);u<d;u++){let p=t.coordsForChar(u);h=p&&new DOMRect(p.left,p.top,p.right-p.left,p.bottom-p.top)||h||new DOMRect,s.push(h)}i.updateCharacterBounds(r.rangeStart,s)},this.handlers.textformatupdate=r=>{let s=[];for(let h of r.getTextFormats()){let u=h.underlineStyle,d=h.underlineThickness;if(u!="None"&&d!="None"){let p=this.toEditorPos(h.rangeStart),v=this.toEditorPos(h.rangeEnd);if(p<v){let y=`text-decoration: underline ${u=="Dashed"?"dashed ":u=="Squiggle"?"wavy ":""}${d=="Thin"?1:2}px`;s.push(Ht.mark({attributes:{style:y}}).range(p,v))}}}t.dispatch({effects:ad.of(Ht.set(s))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:r}=this.composing;this.composing=null,r&&this.reset(t.state)}};for(let r in this.handlers)i.addEventListener(r,this.handlers[r]);this.measureReq={read:r=>{this.editContext.updateControlBounds(r.contentDOM.getBoundingClientRect());let s=jr(r.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let i=0,r=!1,s=this.pendingContextChange;return t.changes.iterChanges((h,u,d,p,v)=>{if(r)return;let y=v.length-(u-h);if(s&&u>=s.to)if(s.from==h&&s.to==u&&s.insert.eq(v)){s=this.pendingContextChange=null,i+=y,this.to+=y;return}else s=null,this.revertPending(t.state);if(h+=i,u+=i,u<=this.from)this.from+=y,this.to+=y;else if(h<this.to){if(h<this.from||u>this.to||this.to-this.from+v.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(h),this.toContextPos(u),v.toString()),this.to+=y}i+=y}),s&&!r&&this.revertPending(t.state),!r}update(t){let i=this.pendingContextChange,r=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(r.from,r.to)&&t.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.reset(t.state)):(t.docChanged||t.selectionSet||i)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:i}=t.selection.main;this.from=Math.max(0,i-1e4),this.to=Math.min(t.doc.length,i+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let i=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(i.from),this.toContextPos(i.from+i.insert.length),t.doc.sliceString(i.from,i.to))}setSelection(t){let{main:i}=t.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,i.anchor))),s=this.toContextPos(i.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(r,s)}rangeIsValid(t){let{head:i}=t.selection.main;return!(this.from>0&&i-this.from<500||this.to<t.doc.length&&this.to-i<500||this.to-this.from>1e4*3)}toEditorPos(t,i=this.to-this.from){t=Math.min(t,i);let r=this.composing;return r&&r.drifted?r.editorBase+(t-r.contextBase):t+this.from}toContextPos(t){let i=this.composing;return i&&i.drifted?i.contextBase+(t-i.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class at{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var i;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:r}=t;this.dispatchTransactions=t.dispatchTransactions||r&&(s=>s.forEach(h=>r(h,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=t.root||K0(t.parent)||document,this.viewState=new Xu(t.state||ut.create(t)),t.scrollTo&&t.scrollTo.is(Gs)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(zn).map(s=>new _l(s));for(let s of this.plugins)s.update(this);this.observer=new ov(this),this.inputState=new Om(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Ou(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((i=document.fonts)===null||i===void 0)&&i.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let i=t.length==1&&t[0]instanceof oe?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(i,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let i=!1,r=!1,s,h=this.state;for(let S of t){if(S.startState!=h)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");h=S.state}if(this.destroyed){this.viewState.state=h;return}let u=this.hasFocus,d=0,p=null;t.some(S=>S.annotation(Sd))?(this.inputState.notifiedFocused=u,d=1):u!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=u,p=kd(h,u),p||(d=1));let v=this.observer.delayedAndroidKey,y=null;if(v?(this.observer.clearDelayedAndroidKey(),y=this.observer.readChange(),(y&&!this.state.doc.eq(h.doc)||!this.state.selection.eq(h.selection))&&(y=null)):this.observer.clear(),h.facet(ut.phrases)!=this.state.facet(ut.phrases))return this.setState(h);s=mo.create(this,h,t),s.flags|=d;let w=this.viewState.scrollTarget;try{this.updateState=2;for(let S of t){if(w&&(w=w.map(S.changes)),S.scrollIntoView){let{main:A}=S.state.selection;w=new Vn(A.empty?A:j.cursor(A.head,A.head>A.anchor?-1:1))}for(let A of S.effects)A.is(Gs)&&(w=A.value.clip(this.state))}this.viewState.update(s,w),this.bidiCache=yo.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),i=this.docView.update(s),this.state.facet(Hr)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some(S=>S.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Js)!=s.state.facet(Js)&&(this.viewState.mustMeasureContent=!0),(i||r||w||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!s.empty)for(let S of this.state.facet(Aa))try{S(s)}catch(A){ni(this.state,A,"update listener")}(p||y)&&Promise.resolve().then(()=>{p&&this.state==p.startState&&this.dispatch(p),y&&!md(this,y)&&v.force&&Un(this.contentDOM,v.key,v.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let i=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new Xu(t),this.plugins=t.facet(zn).map(r=>new _l(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView.destroy(),this.docView=new Ou(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}updatePlugins(t){let i=t.startState.facet(zn),r=t.state.facet(zn);if(i!=r){let s=[];for(let h of r){let u=i.indexOf(h);if(u<0)s.push(new _l(h));else{let d=this.plugins[u];d.mustUpdate=t,s.push(d)}}for(let h of this.plugins)h.mustUpdate!=t&&h.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=t;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);i!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let i=t.value;if(i&&i.docViewUpdate)try{i.docViewUpdate(this)}catch(r){ni(this.state,r,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let i=null,r=this.scrollDOM,s=r.scrollTop*this.scaleY,{scrollAnchorPos:h,scrollAnchorHeight:u}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(u=-1),this.viewState.scrollAnchorHeight=-1;try{for(let d=0;;d++){if(u<0)if(Wc(r))h=-1,u=this.viewState.heightMap.height;else{let A=this.viewState.scrollAnchorAt(s);h=A.from,u=A.top}this.updateState=1;let p=this.viewState.measure(this);if(!p&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(d>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let v=[];p&4||([this.measureRequests,v]=[v,this.measureRequests]);let y=v.map(A=>{try{return A.read(this)}catch(M){return ni(this.state,M),Qu}}),w=mo.create(this,this.state,[]),S=!1;w.flags|=p,i?i.flags|=p:i=w,this.updateState=2,w.empty||(this.updatePlugins(w),this.inputState.update(w),this.updateAttrs(),S=this.docView.update(w),S&&this.docViewUpdate());for(let A=0;A<v.length;A++)if(y[A]!=Qu)try{let M=v[A];M.write&&M.write(y[A],this)}catch(M){ni(this.state,M)}if(S&&this.docView.updateSelection(!0),!w.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,u=-1;continue}else{let M=(h<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(h).top)-u;if(M>1||M<-1){s=s+M,r.scrollTop=s/this.scaleY,u=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(i&&!i.empty)for(let d of this.state.facet(Aa))d(i)}get themeClasses(){return Oa+" "+(this.state.facet(La)?Td:Md)+" "+this.state.facet(Js)}updateAttrs(){let t=$u(this,hd,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),i={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(gi)?"true":"false",class:"cm-content",style:`${G.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(i["aria-readonly"]="true"),$u(this,Ga,i);let r=this.observer.ignore(()=>{let s=xa(this.contentDOM,this.contentAttrs,i),h=xa(this.dom,this.editorAttrs,t);return s||h});return this.editorAttrs=t,this.contentAttrs=i,r}showAnnouncements(t){let i=!0;for(let r of t)for(let s of r.effects)if(s.is(at.announce)){i&&(this.announceDOM.textContent=""),i=!1;let h=this.announceDOM.appendChild(document.createElement("div"));h.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Hr);let t=this.state.facet(at.cspNonce);Hi.mount(this.root,this.styleModules.concat(rv).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===t.key){this.measureRequests[i]=t;return}}this.measureRequests.push(t)}}plugin(t){let i=this.pluginMap.get(t);return(i===void 0||i&&i.plugin!=t)&&this.pluginMap.set(t,i=this.plugins.find(r=>r.plugin==t)||null),i&&i.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,i,r){return Yl(this,t,Bu(this,t,i,r))}moveByGroup(t,i){return Yl(this,t,Bu(this,t,i,r=>xm(this,t.head,r)))}visualLineSide(t,i){let r=this.bidiSpans(t),s=this.textDirectionAt(t.from),h=r[i?r.length-1:0];return j.cursor(h.side(i,s)+t.from,h.forward(!i,s)?1:-1)}moveToLineBoundary(t,i,r=!0){return bm(this,t,i,r)}moveVertically(t,i,r){return Yl(this,t,wm(this,t,i,r))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,i=0){return this.docView.posFromDOM(t,i)}posAtCoords(t,i=!0){return this.readMeasured(),gd(this,t,i)}coordsAtPos(t,i=1){this.readMeasured();let r=this.docView.coordsAt(t,i);if(!r||r.left==r.right)return r;let s=this.state.doc.lineAt(t),h=this.bidiSpans(s),u=h[Ii.find(h,t-s.from,-1,i)];return $r(r,u.dir==te.LTR==i>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(od)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>hv)return Qc(t.length);let i=this.textDirectionAt(t.from),r;for(let h of this.bidiCache)if(h.from==t.from&&h.dir==i&&(h.fresh||Zc(h.isolates,r=Lu(this,t))))return h.order;r||(r=Lu(this,t));let s=em(t.text,i,r);return this.bidiCache.push(new yo(t.from,t.to,i,r,!0,s)),s}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||G.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Rc(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,i={}){return Gs.of(new Vn(typeof t=="number"?j.cursor(t):t,i.y,i.x,i.yMargin,i.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:i}=this.scrollDOM,r=this.viewState.scrollAnchorAt(t);return Gs.of(new Vn(j.cursor(r.from),"start","start",r.top-t,i,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return cn.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return cn.define(()=>({}),{eventObservers:t})}static theme(t,i){let r=Hi.newName(),s=[Js.of(r),Hr.of(Da(`.${r}`,t))];return i&&i.dark&&s.push(La.of(!0)),s}static baseTheme(t){return Sc.lowest(Hr.of(Da("."+Oa,t,Ld)))}static findFromDOM(t){var i;let r=t.querySelector(".cm-content"),s=r&&xt.get(r)||xt.get(t);return((i=s==null?void 0:s.rootView)===null||i===void 0?void 0:i.view)||null}}at.styleModule=Hr;at.inputHandler=rd;at.clipboardInputFilter=Ua;at.clipboardOutputFilter=Va;at.scrollHandler=ld;at.focusChangeEffect=sd;at.perLineTextDirection=od;at.exceptionSink=nd;at.updateListener=Aa;at.editable=gi;at.mouseSelectionStyle=id;at.dragMovesSelection=ed;at.clickAddsSelectionRange=td;at.decorations=Jr;at.outerDecorations=fd;at.atomicRanges=_a;at.bidiIsolatedRanges=ud;at.scrollMargins=cd;at.darkTheme=La;at.cspNonce=ot.define({combine:f=>f.length?f[0]:""});at.contentAttributes=Ga;at.editorAttributes=hd;at.lineWrapping=at.contentAttributes.of({class:"cm-lineWrapping"});at.announce=Wt.define();const hv=4096,Qu={};class yo{constructor(t,i,r,s,h,u){this.from=t,this.to=i,this.dir=r,this.isolates=s,this.fresh=h,this.order=u}static update(t,i){if(i.empty&&!t.some(h=>h.fresh))return t;let r=[],s=t.length?t[t.length-1].dir:te.LTR;for(let h=Math.max(0,t.length-10);h<t.length;h++){let u=t[h];u.dir==s&&!i.touchesRange(u.from,u.to)&&r.push(new yo(i.mapPos(u.from,1),i.mapPos(u.to,-1),u.dir,u.isolates,!1,u.order))}return r}}function $u(f,t,i){for(let r=f.state.facet(t),s=r.length-1;s>=0;s--){let h=r[s],u=typeof h=="function"?h(f):h;u&&ba(u,i)}return i}const fv=G.mac?"mac":G.windows?"win":G.linux?"linux":"key";function uv(f,t){const i=f.split(/-(?!$)/);let r=i[i.length-1];r=="Space"&&(r=" ");let s,h,u,d;for(let p=0;p<i.length-1;++p){const v=i[p];if(/^(cmd|meta|m)$/i.test(v))d=!0;else if(/^a(lt)?$/i.test(v))s=!0;else if(/^(c|ctrl|control)$/i.test(v))h=!0;else if(/^s(hift)?$/i.test(v))u=!0;else if(/^mod$/i.test(v))t=="mac"?d=!0:h=!0;else throw new Error("Unrecognized modifier name: "+v)}return s&&(r="Alt-"+r),h&&(r="Ctrl-"+r),d&&(r="Meta-"+r),u&&(r="Shift-"+r),r}function Zs(f,t,i){return t.altKey&&(f="Alt-"+f),t.ctrlKey&&(f="Ctrl-"+f),t.metaKey&&(f="Meta-"+f),i!==!1&&t.shiftKey&&(f="Shift-"+f),f}const cv=Sc.default(at.domEventHandlers({keydown(f,t){return mv(dv(t.state),f,t,"editor")}})),Od=ot.define({enables:cv}),tc=new WeakMap;function dv(f){let t=f.facet(Od),i=tc.get(t);return i||tc.set(t,i=gv(t.reduce((r,s)=>r.concat(s),[]))),i}let Bi=null;const pv=4e3;function gv(f,t=fv){let i=Object.create(null),r=Object.create(null),s=(u,d)=>{let p=r[u];if(p==null)r[u]=d;else if(p!=d)throw new Error("Key binding "+u+" is used both as a regular binding and as a multi-stroke prefix")},h=(u,d,p,v,y)=>{var w,S;let A=i[u]||(i[u]=Object.create(null)),M=d.split(/ (?!$)/).map(P=>uv(P,t));for(let P=1;P<M.length;P++){let H=M.slice(0,P).join(" ");s(H,!0),A[H]||(A[H]={preventDefault:!0,stopPropagation:!1,run:[q=>{let J=Bi={view:q,prefix:H,scope:u};return setTimeout(()=>{Bi==J&&(Bi=null)},pv),!0}]})}let D=M.join(" ");s(D,!1);let N=A[D]||(A[D]={preventDefault:!1,stopPropagation:!1,run:((S=(w=A._any)===null||w===void 0?void 0:w.run)===null||S===void 0?void 0:S.slice())||[]});p&&N.run.push(p),v&&(N.preventDefault=!0),y&&(N.stopPropagation=!0)};for(let u of f){let d=u.scope?u.scope.split(" "):["editor"];if(u.any)for(let v of d){let y=i[v]||(i[v]=Object.create(null));y._any||(y._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:w}=u;for(let S in y)y[S].run.push(A=>w(A,Na))}let p=u[t]||u.key;if(p)for(let v of d)h(v,p,u.run,u.preventDefault,u.stopPropagation),u.shift&&h(v,"Shift-"+p,u.shift,u.preventDefault,u.stopPropagation)}return i}let Na=null;function mv(f,t,i,r){Na=t;let s=I0(t),h=v0(s,0),u=y0(h)==s.length&&s!=" ",d="",p=!1,v=!1,y=!1;Bi&&Bi.view==i&&Bi.scope==r&&(d=Bi.prefix+" ",yd.indexOf(t.keyCode)<0&&(v=!0,Bi=null));let w=new Set,S=N=>{if(N){for(let P of N.run)if(!w.has(P)&&(w.add(P),P(i)))return N.stopPropagation&&(y=!0),!0;N.preventDefault&&(N.stopPropagation&&(y=!0),v=!0)}return!1},A=f[r],M,D;return A&&(S(A[d+Zs(s,t,!u)])?p=!0:u&&(t.altKey||t.metaKey||t.ctrlKey)&&!(G.windows&&t.ctrlKey&&t.altKey)&&!(G.mac&&t.altKey&&!t.ctrlKey)&&(M=Fi[t.keyCode])&&M!=s?(S(A[d+Zs(M,t,!0)])||t.shiftKey&&(D=Xr[t.keyCode])!=s&&D!=M&&S(A[d+Zs(D,t,!1)]))&&(p=!0):u&&t.shiftKey&&S(A[d+Zs(s,t,!0)])&&(p=!0),!p&&S(A._any)&&(p=!0)),v&&(p=!0),p&&y&&t.stopPropagation(),Na=null,p}class vv extends ko{constructor(t){super(),this.content=t}toDOM(t){let i=document.createElement("span");return i.className="cm-placeholder",i.style.pointerEvents="none",i.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(t):this.content.cloneNode(!0)),i.setAttribute("aria-hidden","true"),i}coordsAt(t){let i=t.firstChild?qn(t.firstChild):[];if(!i.length)return null;let r=window.getComputedStyle(t.parentNode),s=$r(i[0],r.direction!="rtl"),h=parseInt(r.lineHeight);return s.bottom-s.top>h*1.5?{left:s.left,right:s.right,top:s.top,bottom:s.top+h}:s}ignoreEvent(){return!1}}function yv(f){let t=cn.fromClass(class{constructor(i){this.view=i,this.placeholder=f?Ht.set([Ht.widget({widget:new vv(f),side:1}).range(0)]):Ht.none}get decorations(){return this.view.state.doc.length?Ht.none:this.placeholder}},{decorations:i=>i.decorations});return typeof f=="string"?[t,at.contentAttributes.of({"aria-placeholder":f})]:t}class Jn extends _n{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}Jn.prototype.elementClass="";Jn.prototype.toDOM=void 0;Jn.prototype.mapMode=Le.TrackBefore;Jn.prototype.startSide=Jn.prototype.endSide=-1;Jn.prototype.point=!0;const bv=1024;let xv=0;class Jl{constructor(t,i){this.from=t,this.to=i}}class At{constructor(t={}){this.id=xv++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Ie.match(t)),i=>{let r=t(i);return r===void 0?null:[this,r]}}}At.closedBy=new At({deserialize:f=>f.split(" ")});At.openedBy=new At({deserialize:f=>f.split(" ")});At.group=new At({deserialize:f=>f.split(" ")});At.isolate=new At({deserialize:f=>{if(f&&f!="rtl"&&f!="ltr"&&f!="auto")throw new RangeError("Invalid value for isolate: "+f);return f||"auto"}});At.contextHash=new At({perNode:!0});At.lookAhead=new At({perNode:!0});At.mounted=new At({perNode:!0});class bo{constructor(t,i,r){this.tree=t,this.overlay=i,this.parser=r}static get(t){return t&&t.props&&t.props[At.mounted.id]}}const wv=Object.create(null);class Ie{constructor(t,i,r,s=0){this.name=t,this.props=i,this.id=r,this.flags=s}static define(t){let i=t.props&&t.props.length?Object.create(null):wv,r=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),s=new Ie(t.name||"",i,t.id,r);if(t.props){for(let h of t.props)if(Array.isArray(h)||(h=h(s)),h){if(h[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");i[h[0].id]=h[1]}}return s}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let i=this.prop(At.group);return i?i.indexOf(t)>-1:!1}return this.id==t}static match(t){let i=Object.create(null);for(let r in t)for(let s of r.split(" "))i[s]=t[r];return r=>{for(let s=r.prop(At.group),h=-1;h<(s?s.length:0);h++){let u=i[h<0?r.name:s[h]];if(u)return u}}}}Ie.none=new Ie("",Object.create(null),0,8);const Qs=new WeakMap,ec=new WeakMap;var $t;(function(f){f[f.ExcludeBuffers=1]="ExcludeBuffers",f[f.IncludeAnonymous=2]="IncludeAnonymous",f[f.IgnoreMounts=4]="IgnoreMounts",f[f.IgnoreOverlays=8]="IgnoreOverlays"})($t||($t={}));class le{constructor(t,i,r,s,h){if(this.type=t,this.children=i,this.positions=r,this.length=s,this.props=null,h&&h.length){this.props=Object.create(null);for(let[u,d]of h)this.props[typeof u=="number"?u:u.id]=d}}toString(){let t=bo.get(this);if(t&&!t.overlay)return t.tree.toString();let i="";for(let r of this.children){let s=r.toString();s&&(i&&(i+=","),i+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(i.length?"("+i+")":""):i}cursor(t=0){return new Ea(this.topNode,t)}cursorAt(t,i=0,r=0){let s=Qs.get(this)||this.topNode,h=new Ea(s);return h.moveTo(t,i),Qs.set(this,h._tree),h}get topNode(){return new Be(this,0,0,null)}resolve(t,i=0){let r=Zr(Qs.get(this)||this.topNode,t,i,!1);return Qs.set(this,r),r}resolveInner(t,i=0){let r=Zr(ec.get(this)||this.topNode,t,i,!0);return ec.set(this,r),r}resolveStack(t,i=0){return Cv(this,t,i)}iterate(t){let{enter:i,leave:r,from:s=0,to:h=this.length}=t,u=t.mode||0,d=(u&$t.IncludeAnonymous)>0;for(let p=this.cursor(u|$t.IncludeAnonymous);;){let v=!1;if(p.from<=h&&p.to>=s&&(!d&&p.type.isAnonymous||i(p)!==!1)){if(p.firstChild())continue;v=!0}for(;v&&r&&(d||!p.type.isAnonymous)&&r(p),!p.nextSibling();){if(!p.parent())return;v=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let i in this.props)t.push([+i,this.props[i]]);return t}balance(t={}){return this.children.length<=8?this:Za(Ie.none,this.children,this.positions,0,this.children.length,0,this.length,(i,r,s)=>new le(this.type,i,r,s,this.propValues),t.makeTree||((i,r,s)=>new le(Ie.none,i,r,s)))}static build(t){return Av(t)}}le.empty=new le(Ie.none,[],[],0);class ja{constructor(t,i){this.buffer=t,this.index=i}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new ja(this.buffer,this.index)}}class Ki{constructor(t,i,r){this.buffer=t,this.length=i,this.set=r}get type(){return Ie.none}toString(){let t=[];for(let i=0;i<this.buffer.length;)t.push(this.childString(i)),i=this.buffer[i+3];return t.join(",")}childString(t){let i=this.buffer[t],r=this.buffer[t+3],s=this.set.types[i],h=s.name;if(/\W/.test(h)&&!s.isError&&(h=JSON.stringify(h)),t+=4,r==t)return h;let u=[];for(;t<r;)u.push(this.childString(t)),t=this.buffer[t+3];return h+"("+u.join(",")+")"}findChild(t,i,r,s,h){let{buffer:u}=this,d=-1;for(let p=t;p!=i&&!(Dd(h,s,u[p+1],u[p+2])&&(d=p,r>0));p=u[p+3]);return d}slice(t,i,r){let s=this.buffer,h=new Uint16Array(i-t),u=0;for(let d=t,p=0;d<i;){h[p++]=s[d++],h[p++]=s[d++]-r;let v=h[p++]=s[d++]-r;h[p++]=s[d++]-t,u=Math.max(u,v)}return new Ki(h,u,this.set)}}function Dd(f,t,i,r){switch(f){case-2:return i<t;case-1:return r>=t&&i<t;case 0:return i<t&&r>t;case 1:return i<=t&&r>t;case 2:return r>t;case 4:return!0}}function Zr(f,t,i,r){for(var s;f.from==f.to||(i<1?f.from>=t:f.from>t)||(i>-1?f.to<=t:f.to<t);){let u=!r&&f instanceof Be&&f.index<0?null:f.parent;if(!u)return f;f=u}let h=r?0:$t.IgnoreOverlays;if(r)for(let u=f,d=u.parent;d;u=d,d=u.parent)u instanceof Be&&u.index<0&&((s=d.enter(t,i,h))===null||s===void 0?void 0:s.from)!=u.from&&(f=d);for(;;){let u=f.enter(t,i,h);if(!u)return f;f=u}}class Nd{cursor(t=0){return new Ea(this,t)}getChild(t,i=null,r=null){let s=ic(this,t,i,r);return s.length?s[0]:null}getChildren(t,i=null,r=null){return ic(this,t,i,r)}resolve(t,i=0){return Zr(this,t,i,!1)}resolveInner(t,i=0){return Zr(this,t,i,!0)}matchContext(t){return Pa(this.parent,t)}enterUnfinishedNodesBefore(t){let i=this.childBefore(t),r=this;for(;i;){let s=i.lastChild;if(!s||s.to!=i.to)break;s.type.isError&&s.from==s.to?(r=i,i=s.prevSibling):i=s}return r}get node(){return this}get next(){return this.parent}}class Be extends Nd{constructor(t,i,r,s){super(),this._tree=t,this.from=i,this.index=r,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,i,r,s,h=0){for(let u=this;;){for(let{children:d,positions:p}=u._tree,v=i>0?d.length:-1;t!=v;t+=i){let y=d[t],w=p[t]+u.from;if(Dd(s,r,w,w+y.length)){if(y instanceof Ki){if(h&$t.ExcludeBuffers)continue;let S=y.findChild(0,y.buffer.length,i,r-w,s);if(S>-1)return new Wi(new Sv(u,y,t,w),null,S)}else if(h&$t.IncludeAnonymous||!y.type.isAnonymous||Ja(y)){let S;if(!(h&$t.IgnoreMounts)&&(S=bo.get(y))&&!S.overlay)return new Be(S.tree,w,t,u);let A=new Be(y,w,t,u);return h&$t.IncludeAnonymous||!A.type.isAnonymous?A:A.nextChild(i<0?y.children.length-1:0,i,r,s)}}}if(h&$t.IncludeAnonymous||!u.type.isAnonymous||(u.index>=0?t=u.index+i:t=i<0?-1:u._parent._tree.children.length,u=u._parent,!u))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,i,r=0){let s;if(!(r&$t.IgnoreOverlays)&&(s=bo.get(this._tree))&&s.overlay){let h=t-this.from;for(let{from:u,to:d}of s.overlay)if((i>0?u<=h:u<h)&&(i<0?d>=h:d>h))return new Be(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,i,r)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function ic(f,t,i,r){let s=f.cursor(),h=[];if(!s.firstChild())return h;if(i!=null){for(let u=!1;!u;)if(u=s.type.is(i),!s.nextSibling())return h}for(;;){if(r!=null&&s.type.is(r))return h;if(s.type.is(t)&&h.push(s.node),!s.nextSibling())return r==null?h:[]}}function Pa(f,t,i=t.length-1){for(let r=f;i>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(t[i]&&t[i]!=r.name)return!1;i--}}return!0}class Sv{constructor(t,i,r,s){this.parent=t,this.buffer=i,this.index=r,this.start=s}}class Wi extends Nd{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,i,r){super(),this.context=t,this._parent=i,this.index=r,this.type=t.buffer.set.types[t.buffer.buffer[r]]}child(t,i,r){let{buffer:s}=this.context,h=s.findChild(this.index+4,s.buffer[this.index+3],t,i-this.context.start,r);return h<0?null:new Wi(this.context,this,h)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,i,r=0){if(r&$t.ExcludeBuffers)return null;let{buffer:s}=this.context,h=s.findChild(this.index+4,s.buffer[this.index+3],i>0?1:-1,t-this.context.start,i);return h<0?null:new Wi(this.context,this,h)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,i=t.buffer[this.index+3];return i<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new Wi(this.context,this._parent,i):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,i=this._parent?this._parent.index+4:0;return this.index==i?this.externalSibling(-1):new Wi(this.context,this._parent,t.findChild(i,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],i=[],{buffer:r}=this.context,s=this.index+4,h=r.buffer[this.index+3];if(h>s){let u=r.buffer[this.index+1];t.push(r.slice(s,h,u)),i.push(0)}return new le(this.type,t,i,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Pd(f){if(!f.length)return null;let t=0,i=f[0];for(let h=1;h<f.length;h++){let u=f[h];(u.from>i.from||u.to<i.to)&&(i=u,t=h)}let r=i instanceof Be&&i.index<0?null:i.parent,s=f.slice();return r?s[t]=r:s.splice(t,1),new kv(s,i)}class kv{constructor(t,i){this.heads=t,this.node=i}get next(){return Pd(this.heads)}}function Cv(f,t,i){let r=f.resolveInner(t,i),s=null;for(let h=r instanceof Be?r:r.context.parent;h;h=h.parent)if(h.index<0){let u=h.parent;(s||(s=[r])).push(u.resolve(t,i)),h=u}else{let u=bo.get(h.tree);if(u&&u.overlay&&u.overlay[0].from<=t&&u.overlay[u.overlay.length-1].to>=t){let d=new Be(u.tree,u.overlay[0].from+h.from,-1,h);(s||(s=[r])).push(Zr(d,t,i,!1))}}return s?Pd(s):r}class Ea{get name(){return this.type.name}constructor(t,i=0){if(this.mode=i,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Be)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let r=t._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,i){this.index=t;let{start:r,buffer:s}=this.buffer;return this.type=i||s.set.types[s.buffer[t]],this.from=r+s.buffer[t+1],this.to=r+s.buffer[t+2],!0}yield(t){return t?t instanceof Be?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,i,r){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,i,r,this.mode));let{buffer:s}=this.buffer,h=s.findChild(this.index+4,s.buffer[this.index+3],t,i-this.buffer.start,r);return h<0?!1:(this.stack.push(this.index),this.yieldBuf(h))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,i,r=this.mode){return this.buffer?r&$t.ExcludeBuffers?!1:this.enterChild(1,t,i):this.yield(this._tree.enter(t,i,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&$t.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&$t.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:i}=this.buffer,r=this.stack.length-1;if(t<0){let s=r<0?0:this.stack[r]+4;if(this.index!=s)return this.yieldBuf(i.findChild(s,this.index,-1,0,4))}else{let s=i.buffer[this.index+3];if(s<(r<0?i.buffer.length:i.buffer[this.stack[r]+3]))return this.yieldBuf(s)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let i,r,{buffer:s}=this;if(s){if(t>0){if(this.index<s.buffer.buffer.length)return!1}else for(let h=0;h<this.index;h++)if(s.buffer.buffer[h+3]<this.index)return!1;({index:i,parent:r}=s)}else({index:i,_parent:r}=this._tree);for(;r;{index:i,_parent:r}=r)if(i>-1)for(let h=i+t,u=t<0?-1:r._tree.children.length;h!=u;h+=t){let d=r._tree.children[h];if(this.mode&$t.IncludeAnonymous||d instanceof Ki||!d.type.isAnonymous||Ja(d))return!1}return!0}move(t,i){if(i&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,i=0){for(;(this.from==this.to||(i<1?this.from>=t:this.from>t)||(i>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,i););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,i=null,r=0;if(t&&t.context==this.buffer)t:for(let s=this.index,h=this.stack.length;h>=0;){for(let u=t;u;u=u._parent)if(u.index==s){if(s==this.index)return u;i=u,r=h+1;break t}s=this.stack[--h]}for(let s=r;s<this.stack.length;s++)i=new Wi(this.buffer,i,this.stack[s]);return this.bufferNode=new Wi(this.buffer,i,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,i){for(let r=0;;){let s=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&i&&i(this),s=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,s=!0}}}matchContext(t){if(!this.buffer)return Pa(this.node.parent,t);let{buffer:i}=this.buffer,{types:r}=i.set;for(let s=t.length-1,h=this.stack.length-1;s>=0;h--){if(h<0)return Pa(this._tree,t,s);let u=r[i.buffer[this.stack[h]]];if(!u.isAnonymous){if(t[s]&&t[s]!=u.name)return!1;s--}}return!0}}function Ja(f){return f.children.some(t=>t instanceof Ki||!t.type.isAnonymous||Ja(t))}function Av(f){var t;let{buffer:i,nodeSet:r,maxBufferLength:s=bv,reused:h=[],minRepeatType:u=r.types.length}=f,d=Array.isArray(i)?new ja(i,i.length):i,p=r.types,v=0,y=0;function w(_,et,Q,pt,vt,wt){let{id:st,start:tt,end:ht,size:lt}=d,V=y,ae=v;for(;lt<0;)if(d.next(),lt==-1){let Ce=h[st];Q.push(Ce),pt.push(tt-_);return}else if(lt==-3){v=st;return}else if(lt==-4){y=st;return}else throw new RangeError(`Unrecognized record size: ${lt}`);let Se=p[st],ke,Bt,Ve=tt-_;if(ht-tt<=s&&(Bt=N(d.pos-et,vt))){let Ce=new Uint16Array(Bt.size-Bt.skip),_t=d.pos-Bt.size,ee=Ce.length;for(;d.pos>_t;)ee=P(Bt.start,Ce,ee);ke=new Ki(Ce,ht-Bt.start,r),Ve=Bt.start-_}else{let Ce=d.pos-lt;d.next();let _t=[],ee=[],ve=st>=u?st:-1,ye=0,li=ht;for(;d.pos>Ce;)ve>=0&&d.id==ve&&d.size>=0?(d.end<=li-s&&(M(_t,ee,tt,ye,d.end,li,ve,V,ae),ye=_t.length,li=d.end),d.next()):wt>2500?S(tt,Ce,_t,ee):w(tt,Ce,_t,ee,ve,wt+1);if(ve>=0&&ye>0&&ye<_t.length&&M(_t,ee,tt,ye,tt,li,ve,V,ae),_t.reverse(),ee.reverse(),ve>-1&&ye>0){let pn=A(Se,ae);ke=Za(Se,_t,ee,0,_t.length,0,ht-tt,pn,pn)}else ke=D(Se,_t,ee,ht-tt,V-ht,ae)}Q.push(ke),pt.push(Ve)}function S(_,et,Q,pt){let vt=[],wt=0,st=-1;for(;d.pos>et;){let{id:tt,start:ht,end:lt,size:V}=d;if(V>4)d.next();else{if(st>-1&&ht<st)break;st<0&&(st=lt-s),vt.push(tt,ht,lt),wt++,d.next()}}if(wt){let tt=new Uint16Array(wt*4),ht=vt[vt.length-2];for(let lt=vt.length-3,V=0;lt>=0;lt-=3)tt[V++]=vt[lt],tt[V++]=vt[lt+1]-ht,tt[V++]=vt[lt+2]-ht,tt[V++]=V;Q.push(new Ki(tt,vt[2]-ht,r)),pt.push(ht-_)}}function A(_,et){return(Q,pt,vt)=>{let wt=0,st=Q.length-1,tt,ht;if(st>=0&&(tt=Q[st])instanceof le){if(!st&&tt.type==_&&tt.length==vt)return tt;(ht=tt.prop(At.lookAhead))&&(wt=pt[st]+tt.length+ht)}return D(_,Q,pt,vt,wt,et)}}function M(_,et,Q,pt,vt,wt,st,tt,ht){let lt=[],V=[];for(;_.length>pt;)lt.push(_.pop()),V.push(et.pop()+Q-vt);_.push(D(r.types[st],lt,V,wt-vt,tt-wt,ht)),et.push(vt-Q)}function D(_,et,Q,pt,vt,wt,st){if(wt){let tt=[At.contextHash,wt];st=st?[tt].concat(st):[tt]}if(vt>25){let tt=[At.lookAhead,vt];st=st?[tt].concat(st):[tt]}return new le(_,et,Q,pt,st)}function N(_,et){let Q=d.fork(),pt=0,vt=0,wt=0,st=Q.end-s,tt={size:0,start:0,skip:0};t:for(let ht=Q.pos-_;Q.pos>ht;){let lt=Q.size;if(Q.id==et&&lt>=0){tt.size=pt,tt.start=vt,tt.skip=wt,wt+=4,pt+=4,Q.next();continue}let V=Q.pos-lt;if(lt<0||V<ht||Q.start<st)break;let ae=Q.id>=u?4:0,Se=Q.start;for(Q.next();Q.pos>V;){if(Q.size<0)if(Q.size==-3)ae+=4;else break t;else Q.id>=u&&(ae+=4);Q.next()}vt=Se,pt+=lt,wt+=ae}return(et<0||pt==_)&&(tt.size=pt,tt.start=vt,tt.skip=wt),tt.size>4?tt:void 0}function P(_,et,Q){let{id:pt,start:vt,end:wt,size:st}=d;if(d.next(),st>=0&&pt<u){let tt=Q;if(st>4){let ht=d.pos-(st-4);for(;d.pos>ht;)Q=P(_,et,Q)}et[--Q]=tt,et[--Q]=wt-_,et[--Q]=vt-_,et[--Q]=pt}else st==-3?v=pt:st==-4&&(y=pt);return Q}let H=[],q=[];for(;d.pos>0;)w(f.start||0,f.bufferStart||0,H,q,-1,0);let J=(t=f.length)!==null&&t!==void 0?t:H.length?q[0]+H[0].length:0;return new le(p[f.topID],H.reverse(),q.reverse(),J)}const nc=new WeakMap;function ho(f,t){if(!f.isAnonymous||t instanceof Ki||t.type!=f)return 1;let i=nc.get(t);if(i==null){i=1;for(let r of t.children){if(r.type!=f||!(r instanceof le)){i=1;break}i+=ho(f,r)}nc.set(t,i)}return i}function Za(f,t,i,r,s,h,u,d,p){let v=0;for(let M=r;M<s;M++)v+=ho(f,t[M]);let y=Math.ceil(v*1.5/8),w=[],S=[];function A(M,D,N,P,H){for(let q=N;q<P;){let J=q,_=D[q],et=ho(f,M[q]);for(q++;q<P;q++){let Q=ho(f,M[q]);if(et+Q>=y)break;et+=Q}if(q==J+1){if(et>y){let Q=M[J];A(Q.children,Q.positions,0,Q.children.length,D[J]+H);continue}w.push(M[J])}else{let Q=D[q-1]+M[q-1].length-_;w.push(Za(f,M,D,J,q,_,Q,null,p))}S.push(_+H-h)}}return A(t,i,r,s,0),(d||p)(w,S,u)}class an{constructor(t,i,r,s,h=!1,u=!1){this.from=t,this.to=i,this.tree=r,this.offset=s,this.open=(h?1:0)|(u?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,i=[],r=!1){let s=[new an(0,t.length,t,0,!1,r)];for(let h of i)h.to>t.length&&s.push(h);return s}static applyChanges(t,i,r=128){if(!i.length)return t;let s=[],h=1,u=t.length?t[0]:null;for(let d=0,p=0,v=0;;d++){let y=d<i.length?i[d]:null,w=y?y.fromA:1e9;if(w-p>=r)for(;u&&u.from<w;){let S=u;if(p>=S.from||w<=S.to||v){let A=Math.max(S.from,p)-v,M=Math.min(S.to,w)-v;S=A>=M?null:new an(A,M,S.tree,S.offset+v,d>0,!!y)}if(S&&s.push(S),u.to>w)break;u=h<t.length?t[h++]:null}if(!y)break;p=y.toA,v=y.toA-y.toB}return s}}class Mv{startParse(t,i,r){return typeof t=="string"&&(t=new Tv(t)),r=r?r.length?r.map(s=>new Jl(s.from,s.to)):[new Jl(0,0)]:[new Jl(0,t.length)],this.createParse(t,i||[],r)}parse(t,i,r){let s=this.startParse(t,i,r);for(;;){let h=s.advance();if(h)return h}}}class Tv{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,i){return this.string.slice(t,i)}}new At({perNode:!0});let Lv=0;class Pe{constructor(t,i,r,s){this.name=t,this.set=i,this.base=r,this.modified=s,this.id=Lv++}toString(){let{name:t}=this;for(let i of this.modified)i.name&&(t=`${i.name}(${t})`);return t}static define(t,i){let r=typeof t=="string"?t:"?";if(t instanceof Pe&&(i=t),i!=null&&i.base)throw new Error("Can not derive from a modified tag");let s=new Pe(r,[],null,[]);if(s.set.push(s),i)for(let h of i.set)s.set.push(h);return s}static defineModifier(t){let i=new xo(t);return r=>r.modified.indexOf(i)>-1?r:xo.get(r.base||r,r.modified.concat(i).sort((s,h)=>s.id-h.id))}}let Ov=0;class xo{constructor(t){this.name=t,this.instances=[],this.id=Ov++}static get(t,i){if(!i.length)return t;let r=i[0].instances.find(d=>d.base==t&&Dv(i,d.modified));if(r)return r;let s=[],h=new Pe(t.name,s,t,i);for(let d of i)d.instances.push(h);let u=Nv(i);for(let d of t.set)if(!d.modified.length)for(let p of u)s.push(xo.get(d,p));return h}}function Dv(f,t){return f.length==t.length&&f.every((i,r)=>i==t[r])}function Nv(f){let t=[[]];for(let i=0;i<f.length;i++)for(let r=0,s=t.length;r<s;r++)t.push(t[r].concat(f[i]));return t.sort((i,r)=>r.length-i.length)}function Pv(f){let t=Object.create(null);for(let i in f){let r=f[i];Array.isArray(r)||(r=[r]);for(let s of i.split(" "))if(s){let h=[],u=2,d=s;for(let w=0;;){if(d=="..."&&w>0&&w+3==s.length){u=1;break}let S=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(d);if(!S)throw new RangeError("Invalid path: "+s);if(h.push(S[0]=="*"?"":S[0][0]=='"'?JSON.parse(S[0]):S[0]),w+=S[0].length,w==s.length)break;let A=s[w++];if(w==s.length&&A=="!"){u=0;break}if(A!="/")throw new RangeError("Invalid path: "+s);d=s.slice(w)}let p=h.length-1,v=h[p];if(!v)throw new RangeError("Invalid path: "+s);let y=new Ba(r,u,p>0?h.slice(0,p):null);t[v]=y.sort(t[v])}}return Ev.add(t)}const Ev=new At;class Ba{constructor(t,i,r,s){this.tags=t,this.mode=i,this.context=r,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}Ba.empty=new Ba([],2,null);function Ed(f,t){let i=Object.create(null);for(let h of f)if(!Array.isArray(h.tag))i[h.tag.id]=h.class;else for(let u of h.tag)i[u.id]=h.class;let{scope:r,all:s=null}=t||{};return{style:h=>{let u=s;for(let d of h)for(let p of d.set){let v=i[p.id];if(v){u=u?u+" "+v:v;break}}return u},scope:r}}const z=Pe.define,$s=z(),Pi=z(),rc=z(Pi),sc=z(Pi),Ei=z(),to=z(Ei),Zl=z(Ei),$e=z(),nn=z($e),Ze=z(),Qe=z(),Ra=z(),Ir=z(Ra),eo=z(),K={comment:$s,lineComment:z($s),blockComment:z($s),docComment:z($s),name:Pi,variableName:z(Pi),typeName:rc,tagName:z(rc),propertyName:sc,attributeName:z(sc),className:z(Pi),labelName:z(Pi),namespace:z(Pi),macroName:z(Pi),literal:Ei,string:to,docString:z(to),character:z(to),attributeValue:z(to),number:Zl,integer:z(Zl),float:z(Zl),bool:z(Ei),regexp:z(Ei),escape:z(Ei),color:z(Ei),url:z(Ei),keyword:Ze,self:z(Ze),null:z(Ze),atom:z(Ze),unit:z(Ze),modifier:z(Ze),operatorKeyword:z(Ze),controlKeyword:z(Ze),definitionKeyword:z(Ze),moduleKeyword:z(Ze),operator:Qe,derefOperator:z(Qe),arithmeticOperator:z(Qe),logicOperator:z(Qe),bitwiseOperator:z(Qe),compareOperator:z(Qe),updateOperator:z(Qe),definitionOperator:z(Qe),typeOperator:z(Qe),controlOperator:z(Qe),punctuation:Ra,separator:z(Ra),bracket:Ir,angleBracket:z(Ir),squareBracket:z(Ir),paren:z(Ir),brace:z(Ir),content:$e,heading:nn,heading1:z(nn),heading2:z(nn),heading3:z(nn),heading4:z(nn),heading5:z(nn),heading6:z(nn),contentSeparator:z($e),list:z($e),quote:z($e),emphasis:z($e),strong:z($e),link:z($e),monospace:z($e),strikethrough:z($e),inserted:z(),deleted:z(),changed:z(),invalid:z(),meta:eo,documentMeta:z(eo),annotation:z(eo),processingInstruction:z(eo),definition:Pe.defineModifier("definition"),constant:Pe.defineModifier("constant"),function:Pe.defineModifier("function"),standard:Pe.defineModifier("standard"),local:Pe.defineModifier("local"),special:Pe.defineModifier("special")};for(let f in K){let t=K[f];t instanceof Pe&&(t.name=f)}Ed([{tag:K.link,class:"tok-link"},{tag:K.heading,class:"tok-heading"},{tag:K.emphasis,class:"tok-emphasis"},{tag:K.strong,class:"tok-strong"},{tag:K.keyword,class:"tok-keyword"},{tag:K.atom,class:"tok-atom"},{tag:K.bool,class:"tok-bool"},{tag:K.url,class:"tok-url"},{tag:K.labelName,class:"tok-labelName"},{tag:K.inserted,class:"tok-inserted"},{tag:K.deleted,class:"tok-deleted"},{tag:K.literal,class:"tok-literal"},{tag:K.string,class:"tok-string"},{tag:K.number,class:"tok-number"},{tag:[K.regexp,K.escape,K.special(K.string)],class:"tok-string2"},{tag:K.variableName,class:"tok-variableName"},{tag:K.local(K.variableName),class:"tok-variableName tok-local"},{tag:K.definition(K.variableName),class:"tok-variableName tok-definition"},{tag:K.special(K.variableName),class:"tok-variableName2"},{tag:K.definition(K.propertyName),class:"tok-propertyName tok-definition"},{tag:K.typeName,class:"tok-typeName"},{tag:K.namespace,class:"tok-namespace"},{tag:K.className,class:"tok-className"},{tag:K.macroName,class:"tok-macroName"},{tag:K.propertyName,class:"tok-propertyName"},{tag:K.operator,class:"tok-operator"},{tag:K.comment,class:"tok-comment"},{tag:K.meta,class:"tok-meta"},{tag:K.invalid,class:"tok-invalid"},{tag:K.punctuation,class:"tok-punctuation"}]);var Ql;const Kr=new At,Bv=new At;class ri{constructor(t,i,r=[],s=""){this.data=t,this.name=s,ut.prototype.hasOwnProperty("tree")||Object.defineProperty(ut.prototype,"tree",{get(){return Ia(this)}}),this.parser=i,this.extension=[Qn.of(this),ut.languageData.of((h,u,d)=>{let p=oc(h,u,d),v=p.type.prop(Kr);if(!v)return[];let y=h.facet(v),w=p.type.prop(Bv);if(w){let S=p.resolve(u-p.from,d);for(let A of w)if(A.test(S,h)){let M=h.facet(A.facet);return A.type=="replace"?M:M.concat(y)}}return y})].concat(r)}isActiveAt(t,i,r=-1){return oc(t,i,r).type.prop(Kr)==this.data}findRegions(t){let i=t.facet(Qn);if((i==null?void 0:i.data)==this.data)return[{from:0,to:t.doc.length}];if(!i||!i.allowsNesting)return[];let r=[],s=(h,u)=>{if(h.prop(Kr)==this.data){r.push({from:u,to:u+h.length});return}let d=h.prop(At.mounted);if(d){if(d.tree.prop(Kr)==this.data){if(d.overlay)for(let p of d.overlay)r.push({from:p.from+u,to:p.to+u});else r.push({from:u,to:u+h.length});return}else if(d.overlay){let p=r.length;if(s(d.tree,d.overlay[0].from+u),r.length>p)return}}for(let p=0;p<h.children.length;p++){let v=h.children[p];v instanceof le&&s(v,h.positions[p]+u)}};return s(Ia(t),0),r}get allowsNesting(){return!0}}ri.setState=Wt.define();function oc(f,t,i){let r=f.facet(Qn),s=Ia(f).topNode;if(!r||r.allowsNesting)for(let h=s;h;h=h.enter(t,i,$t.ExcludeBuffers))h.type.isTop&&(s=h);return s}function Ia(f){let t=f.field(ri.state,!1);return t?t.tree:le.empty}class Rv{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,i){let r=this.cursorPos-this.string.length;return t<r||i>=this.cursorPos?this.doc.sliceString(t,i):this.string.slice(t-r,i-r)}}let Wr=null;class wo{constructor(t,i,r=[],s,h,u,d,p){this.parser=t,this.state=i,this.fragments=r,this.tree=s,this.treeLen=h,this.viewport=u,this.skipped=d,this.scheduleOn=p,this.parse=null,this.tempSkipped=[]}static create(t,i,r){return new wo(t,i,[],le.empty,0,r,[],null)}startParse(){return this.parser.startParse(new Rv(this.state.doc),this.fragments)}work(t,i){return i!=null&&i>=this.state.doc.length&&(i=void 0),this.tree!=le.empty&&this.isDone(i??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof t=="number"){let s=Date.now()+t;t=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),i!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>i)&&i<this.state.doc.length&&this.parse.stopAt(i);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(an.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(i??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,i;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(i=this.parse.advance()););}),this.treeLen=t,this.tree=i,this.fragments=this.withoutTempSkipped(an.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let i=Wr;Wr=this;try{return t()}finally{Wr=i}}withoutTempSkipped(t){for(let i;i=this.tempSkipped.pop();)t=lc(t,i.from,i.to);return t}changes(t,i){let{fragments:r,tree:s,treeLen:h,viewport:u,skipped:d}=this;if(this.takeTree(),!t.empty){let p=[];if(t.iterChangedRanges((v,y,w,S)=>p.push({fromA:v,toA:y,fromB:w,toB:S})),r=an.applyChanges(r,p),s=le.empty,h=0,u={from:t.mapPos(u.from,-1),to:t.mapPos(u.to,1)},this.skipped.length){d=[];for(let v of this.skipped){let y=t.mapPos(v.from,1),w=t.mapPos(v.to,-1);y<w&&d.push({from:y,to:w})}}}return new wo(this.parser,i,r,s,h,u,d,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let i=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:s,to:h}=this.skipped[r];s<t.to&&h>t.from&&(this.fragments=lc(this.fragments,s,h),this.skipped.splice(r--,1))}return this.skipped.length>=i?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,i){this.skipped.push({from:t,to:i})}static getSkippingParser(t){return new class extends Mv{createParse(i,r,s){let h=s[0].from,u=s[s.length-1].to;return{parsedPos:h,advance(){let p=Wr;if(p){for(let v of s)p.tempSkipped.push(v);t&&(p.scheduleOn=p.scheduleOn?Promise.all([p.scheduleOn,t]):t)}return this.parsedPos=u,new le(Ie.none,[],[],u-h)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let i=this.fragments;return this.treeLen>=t&&i.length&&i[0].from==0&&i[0].to>=t}static get(){return Wr}}function lc(f,t,i){return an.applyChanges(f,[{fromA:t,toA:i,fromB:t,toB:i}])}class Zn{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let i=this.context.changes(t.changes,t.state),r=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),i.viewport.to);return i.work(20,r)||i.takeTree(),new Zn(i)}static init(t){let i=Math.min(3e3,t.doc.length),r=wo.create(t.facet(Qn).parser,t,{from:0,to:i});return r.work(20,i)||r.takeTree(),new Zn(r)}}ri.state=dn.define({create:Zn.init,update(f,t){for(let i of t.effects)if(i.is(ri.setState))return i.value;return t.startState.facet(Qn)!=t.state.facet(Qn)?Zn.init(t.state):f.apply(t)}});let Bd=f=>{let t=setTimeout(()=>f(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(Bd=f=>{let t=-1,i=setTimeout(()=>{t=requestIdleCallback(f,{timeout:500-100})},100);return()=>t<0?clearTimeout(i):cancelIdleCallback(t)});const $l=typeof navigator<"u"&&(!((Ql=navigator.scheduling)===null||Ql===void 0)&&Ql.isInputPending)?()=>navigator.scheduling.isInputPending():null,Iv=cn.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let i=this.view.state.field(ri.state).context;(i.updateViewport(t.view.viewport)||this.view.viewport.to>i.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(i)}scheduleWork(){if(this.working)return;let{state:t}=this.view,i=t.field(ri.state);(i.tree!=i.context.tree||!i.context.isDone(t.doc.length))&&(this.working=Bd(this.work))}work(t){this.working=null;let i=Date.now();if(this.chunkEnd<i&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=i+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:s}}=this.view,h=r.field(ri.state);if(h.tree==h.context.tree&&h.context.isDone(s+1e5))return;let u=Date.now()+Math.min(this.chunkBudget,100,t&&!$l?Math.max(25,t.timeRemaining()-5):1e9),d=h.context.treeLen<s&&r.doc.length>s+1e3,p=h.context.work(()=>$l&&$l()||Date.now()>u,s+(d?0:1e5));this.chunkBudget-=Date.now()-i,(p||this.chunkBudget<=0)&&(h.context.takeTree(),this.view.dispatch({effects:ri.setState.of(new Zn(h.context))})),this.chunkBudget>0&&!(p&&!d)&&this.scheduleWork(),this.checkAsyncSchedule(h.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(i=>ni(this.view.state,i)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Qn=ot.define({combine(f){return f.length?f[0]:null},enables:f=>[ri.state,Iv,at.contentAttributes.compute([f],t=>{let i=t.facet(f);return i&&i.name?{"data-language":i.name}:{}})]}),Ao=ot.define({combine:f=>{if(!f.length)return"  ";let t=f[0];if(!t||/\S/.test(t)||Array.from(t).some(i=>i!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(f[0]));return t}});function Wv(f){let t=f.facet(Ao);return t.charCodeAt(0)==9?f.tabSize*t.length:t.length}function Hv(f,t){let i="",r=f.tabSize,s=f.facet(Ao)[0];if(s=="	"){for(;t>=r;)i+="	",t-=r;s=" "}for(let h=0;h<t;h++)i+=s;return i}class Qa{constructor(t,i){this.specs=t;let r;function s(d){let p=Hi.newName();return(r||(r=Object.create(null)))["."+p]=d,p}const h=typeof i.all=="string"?i.all:i.all?s(i.all):void 0,u=i.scope;this.scope=u instanceof ri?d=>d.prop(Kr)==u.data:u?d=>d==u:void 0,this.style=Ed(t.map(d=>({tag:d.tag,class:d.class||s(Object.assign({},d,{tag:null}))})),{all:h}).style,this.module=r?new Hi(r):null,this.themeType=i.themeType}static define(t,i){return new Qa(t,i||{})}}K.meta,K.link,K.heading,K.emphasis,K.strong,K.strikethrough,K.keyword,K.atom,K.bool,K.url,K.contentSeparator,K.labelName,K.literal,K.inserted,K.string,K.deleted,K.regexp,K.escape,K.string,K.variableName,K.variableName,K.typeName,K.namespace,K.className,K.variableName,K.macroName,K.propertyName,K.comment,K.invalid;const Fv=Object.create(null),ac=[Ie.none],hc=[],fc=Object.create(null),zv=Object.create(null);for(let[f,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])zv[f]=Kv(Fv,t);function ta(f,t){hc.indexOf(f)>-1||(hc.push(f),console.warn(t))}function Kv(f,t){let i=[];for(let d of t.split(" ")){let p=[];for(let v of d.split(".")){let y=f[v]||K[v];y?typeof y=="function"?p.length?p=p.map(y):ta(v,`Modifier ${v} used at start of tag`):p.length?ta(v,`Tag ${v} used as modifier`):p=Array.isArray(y)?y:[y]:ta(v,`Unknown highlighting tag ${v}`)}for(let v of p)i.push(v)}if(!i.length)return 0;let r=t.replace(/ /g,"_"),s=r+" "+i.map(d=>d.id),h=fc[s];if(h)return h.id;let u=fc[s]=Ie.define({id:ac.length,name:r,props:[Pv({[r]:i})]});return ac.push(u),u.id}te.RTL,te.LTR;function Rd(f,t){let i=-1;return f.changeByRange(r=>{let s=[];for(let u=r.from;u<=r.to;){let d=f.doc.lineAt(u);d.number>i&&(r.empty||r.to>d.from)&&(t(d,s,r),i=d.number),u=d.to+1}let h=f.changes(s);return{changes:s,range:j.range(h.mapPos(r.anchor,1),h.mapPos(r.head,1))}})}const Uv=({state:f,dispatch:t})=>f.readOnly?!1:(t(f.update(Rd(f,(i,r)=>{r.push({from:i.from,insert:f.facet(Ao)})}),{userEvent:"input.indent"})),!0),Vv=({state:f,dispatch:t})=>f.readOnly?!1:(t(f.update(Rd(f,(i,r)=>{let s=/^\s*/.exec(i.text)[0];if(!s)return;let h=N0(s,f.tabSize),u=0,d=Hv(f,Math.max(0,h-Wv(f)));for(;u<s.length&&u<d.length&&s.charCodeAt(u)==d.charCodeAt(u);)u++;r.push({from:i.from+u,to:i.from+s.length,insert:d.slice(u)})}),{userEvent:"delete.dedent"})),!0),Gv={key:"Tab",run:Uv,shift:Vv};/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var _v=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[h0.basicSetup]}),qv=Symbol("vue-codemirror-global-config"),ge,Yv=function(f){var t=f.onUpdate,i=f.onChange,r=f.onFocus,s=f.onBlur,h=function(u,d){var p={};for(var v in u)Object.prototype.hasOwnProperty.call(u,v)&&d.indexOf(v)<0&&(p[v]=u[v]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var y=0;for(v=Object.getOwnPropertySymbols(u);y<v.length;y++)d.indexOf(v[y])<0&&Object.prototype.propertyIsEnumerable.call(u,v[y])&&(p[v[y]]=u[v[y]])}return p}(f,["onUpdate","onChange","onFocus","onBlur"]);return ut.create({doc:h.doc,selection:h.selection,extensions:(Array.isArray(h.extensions)?h.extensions:[h.extensions]).concat([at.updateListener.of(function(u){t(u),u.docChanged&&i(u.state.doc.toString(),u),u.focusChanged&&(u.view.hasFocus?r(u):s(u))})])})},Fn=function(f){var t=new Qr;return{compartment:t,run:function(i){t.get(f.state)?f.dispatch({effects:t.reconfigure(i)}):f.dispatch({effects:Wt.appendConfig.of(t.of(i))})}}},uc=function(f,t){var i=Fn(f),r=i.compartment,s=i.run;return function(h){var u=r.get(f.state);s(h??u!==t?t:[])}},io={type:Boolean,default:void 0},Xv={autofocus:io,disabled:io,indentWithTab:io,tabSize:Number,placeholder:String,style:Object,autoDestroy:io,phrases:Object,root:Object,extensions:Array,selection:Object},jv={modelValue:{type:String,default:""}},Jv=Object.assign(Object.assign({},Xv),jv);(function(f){f.Change="change",f.Update="update",f.Focus="focus",f.Blur="blur",f.Ready="ready",f.ModelUpdate="update:modelValue"})(ge||(ge={}));var sn={};sn[ge.Change]=function(f,t){return!0},sn[ge.Update]=function(f){return!0},sn[ge.Focus]=function(f){return!0},sn[ge.Blur]=function(f){return!0},sn[ge.Ready]=function(f){return!0};var Id={};Id[ge.ModelUpdate]=sn[ge.Change];var Zv=Object.assign(Object.assign({},sn),Id),Qv=cc({name:"VueCodemirror",props:Object.assign({},Jv),emits:Object.assign({},Zv),setup:function(f,t){var i=Hl(),r=Hl(),s=Hl(),h=Object.assign(Object.assign({},_v),$g(qv,{})),u=t0(function(){var d={};return Object.keys(r0(f)).forEach(function(p){var v;p!=="modelValue"&&(d[p]=(v=f[p])!==null&&v!==void 0?v:h[p])}),d});return e0(function(){var d;r.value=Yv({doc:f.modelValue,selection:u.value.selection,extensions:(d=h.extensions)!==null&&d!==void 0?d:[],onFocus:function(v){return t.emit(ge.Focus,v)},onBlur:function(v){return t.emit(ge.Blur,v)},onUpdate:function(v){return t.emit(ge.Update,v)},onChange:function(v,y){v!==f.modelValue&&(t.emit(ge.Change,v,y),t.emit(ge.ModelUpdate,v,y))}}),s.value=function(v){return new at(Object.assign({},v))}({state:r.value,parent:i.value,root:u.value.root});var p=function(v){var y=function(){return v.state.doc.toString()},w=Fn(v).run,S=uc(v,[at.editable.of(!1),ut.readOnly.of(!0)]),A=uc(v,Od.of([Gv])),M=Fn(v).run,D=Fn(v).run,N=Fn(v).run,P=Fn(v).run;return{focus:function(){return v.focus()},getDoc:y,setDoc:function(H){H!==y()&&v.dispatch({changes:{from:0,to:v.state.doc.length,insert:H}})},reExtensions:w,toggleDisabled:S,toggleIndentWithTab:A,setTabSize:function(H){M([ut.tabSize.of(H),Ao.of(" ".repeat(H))])},setPhrases:function(H){D([ut.phrases.of(H)])},setPlaceholder:function(H){N(yv(H))},setStyle:function(H){H===void 0&&(H={}),P(at.theme({"&":Object.assign({},H)}))}}}(s.value);Di(function(){return f.modelValue},function(v){v!==p.getDoc()&&p.setDoc(v)}),Di(function(){return f.extensions},function(v){return p.reExtensions(v||[])},{immediate:!0}),Di(function(){return u.value.disabled},function(v){return p.toggleDisabled(v)},{immediate:!0}),Di(function(){return u.value.indentWithTab},function(v){return p.toggleIndentWithTab(v)},{immediate:!0}),Di(function(){return u.value.tabSize},function(v){return p.setTabSize(v)},{immediate:!0}),Di(function(){return u.value.phrases},function(v){return p.setPhrases(v||{})},{immediate:!0}),Di(function(){return u.value.placeholder},function(v){return p.setPlaceholder(v)},{immediate:!0}),Di(function(){return u.value.style},function(v){return p.setStyle(v)},{immediate:!0}),u.value.autofocus&&p.focus(),t.emit(ge.Ready,{state:r.value,view:s.value,container:i.value})}),i0(function(){u.value.autoDestroy&&s.value&&function(d){d.destroy()}(s.value)}),function(){return n0("div",{class:"v-codemirror",style:{display:"contents"},ref:i})}}}),$v=Qv;const ty={class:"flex flex-col mt-3 flex-1"},ey={class:"p-4 rounded-2xl bg-white"},iy={class:"mt-4"},ny={class:"flex flex-wrap"},ry={class:"flex items-center mt-4"},sy={class:"mr-2"},oy={class:"mr-2"},ly={class:"mt-3 min-h-md bg-gray-100 p-3 mb-3"},dy=cc({__name:"RegTest",setup(f){const t=s0({title:"正则表达式测试",reg:"",content:`一些测试实例:
邮箱1：demo@163.com
邮箱2：demo2@163.com
手机号：13012341234
url: http://tools.ranblogs.com、https://ranblogs.com
IP: 192.168.0.1
时间：2023-11-24
`,matchRes:"",matchNum:0,isAll:!0,isCase:!1,isParseErr:!1,parseErr:"",regList:[{id:1,title:"匹配手机号",reg:"(13\\d|14[579]|15[^4\\D]|17[^49\\D]|18\\d)\\d{8}"},{id:1,title:"匹配网址URL",reg:"(http|ftp|https):\\/\\/[\\w\\-_]+(\\.[\\w\\-_]+)+([\\w\\-\\.,@?^=%&:/~\\+#]*[\\w\\-\\@?^=%&/~\\+#])?"},{id:1,title:"匹配Email",reg:"\\w[-\\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\\.)+[A-Za-z]{2,14}"},{id:1,title:"匹配中文字符",reg:"[一-龥]"},{id:1,title:"匹配双字节字符(包含汉字)",reg:"[^\0-ÿ]+"},{id:1,title:"匹配18位身份证号",reg:"\\d{17}[0-9Xx]|\\d{15}"},{id:1,title:"匹配整数",reg:"[1-9]\\d*"},{id:1,title:"匹配IP(IPV4)",reg:"\\d{0,3}\\.\\d{0,3}\\.\\d{0,3}\\.\\d{0,3}"},{id:1,title:"匹配日期(年-月-日)",reg:"(([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3})-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8]))))|((([0-9]{2})(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00))-02-29)"}]}),i=h=>{t.reg=h},r=()=>{t.matchNum=0,t.matchRes=""},s=()=>{if(r(),t.reg=="")return;let h="";h=t.isAll===!0?"g":"",h+=t.isCase===!0?"i":"";let u=new RegExp(t.reg,h),d=t.content.match(u);if(t.isAll===!0){if(d!=null&&d.length){t.matchNum=d==null?void 0:d.length;for(let p in d)t.matchRes+=d[p]+`
`}}else d!=null&&d[0]&&(t.matchRes=d[0],t.matchNum=1)};return(h,u)=>{const d=Fs("el-text"),p=Fs("el-button"),v=Fs("el-input"),y=Fs("el-checkbox");return Fl(),zl("div",ty,[Ne(Jg,{title:t.title},null,8,["title"]),Ni("div",ey,[Ni("div",null,[Ne(o0($v),{modelValue:t.content,"onUpdate:modelValue":u[0]||(u[0]=w=>t.content=w),placeholder:"",style:{height:"300px"},autofocus:!0,"indent-with-tab":!0,tabSize:2},null,8,["modelValue"])]),Ni("div",iy,[Ne(d,{class:"font-bold"},{default:Wn(()=>u[5]||(u[5]=[Er("常用正则：",-1)])),_:1,__:[5]}),Ni("ul",ny,[(Fl(!0),zl(l0,null,a0(t.regList,(w,S)=>(Fl(),zl("li",{key:S},[Ne(p,{link:"",type:"primary",onClick:A=>i(w.reg),class:"mr-2 mt-2"},{default:Wn(()=>[Er(hu(w.title),1)]),_:2},1032,["onClick"])]))),128))]),Ni("div",ry,[Ne(v,{modelValue:t.reg,"onUpdate:modelValue":u[1]||(u[1]=w=>t.reg=w),class:"mr-2",placeholder:"正则表达式"},null,8,["modelValue"]),Ni("div",sy,[Ne(y,{modelValue:t.isAll,"onUpdate:modelValue":u[2]||(u[2]=w=>t.isAll=w),label:"全局搜索",size:"large"},null,8,["modelValue"])]),Ni("div",oy,[Ne(y,{modelValue:t.isCase,"onUpdate:modelValue":u[3]||(u[3]=w=>t.isCase=w),label:"忽略大小写",size:"large"},null,8,["modelValue"])]),Ne(p,{type:"primary",onClick:s},{default:Wn(()=>u[6]||(u[6]=[Er("测试匹配",-1)])),_:1,__:[6]})])]),Ni("div",ly,[Ne(d,null,{default:Wn(()=>[Er("共找到 "+hu(t.matchNum)+" 处匹配结果",1)]),_:1}),Ne(v,{type:"textarea",rows:4,readonly:"",modelValue:t.matchRes,"onUpdate:modelValue":u[4]||(u[4]=w=>t.matchRes=w)},null,8,["modelValue"])])]),Ne(Zg,{title:"描述"},{default:Wn(()=>[Ne(d,null,{default:Wn(()=>u[7]||(u[7]=[Er(" 正则表达式是对字符串（包括普通字符（例如，a 到 z 之间的字母）和特殊字符（称为“元字符”））操作的一种逻辑公式，就是用事先定义好的一些特定字符、及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。正则表达式是一种文本模式，该模式描述在搜索文本时要匹配的一个或多个字符串 ",-1)])),_:1,__:[7]})]),_:1})])}}});export{dy as default};
