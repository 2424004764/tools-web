import{d as w,A as l,B as I,o as h,E as i,r as u,b as c,c as r,f as t,i as d,h as g,k as S,ac as C,C as m,j as E,_ as N}from"./index-e54ac48d.js";const k={class:"flex flex-col mt-8 flex-1 items-center bg-white rounded-md p-10"},B={class:"w-96"},L={class:"space-y-6"},O={key:0,class:"text-center"},z={key:1,class:"text-center"},G=w({__name:"Login",setup(j){const a=l(!1),_=l(!1),n=l(null),p="825228691844-jflrvsfqa82gs1s225qbcaa4raujmp1f.apps.googleusercontent.com",f=I(()=>!!n.value);h(()=>{const o=localStorage.getItem("user");if(o)try{n.value=JSON.parse(o)}catch{localStorage.removeItem("user")}const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{_.value=!0,v()},document.head.appendChild(e)});const v=()=>{if(typeof window.google<"u"){window.google.accounts.id.initialize({client_id:p,callback:y,auto_select:!1,cancel_on_tap_outside:!0});const o=document.getElementById("google-signin-button");o&&window.google.accounts.id.renderButton(o,{theme:"outline",size:"large",type:"standard",text:"signin_with",shape:"rectangular",logo_alignment:"left",width:400})}},y=async o=>{if(o.credential){a.value=!0;try{const e=JSON.parse(atob(o.credential.split(".")[1]));i.success(`欢迎回来，${e.name}！`);const s={id:e.sub,name:e.name,email:e.email,picture:e.picture,loginType:"google"};n.value=s,localStorage.setItem("user",JSON.stringify(s))}catch(e){i.error("谷歌登录失败，请重试"),console.error("Google sign-in error:",e)}finally{a.value=!1}}},x=()=>{typeof window.google<"u"&&window.google.accounts.id.disableAutoSelect(),n.value=null,localStorage.removeItem("user"),i.success("已退出登录")};return(o,e)=>{const s=u("el-icon"),b=u("el-button");return c(),r("div",k,[t("div",B,[e[4]||(e[4]=t("div",{class:"text-center mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-800 mb-2"},"用户登录"),t("p",{class:"text-gray-600"},"欢迎使用Tools-Web工具箱")],-1)),t("div",L,[e[2]||(e[2]=t("div",{class:"flex justify-center"},[t("div",{id:"google-signin-button"})],-1)),a.value?(c(),r("div",O,[d(s,{class:"is-loading"},{default:g(()=>[d(S(C))]),_:1}),e[0]||(e[0]=t("span",{class:"ml-2 text-gray-600"},"登录中...",-1))])):m("",!0),e[3]||(e[3]=t("div",{class:"text-center text-gray-500 text-sm"},[t("p",null,"目前仅支持谷歌账号登录"),t("p",{class:"mt-2"},"登录后可以享受更多个性化功能")],-1)),f.value?(c(),r("div",z,[d(b,{type:"danger",size:"small",onClick:x},{default:g(()=>e[1]||(e[1]=[E(" 退出登录 ",-1)])),_:1,__:[1]})])):m("",!0)])])])}}});const V=N(G,[["__scopeId","data-v-85c59ee6"]]);export{V as default};
