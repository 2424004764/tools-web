import{d as R,z as L,r as x,o as A,f as c,g as w,h,m as t,j as l,l as a,K,p as n,t as j,v as C,F as W,i as H,as as Q,y as _,_ as X}from"./index-8a98efeb.js";import{_ as Y}from"./DetailHeader.vue_vue_type_script_setup_true_lang-4994fbff.js";import{_ as T}from"./ToolDetail.vue_vue_type_script_setup_true_lang-4e117a8f.js";const Z={class:"flex flex-col mt-3 flex-1"},ee={class:"p-4 rounded-2xl bg-white space-y-4"},le={class:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg"},te={class:"flex flex-col items-center space-y-4"},oe={key:0,class:"text-center py-8"},se={class:"mt-2 text-gray-600"},ae={key:1,class:"p-3 bg-blue-50 rounded-lg"},ne={class:"text-sm text-blue-800"},re={key:2,class:"space-y-4"},ue={class:"flex justify-between items-center"},ie={class:"text-lg font-semibold"},de={class:"space-x-2"},ce={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},ge={class:"aspect-[3/4] bg-gray-100"},me=["src","alt"],pe={class:"p-3 bg-white"},_e={class:"text-sm text-gray-600 mb-2"},fe=R({__name:"PdfToImage",setup(ve){let I=null;const z=L({title:"PDF转图片"}),f=x(!1),$=x(!1),g=x([]),v=x(""),m=x(""),y=x(0),i=L({dpi:300,format:"png",quality:1}),B=async()=>{try{console.log("开始加载PDF.js...");const o=await Q(()=>import("./pdf-49561840.js"),["assets/pdf-49561840.js","assets/index-8a98efeb.js","assets/index-19e4e00d.css"]);o.GlobalWorkerOptions.workerSrc="/js/pdf.min.mjs",I=o,console.log("PDF.js 加载成功, version:",o.version)}catch(o){console.error("PDF.js 加载失败:",o),_.error("PDF.js 库加载失败，请刷新页面重试")}};A(()=>{B()});const G=o=>{if(!o||o.length===0)return;const e=o[0];if(e.type!=="application/pdf"){_.error("请选择PDF文件");return}console.log("选择的PDF文件:",e.name,"大小:",e.size),v.value=e.name,E(e)},E=async o=>{if(!I){_.error("PDF.js 库未加载完成，请稍后重试");return}f.value=!0,g.value=[],m.value="正在读取PDF文件...",y.value=0;try{console.log("开始转换PDF...",o.name,o.size);const e=await o.arrayBuffer();console.log("PDF文件读取完成, 大小:",e.byteLength),m.value="正在解析PDF结构...",console.log("开始解析PDF...");const s=await I.getDocument({data:e}).promise,u=s.numPages;console.log("PDF解析完成, 总页数:",u),_.success(`PDF加载成功，共${u}页，开始转换...`);for(let r=1;r<=u;r++){m.value=`正在转换第 ${r}/${u} 页...`,y.value=Math.round((r-1)/u*100),console.log(`开始转换第${r}页`);const D=await s.getPage(r);console.log(`第${r}页获取成功`);const P=i.dpi/72,p=D.getViewport({scale:P});console.log(`第${r}页视窗尺寸:`,p.width,"x",p.height);const b=document.createElement("canvas"),k=b.getContext("2d");b.height=p.height,b.width=p.width,console.log(`开始渲染第${r}页到canvas`),await D.render({canvasContext:k,viewport:p}).promise,console.log(`第${r}页渲染完成`);const F=b.toDataURL(`image/${i.format}`,i.quality);g.value.push(F),console.log(`第${r}页转换为图片完成`),y.value=Math.round(r/u*100),await new Promise(d=>setTimeout(d,10))}m.value="转换完成！",console.log("所有页面转换完成"),_.success(`转换完成！共生成${u}张图片`)}catch(e){console.error("PDF转换失败:",e),m.value="转换失败";const s=e instanceof Error?e.message:"未知错误";_.error(`PDF转换失败: ${s}`)}finally{f.value=!1,y.value=0,m.value=""}},N=(o,e)=>{const s=document.createElement("a");s.href=o,s.download=`${v.value.replace(".pdf","")}_第${e+1}页.${i.format}`,s.click()},M=()=>{g.value.forEach((o,e)=>{setTimeout(()=>{N(o,e)},e*100)})},q=o=>{var s;o.preventDefault(),$.value=!1;const e=(s=o.dataTransfer)==null?void 0:s.files;e&&G(e)},S=o=>{o.preventDefault(),$.value=!0},U=()=>{$.value=!1},J=()=>{g.value=[],v.value=""},O=o=>{if(!(o!=null&&o.raw))return;const e=o.raw;if(e.type!=="application/pdf"){_.error("请选择PDF文件");return}console.log("选择的PDF文件:",e.name,"大小:",e.size),v.value=e.name,E(e)};return(o,e)=>{const s=c("el-option"),u=c("el-select"),r=c("Document"),D=c("el-icon"),P=c("el-button"),p=c("el-upload"),b=c("el-progress"),k=c("Download"),F=c("el-text");return w(),h("div",Z,[t(Y,{title:z.title},null,8,["title"]),l("div",ee,[l("div",le,[l("div",null,[e[3]||(e[3]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"分辨率 (DPI)",-1)),t(u,{modelValue:i.dpi,"onUpdate:modelValue":e[0]||(e[0]=d=>i.dpi=d),class:"w-full"},{default:a(()=>[t(s,{label:"150 DPI (标准)",value:150}),t(s,{label:"300 DPI (高清)",value:300}),t(s,{label:"600 DPI (超高清)",value:600})]),_:1},8,["modelValue"])]),l("div",null,[e[4]||(e[4]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"输出格式",-1)),t(u,{modelValue:i.format,"onUpdate:modelValue":e[1]||(e[1]=d=>i.format=d),class:"w-full"},{default:a(()=>[t(s,{label:"PNG (推荐)",value:"png"}),t(s,{label:"JPG",value:"jpeg"})]),_:1},8,["modelValue"])]),l("div",null,[e[5]||(e[5]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"图片质量",-1)),t(u,{modelValue:i.quality,"onUpdate:modelValue":e[2]||(e[2]=d=>i.quality=d),class:"w-full"},{default:a(()=>[t(s,{label:"高质量",value:1}),t(s,{label:"中等质量",value:.8}),t(s,{label:"压缩质量",value:.6})]),_:1},8,["modelValue"])])]),l("div",{class:K(["border-2 border-dashed border-gray-300 rounded-lg p-8 text-center transition-colors",{"border-blue-500 bg-blue-50":$.value}]),onDrop:q,onDragover:S,onDragleave:U},[l("div",te,[t(D,{class:"text-6xl text-gray-400"},{default:a(()=>[t(r)]),_:1}),e[7]||(e[7]=l("div",null,[l("p",{class:"text-lg text-gray-600 mb-2"},"拖拽PDF文件到此处，或点击选择文件"),l("p",{class:"text-sm text-gray-400"},"支持单个PDF文件，自动转换所有页面")],-1)),t(p,{class:"upload-demo","before-upload":()=>!1,"on-change":O,"show-file-list":!1,accept:".pdf",disabled:f.value},{default:a(()=>[t(P,{type:"primary",loading:f.value},{default:a(()=>e[6]||(e[6]=[n("选择PDF文件",-1)])),_:1,__:[6]},8,["loading"])]),_:1},8,["disabled"])])],34),f.value?(w(),h("div",oe,[t(b,{percentage:y.value,indeterminate:y.value===0,"stroke-width":8,class:"mb-4"},null,8,["percentage","indeterminate"]),l("p",se,j(m.value),1),e[8]||(e[8]=l("p",{class:"text-sm text-gray-400 mt-1"},"首次转换可能需要较长时间加载...",-1))])):C("",!0),v.value&&!f.value?(w(),h("div",ae,[l("p",ne,"当前文件: "+j(v.value),1)])):C("",!0),g.value.length>0?(w(),h("div",re,[l("div",ue,[l("h3",ie,"转换结果 ("+j(g.value.length)+"张图片)",1),l("div",de,[t(P,{onClick:M,type:"primary"},{default:a(()=>[t(D,null,{default:a(()=>[t(k)]),_:1}),e[9]||(e[9]=n(" 下载全部 ",-1))]),_:1,__:[9]}),t(P,{onClick:J},{default:a(()=>e[10]||(e[10]=[n("清除结果",-1)])),_:1,__:[10]})])]),l("div",ce,[(w(!0),h(W,null,H(g.value,(d,V)=>(w(),h("div",{key:V,class:"border rounded-lg overflow-hidden hover:shadow-lg transition-shadow"},[l("div",ge,[l("img",{src:d,alt:`第${V+1}页`,class:"w-full h-full object-contain"},null,8,me)]),l("div",pe,[l("p",_e,"第 "+j(V+1)+" 页",1),t(P,{onClick:ye=>N(d,V),size:"small",type:"primary",class:"w-full"},{default:a(()=>[t(D,null,{default:a(()=>[t(k)]),_:1}),e[11]||(e[11]=n(" 下载此页 ",-1))]),_:2,__:[11]},1032,["onClick"])])]))),128))])])):C("",!0)]),t(T,{title:"功能说明"},{default:a(()=>[t(F,null,{default:a(()=>e[12]||(e[12]=[l("ul",{class:"space-y-2 text-gray-700"},[l("li",null,[n("• "),l("strong",null,"高清转换"),n("：支持150-600 DPI分辨率，确保图片清晰度")]),l("li",null,[n("• "),l("strong",null,"多页处理"),n("：自动转换PDF中的所有页面")]),l("li",null,[n("• "),l("strong",null,"格式选择"),n("：支持PNG和JPG格式输出")]),l("li",null,[n("• "),l("strong",null,"质量控制"),n("：可调节图片质量，平衡文件大小和清晰度")]),l("li",null,[n("• "),l("strong",null,"批量下载"),n("：支持单页下载和批量下载")]),l("li",null,[n("• "),l("strong",null,"本地处理"),n("：所有转换在浏览器本地完成，保护文件隐私")])],-1)])),_:1,__:[12]})]),_:1}),t(T,{title:"使用说明"},{default:a(()=>[t(F,null,{default:a(()=>e[13]||(e[13]=[l("ol",{class:"space-y-2 text-gray-700"},[l("li",null,"1. 选择转换设置（分辨率、格式、质量）"),l("li",null,"2. 拖拽或点击上传PDF文件"),l("li",null,"3. 等待自动转换完成"),l("li",null,"4. 预览转换结果"),l("li",null,"5. 下载单页图片或批量下载所有图片")],-1)])),_:1,__:[13]})]),_:1}),t(T,{title:"注意事项"},{default:a(()=>[t(F,null,{default:a(()=>e[14]||(e[14]=[l("ul",{class:"space-y-1 text-gray-600 text-sm"},[l("li",null,"• 首次使用需要加载PDF.js库，可能需要等待几秒"),l("li",null,"• 大文件或高分辨率转换需要较长时间，请耐心等待"),l("li",null,"• 暂不支持密码保护的PDF文件"),l("li",null,"• 建议使用现代浏览器以获得最佳体验")],-1)])),_:1,__:[14]})]),_:1})])}}});const xe=X(fe,[["__scopeId","data-v-d3932e48"]]);export{xe as default};
