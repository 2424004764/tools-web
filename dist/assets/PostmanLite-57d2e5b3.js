import{d as me,v as ce,H as _,I as fe,P as ye,r as C,b as i,c,i as t,f as S,h as n,j as v,t as B,p as E,F as M,e as W,C as _e,D as ke,g as Q,k as be,B as le,_ as xe}from"./index-35951af1.js";import{_ as Ve}from"./DetailHeader.vue_vue_type_script_setup_true_lang-af3ff089.js";import{_ as te}from"./ToolDetail.vue_vue_type_script_setup_true_lang-9f1fa948.js";const we={class:"flex flex-col mt-3 flex-1"},ge={class:"p-4 rounded-2xl bg-white space-y-4"},he={class:"flex items-center gap-2"},Ce={key:0,class:"text-xs text-gray-500"},Ue={class:"space-y-2"},Te={class:"space-y-2"},Se={class:"space-y-3"},Ee={key:0},Le={key:1,class:"space-y-2"},Oe={key:2,class:"space-y-2"},Re={class:"flex items-center gap-2"},$e=["onChange"],He={key:0,class:"text-xs text-gray-500"},Pe={class:"space-y-2"},je={class:"text-sm"},Ne={key:0},Be={key:1},De={key:0},Fe=["src"],Je={key:1},Ge={class:"mb-2 flex items-center gap-2"},Ie=me({__name:"PostmanLite",setup(Ae){const ae=ce({title:"在线请求调试"}),g=_("GET"),U=_(""),$=_([{key:"",value:"",enabled:!0}]),y=_([{key:"",value:"",enabled:!0}]),p=_("none"),k=_([{key:"",type:"text",value:"",enabled:!0}]),L=_(""),X=_(!1),D=_(""),F=_(null),J=_(null),q=_([]),V=_(""),K=_(""),O=_(null),H=_(!1),G=_("");function Z(o){o.value.push({key:"",value:"",enabled:!0})}function I(o,e){o.value.splice(e,1)}const P=fe(()=>{if(!U.value)return"";try{const o=new URL(U.value),e=new URLSearchParams(o.search);return $.value.filter(a=>a.enabled&&a.key).forEach(a=>e.set(a.key,a.value)),o.search=e.toString(),o.toString()}catch{return U.value}});function oe(){const o={};return y.value.filter(e=>e.enabled&&e.key).forEach(e=>o[e.key]=e.value),o}function Y(o,e){y.value.some(m=>m.enabled&&m.key.toLowerCase()===o.toLowerCase())||y.value.push({key:o,value:e,enabled:!0})}function ne(){if(!(g.value==="GET"||g.value==="HEAD")&&p.value!=="none"){if(p.value==="json")return Y("Content-Type","application/json"),L.value||"";if(p.value==="form"){Y("Content-Type","application/x-www-form-urlencoded");const o=new URLSearchParams;return k.value.filter(e=>e.enabled&&e.key&&e.type!=="file").forEach(e=>o.append(e.key,e.value||"")),o.toString()}if(p.value==="form-data"){se("Content-Type");const o=new FormData;return k.value.filter(e=>e.enabled&&e.key).forEach(e=>{e.type==="file"?(e.files||[]).forEach(a=>o.append(e.key,a,a.name)):o.append(e.key,e.value??"")}),o}if(p.value==="raw")return L.value}}async function ue(){if(!U.value)return;X.value=!0,D.value="",F.value=null,J.value=null,q.value=[],V.value="",O.value&&(URL.revokeObjectURL(O.value),O.value=null),K.value="";const o=performance.now();try{const e={method:g.value,headers:oe()},a=ne();a!==void 0&&(e.body=a);const m=P.value||U.value,d=await fetch(m,e),s=performance.now();F.value=Math.round(s-o),D.value=`${d.status} ${d.statusText}`,d.headers.forEach((f,j)=>q.value.push({key:j,value:f,enabled:!0}));const h=await d.arrayBuffer();J.value=h.byteLength;const b=d.headers.get("content-type")||"";if(K.value=b,b.startsWith("image/")){const f=new Blob([h],{type:b});O.value=URL.createObjectURL(f),V.value=""}else{let f="";try{f=new TextDecoder("utf-8").decode(h)}catch{f="[二进制内容]"}if(b.includes("application/json"))try{V.value=JSON.stringify(JSON.parse(f),null,2)}catch{V.value=f}else V.value=f}}catch(e){D.value="请求失败",V.value=String((e==null?void 0:e.message)||e)}finally{X.value=!1}}ye(()=>{O.value&&URL.revokeObjectURL(O.value)});function se(o){y.value=y.value.filter(e=>!(e.enabled&&e.key&&e.key.toLowerCase()===o.toLowerCase()))}function de(o,e){const a=e.target,m=Array.from(a.files||[]);k.value[o].files=m}function ee(){k.value.push({key:"",type:"text",value:"",enabled:!0})}function T(o){return`'${String(o).replace(/'/g,"'\\''")}'`}function re(){const o=P.value||U.value;if(!o)return;const e=["curl",T(o)];if(g.value&&g.value!=="GET"&&e.push("-X",g.value),y.value.filter(a=>a.enabled&&a.key).forEach(a=>{e.push("-H",T(`${a.key}: ${a.value||""}`))}),g.value!=="GET"&&p.value!=="none")if(p.value==="json")y.value.some(m=>{var d;return m.enabled&&((d=m.key)==null?void 0:d.toLowerCase())==="content-type"})||e.push("-H",T("Content-Type: application/json")),e.push("--data-raw",T(L.value));else if(p.value==="form"){const a=new URLSearchParams;k.value.filter(s=>s.enabled&&s.key&&s.type!=="file").forEach(s=>a.append(s.key,s.value||""));const m=a.toString();y.value.some(s=>{var h;return s.enabled&&((h=s.key)==null?void 0:h.toLowerCase())==="content-type"})||e.push("-H",T("Content-Type: application/x-www-form-urlencoded")),e.push("--data-raw",T(m))}else p.value==="form-data"?k.value.filter(a=>a.enabled&&a.key).forEach(a=>{if(a.type==="file"){const m=(a.files||[]).map(d=>d.name);m.length===0?e.push("-F",T(`${a.key}=@<选择文件路径>`)):m.forEach(d=>e.push("-F",T(`${a.key}=@./${d}`)))}else e.push("-F",T(`${a.key}=${a.value??""}`))}):p.value==="raw"&&e.push("--data-raw",T(L.value));le(e.join(" "))}function ie(){ve(G.value||""),H.value=!1,G.value=""}function ve(o){var A,z;if(!o.trim())return;g.value="GET",$.value=[{key:"",value:"",enabled:!0}],y.value=[{key:"",value:"",enabled:!0}],p.value="none",k.value=[{key:"",type:"text",value:"",enabled:!0}],L.value="",U.value="";const e=o.replace(/\\\r?\n/g," ").replace(/\s+/g," ").trim(),a=e.match(/-X\s+([A-Z]+)/);a&&(g.value=a[1]);const m=e.match(/--url\s+(['"])(.*?)\1/);if(m)U.value=m[2];else{const x=e.match(/https?:\/\/[^\s'"]+/);x&&(U.value=x[0])}const d=/(?:-H|--header)\s+(['"])(.*?)\1/g;let s;for(y.value=[];s=d.exec(e);){const x=s[2],l=x.indexOf(":");if(l>-1){const r=x.slice(0,l).trim(),u=x.slice(l+1).trim();y.value.push({key:r,value:u,enabled:!0})}}y.value.length===0&&(y.value=[{key:"",value:"",enabled:!0}]);const h=/(?:-F|--form)\s+(['"])(.*?)\1/g,b=[];let f;for(;f=h.exec(e);){const x=f[2],l=x.indexOf("=");if(l>-1){const r=x.slice(0,l),u=x.slice(l+1);u.startsWith("@")?b.push({key:r,type:"file",files:[],enabled:!0}):b.push({key:r,type:"text",value:u,enabled:!0})}}if(b.length>0){p.value="form-data",k.value=b;return}const j=/(?:--data(?:-raw|-binary)?|-d)\s+(['"])([\s\S]*?)\1/g,R=[];let N;for(;N=j.exec(e);)R.push(N[2]);if(R.length>0){const x=R[R.length-1];L.value=x;const l=((z=(A=y.value.find(r=>{var u;return r.enabled&&((u=r.key)==null?void 0:u.toLowerCase())==="content-type"}))==null?void 0:A.value)==null?void 0:z.toLowerCase())||"";if(l.includes("application/x-www-form-urlencoded")){p.value="form";const r=new URLSearchParams(x);k.value=[],r.forEach((u,w)=>k.value.push({key:w,type:"text",value:u,enabled:!0})),k.value.length===0&&(k.value=[{key:"",type:"text",value:"",enabled:!0}])}else l.includes("application/json")?p.value="json":p.value="raw";!a&&g.value==="GET"&&(g.value="POST")}}function pe(){if(V.value)try{const o=JSON.parse(V.value);V.value=JSON.stringify(o,null,2)}catch{}}return(o,e)=>{const a=C("el-option"),m=C("el-select"),d=C("el-input"),s=C("el-button"),h=C("el-checkbox"),b=C("el-tab-pane"),f=C("el-radio"),j=C("el-radio-group"),R=C("el-tabs"),N=C("el-table-column"),A=C("el-table"),z=C("el-text"),x=C("el-dialog");return i(),c("div",we,[t(Ve,{title:ae.title},null,8,["title"]),S("div",ge,[S("div",he,[t(m,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),style:{width:"130px"}},{default:n(()=>[t(a,{label:"GET",value:"GET"}),t(a,{label:"POST",value:"POST"}),t(a,{label:"PUT",value:"PUT"}),t(a,{label:"DELETE",value:"DELETE"}),t(a,{label:"PATCH",value:"PATCH"}),t(a,{label:"HEAD",value:"HEAD"}),t(a,{label:"OPTIONS",value:"OPTIONS"})]),_:1},8,["modelValue"]),t(d,{modelValue:U.value,"onUpdate:modelValue":e[1]||(e[1]=l=>U.value=l),placeholder:"https://api.example.com/path"},null,8,["modelValue"]),t(s,{type:"primary",loading:X.value,onClick:ue},{default:n(()=>e[12]||(e[12]=[v("发送",-1)])),_:1,__:[12]},8,["loading"]),t(s,{text:"",onClick:e[2]||(e[2]=l=>H.value=!0)},{default:n(()=>e[13]||(e[13]=[v("导入 cURL",-1)])),_:1,__:[13]}),t(s,{text:"",onClick:re},{default:n(()=>e[14]||(e[14]=[v("复制 cURL",-1)])),_:1,__:[14]})]),P.value&&P.value!==U.value?(i(),c("div",Ce,"最终请求: "+B(P.value),1)):E("",!0),t(R,{type:"border-card"},{default:n(()=>[t(b,{label:"Params"},{default:n(()=>[S("div",Ue,[(i(!0),c(M,null,W($.value,(l,r)=>(i(),c("div",{key:r,class:"flex items-center gap-2"},[t(h,{modelValue:l.enabled,"onUpdate:modelValue":u=>l.enabled=u},null,8,["modelValue","onUpdate:modelValue"]),t(d,{modelValue:l.key,"onUpdate:modelValue":u=>l.key=u,placeholder:"key",style:{width:"220px"}},null,8,["modelValue","onUpdate:modelValue"]),t(d,{modelValue:l.value,"onUpdate:modelValue":u=>l.value=u,placeholder:"value"},null,8,["modelValue","onUpdate:modelValue"]),t(s,{text:"",type:"danger",onClick:u=>I($.value,r)},{default:n(()=>e[15]||(e[15]=[v("删除",-1)])),_:2,__:[15]},1032,["onClick"])]))),128)),t(s,{text:"",type:"primary",onClick:e[3]||(e[3]=l=>Z($.value))},{default:n(()=>e[16]||(e[16]=[v("添加参数",-1)])),_:1,__:[16]})])]),_:1}),t(b,{label:"Headers"},{default:n(()=>[S("div",Te,[(i(!0),c(M,null,W(y.value,(l,r)=>(i(),c("div",{key:r,class:"flex items-center gap-2"},[t(h,{modelValue:l.enabled,"onUpdate:modelValue":u=>l.enabled=u},null,8,["modelValue","onUpdate:modelValue"]),t(d,{modelValue:l.key,"onUpdate:modelValue":u=>l.key=u,placeholder:"Header",style:{width:"260px"}},null,8,["modelValue","onUpdate:modelValue"]),t(d,{modelValue:l.value,"onUpdate:modelValue":u=>l.value=u,placeholder:"Value"},null,8,["modelValue","onUpdate:modelValue"]),t(s,{text:"",type:"danger",onClick:u=>I(y.value,r)},{default:n(()=>e[17]||(e[17]=[v("删除",-1)])),_:2,__:[17]},1032,["onClick"])]))),128)),t(s,{text:"",type:"primary",onClick:e[4]||(e[4]=l=>Z(y.value))},{default:n(()=>e[18]||(e[18]=[v("添加Header",-1)])),_:1,__:[18]})])]),_:1}),t(b,{label:"Body"},{default:n(()=>[S("div",Se,[t(j,{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=l=>p.value=l)},{default:n(()=>[t(f,{label:"none"},{default:n(()=>e[19]||(e[19]=[v("none",-1)])),_:1,__:[19]}),t(f,{label:"json"},{default:n(()=>e[20]||(e[20]=[v("JSON",-1)])),_:1,__:[20]}),t(f,{label:"form"},{default:n(()=>e[21]||(e[21]=[v("x-www-form-urlencoded",-1)])),_:1,__:[21]}),t(f,{label:"form-data"},{default:n(()=>e[22]||(e[22]=[v("form-data",-1)])),_:1,__:[22]}),t(f,{label:"raw"},{default:n(()=>e[23]||(e[23]=[v("Raw",-1)])),_:1,__:[23]})]),_:1},8,["modelValue"]),p.value==="json"||p.value==="raw"?(i(),c("div",Ee,[t(d,{modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=l=>L.value=l),type:"textarea",rows:8,placeholder:'JSON 或任意文本。JSON示例: {"a":1}'},null,8,["modelValue"])])):E("",!0),p.value==="form"?(i(),c("div",Le,[(i(!0),c(M,null,W(k.value,(l,r)=>_e((i(),c("div",{key:"f-"+r,class:"flex items-center gap-2"},[t(h,{modelValue:l.enabled,"onUpdate:modelValue":u=>l.enabled=u},null,8,["modelValue","onUpdate:modelValue"]),t(d,{modelValue:l.key,"onUpdate:modelValue":u=>l.key=u,placeholder:"key",style:{width:"220px"}},null,8,["modelValue","onUpdate:modelValue"]),t(d,{modelValue:l.value,"onUpdate:modelValue":u=>l.value=u,placeholder:"value"},null,8,["modelValue","onUpdate:modelValue"]),t(s,{text:"",type:"danger",onClick:u=>I(k.value,r)},{default:n(()=>e[24]||(e[24]=[v("删除",-1)])),_:2,__:[24]},1032,["onClick"])])),[[ke,l.type!=="file"]])),128)),t(s,{text:"",type:"primary",onClick:ee},{default:n(()=>e[25]||(e[25]=[v("添加字段",-1)])),_:1,__:[25]})])):E("",!0),p.value==="form-data"?(i(),c("div",Oe,[(i(!0),c(M,null,W(k.value,(l,r)=>{var u;return i(),c("div",{key:"fd-"+r,class:"flex flex-col gap-1"},[S("div",Re,[t(h,{modelValue:l.enabled,"onUpdate:modelValue":w=>l.enabled=w},null,8,["modelValue","onUpdate:modelValue"]),t(d,{modelValue:l.key,"onUpdate:modelValue":w=>l.key=w,placeholder:"key",style:{width:"220px"}},null,8,["modelValue","onUpdate:modelValue"]),t(m,{modelValue:l.type,"onUpdate:modelValue":w=>l.type=w,style:{width:"120px"}},{default:n(()=>[t(a,{label:"文本",value:"text"}),t(a,{label:"文件",value:"file"})]),_:2},1032,["modelValue","onUpdate:modelValue"]),l.type==="text"?(i(),Q(d,{key:0,modelValue:l.value,"onUpdate:modelValue":w=>l.value=w,placeholder:"value"},null,8,["modelValue","onUpdate:modelValue"])):(i(),c("input",{key:1,type:"file",multiple:"",onChange:w=>de(r,w)},null,40,$e)),t(s,{text:"",type:"danger",onClick:w=>I(k.value,r)},{default:n(()=>e[26]||(e[26]=[v("删除",-1)])),_:2,__:[26]},1032,["onClick"])]),l.type==="file"&&((u=l.files)!=null&&u.length)?(i(),c("div",He," 已选: "+B(l.files.map(w=>w.name).join(", ")),1)):E("",!0)])}),128)),t(s,{text:"",type:"primary",onClick:ee},{default:n(()=>e[27]||(e[27]=[v("添加字段",-1)])),_:1,__:[27]})])):E("",!0)])]),_:1})]),_:1})]),t(te,{title:"响应"},{default:n(()=>[S("div",Pe,[S("div",je,[v(" 状态: "+B(D.value)+" ",1),F.value!==null?(i(),c("span",Ne," | 时间: "+B(F.value)+"ms",1)):E("",!0),J.value!==null?(i(),c("span",Be," | 大小: "+B((J.value/1024).toFixed(2))+" KB",1)):E("",!0)]),t(R,null,{default:n(()=>[t(b,{label:"Body"},{default:n(()=>[K.value.startsWith("image/")?(i(),c("div",De,[S("img",{src:O.value||"",alt:"响应图片",style:{"max-width":"100%","max-height":"60vh"}},null,8,Fe)])):(i(),c("div",Je,[S("div",Ge,[V.value?(i(),Q(s,{key:0,size:"small",onClick:pe},{default:n(()=>e[28]||(e[28]=[v("美化 JSON",-1)])),_:1,__:[28]})):E("",!0),V.value?(i(),Q(s,{key:1,size:"small",onClick:e[7]||(e[7]=l=>be(le)(V.value))},{default:n(()=>e[29]||(e[29]=[v("复制响应",-1)])),_:1,__:[29]})):E("",!0)]),t(d,{type:"textarea",rows:12,modelValue:V.value,"onUpdate:modelValue":e[8]||(e[8]=l=>V.value=l)},null,8,["modelValue"])]))]),_:1}),t(b,{label:"Headers"},{default:n(()=>[t(A,{data:q.value,size:"small"},{default:n(()=>[t(N,{prop:"key",label:"Header",width:"260"}),t(N,{prop:"value",label:"Value"})]),_:1},8,["data"])]),_:1})]),_:1})])]),_:1}),t(te,{title:"说明"},{default:n(()=>[t(z,null,{default:n(()=>e[30]||(e[30]=[v(" 仅支持目标接口已开启 CORS 或同源的请求；如需跨域访问，可在服务端增加通用代理后再使用。 ",-1)])),_:1,__:[30]})]),_:1}),t(x,{modelValue:H.value,"onUpdate:modelValue":e[11]||(e[11]=l=>H.value=l),title:"导入 cURL",width:"600px"},{footer:n(()=>[t(s,{onClick:e[10]||(e[10]=l=>H.value=!1)},{default:n(()=>e[31]||(e[31]=[v("取消",-1)])),_:1,__:[31]}),t(s,{type:"primary",onClick:ie},{default:n(()=>e[32]||(e[32]=[v("导入",-1)])),_:1,__:[32]})]),default:n(()=>[t(d,{modelValue:G.value,"onUpdate:modelValue":e[9]||(e[9]=l=>G.value=l),type:"textarea",rows:10,placeholder:"粘贴 curl 命令，例如：curl 'https://api.example.com' -X POST -H 'Content-Type: application/json'"},null,8,["modelValue"])]),_:1},8,["modelValue"])])}}});const Xe=xe(Ie,[["__scopeId","data-v-e5ad95c9"]]);export{Xe as default};
