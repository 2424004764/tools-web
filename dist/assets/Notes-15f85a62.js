var ae=Object.defineProperty;var se=(C,t,o)=>t in C?ae(C,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):C[t]=o;var q=(C,t,o)=>(se(C,typeof t!="symbol"?t+"":t,o),o);import{ac as le,ad as oe,y as p,ae as ne,d as ie,z as H,r as x,J as re,o as ue,f as z,af as de,g as k,h as b,m as s,j as a,l as u,q as m,ag as B,t as h,ah as ce,p as y,a3 as J,G as pe,v as P,F as ve,i as _e,K as me,ai as fe,X as D,aj as E,a4 as ge,E as he,_ as ye}from"./index-3b1783ed.js";import{_ as we}from"./DetailHeader.vue_vue_type_script_setup_true_lang-ef7f246f.js";import{_ as xe}from"./ToolDetail.vue_vue_type_script_setup_true_lang-3f06b788.js";class ze{constructor(){q(this,"instance");q(this,"proxyUrl");this.proxyUrl="https://tool.fologde.com",this.instance=le.create({baseURL:this.proxyUrl,timeout:3e4}),this.instance.interceptors.request.use(t=>{const o=oe();return o&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${o}`),t},t=>Promise.reject(t)),this.instance.interceptors.response.use(t=>t,t=>{if(t.response){const o=t.response.status;o===401?(p.error("登录已过期，即将跳转到登录页"),setTimeout(()=>{window.location.href="/login"},1e3)):ne(o)}else t.request&&p.error("网络连接失败");return Promise.reject(t)})}get(t,o){return this.instance.get(t,o)}post(t,o,r){return this.instance.post(t,o,r)}put(t,o,r){return this.instance.put(t,o,r)}delete(t,o){return this.instance.delete(t,o)}getProxyUrl(){return this.proxyUrl}}const $=new ze,Ce={class:"flex flex-col mt-3 flex-1"},ke={class:"notes-container"},be={class:"header-section"},Ne={class:"header-left"},Ve={class:"icon-wrapper"},$e={class:"header-subtitle"},Se={class:"header-actions"},Ue={class:"notes-grid"},Te={key:0,class:"empty-state"},qe=["onClick"],Be={class:"note-header"},Pe={class:"note-title"},De={class:"note-actions"},Ee={class:"note-content"},je={class:"note-text"},Fe={class:"note-footer"},Le={class:"note-time"},Me={class:"time-value"},Re={key:0,class:"pagination-wrapper"},Ie={class:"form-container"},Ae={class:"dialog-footer"},Ge={key:0,class:"detail-container"},He={class:"detail-header"},Je={class:"detail-title"},Ke={class:"detail-meta"},Xe={class:"meta-item"},Oe={class:"meta-item"},Qe={class:"detail-content"},We={class:"content-wrapper"},Ye={class:"content-text"},Ze={class:"dialog-footer"},et=ie({__name:"Notes",setup(C){const t=H({title:"笔记备忘录"}),o=x([]),r=x(null),f=x(!1),g=x(!1),V=x(null),i=x({total:0,page:1,pageSize:12,totalPages:0,hasNext:!1,hasPrev:!1}),d=H({title:"",content:""}),N=x(!1),v=x(!1),w=async(n=1,e=12)=>{try{N.value=!0;const _=await $.get("/api/notes",{params:{page:n,pageSize:e}});if(_.status===200){const c=_.data;o.value=c.data||[],c.pagination&&(i.value=c.pagination)}}catch(_){console.error("获取笔记列表失败:",_),p.error("获取笔记列表失败")}finally{N.value=!1}},K=n=>{w(n,i.value.pageSize)},X=n=>{i.value.pageSize=n,w(1,n)},O=async()=>{if(!d.title.trim()||!d.content.trim()){p.warning("标题和内容不能为空");return}try{v.value=!0,(await $.post("/api/notes",{title:d.title.trim(),content:d.content.trim()})).status===201?(p.success("创建成功"),g.value=!1,S(),await w(i.value.page,i.value.pageSize)):p.error("创建失败")}catch(n){console.error("创建笔记失败:",n),p.error("创建失败")}finally{v.value=!1}},Q=async()=>{if(!V.value||!d.title.trim()||!d.content.trim()){p.warning("标题和内容不能为空");return}try{v.value=!0,(await $.put(`/api/notes/${V.value}`,{title:d.title.trim(),content:d.content.trim()})).status===200?(p.success("更新成功"),g.value=!1,f.value=!1,V.value=null,S(),await w(i.value.page,i.value.pageSize)):p.error("更新失败")}catch(n){console.error("更新笔记失败:",n),p.error("更新失败")}finally{v.value=!1}},W=async n=>{var e;await he.confirm("确定要删除这条笔记吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});try{v.value=!0,(await $.delete(`/api/notes/${n.id}`)).status===200?(p.success("删除成功"),((e=r.value)==null?void 0:e.id)===n.id&&(r.value=null),o.value.length===1&&i.value.page>1?await w(i.value.page-1,i.value.pageSize):await w(i.value.page,i.value.pageSize)):p.error("删除失败")}catch(_){console.error("删除笔记失败:",_),p.error("删除失败")}finally{v.value=!1}},j=n=>{f.value=!0,V.value=n.id,d.title=n.title,d.content=n.content,g.value=!0},F=n=>{f.value||(r.value=n,g.value=!1)},L=()=>{r.value=null,f.value=!1,S(),g.value=!0},S=()=>{d.title="",d.content=""},U=n=>new Date(n).toLocaleString("zh-CN"),M=re(()=>r.value!==null&&!g.value&&!f.value);return ue(()=>{w()}),(n,e)=>{const _=z("el-icon"),c=z("el-button"),Y=z("el-pagination"),R=z("el-input"),I=z("el-form-item"),Z=z("el-form"),A=z("el-dialog"),ee=z("el-text"),te=de("loading");return k(),b("div",Ce,[s(we,{title:t.title},null,8,["title"]),a("div",ke,[a("div",be,[a("div",Ne,[a("div",Ve,[s(_,{class:"header-icon"},{default:u(()=>[s(m(B))]),_:1})]),a("div",null,[e[13]||(e[13]=a("h3",{class:"header-title"},"我的笔记",-1)),a("p",$e,"共 "+h(i.value.total)+" 条笔记",1)])]),a("div",Se,[s(c,{class:"action-btn refresh-btn",onClick:e[0]||(e[0]=l=>w(i.value.page,i.value.pageSize)),icon:m(ce),loading:N.value,disabled:N.value,circle:""},null,8,["icon","loading","disabled"]),s(c,{class:"action-btn create-btn",type:"primary",onClick:L,icon:m(J)},{default:u(()=>e[14]||(e[14]=[y(" 新建笔记 ",-1)])),_:1,__:[14]},8,["icon"])])]),pe((k(),b("div",Ue,[o.value.length===0&&!N.value?(k(),b("div",Te,[s(_,{class:"empty-icon"},{default:u(()=>[s(m(B))]),_:1}),e[16]||(e[16]=a("h3",{class:"empty-title"},"暂无笔记",-1)),e[17]||(e[17]=a("p",{class:"empty-desc"},"开始创建你的第一条笔记吧",-1)),s(c,{type:"primary",onClick:L,icon:m(J)},{default:u(()=>e[15]||(e[15]=[y("创建笔记",-1)])),_:1,__:[15]},8,["icon"])])):P("",!0),(k(!0),b(ve,null,_e(o.value,l=>{var G;return k(),b("div",{key:l.id,class:me(["note-card",{"note-active":((G=r.value)==null?void 0:G.id)===l.id}]),onClick:T=>F(l)},[a("div",Be,[a("h4",Pe,h(l.title),1),a("div",De,[s(c,{class:"action-icon",size:"small",icon:m(fe),onClick:D(T=>F(l),["stop"]),circle:"",plain:""},null,8,["icon","onClick"]),s(c,{class:"action-icon edit-icon",size:"small",type:"primary",icon:m(E),loading:v.value,disabled:v.value,onClick:D(T=>j(l),["stop"]),circle:"",plain:""},null,8,["icon","loading","disabled","onClick"]),s(c,{class:"action-icon delete-icon",size:"small",type:"danger",icon:m(ge),loading:v.value,disabled:v.value,onClick:D(T=>W(l),["stop"]),circle:"",plain:""},null,8,["icon","loading","disabled","onClick"])])]),a("div",Ee,[a("p",je,h(l.content),1)]),a("div",Fe,[a("div",Le,[e[18]||(e[18]=a("span",{class:"time-label"},"更新于",-1)),a("span",Me,h(U(l.updateTime)),1)])])],10,qe)}),128))])),[[te,N.value]]),i.value.total>0?(k(),b("div",Re,[s(Y,{"current-page":i.value.page,"onUpdate:currentPage":e[1]||(e[1]=l=>i.value.page=l),"page-size":i.value.pageSize,"onUpdate:pageSize":e[2]||(e[2]=l=>i.value.pageSize=l),"page-sizes":[6,12,24,48],total:i.value.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:X,onCurrentChange:K,class:"custom-pagination"},null,8,["current-page","page-size","total"])])):P("",!0),s(A,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=l=>g.value=l),title:f.value?"编辑笔记":"新建笔记",width:"90%","max-width":"600px",class:"note-dialog",onClose:e[8]||(e[8]=l=>f.value=!1),"destroy-on-close":""},{footer:u(()=>[a("div",Ae,[s(c,{size:"large",disabled:v.value,onClick:e[5]||(e[5]=l=>{g.value=!1,f.value=!1})},{default:u(()=>e[19]||(e[19]=[y(" 取消 ",-1)])),_:1,__:[19]},8,["disabled"]),s(c,{type:"primary",size:"large",loading:v.value,disabled:v.value,onClick:e[6]||(e[6]=l=>f.value?Q():O())},{default:u(()=>[y(h(f.value?"保存修改":"创建笔记"),1)]),_:1},8,["loading","disabled"])])]),default:u(()=>[a("div",Ie,[s(Z,{model:d,"label-position":"top"},{default:u(()=>[s(I,{label:"笔记标题",required:"",class:"form-item"},{default:u(()=>[s(R,{modelValue:d.title,"onUpdate:modelValue":e[3]||(e[3]=l=>d.title=l),placeholder:"请输入笔记标题",size:"large",class:"title-input"},null,8,["modelValue"])]),_:1}),s(I,{label:"笔记内容",required:"",class:"form-item"},{default:u(()=>[s(R,{modelValue:d.content,"onUpdate:modelValue":e[4]||(e[4]=l=>d.content=l),type:"textarea",rows:12,placeholder:"在这里记录你的想法...",class:"content-textarea",resize:"vertical"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue","title"]),s(A,{modelValue:M.value,"onUpdate:modelValue":e[11]||(e[11]=l=>M.value=l),title:"笔记详情",width:"90%","max-width":"700px",class:"detail-dialog",onClose:e[12]||(e[12]=l=>r.value=null),"destroy-on-close":""},{footer:u(()=>[a("div",Ze,[s(c,{size:"large",onClick:e[9]||(e[9]=l=>r.value=null)},{default:u(()=>e[20]||(e[20]=[y("关闭",-1)])),_:1,__:[20]}),s(c,{type:"primary",size:"large",icon:m(E),onClick:e[10]||(e[10]=l=>r.value&&j(r.value))},{default:u(()=>e[21]||(e[21]=[y(" 编辑笔记 ",-1)])),_:1,__:[21]},8,["icon"])])]),default:u(()=>[r.value?(k(),b("div",Ge,[a("div",He,[a("h2",Je,h(r.value.title),1),a("div",Ke,[a("span",Xe,[s(_,null,{default:u(()=>[s(m(B))]),_:1}),y(" 创建于 "+h(U(r.value.createTime)),1)]),a("span",Oe,[s(_,null,{default:u(()=>[s(m(E))]),_:1}),y(" 更新于 "+h(U(r.value.updateTime)),1)])])]),a("div",Qe,[a("div",We,[a("pre",Ye,h(r.value.content),1)])])])):P("",!0)]),_:1},8,["modelValue"])]),s(xe,{title:"描述"},{default:u(()=>[s(ee,null,{default:u(()=>e[22]||(e[22]=[y(" 在线笔记记录工具，支持创建、编辑、删除笔记，数据安全存储在云端。您可以随时记录想法、待办事项、学习笔记等，支持富文本编辑，数据实时同步。 ",-1)])),_:1,__:[22]})]),_:1})])}}});const ot=ye(et,[["__scopeId","data-v-34e5dfe9"]]);export{ot as default};
