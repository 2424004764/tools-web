import{_ as B}from"./DetailHeader.vue_vue_type_script_setup_true_lang-2c4dac67.js";import{_ as w}from"./ToolDetail.vue_vue_type_script_setup_true_lang-2f7bc01d.js";import{d as Q,z as V,r as N,w as R,f as v,g as L,h as D,m as u,j as t,l as c,t as M,v as A,F as Y,i as k,p as g,D as q,_ as K}from"./index-65c2207c.js";const X={class:"flex flex-col mt-3 flex-1"},j={class:"p-4 rounded-2xl bg-white"},F={key:0,class:"text-red-500 text-sm bg-red-50 p-3 rounded-lg border border-red-200"},J={key:1,class:"text-yellow-600 text-sm bg-yellow-50 p-3 rounded-lg border border-yellow-200"},z={class:"list-disc list-inside space-y-1"},H={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Z={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},ee={class:"flex flex-wrap gap-2"},te={key:0,class:"p-4 rounded-2xl bg-white"},le={class:"flex justify-between items-center mb-3"},se={class:"bg-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono"},ie="CREATE TABLE `users` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '用户ID',\n  `username` varchar(50) NOT NULL COMMENT '用户名',\n  `email` varchar(100) DEFAULT NULL COMMENT '邮箱',\n  `age` int(11) DEFAULT NULL COMMENT '年龄',\n  `created_at` datetime NOT NULL COMMENT '创建时间',\n  `updated_at` datetime DEFAULT NULL COMMENT '更新时间',\n  `is_active` tinyint(1) DEFAULT '1' COMMENT '是否激活',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_username` (`username`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';",ae=Q({__name:"MySQLToGo",setup(ne){const G=V({title:"MySQL转Go结构体"}),l=V({mysqlDDL:"",addJsonTag:!0,addGormTag:!0,addXormTag:!1,addGinTag:!1,usePointer:!1,useTime:!0,useNull:!1}),f=N(""),T=N(""),y=N([]),_={tinyint:"int8",smallint:"int16",mediumint:"int32",int:"int",integer:"int",bigint:"int64",float:"float32",double:"float64",decimal:"float64",numeric:"float64",char:"string",varchar:"string",text:"string",tinytext:"string",mediumtext:"string",longtext:"string",blob:"[]byte",tinyblob:"[]byte",mediumblob:"[]byte",longblob:"[]byte",binary:"[]byte",varbinary:"[]byte",date:"time.Time",time:"time.Time",datetime:"time.Time",timestamp:"time.Time",year:"int",json:"string",enum:"string",set:"string",bit:"[]byte",boolean:"bool",bool:"bool"},C=i=>{const e=[],p=[];if(!i.trim())return{isValid:!0,errors:e,warnings:p};if(!i.toUpperCase().includes("CREATE TABLE"))return e.push("DDL语句必须包含CREATE TABLE关键字"),{isValid:!1,errors:e,warnings:p};i.match(/CREATE\s+TABLE\s+(?:`?(\w+)`?|`([^`]+)`)/i)||e.push("无法识别表名，请确保CREATE TABLE语句格式正确");const r=i.split(`
`).map(m=>m.trim()).filter(m=>m);let a=!1;for(const m of r){if(m.startsWith("--")||m.startsWith("/*")||m.startsWith("CREATE TABLE")||m.startsWith("(")||m.startsWith(")")||m.startsWith("PRIMARY KEY")||m.startsWith("KEY")||m.startsWith("INDEX")||m.startsWith("UNIQUE KEY"))continue;const U=m.match(/`?(\w+)`?\s+(\w+)/i);if(U){a=!0;const[,b,h]=U;b||e.push(`字段定义错误: ${m}`),h?_[h.toLowerCase()]||p.push(`未知字段类型 "${h}"，将映射为string类型`):e.push(`字段类型缺失: ${m}`),b.includes(" ")&&e.push(`字段名包含空格: ${b}`)}}a||e.push("未找到有效的字段定义");const n=(i.match(/\(/g)||[]).length,o=(i.match(/\)/g)||[]).length;n!==o&&e.push("括号不匹配，请检查DDL语句的括号");const E=(i.match(/'/g)||[]).length,d=(i.match(/"/g)||[]).length;return E%2!==0&&e.push("单引号不匹配"),d%2!==0&&e.push("双引号不匹配"),(i.includes("121")||i.includes("UP1212DATE"))&&e.push("检测到明显的语法错误，如多余的数字或拼写错误"),i.includes("ON UP")&&!i.includes("ON UPDATE")&&e.push('ON UPDATE语法错误，应该是"ON UPDATE CURRENT_TIMESTAMP"'),{isValid:e.length===0,errors:e,warnings:p}},O=i=>{const e=i.match(/CREATE\s+TABLE\s+(?:`?(\w+)`?|`([^`]+)`)/i);return e&&(e[1]||e[2])||""},P=i=>i?i.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(""):"Table",I=i=>{const e=i.split(`
`).map(s=>s.trim()).filter(s=>s),p=[];for(const s of e){if(s.startsWith("--")||s.startsWith("/*")||s.startsWith("CREATE TABLE")||s.startsWith("(")||s.startsWith(")")||s.startsWith("PRIMARY KEY")||s.startsWith("KEY")||s.startsWith("INDEX")||s.startsWith("UNIQUE KEY"))continue;const r=s.match(/`?(\w+)`?\s+(\w+)(?:\([^)]+\))?(?:\s+(\w+))*(?:\s+COMMENT\s+['"]([^'"]*)['"])?/i);if(r){const[,a,n,,o]=r,E=s.includes("PRIMARY KEY")?"PRI":s.includes("UNIQUE KEY")?"UNI":s.includes("KEY")?"MUL":"";p.push({name:a.toLowerCase(),type:n.toLowerCase(),comment:o||"",key:E})}}return p},x=()=>{if(T.value="",y.value=[],!l.mysqlDDL.trim()){f.value="";return}const i=C(l.mysqlDDL);if(y.value=i.warnings,!i.isValid){T.value=i.errors.join("; "),f.value="";return}try{const e=I(l.mysqlDDL);if(e.length===0){T.value="未能解析到有效的字段信息，请检查DDL格式",f.value="";return}const p=O(l.mysqlDDL);if(!p){T.value="未能从DDL中提取到表名，请检查CREATE TABLE语句格式",f.value="";return}let r=`type ${P(p)} struct {
`;for(const a of e){let n=_[a.type]||"string";l.useNull&&(n==="string"?n="*string":n==="int"?n="*int":n==="int64"?n="*int64":n==="float64"?n="*float64":n==="bool"?n="*bool":n==="time.Time"&&(n="*time.Time")),l.usePointer&&!n.startsWith("*")&&(n="*"+n);const o=a.name.split("_").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join("");r+=`	${o}`,l.usePointer&&!n.startsWith("*")?r+=` *${n}`:r+=` ${n}`;const E=[];if(l.addJsonTag&&E.push(`json:"${a.name}"`),l.addGormTag){let d=`gorm:"column:${a.name}`;a.key==="PRI"&&(d+=";primaryKey"),a.comment&&(d+=`;comment:${a.comment}`),d+='"',E.push(d)}if(l.addXormTag){let d=`xorm:"'${a.name}'`;a.key==="PRI"&&(d+=" pk"),a.comment&&(d+=` comment('${a.comment}')`),d+='"',E.push(d)}l.addGinTag&&E.push(`form:"${a.name}" binding:"required"`),E.length>0&&(r+=` \`${E.join(" ")}\``),a.comment&&(r+=` // ${a.comment}`),r+=`
`}r+="}",l.useTime&&e.some(a=>_[a.type]==="time.Time")&&(r=`import "time"

`+r),f.value=r}catch(e){T.value=`转换失败: ${e}`,f.value=""}};R(()=>l.mysqlDDL,i=>{const e=C(i);y.value=e.warnings,e.isValid?(T.value="",x()):(T.value=e.errors.join("; "),f.value="")},{immediate:!0}),R([()=>l.addJsonTag,()=>l.addGormTag,()=>l.addXormTag,()=>l.addGinTag,()=>l.usePointer,()=>l.useTime,()=>l.useNull],()=>{l.mysqlDDL.trim()&&x()});const W=async()=>{f.value&&await q(f.value)},$=()=>{l.mysqlDDL="",f.value="",T.value="",y.value=[]},S=()=>{l.mysqlDDL=ie};return(i,e)=>{const p=v("el-input"),s=v("el-form-item"),r=v("el-switch"),a=v("el-button"),n=v("el-form");return L(),D("div",X,[u(B,{title:G.title},null,8,["title"]),t("div",j,[u(n,{model:l,"label-width":"120px",class:"space-y-4"},{default:c(()=>[u(s,{label:"MySQL DDL"},{default:c(()=>[u(p,{modelValue:l.mysqlDDL,"onUpdate:modelValue":e[0]||(e[0]=o=>l.mysqlDDL=o),type:"textarea",rows:8,placeholder:"请输入MySQL CREATE TABLE语句",class:"font-mono"},null,8,["modelValue"])]),_:1}),T.value?(L(),D("div",F,[e[8]||(e[8]=t("div",{class:"flex items-center mb-1"},[t("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),t("span",{class:"font-medium"},"错误")],-1)),t("div",null,M(T.value),1)])):A("",!0),y.value.length>0?(L(),D("div",J,[e[9]||(e[9]=t("div",{class:"flex items-center mb-1"},[t("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),t("span",{class:"font-medium"},"警告")],-1)),t("ul",z,[(L(!0),D(Y,null,k(y.value,o=>(L(),D("li",{key:o},M(o),1))),128))])])):A("",!0),t("div",H,[u(s,{label:"JSON标签"},{default:c(()=>[u(r,{modelValue:l.addJsonTag,"onUpdate:modelValue":e[1]||(e[1]=o=>l.addJsonTag=o)},null,8,["modelValue"])]),_:1}),u(s,{label:"GORM标签"},{default:c(()=>[u(r,{modelValue:l.addGormTag,"onUpdate:modelValue":e[2]||(e[2]=o=>l.addGormTag=o)},null,8,["modelValue"])]),_:1}),u(s,{label:"XORM标签"},{default:c(()=>[u(r,{modelValue:l.addXormTag,"onUpdate:modelValue":e[3]||(e[3]=o=>l.addXormTag=o)},null,8,["modelValue"])]),_:1}),u(s,{label:"Gin标签"},{default:c(()=>[u(r,{modelValue:l.addGinTag,"onUpdate:modelValue":e[4]||(e[4]=o=>l.addGinTag=o)},null,8,["modelValue"])]),_:1})]),t("div",Z,[u(s,{label:"使用指针"},{default:c(()=>[u(r,{modelValue:l.usePointer,"onUpdate:modelValue":e[5]||(e[5]=o=>l.usePointer=o)},null,8,["modelValue"])]),_:1}),u(s,{label:"使用time包"},{default:c(()=>[u(r,{modelValue:l.useTime,"onUpdate:modelValue":e[6]||(e[6]=o=>l.useTime=o)},null,8,["modelValue"])]),_:1}),u(s,{label:"可空类型"},{default:c(()=>[u(r,{modelValue:l.useNull,"onUpdate:modelValue":e[7]||(e[7]=o=>l.useNull=o)},null,8,["modelValue"])]),_:1})]),t("div",ee,[u(a,{onClick:S},{default:c(()=>e[10]||(e[10]=[g("加载示例",-1)])),_:1,__:[10]}),u(a,{onClick:$},{default:c(()=>e[11]||(e[11]=[g("清空",-1)])),_:1,__:[11]})])]),_:1},8,["model"])]),f.value?(L(),D("div",te,[t("div",le,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold"},"转换结果",-1)),u(a,{type:"primary",onClick:W},{default:c(()=>e[12]||(e[12]=[g("复制结果",-1)])),_:1,__:[12]})]),t("pre",se,M(f.value),1)])):A("",!0),u(w,{title:"功能说明"},{default:c(()=>e[14]||(e[14]=[t("div",{class:"space-y-2"},[t("p",null,"将MySQL数据表的DDL语句转换为Go语言结构体，支持以下功能："),t("ul",{class:"list-disc list-inside space-y-1 text-sm"},[t("li",null,[t("strong",null,"实时验证："),g("输入DDL时实时检查语法错误和格式问题")]),t("li",null,[t("strong",null,"自动转换："),g("输入DDL后自动转换，无需手动点击按钮")]),t("li",null,[t("strong",null,"自动提取："),g("自动从DDL中提取表名并转换为结构体名")]),t("li",null,[t("strong",null,"字段类型映射："),g("自动将MySQL字段类型转换为对应的Go类型")]),t("li",null,[t("strong",null,"标签生成："),g("支持生成JSON、GORM、XORM、Gin等常用标签")]),t("li",null,[t("strong",null,"命名转换："),g("将下划线命名转换为PascalCase命名")]),t("li",null,[t("strong",null,"注释保留："),g("保留字段注释信息")]),t("li",null,[t("strong",null,"错误提示："),g("详细的错误和警告信息，帮助快速定位问题")])])],-1)])),_:1,__:[14]}),u(w,{title:"使用说明"},{default:c(()=>e[15]||(e[15]=[t("div",{class:"space-y-2"},[t("ol",{class:"list-decimal list-inside space-y-1 text-sm"},[t("li",null,'在"MySQL DDL"文本框中粘贴完整的CREATE TABLE语句'),t("li",null,"系统会实时检查DDL格式，如有问题会显示错误或警告信息"),t("li",null,"系统会自动从DDL中提取表名并转换为结构体名"),t("li",null,"根据需要配置标签选项（JSON、GORM、XORM、Gin等）"),t("li",null,"配置其他选项（指针类型、时间包、可空类型等）"),t("li",null,'转换结果会实时显示，点击"复制结果"按钮复制生成的Go代码')]),t("p",{class:"text-sm text-gray-600 mt-2"},[t("strong",null,"提示："),g('可以点击"加载示例"按钮查看示例DDL语句。 ')])],-1)])),_:1,__:[15]})])}}});const me=K(ae,[["__scopeId","data-v-3f2c5f99"]]);export{me as default};
